/*! For license information please see app.min.js.LICENSE.txt */
(()=>{var e={680:function(e,t,i){var n;e=i.nmd(e),window.createjs=window.createjs||{},function(){"use strict";var e=createjs.PreloadJS=createjs.PreloadJS||{};e.version="1.0.0",e.buildDate="Thu, 14 Sep 2017 19:47:47 GMT"}(),window.createjs=window.createjs||{},createjs.extend=function(e,t){"use strict";function i(){this.constructor=e}return i.prototype=t.prototype,e.prototype=new i},window.createjs=window.createjs||{},createjs.promote=function(e,t){"use strict";var i=e.prototype,n=Object.getPrototypeOf&&Object.getPrototypeOf(i)||i.__proto__;if(n)for(var r in i[(t+="_")+"constructor"]=n.constructor,n)i.hasOwnProperty(r)&&"function"==typeof n[r]&&(i[t+r]=n[r]);return e},window.createjs=window.createjs||{},createjs.deprecate=function(e,t){"use strict";return function(){var i="Deprecated property or method '"+t+"'. See docs for info.";return console&&(console.warn?console.warn(i):console.log(i)),e&&e.apply(this,arguments)}},window.createjs=window.createjs||{},function(){"use strict";createjs.proxy=function(e,t){var i=Array.prototype.slice.call(arguments,2);return function(){return e.apply(t,Array.prototype.slice.call(arguments,0).concat(i))}}}(),window.createjs=window.createjs||{},createjs.indexOf=function(e,t){"use strict";for(var i=0,n=e.length;i<n;i++)if(t===e[i])return i;return-1},window.createjs=window.createjs||{},function(){"use strict";function e(e,t,i){this.type=e,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!t,this.cancelable=!!i,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var t=e.prototype;t.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},t.stopPropagation=function(){this.propagationStopped=!0},t.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},t.remove=function(){this.removed=!0},t.clone=function(){return new e(this.type,this.bubbles,this.cancelable)},t.set=function(e){for(var t in e)this[t]=e[t];return this},t.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=e}(),window.createjs=window.createjs||{},function(){"use strict";function e(e,t,i){this.Event_constructor("error"),this.title=e,this.message=t,this.data=i}createjs.extend(e,createjs.Event).clone=function(){return new createjs.ErrorEvent(this.title,this.message,this.data)},createjs.ErrorEvent=createjs.promote(e,"Event")}(),window.createjs=window.createjs||{},function(){"use strict";function e(){this._listeners=null,this._captureListeners=null}var t=e.prototype;e.initialize=function(e){e.addEventListener=t.addEventListener,e.on=t.on,e.removeEventListener=e.off=t.removeEventListener,e.removeAllEventListeners=t.removeAllEventListeners,e.hasEventListener=t.hasEventListener,e.dispatchEvent=t.dispatchEvent,e._dispatchEvent=t._dispatchEvent,e.willTrigger=t.willTrigger},t.addEventListener=function(e,t,i){var n,r=(n=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{})[e];return r&&this.removeEventListener(e,t,i),(r=n[e])?r.push(t):n[e]=[t],t},t.on=function(e,t,i,n,r,s){return t.handleEvent&&(i=i||t,t=t.handleEvent),i=i||this,this.addEventListener(e,(function(e){t.call(i,e,r),n&&e.remove()}),s)},t.removeEventListener=function(e,t,i){var n=i?this._captureListeners:this._listeners;if(n){var r=n[e];if(r)for(var s=0,a=r.length;s<a;s++)if(r[s]==t){1==a?delete n[e]:r.splice(s,1);break}}},t.off=t.removeEventListener,t.removeAllEventListeners=function(e){e?(this._listeners&&delete this._listeners[e],this._captureListeners&&delete this._captureListeners[e]):this._listeners=this._captureListeners=null},t.dispatchEvent=function(e,t,i){if("string"==typeof e){var n=this._listeners;if(!(t||n&&n[e]))return!0;e=new createjs.Event(e,t,i)}else e.target&&e.clone&&(e=e.clone());try{e.target=this}catch(e){}if(e.bubbles&&this.parent){for(var r=this,s=[r];r.parent;)s.push(r=r.parent);var a,o=s.length;for(a=o-1;a>=0&&!e.propagationStopped;a--)s[a]._dispatchEvent(e,1+(0==a));for(a=1;a<o&&!e.propagationStopped;a++)s[a]._dispatchEvent(e,3)}else this._dispatchEvent(e,2);return!e.defaultPrevented},t.hasEventListener=function(e){var t=this._listeners,i=this._captureListeners;return!!(t&&t[e]||i&&i[e])},t.willTrigger=function(e){for(var t=this;t;){if(t.hasEventListener(e))return!0;t=t.parent}return!1},t.toString=function(){return"[EventDispatcher]"},t._dispatchEvent=function(e,t){var i,n,r=t<=2?this._captureListeners:this._listeners;if(e&&r&&(n=r[e.type])&&(i=n.length)){try{e.currentTarget=this}catch(e){}try{e.eventPhase=0|t}catch(e){}e.removed=!1,n=n.slice();for(var s=0;s<i&&!e.immediatePropagationStopped;s++){var a=n[s];a.handleEvent?a.handleEvent(e):a(e),e.removed&&(this.off(e.type,a,1==t),e.removed=!1)}}2===t&&this._dispatchEvent(e,2.1)},createjs.EventDispatcher=e}(),window.createjs=window.createjs||{},function(e){"use strict";function t(e,t){this.Event_constructor("progress"),this.loaded=e,this.total=null==t?1:t,this.progress=0==t?0:this.loaded/this.total}createjs.extend(t,createjs.Event).clone=function(){return new createjs.ProgressEvent(this.loaded,this.total)},createjs.ProgressEvent=createjs.promote(t,"Event")}(window),function(){var r=i.amdO,s={function:!0,object:!0},a=s[typeof t]&&t&&!t.nodeType&&t,o=s[typeof window]&&window||this,l=a&&s.object&&e&&!e.nodeType&&"object"==typeof i.g&&i.g;function c(e,t){e||(e=o.Object()),t||(t=o.Object());var i=e.Number||o.Number,n=e.String||o.String,r=e.Object||o.Object,a=e.Date||o.Date,l=e.SyntaxError||o.SyntaxError,h=e.TypeError||o.TypeError,d=e.Math||o.Math,u=e.JSON||o.JSON;"object"==typeof u&&u&&(t.stringify=u.stringify,t.parse=u.parse);var p,f,m,g=r.prototype,v=g.toString,_=new a(-0xc782b5b800cec);try{_=-109252==_.getUTCFullYear()&&0===_.getUTCMonth()&&1===_.getUTCDate()&&10==_.getUTCHours()&&37==_.getUTCMinutes()&&6==_.getUTCSeconds()&&708==_.getUTCMilliseconds()}catch(e){}function y(e){if(y[e]!==m)return y[e];var r;if("bug-string-char-index"==e)r="a"!="a"[0];else if("json"==e)r=y("json-stringify")&&y("json-parse");else{var s,o='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var l=t.stringify,c="function"==typeof l&&_;if(c){(s=function(){return 1}).toJSON=s;try{c="0"===l(0)&&"0"===l(new i)&&'""'==l(new n)&&l(v)===m&&l(m)===m&&l()===m&&"1"===l(s)&&"[1]"==l([s])&&"[null]"==l([m])&&"null"==l(null)&&"[null,null,null]"==l([m,v,null])&&l({a:[s,!0,!1,null,"\0\b\n\f\r\t"]})==o&&"1"===l(null,s)&&"[\n 1,\n 2\n]"==l([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==l(new a(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==l(new a(864e13))&&'"-000001-01-01T00:00:00.000Z"'==l(new a(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==l(new a(-1))}catch(e){c=!1}}r=c}if("json-parse"==e){var h=t.parse;if("function"==typeof h)try{if(0===h("0")&&!h(!1)){var d=5==(s=h(o)).a.length&&1===s.a[0];if(d){try{d=!h('"\t"')}catch(e){}if(d)try{d=1!==h("01")}catch(e){}if(d)try{d=1!==h("1.")}catch(e){}}}}catch(e){d=!1}r=d}}return y[e]=!!r}if(!y("json")){var b="[object Function]",x="[object Number]",w="[object String]",E="[object Array]",S=y("bug-string-char-index");if(!_)var T=d.floor,M=[0,31,59,90,120,151,181,212,243,273,304,334],A=function(e,t){return M[t]+365*(e-1970)+T((e-1969+(t=+(t>1)))/4)-T((e-1901+t)/100)+T((e-1601+t)/400)};if((p=g.hasOwnProperty)||(p=function(e){var t,i={};return(i.__proto__=null,i.__proto__={toString:1},i).toString!=v?p=function(e){var t=this.__proto__,i=e in(this.__proto__=null,this);return this.__proto__=t,i}:(t=i.constructor,p=function(e){var i=(this.constructor||t).prototype;return e in this&&!(e in i&&this[e]===i[e])}),i=null,p.call(this,e)}),f=function(e,t){var i,n,r,a=0;for(r in(i=function(){this.valueOf=0}).prototype.valueOf=0,n=new i)p.call(n,r)&&a++;return i=n=null,a?f=2==a?function(e,t){var i,n={},r=v.call(e)==b;for(i in e)r&&"prototype"==i||p.call(n,i)||!(n[i]=1)||!p.call(e,i)||t(i)}:function(e,t){var i,n,r=v.call(e)==b;for(i in e)r&&"prototype"==i||!p.call(e,i)||(n="constructor"===i)||t(i);(n||p.call(e,i="constructor"))&&t(i)}:(n=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],f=function(e,t){var i,r,a=v.call(e)==b,o=!a&&"function"!=typeof e.constructor&&s[typeof e.hasOwnProperty]&&e.hasOwnProperty||p;for(i in e)a&&"prototype"==i||!o.call(e,i)||t(i);for(r=n.length;i=n[--r];o.call(e,i)&&t(i));}),f(e,t)},!y("json-stringify")){var C={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},L=function(e,t){return("000000"+(t||0)).slice(-e)},P=function(e){for(var t='"',i=0,n=e.length,r=!S||n>10,s=r&&(S?e.split(""):e);i<n;i++){var a=e.charCodeAt(i);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=C[a];break;default:if(a<32){t+="\\u00"+L(2,a.toString(16));break}t+=r?s[i]:e.charAt(i)}}return t+'"'},R=function(e,t,i,n,r,s,a){var o,l,c,d,u,g,_,y,b,S,M,C,O,I,D,N;try{o=t[e]}catch(e){}if("object"==typeof o&&o)if("[object Date]"!=(l=v.call(o))||p.call(o,"toJSON"))"function"==typeof o.toJSON&&(l!=x&&l!=w&&l!=E||p.call(o,"toJSON"))&&(o=o.toJSON(e));else if(o>-1/0&&o<1/0){if(A){for(u=T(o/864e5),c=T(u/365.2425)+1970-1;A(c+1,0)<=u;c++);for(d=T((u-A(c,0))/30.42);A(c,d+1)<=u;d++);u=1+u-A(c,d),_=T((g=(o%864e5+864e5)%864e5)/36e5)%24,y=T(g/6e4)%60,b=T(g/1e3)%60,S=g%1e3}else c=o.getUTCFullYear(),d=o.getUTCMonth(),u=o.getUTCDate(),_=o.getUTCHours(),y=o.getUTCMinutes(),b=o.getUTCSeconds(),S=o.getUTCMilliseconds();o=(c<=0||c>=1e4?(c<0?"-":"+")+L(6,c<0?-c:c):L(4,c))+"-"+L(2,d+1)+"-"+L(2,u)+"T"+L(2,_)+":"+L(2,y)+":"+L(2,b)+"."+L(3,S)+"Z"}else o=null;if(i&&(o=i.call(t,e,o)),null===o)return"null";if("[object Boolean]"==(l=v.call(o)))return""+o;if(l==x)return o>-1/0&&o<1/0?""+o:"null";if(l==w)return P(""+o);if("object"==typeof o){for(I=a.length;I--;)if(a[I]===o)throw h();if(a.push(o),M=[],D=s,s+=r,l==E){for(O=0,I=o.length;O<I;O++)C=R(O,o,i,n,r,s,a),M.push(C===m?"null":C);N=M.length?r?"[\n"+s+M.join(",\n"+s)+"\n"+D+"]":"["+M.join(",")+"]":"[]"}else f(n||o,(function(e){var t=R(e,o,i,n,r,s,a);t!==m&&M.push(P(e)+":"+(r?" ":"")+t)})),N=M.length?r?"{\n"+s+M.join(",\n"+s)+"\n"+D+"}":"{"+M.join(",")+"}":"{}";return a.pop(),N}};t.stringify=function(e,t,i){var n,r,a,o;if(s[typeof t]&&t)if((o=v.call(t))==b)r=t;else if(o==E){a={};for(var l,c=0,h=t.length;c<h;l=t[c++],((o=v.call(l))==w||o==x)&&(a[l]=1));}if(i)if((o=v.call(i))==x){if((i-=i%1)>0)for(n="",i>10&&(i=10);n.length<i;n+=" ");}else o==w&&(n=i.length<=10?i:i.slice(0,10));return R("",((l={})[""]=e,l),r,a,n,"",[])}}if(!y("json-parse")){var O,I,D=n.fromCharCode,N={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},U=function(){throw O=I=null,l()},F=function(){for(var e,t,i,n,r,s=I,a=s.length;O<a;)switch(r=s.charCodeAt(O)){case 9:case 10:case 13:case 32:O++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=S?s.charAt(O):s[O],O++,e;case 34:for(e="@",O++;O<a;)if((r=s.charCodeAt(O))<32)U();else if(92==r)switch(r=s.charCodeAt(++O)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=N[r],O++;break;case 117:for(t=++O,i=O+4;O<i;O++)(r=s.charCodeAt(O))>=48&&r<=57||r>=97&&r<=102||r>=65&&r<=70||U();e+=D("0x"+s.slice(t,O));break;default:U()}else{if(34==r)break;for(r=s.charCodeAt(O),t=O;r>=32&&92!=r&&34!=r;)r=s.charCodeAt(++O);e+=s.slice(t,O)}if(34==s.charCodeAt(O))return O++,e;U();default:if(t=O,45==r&&(n=!0,r=s.charCodeAt(++O)),r>=48&&r<=57){for(48==r&&(r=s.charCodeAt(O+1))>=48&&r<=57&&U(),n=!1;O<a&&(r=s.charCodeAt(O))>=48&&r<=57;O++);if(46==s.charCodeAt(O)){for(i=++O;i<a&&(r=s.charCodeAt(i))>=48&&r<=57;i++);i==O&&U(),O=i}if(101==(r=s.charCodeAt(O))||69==r){for(43!=(r=s.charCodeAt(++O))&&45!=r||O++,i=O;i<a&&(r=s.charCodeAt(i))>=48&&r<=57;i++);i==O&&U(),O=i}return+s.slice(t,O)}if(n&&U(),"true"==s.slice(O,O+4))return O+=4,!0;if("false"==s.slice(O,O+5))return O+=5,!1;if("null"==s.slice(O,O+4))return O+=4,null;U()}return"$"},z=function(e){var t,i;if("$"==e&&U(),"string"==typeof e){if("@"==(S?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];"]"!=(e=F());i||(i=!0))i&&(","==e?"]"==(e=F())&&U():U()),","==e&&U(),t.push(z(e));return t}if("{"==e){for(t={};"}"!=(e=F());i||(i=!0))i&&(","==e?"}"==(e=F())&&U():U()),","!=e&&"string"==typeof e&&"@"==(S?e.charAt(0):e[0])&&":"==F()||U(),t[e.slice(1)]=z(F());return t}U()}return e},k=function(e,t,i){var n=H(e,t,i);n===m?delete e[t]:e[t]=n},H=function(e,t,i){var n,r=e[t];if("object"==typeof r&&r)if(v.call(r)==E)for(n=r.length;n--;)k(r,n,i);else f(r,(function(e){k(r,e,i)}));return i.call(e,t,r)};t.parse=function(e,t){var i,n;return O=0,I=""+e,i=z(F()),"$"!=F()&&U(),O=I=null,t&&v.call(t)==b?H(((n={})[""]=i,n),"",t):i}}}return t.runInContext=c,t}if(!l||l.global!==l&&l.window!==l&&l.self!==l||(o=l),a&&!r)c(o,a);else{var h=o.JSON,d=o.JSON3,u=!1,p=c(o,o.JSON3={noConflict:function(){return u||(u=!0,o.JSON=h,o.JSON3=d,h=d=null),p}});o.JSON={parse:p.parse,stringify:p.stringify}}r&&(void 0===(n=function(){return p}.call(t,i,t,e))||(e.exports=n))}.call(this),function(){var e={a:function(){return e.el("a")},svg:function(){return e.el("svg")},object:function(){return e.el("object")},image:function(){return e.el("image")},img:function(){return e.el("img")},style:function(){return e.el("style")},link:function(){return e.el("link")},script:function(){return e.el("script")},audio:function(){return e.el("audio")},video:function(){return e.el("video")},text:function(e){return document.createTextNode(e)},el:function(e){return document.createElement(e)}};createjs.Elements=e}(),function(){var e={ABSOLUTE_PATT:/^(?:\w+:)?\/{2}/i,RELATIVE_PATT:/^[./]*?\//i,EXTENSION_PATT:/\/?[^/]+\.(\w{1,5})$/i,parseURI:function(t){var i={absolute:!1,relative:!1,protocol:null,hostname:null,port:null,pathname:null,search:null,hash:null,host:null};if(null==t)return i;var n=createjs.Elements.a();for(var r in n.href=t,i)r in n&&(i[r]=n[r]);var s,a=t.indexOf("?");return a>-1&&(t=t.substr(0,a)),e.ABSOLUTE_PATT.test(t)?i.absolute=!0:e.RELATIVE_PATT.test(t)&&(i.relative=!0),(s=t.match(e.EXTENSION_PATT))&&(i.extension=s[1].toLowerCase()),i},formatQueryString:function(e,t){if(null==e)throw new Error("You must specify data.");var i=[];for(var n in e)i.push(n+"="+escape(e[n]));return t&&(i=i.concat(t)),i.join("&")},buildURI:function(e,t){if(null==t)return e;var i=[],n=e.indexOf("?");if(-1!=n){var r=e.slice(n+1);i=i.concat(r.split("&"))}return-1!=n?e.slice(0,n)+"?"+this.formatQueryString(t,i):e+"?"+this.formatQueryString(t,i)},isCrossDomain:function(e){var t=createjs.Elements.a();t.href=e.src;var i=createjs.Elements.a();return i.href=location.href,""!=t.hostname&&(t.port!=i.port||t.protocol!=i.protocol||t.hostname!=i.hostname)},isLocal:function(e){var t=createjs.Elements.a();return t.href=e.src,""==t.hostname&&"file:"==t.protocol}};createjs.URLUtils=e}(),function(){var e={container:null,appendToHead:function(t){e.getHead().appendChild(t)},appendToBody:function(t){if(null==e.container){e.container=document.createElement("div"),e.container.id="preloadjs-container";var i=e.container.style;i.visibility="hidden",i.position="absolute",i.width=e.container.style.height="10px",i.overflow="hidden",i.transform=i.msTransform=i.webkitTransform=i.oTransform="translate(-10px, -10px)",e.getBody().appendChild(e.container)}e.container.appendChild(t)},getHead:function(){return document.head||document.getElementsByTagName("head")[0]},getBody:function(){return document.body||document.getElementsByTagName("body")[0]},removeChild:function(e){e.parent&&e.parent.removeChild(e)},isImageTag:function(e){return e instanceof HTMLImageElement},isAudioTag:function(e){return!!window.HTMLAudioElement&&e instanceof HTMLAudioElement},isVideoTag:function(e){return!!window.HTMLVideoElement&&e instanceof HTMLVideoElement}};createjs.DomUtils=e}(),function(){var e={parseXML:function(e){var t=null;try{window.DOMParser&&(t=(new DOMParser).parseFromString(e,"text/xml"))}catch(e){}if(!t)try{(t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(e)}catch(e){t=null}return t},parseJSON:function(e){if(null==e)return null;try{return JSON.parse(e)}catch(e){throw e}}};createjs.DataUtils=e}(),window.createjs=window.createjs||{},createjs.Types={BINARY:"binary",CSS:"css",FONT:"font",FONTCSS:"fontcss",IMAGE:"image",JAVASCRIPT:"javascript",JSON:"json",JSONP:"jsonp",MANIFEST:"manifest",SOUND:"sound",VIDEO:"video",SPRITESHEET:"spritesheet",SVG:"svg",TEXT:"text",XML:"xml"},window.createjs=window.createjs||{},createjs.Methods={POST:"POST",GET:"GET"},window.createjs=window.createjs||{},function(){"use strict";function e(){this.src=null,this.type=null,this.id=null,this.maintainOrder=!1,this.callback=null,this.data=null,this.method=createjs.Methods.GET,this.values=null,this.headers=null,this.withCredentials=!1,this.mimeType=null,this.crossOrigin=null,this.loadTimeout=i.LOAD_TIMEOUT_DEFAULT}var t=e.prototype={},i=e;i.LOAD_TIMEOUT_DEFAULT=8e3,i.create=function(t){if("string"==typeof t){var n=new e;return n.src=t,n}if(t instanceof i)return t;if(t instanceof Object&&t.src)return null==t.loadTimeout&&(t.loadTimeout=i.LOAD_TIMEOUT_DEFAULT),t;throw new Error("Type not recognized.")},t.set=function(e){for(var t in e)this[t]=e[t];return this},createjs.LoadItem=i}(),function(){var e={isBinary:function(e){switch(e){case createjs.Types.IMAGE:case createjs.Types.BINARY:return!0;default:return!1}},isText:function(e){switch(e){case createjs.Types.TEXT:case createjs.Types.JSON:case createjs.Types.MANIFEST:case createjs.Types.XML:case createjs.Types.CSS:case createjs.Types.SVG:case createjs.Types.JAVASCRIPT:case createjs.Types.SPRITESHEET:return!0;default:return!1}},getTypeByExtension:function(e){if(null==e)return createjs.Types.TEXT;switch(e.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"webp":case"bmp":return createjs.Types.IMAGE;case"ogg":case"mp3":case"webm":return createjs.Types.SOUND;case"mp4":case"webm":case"ts":return createjs.Types.VIDEO;case"json":return createjs.Types.JSON;case"xml":return createjs.Types.XML;case"css":return createjs.Types.CSS;case"js":return createjs.Types.JAVASCRIPT;case"svg":return createjs.Types.SVG;default:return createjs.Types.TEXT}}};createjs.RequestUtils=e}(),window.createjs=window.createjs||{},function(){"use strict";function e(e,t,i){this.EventDispatcher_constructor(),this.loaded=!1,this.canceled=!1,this.progress=0,this.type=i,this.resultFormatter=null,this._item=e?createjs.LoadItem.create(e):null,this._preferXHR=t,this._result=null,this._rawResult=null,this._loadedItems=null,this._tagSrcAttribute=null,this._tag=null}var t=createjs.extend(e,createjs.EventDispatcher),i=e;try{Object.defineProperties(i,{POST:{get:createjs.deprecate((function(){return createjs.Methods.POST}),"AbstractLoader.POST")},GET:{get:createjs.deprecate((function(){return createjs.Methods.GET}),"AbstractLoader.GET")},BINARY:{get:createjs.deprecate((function(){return createjs.Types.BINARY}),"AbstractLoader.BINARY")},CSS:{get:createjs.deprecate((function(){return createjs.Types.CSS}),"AbstractLoader.CSS")},FONT:{get:createjs.deprecate((function(){return createjs.Types.FONT}),"AbstractLoader.FONT")},FONTCSS:{get:createjs.deprecate((function(){return createjs.Types.FONTCSS}),"AbstractLoader.FONTCSS")},IMAGE:{get:createjs.deprecate((function(){return createjs.Types.IMAGE}),"AbstractLoader.IMAGE")},JAVASCRIPT:{get:createjs.deprecate((function(){return createjs.Types.JAVASCRIPT}),"AbstractLoader.JAVASCRIPT")},JSON:{get:createjs.deprecate((function(){return createjs.Types.JSON}),"AbstractLoader.JSON")},JSONP:{get:createjs.deprecate((function(){return createjs.Types.JSONP}),"AbstractLoader.JSONP")},MANIFEST:{get:createjs.deprecate((function(){return createjs.Types.MANIFEST}),"AbstractLoader.MANIFEST")},SOUND:{get:createjs.deprecate((function(){return createjs.Types.SOUND}),"AbstractLoader.SOUND")},VIDEO:{get:createjs.deprecate((function(){return createjs.Types.VIDEO}),"AbstractLoader.VIDEO")},SPRITESHEET:{get:createjs.deprecate((function(){return createjs.Types.SPRITESHEET}),"AbstractLoader.SPRITESHEET")},SVG:{get:createjs.deprecate((function(){return createjs.Types.SVG}),"AbstractLoader.SVG")},TEXT:{get:createjs.deprecate((function(){return createjs.Types.TEXT}),"AbstractLoader.TEXT")},XML:{get:createjs.deprecate((function(){return createjs.Types.XML}),"AbstractLoader.XML")}})}catch(e){}t.getItem=function(){return this._item},t.getResult=function(e){return e?this._rawResult:this._result},t.getTag=function(){return this._tag},t.setTag=function(e){this._tag=e},t.load=function(){this._createRequest(),this._request.on("complete",this,this),this._request.on("progress",this,this),this._request.on("loadStart",this,this),this._request.on("abort",this,this),this._request.on("timeout",this,this),this._request.on("error",this,this);var e=new createjs.Event("initialize");e.loader=this._request,this.dispatchEvent(e),this._request.load()},t.cancel=function(){this.canceled=!0,this.destroy()},t.destroy=function(){this._request&&(this._request.removeAllEventListeners(),this._request.destroy()),this._request=null,this._item=null,this._rawResult=null,this._result=null,this._loadItems=null,this.removeAllEventListeners()},t.getLoadedItems=function(){return this._loadedItems},t._createRequest=function(){this._preferXHR?this._request=new createjs.XHRRequest(this._item):this._request=new createjs.TagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},t._createTag=function(e){return null},t._sendLoadStart=function(){this._isCanceled()||this.dispatchEvent("loadstart")},t._sendProgress=function(e){if(!this._isCanceled()){var t=null;"number"==typeof e?(this.progress=e,t=new createjs.ProgressEvent(this.progress)):(t=e,this.progress=e.loaded/e.total,t.progress=this.progress,(isNaN(this.progress)||this.progress==1/0)&&(this.progress=0)),this.hasEventListener("progress")&&this.dispatchEvent(t)}},t._sendComplete=function(){if(!this._isCanceled()){this.loaded=!0;var e=new createjs.Event("complete");e.rawResult=this._rawResult,null!=this._result&&(e.result=this._result),this.dispatchEvent(e)}},t._sendError=function(e){!this._isCanceled()&&this.hasEventListener("error")&&(null==e&&(e=new createjs.ErrorEvent("PRELOAD_ERROR_EMPTY")),this.dispatchEvent(e))},t._isCanceled=function(){return!(null!=window.createjs&&!this.canceled)},t.resultFormatter=null,t.handleEvent=function(e){switch(e.type){case"complete":this._rawResult=e.target._response;var t=this.resultFormatter&&this.resultFormatter(this);t instanceof Function?t.call(this,createjs.proxy(this._resultFormatSuccess,this),createjs.proxy(this._resultFormatFailed,this)):(this._result=t||this._rawResult,this._sendComplete());break;case"progress":this._sendProgress(e);break;case"error":this._sendError(e);break;case"loadstart":this._sendLoadStart();break;case"abort":case"timeout":this._isCanceled()||this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_"+e.type.toUpperCase()+"_ERROR"))}},t._resultFormatSuccess=function(e){this._result=e,this._sendComplete()},t._resultFormatFailed=function(e){this._sendError(e)},t.toString=function(){return"[PreloadJS AbstractLoader]"},createjs.AbstractLoader=createjs.promote(e,"EventDispatcher")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e,t,i){this.AbstractLoader_constructor(e,t,i),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.on("initialize",this._updateXHR,this)}var t=createjs.extend(e,createjs.AbstractLoader);t.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},t._createTag=function(){},t._createRequest=function(){this._preferXHR?this._request=new createjs.XHRRequest(this._item):this._request=new createjs.MediaTagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},t._updateXHR=function(e){e.loader.setResponseType&&e.loader.setResponseType("blob")},t._formatResult=function(e){if(this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR){var t=window.URL||window.webkitURL,i=e.getResult(!0);e.getTag().src=t.createObjectURL(i)}return e.getTag()},createjs.AbstractMediaLoader=createjs.promote(e,"AbstractLoader")}(),window.createjs=window.createjs||{},function(){"use strict";var e=function(e){this._item=e},t=createjs.extend(e,createjs.EventDispatcher);t.load=function(){},t.destroy=function(){},t.cancel=function(){},createjs.AbstractRequest=createjs.promote(e,"EventDispatcher")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e,t,i){this.AbstractRequest_constructor(e),this._tag=t,this._tagSrcAttribute=i,this._loadedHandler=createjs.proxy(this._handleTagComplete,this),this._addedToDOM=!1}var t=createjs.extend(e,createjs.AbstractRequest);t.load=function(){this._tag.onload=createjs.proxy(this._handleTagComplete,this),this._tag.onreadystatechange=createjs.proxy(this._handleReadyStateChange,this),this._tag.onerror=createjs.proxy(this._handleError,this);var e=new createjs.Event("initialize");e.loader=this._tag,this.dispatchEvent(e),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag[this._tagSrcAttribute]=this._item.src,null==this._tag.parentNode&&(createjs.DomUtils.appendToBody(this._tag),this._addedToDOM=!0)},t.destroy=function(){this._clean(),this._tag=null,this.AbstractRequest_destroy()},t._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var e=this._tag;"loaded"!=e.readyState&&"complete"!=e.readyState||this._handleTagComplete()},t._handleError=function(){this._clean(),this.dispatchEvent("error")},t._handleTagComplete=function(){this._rawResult=this._tag,this._result=this.resultFormatter&&this.resultFormatter(this)||this._rawResult,this._clean(),this.dispatchEvent("complete")},t._handleTimeout=function(){this._clean(),this.dispatchEvent(new createjs.Event("timeout"))},t._clean=function(){this._tag.onload=null,this._tag.onreadystatechange=null,this._tag.onerror=null,this._addedToDOM&&null!=this._tag.parentNode&&this._tag.parentNode.removeChild(this._tag),clearTimeout(this._loadTimeout)},t._handleStalled=function(){},createjs.TagRequest=createjs.promote(e,"AbstractRequest")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e,t,i){this.AbstractRequest_constructor(e),this._tag=t,this._tagSrcAttribute=i,this._loadedHandler=createjs.proxy(this._handleTagComplete,this)}var t=createjs.extend(e,createjs.TagRequest);t.load=function(){var e=createjs.proxy(this._handleStalled,this);this._stalledCallback=e;var t=createjs.proxy(this._handleProgress,this);this._handleProgress=t,this._tag.addEventListener("stalled",e),this._tag.addEventListener("progress",t),this._tag.addEventListener&&this._tag.addEventListener("canplaythrough",this._loadedHandler,!1),this.TagRequest_load()},t._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var e=this._tag;"loaded"!=e.readyState&&"complete"!=e.readyState||this._handleTagComplete()},t._handleStalled=function(){},t._handleProgress=function(e){if(e&&!(e.loaded>0&&0==e.total)){var t=new createjs.ProgressEvent(e.loaded,e.total);this.dispatchEvent(t)}},t._clean=function(){this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.removeEventListener("stalled",this._stalledCallback),this._tag.removeEventListener("progress",this._progressCallback),this.TagRequest__clean()},createjs.MediaTagRequest=createjs.promote(e,"TagRequest")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e){this.AbstractRequest_constructor(e),this._request=null,this._loadTimeout=null,this._xhrLevel=1,this._response=null,this._rawResponse=null,this._canceled=!1,this._handleLoadStartProxy=createjs.proxy(this._handleLoadStart,this),this._handleProgressProxy=createjs.proxy(this._handleProgress,this),this._handleAbortProxy=createjs.proxy(this._handleAbort,this),this._handleErrorProxy=createjs.proxy(this._handleError,this),this._handleTimeoutProxy=createjs.proxy(this._handleTimeout,this),this._handleLoadProxy=createjs.proxy(this._handleLoad,this),this._handleReadyStateChangeProxy=createjs.proxy(this._handleReadyStateChange,this),this._createXHR(e)}var t=createjs.extend(e,createjs.AbstractRequest);e.ACTIVEX_VERSIONS=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],t.getResult=function(e){return e&&this._rawResponse?this._rawResponse:this._response},t.cancel=function(){this.canceled=!0,this._clean(),this._request.abort()},t.load=function(){if(null!=this._request){null!=this._request.addEventListener?(this._request.addEventListener("loadstart",this._handleLoadStartProxy,!1),this._request.addEventListener("progress",this._handleProgressProxy,!1),this._request.addEventListener("abort",this._handleAbortProxy,!1),this._request.addEventListener("error",this._handleErrorProxy,!1),this._request.addEventListener("timeout",this._handleTimeoutProxy,!1),this._request.addEventListener("load",this._handleLoadProxy,!1),this._request.addEventListener("readystatechange",this._handleReadyStateChangeProxy,!1)):(this._request.onloadstart=this._handleLoadStartProxy,this._request.onprogress=this._handleProgressProxy,this._request.onabort=this._handleAbortProxy,this._request.onerror=this._handleErrorProxy,this._request.ontimeout=this._handleTimeoutProxy,this._request.onload=this._handleLoadProxy,this._request.onreadystatechange=this._handleReadyStateChangeProxy),1==this._xhrLevel&&(this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout));try{this._item.values?this._request.send(createjs.URLUtils.formatQueryString(this._item.values)):this._request.send()}catch(e){this.dispatchEvent(new createjs.ErrorEvent("XHR_SEND",null,e))}}else this._handleError()},t.setResponseType=function(e){"blob"===e&&(e=window.URL?"blob":"arraybuffer",this._responseType=e),this._request.responseType=e},t.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders instanceof Function?this._request.getAllResponseHeaders():null},t.getResponseHeader=function(e){return this._request.getResponseHeader instanceof Function?this._request.getResponseHeader(e):null},t._handleProgress=function(e){if(e&&!(e.loaded>0&&0==e.total)){var t=new createjs.ProgressEvent(e.loaded,e.total);this.dispatchEvent(t)}},t._handleLoadStart=function(e){clearTimeout(this._loadTimeout),this.dispatchEvent("loadstart")},t._handleAbort=function(e){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("XHR_ABORTED",null,e))},t._handleError=function(e){this._clean(),this.dispatchEvent(new createjs.ErrorEvent(e.message))},t._handleReadyStateChange=function(e){4==this._request.readyState&&this._handleLoad()},t._handleLoad=function(e){if(!this.loaded){this.loaded=!0;var t=this._checkError();if(t)this._handleError(t);else{if(this._response=this._getResponse(),"arraybuffer"===this._responseType)try{this._response=new Blob([this._response])}catch(e){if(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,"TypeError"===e.name&&window.BlobBuilder){var i=new BlobBuilder;i.append(this._response),this._response=i.getBlob()}}this._clean(),this.dispatchEvent(new createjs.Event("complete"))}}},t._handleTimeout=function(e){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_TIMEOUT",null,e))},t._checkError=function(){var e=parseInt(this._request.status);return e>=400&&e<=599?new Error(e):0==e&&/^https?:/.test(location.protocol)?new Error(0):null},t._getResponse=function(){if(null!=this._response)return this._response;if(null!=this._request.response)return this._request.response;try{if(null!=this._request.responseText)return this._request.responseText}catch(e){}try{if(null!=this._request.responseXML)return this._request.responseXML}catch(e){}return null},t._createXHR=function(e){var t=createjs.URLUtils.isCrossDomain(e),i={},n=null;if(window.XMLHttpRequest)n=new XMLHttpRequest,t&&void 0===n.withCredentials&&window.XDomainRequest&&(n=new XDomainRequest);else{for(var r=0,a=s.ACTIVEX_VERSIONS.length;r<a;r++){var o=s.ACTIVEX_VERSIONS[r];try{n=new ActiveXObject(o);break}catch(e){}}if(null==n)return!1}null==e.mimeType&&createjs.RequestUtils.isText(e.type)&&(e.mimeType="text/plain; charset=utf-8"),e.mimeType&&n.overrideMimeType&&n.overrideMimeType(e.mimeType),this._xhrLevel="string"==typeof n.responseType?2:1;var l;if(l=e.method==createjs.Methods.GET?createjs.URLUtils.buildURI(e.src,e.values):e.src,n.open(e.method||createjs.Methods.GET,l,!0),t&&n instanceof XMLHttpRequest&&1==this._xhrLevel&&(i.Origin=location.origin),e.values&&e.method==createjs.Methods.POST&&(i["Content-Type"]="application/x-www-form-urlencoded"),t||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),e.headers)for(var c in e.headers)i[c]=e.headers[c];for(c in i)n.setRequestHeader(c,i[c]);return n instanceof XMLHttpRequest&&void 0!==e.withCredentials&&(n.withCredentials=e.withCredentials),this._request=n,!0},t._clean=function(){clearTimeout(this._loadTimeout),null!=this._request.removeEventListener?(this._request.removeEventListener("loadstart",this._handleLoadStartProxy),this._request.removeEventListener("progress",this._handleProgressProxy),this._request.removeEventListener("abort",this._handleAbortProxy),this._request.removeEventListener("error",this._handleErrorProxy),this._request.removeEventListener("timeout",this._handleTimeoutProxy),this._request.removeEventListener("load",this._handleLoadProxy),this._request.removeEventListener("readystatechange",this._handleReadyStateChangeProxy)):(this._request.onloadstart=null,this._request.onprogress=null,this._request.onabort=null,this._request.onerror=null,this._request.ontimeout=null,this._request.onload=null,this._request.onreadystatechange=null)},t.toString=function(){return"[PreloadJS XHRRequest]"},createjs.XHRRequest=createjs.promote(e,"AbstractRequest")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e,t,i){this.AbstractLoader_constructor(),this._plugins=[],this._typeCallbacks={},this._extensionCallbacks={},this.next=null,this.maintainScriptOrder=!0,this.stopOnError=!1,this._maxConnections=1,this._availableLoaders=[createjs.FontLoader,createjs.ImageLoader,createjs.JavaScriptLoader,createjs.CSSLoader,createjs.JSONLoader,createjs.JSONPLoader,createjs.SoundLoader,createjs.ManifestLoader,createjs.SpriteSheetLoader,createjs.XMLLoader,createjs.SVGLoader,createjs.BinaryLoader,createjs.VideoLoader,createjs.TextLoader],this._defaultLoaderLength=this._availableLoaders.length,this.init(e,t,i)}var t=createjs.extend(e,createjs.AbstractLoader),i=e;try{Object.defineProperties(i,{POST:{get:createjs.deprecate((function(){return createjs.Methods.POST}),"AbstractLoader.POST")},GET:{get:createjs.deprecate((function(){return createjs.Methods.GET}),"AbstractLoader.GET")},BINARY:{get:createjs.deprecate((function(){return createjs.Types.BINARY}),"AbstractLoader.BINARY")},CSS:{get:createjs.deprecate((function(){return createjs.Types.CSS}),"AbstractLoader.CSS")},FONT:{get:createjs.deprecate((function(){return createjs.Types.FONT}),"AbstractLoader.FONT")},FONTCSS:{get:createjs.deprecate((function(){return createjs.Types.FONTCSS}),"AbstractLoader.FONTCSS")},IMAGE:{get:createjs.deprecate((function(){return createjs.Types.IMAGE}),"AbstractLoader.IMAGE")},JAVASCRIPT:{get:createjs.deprecate((function(){return createjs.Types.JAVASCRIPT}),"AbstractLoader.JAVASCRIPT")},JSON:{get:createjs.deprecate((function(){return createjs.Types.JSON}),"AbstractLoader.JSON")},JSONP:{get:createjs.deprecate((function(){return createjs.Types.JSONP}),"AbstractLoader.JSONP")},MANIFEST:{get:createjs.deprecate((function(){return createjs.Types.MANIFEST}),"AbstractLoader.MANIFEST")},SOUND:{get:createjs.deprecate((function(){return createjs.Types.SOUND}),"AbstractLoader.SOUND")},VIDEO:{get:createjs.deprecate((function(){return createjs.Types.VIDEO}),"AbstractLoader.VIDEO")},SPRITESHEET:{get:createjs.deprecate((function(){return createjs.Types.SPRITESHEET}),"AbstractLoader.SPRITESHEET")},SVG:{get:createjs.deprecate((function(){return createjs.Types.SVG}),"AbstractLoader.SVG")},TEXT:{get:createjs.deprecate((function(){return createjs.Types.TEXT}),"AbstractLoader.TEXT")},XML:{get:createjs.deprecate((function(){return createjs.Types.XML}),"AbstractLoader.XML")}})}catch(e){}t.init=function(e,t,i){this.preferXHR=!0,this._preferXHR=!0,this.setPreferXHR(e),this._paused=!1,this._basePath=t,this._crossOrigin=i,this._loadStartWasDispatched=!1,this._currentlyLoadingScript=null,this._currentLoads=[],this._loadQueue=[],this._loadQueueBackup=[],this._loadItemsById={},this._loadItemsBySrc={},this._loadedResults={},this._loadedRawResults={},this._numItems=0,this._numItemsLoaded=0,this._scriptOrder=[],this._loadedScripts=[],this._lastProgress=NaN},t.registerLoader=function(e){if(!e||!e.canLoadItem)throw new Error("loader is of an incorrect type.");if(-1!=this._availableLoaders.indexOf(e))throw new Error("loader already exists.");this._availableLoaders.unshift(e)},t.unregisterLoader=function(e){var t=this._availableLoaders.indexOf(e);-1!=t&&t<this._defaultLoaderLength-1&&this._availableLoaders.splice(t,1)},t.setPreferXHR=function(e){return this.preferXHR=0!=e&&null!=window.XMLHttpRequest,this.preferXHR},t.removeAll=function(){this.remove()},t.remove=function(e){var t=null;if(e&&!Array.isArray(e))t=[e];else if(e)t=e;else if(arguments.length>0)return;var i=!1;if(t){for(;t.length;){var n=t.pop(),r=this.getResult(n);for(s=this._loadQueue.length-1;s>=0;s--)if((a=this._loadQueue[s].getItem()).id==n||a.src==n){this._loadQueue.splice(s,1)[0].cancel();break}for(s=this._loadQueueBackup.length-1;s>=0;s--)if((a=this._loadQueueBackup[s].getItem()).id==n||a.src==n){this._loadQueueBackup.splice(s,1)[0].cancel();break}if(r)this._disposeItem(this.getItem(n));else for(var s=this._currentLoads.length-1;s>=0;s--){var a=this._currentLoads[s].getItem();if(a.id==n||a.src==n){this._currentLoads.splice(s,1)[0].cancel(),i=!0;break}}}i&&this._loadNext()}else{for(var o in this.close(),this._loadItemsById)this._disposeItem(this._loadItemsById[o]);this.init(this.preferXHR,this._basePath)}},t.reset=function(){for(var e in this.close(),this._loadItemsById)this._disposeItem(this._loadItemsById[e]);for(var t=[],i=0,n=this._loadQueueBackup.length;i<n;i++)t.push(this._loadQueueBackup[i].getItem());this.loadManifest(t,!1)},t.installPlugin=function(e){if(null!=e&&null!=e.getPreloadHandlers){this._plugins.push(e);var t=e.getPreloadHandlers();if(t.scope=e,null!=t.types)for(var i=0,n=t.types.length;i<n;i++)this._typeCallbacks[t.types[i]]=t;if(null!=t.extensions)for(i=0,n=t.extensions.length;i<n;i++)this._extensionCallbacks[t.extensions[i]]=t}},t.setMaxConnections=function(e){this._maxConnections=e,!this._paused&&this._loadQueue.length>0&&this._loadNext()},t.loadFile=function(e,t,i){if(null!=e)this._addItem(e,null,i),!1!==t?this.setPaused(!1):this.setPaused(!0);else{var n=new createjs.ErrorEvent("PRELOAD_NO_FILE");this._sendError(n)}},t.loadManifest=function(e,t,n){var r=null,s=null;if(Array.isArray(e)){if(0==e.length){var a=new createjs.ErrorEvent("PRELOAD_MANIFEST_EMPTY");return void this._sendError(a)}r=e}else if("string"==typeof e)r=[{src:e,type:i.MANIFEST}];else{if("object"!=typeof e)return a=new createjs.ErrorEvent("PRELOAD_MANIFEST_NULL"),void this._sendError(a);if(void 0!==e.src){if(null==e.type)e.type=i.MANIFEST;else if(e.type!=i.MANIFEST){a=new createjs.ErrorEvent("PRELOAD_MANIFEST_TYPE");this._sendError(a)}r=[e]}else void 0!==e.manifest&&(r=e.manifest,s=e.path)}for(var o=0,l=r.length;o<l;o++)this._addItem(r[o],s,n);!1!==t?this.setPaused(!1):this.setPaused(!0)},t.load=function(){this.setPaused(!1)},t.getItem=function(e){return this._loadItemsById[e]||this._loadItemsBySrc[e]},t.getResult=function(e,t){var i=this._loadItemsById[e]||this._loadItemsBySrc[e];if(null==i)return null;var n=i.id;return t&&this._loadedRawResults[n]?this._loadedRawResults[n]:this._loadedResults[n]},t.getItems=function(e){var t=[];for(var i in this._loadItemsById){var n=this._loadItemsById[i],r=this.getResult(i);!0===e&&null==r||t.push({item:n,result:r,rawResult:this.getResult(i,!0)})}return t},t.setPaused=function(e){this._paused=e,this._paused||this._loadNext()},t.close=function(){for(;this._currentLoads.length;)this._currentLoads.pop().cancel();this._scriptOrder.length=0,this._loadedScripts.length=0,this.loadStartWasDispatched=!1,this._itemCount=0,this._lastProgress=NaN},t._addItem=function(e,t,i){var n=this._createLoadItem(e,t,i);if(null!=n){var r=this._createLoader(n);null!=r&&("plugins"in r&&(r.plugins=this._plugins),n._loader=r,this._loadQueue.push(r),this._loadQueueBackup.push(r),this._numItems++,this._updateProgress(),(this.maintainScriptOrder&&n.type==createjs.Types.JAVASCRIPT||!0===n.maintainOrder)&&(this._scriptOrder.push(n),this._loadedScripts.push(null)))}},t._createLoadItem=function(e,t,i){var n=createjs.LoadItem.create(e);if(null==n)return null;var r="",s=i||this._basePath;if(n.src instanceof Object){if(!n.type)return null;if(t){r=t;var a=createjs.URLUtils.parseURI(t);null==s||a.absolute||a.relative||(r=s+r)}else null!=s&&(r=s)}else{var o=createjs.URLUtils.parseURI(n.src);o.extension&&(n.ext=o.extension),null==n.type&&(n.type=createjs.RequestUtils.getTypeByExtension(n.ext));var l=n.src;o.absolute||o.relative||(t?(r=t,a=createjs.URLUtils.parseURI(t),l=t+l,null==s||a.absolute||a.relative||(r=s+r)):null!=s&&(r=s)),n.src=r+n.src}n.path=r,void 0!==n.id&&null!==n.id&&""!==n.id||(n.id=l);var c=this._typeCallbacks[n.type]||this._extensionCallbacks[n.ext];if(c){var h=c.callback.call(c.scope,n,this);if(!1===h)return null;!0===h||null!=h&&(n._loader=h),null!=(o=createjs.URLUtils.parseURI(n.src)).extension&&(n.ext=o.extension)}return this._loadItemsById[n.id]=n,this._loadItemsBySrc[n.src]=n,null==n.crossOrigin&&(n.crossOrigin=this._crossOrigin),n},t._createLoader=function(e){if(null!=e._loader)return e._loader;for(var t=this.preferXHR,i=0;i<this._availableLoaders.length;i++){var n=this._availableLoaders[i];if(n&&n.canLoadItem(e))return new n(e,t)}return null},t._loadNext=function(){if(!this._paused){this._loadStartWasDispatched||(this._sendLoadStart(),this._loadStartWasDispatched=!0),this._numItems==this._numItemsLoaded?(this.loaded=!0,this._sendComplete(),this.next&&this.next.load&&this.next.load()):this.loaded=!1;for(var e=0;e<this._loadQueue.length&&!(this._currentLoads.length>=this._maxConnections);e++){var t=this._loadQueue[e];this._canStartLoad(t)&&(this._loadQueue.splice(e,1),e--,this._loadItem(t))}}},t._loadItem=function(e){e.on("fileload",this._handleFileLoad,this),e.on("progress",this._handleProgress,this),e.on("complete",this._handleFileComplete,this),e.on("error",this._handleError,this),e.on("fileerror",this._handleFileError,this),this._currentLoads.push(e),this._sendFileStart(e.getItem()),e.load()},t._handleFileLoad=function(e){e.target=null,this.dispatchEvent(e)},t._handleFileError=function(e){var t=new createjs.ErrorEvent("FILE_LOAD_ERROR",null,e.item);this._sendError(t)},t._handleError=function(e){var t=e.target;this._numItemsLoaded++,this._finishOrderedItem(t,!0),this._updateProgress();var i=new createjs.ErrorEvent("FILE_LOAD_ERROR",null,t.getItem());this._sendError(i),this.stopOnError?this.setPaused(!0):(this._removeLoadItem(t),this._cleanLoadItem(t),this._loadNext())},t._handleFileComplete=function(e){var t=e.target,i=t.getItem(),n=t.getResult();this._loadedResults[i.id]=n;var r=t.getResult(!0);null!=r&&r!==n&&(this._loadedRawResults[i.id]=r),this._saveLoadedItems(t),this._removeLoadItem(t),this._finishOrderedItem(t)||this._processFinishedLoad(i,t),this._cleanLoadItem(t)},t._saveLoadedItems=function(e){var t=e.getLoadedItems();if(null!==t)for(var i=0;i<t.length;i++){var n=t[i].item;this._loadItemsBySrc[n.src]=n,this._loadItemsById[n.id]=n,this._loadedResults[n.id]=t[i].result,this._loadedRawResults[n.id]=t[i].rawResult}},t._finishOrderedItem=function(e,t){var i=e.getItem();if(this.maintainScriptOrder&&i.type==createjs.Types.JAVASCRIPT||i.maintainOrder){e instanceof createjs.JavaScriptLoader&&(this._currentlyLoadingScript=!1);var n=createjs.indexOf(this._scriptOrder,i);return-1!=n&&(this._loadedScripts[n]=!0===t||i,this._checkScriptLoadOrder(),!0)}return!1},t._checkScriptLoadOrder=function(){for(var e=this._loadedScripts.length,t=0;t<e;t++){var i=this._loadedScripts[t];if(null===i)break;if(!0!==i){var n=this._loadedResults[i.id];i.type==createjs.Types.JAVASCRIPT&&createjs.DomUtils.appendToHead(n);var r=i._loader;this._processFinishedLoad(i,r),this._loadedScripts[t]=!0}}},t._processFinishedLoad=function(e,t){if(this._numItemsLoaded++,!this.maintainScriptOrder&&e.type==createjs.Types.JAVASCRIPT){var i=t.getTag();createjs.DomUtils.appendToHead(i)}this._updateProgress(),this._sendFileComplete(e,t),this._loadNext()},t._canStartLoad=function(e){if(!this.maintainScriptOrder||e.preferXHR)return!0;var t=e.getItem();if(t.type!=createjs.Types.JAVASCRIPT)return!0;if(this._currentlyLoadingScript)return!1;for(var i=this._scriptOrder.indexOf(t),n=0;n<i;){if(null==this._loadedScripts[n])return!1;n++}return this._currentlyLoadingScript=!0,!0},t._removeLoadItem=function(e){for(var t=this._currentLoads.length,i=0;i<t;i++)if(this._currentLoads[i]==e){this._currentLoads.splice(i,1);break}},t._cleanLoadItem=function(e){var t=e.getItem();t&&delete t._loader},t._handleProgress=function(e){var t=e.target;this._sendFileProgress(t.getItem(),t.progress),this._updateProgress()},t._updateProgress=function(){var e=this._numItemsLoaded/this._numItems,t=this._numItems-this._numItemsLoaded;if(t>0){for(var i=0,n=0,r=this._currentLoads.length;n<r;n++)i+=this._currentLoads[n].progress;e+=i/t*(t/this._numItems)}this._lastProgress!=e&&(this._sendProgress(e),this._lastProgress=e)},t._disposeItem=function(e){delete this._loadedResults[e.id],delete this._loadedRawResults[e.id],delete this._loadItemsById[e.id],delete this._loadItemsBySrc[e.src]},t._sendFileProgress=function(e,t){if(!this._isCanceled()&&!this._paused&&this.hasEventListener("fileprogress")){var i=new createjs.Event("fileprogress");i.progress=t,i.loaded=t,i.total=1,i.item=e,this.dispatchEvent(i)}},t._sendFileComplete=function(e,t){if(!this._isCanceled()&&!this._paused){var i=new createjs.Event("fileload");i.loader=t,i.item=e,i.result=this._loadedResults[e.id],i.rawResult=this._loadedRawResults[e.id],e.completeHandler&&e.completeHandler(i),this.hasEventListener("fileload")&&this.dispatchEvent(i)}},t._sendFileStart=function(e){var t=new createjs.Event("filestart");t.item=e,this.hasEventListener("filestart")&&this.dispatchEvent(t)},t.toString=function(){return"[PreloadJS LoadQueue]"},createjs.LoadQueue=createjs.promote(e,"AbstractLoader")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e){this.AbstractLoader_constructor(e,!0,createjs.Types.TEXT)}createjs.extend(e,createjs.AbstractLoader),e.canLoadItem=function(e){return e.type==createjs.Types.TEXT},createjs.TextLoader=createjs.promote(e,"AbstractLoader")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e){this.AbstractLoader_constructor(e,!0,createjs.Types.BINARY),this.on("initialize",this._updateXHR,this)}var t=createjs.extend(e,createjs.AbstractLoader);e.canLoadItem=function(e){return e.type==createjs.Types.BINARY},t._updateXHR=function(e){e.loader.setResponseType("arraybuffer")},createjs.BinaryLoader=createjs.promote(e,"AbstractLoader")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e,t){this.AbstractLoader_constructor(e,t,createjs.Types.CSS),this.resultFormatter=this._formatResult,this._tagSrcAttribute="href",this._tag=t?createjs.Elements.style():createjs.Elements.link(),this._tag.rel="stylesheet",this._tag.type="text/css"}var t=createjs.extend(e,createjs.AbstractLoader);e.canLoadItem=function(e){return e.type==createjs.Types.CSS},t._formatResult=function(e){if(this._preferXHR){var t=e.getTag();if(t.styleSheet)t.styleSheet.cssText=e.getResult(!0);else{var i=createjs.Elements.text(e.getResult(!0));t.appendChild(i)}}else t=this._tag;return createjs.DomUtils.appendToHead(t),t},createjs.CSSLoader=createjs.promote(e,"AbstractLoader")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e,t){this.AbstractLoader_constructor(e,t,e.type),this._faces={},this._watched=[],this._count=0,this._watchInterval=null,this._loadTimeout=null,this._injectCSS=void 0===e.injectCSS||e.injectCSS,this.dispatchEvent("initialize")}var t=createjs.extend(e,createjs.AbstractLoader);e.canLoadItem=function(e){return e.type==createjs.Types.FONT||e.type==createjs.Types.FONTCSS},e.sampleText="abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ",e._ctx=document.createElement("canvas").getContext("2d"),e._referenceFonts=["serif","monospace"],e.WEIGHT_REGEX=/[- ._]*(thin|normal|book|regular|medium|black|heavy|[1-9]00|(?:extra|ultra|semi|demi)?[- ._]*(?:light|bold))[- ._]*/gi,e.STYLE_REGEX=/[- ._]*(italic|oblique)[- ._]*/gi,e.FONT_FORMAT={woff2:"woff2",woff:"woff",ttf:"truetype",otf:"truetype"},e.FONT_WEIGHT={thin:100,extralight:200,ultralight:200,light:300,semilight:300,demilight:300,book:"normal",regular:"normal",semibold:600,demibold:600,extrabold:800,ultrabold:800,black:900,heavy:900},e.WATCH_DURATION=10,t.load=function(){if(this.type==createjs.Types.FONTCSS){if(!this._watchCSS())return void this.AbstractLoader_load()}else if(this._item.src instanceof Array)this._watchFontArray();else{var e=this._defFromSrc(this._item.src);this._watchFont(e),this._injectStyleTag(this._cssFromDef(e))}this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this.dispatchEvent("loadstart")},t._handleTimeout=function(){this._stopWatching(),this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_TIMEOUT"))},t._createRequest=function(){return this._request},t.handleEvent=function(e){switch(e.type){case"complete":this._rawResult=e.target._response,this._result=!0,this._parseCSS(this._rawResult);break;case"error":this._stopWatching(),this.AbstractLoader_handleEvent(e)}},t._watchCSS=function(){var e=this._item.src;return e instanceof HTMLStyleElement&&(this._injectCSS&&!e.parentNode&&(document.head||document.getElementsByTagName("head")[0]).appendChild(e),this._injectCSS=!1,e="\n"+e.textContent),-1!==e.search(/\n|\r|@font-face/i)?(this._parseCSS(e),!0):(this._request=new createjs.XHRRequest(this._item),!1)},t._parseCSS=function(e){for(var t=/@font-face\s*\{([^}]+)}/g;;){var i=t.exec(e);if(!i)break;this._watchFont(this._parseFontFace(i[1]))}this._injectStyleTag(e)},t._watchFontArray=function(){for(var e,t=this._item.src,i="",n=t.length-1;n>=0;n--){var r=t[n];e="string"==typeof r?this._defFromSrc(r):this._defFromObj(r),this._watchFont(e),i+=this._cssFromDef(e)+"\n"}this._injectStyleTag(i)},t._injectStyleTag=function(e){if(this._injectCSS){var t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e)),t.appendChild(i)}},t._parseFontFace=function(e){var t=this._getCSSValue(e,"font-family"),i=this._getCSSValue(e,"src");return t&&i?this._defFromObj({family:t,src:i,style:this._getCSSValue(e,"font-style"),weight:this._getCSSValue(e,"font-weight")}):null},t._watchFont=function(e){e&&!this._faces[e.id]&&(this._faces[e.id]=e,this._watched.push(e),this._count++,this._calculateReferenceSizes(e),this._startWatching())},t._startWatching=function(){null==this._watchInterval&&(this._watchInterval=setInterval(createjs.proxy(this._watch,this),e.WATCH_DURATION))},t._stopWatching=function(){clearInterval(this._watchInterval),clearTimeout(this._loadTimeout),this._watchInterval=null},t._watch=function(){for(var t=this._watched,i=e._referenceFonts,n=t.length,r=n-1;r>=0;r--)for(var s=t[r],a=s.refs,o=a.length-1;o>=0;o--)if(this._getTextWidth(s.family+","+i[o],s.weight,s.style)!=a[o]){var l=new createjs.Event("fileload");s.type="font-family",l.item=s,this.dispatchEvent(l),t.splice(r,1);break}n!==t.length&&(l=new createjs.ProgressEvent(this._count-t.length,this._count),this.dispatchEvent(l)),0===n&&(this._stopWatching(),this._sendComplete())},t._calculateReferenceSizes=function(t){for(var i=e._referenceFonts,n=t.refs=[],r=0;r<i.length;r++)n[r]=this._getTextWidth(i[r],t.weight,t.style)},t._defFromSrc=function(t){var i,n=/[- ._]+/g,r=t,s=null;-1!==(i=r.search(/[?#]/))&&(r=r.substr(0,i)),-1!==(i=r.lastIndexOf("."))&&(s=r.substr(i+1),r=r.substr(0,i)),-1!==(i=r.lastIndexOf("/"))&&(r=r.substr(i+1));var a=r,o=a.match(e.WEIGHT_REGEX);o&&(o=o[0],a=a.replace(o,""),o=o.replace(n,"").toLowerCase());var l=r.match(e.STYLE_REGEX);l&&(a=a.replace(l[0],""),l="italic"),a=a.replace(n,"");var c="local('"+r.replace(n," ")+"'), url('"+t+"')",h=e.FONT_FORMAT[s];return h&&(c+=" format('"+h+"')"),this._defFromObj({family:a,weight:e.FONT_WEIGHT[o]||o,style:l,src:c})},t._defFromObj=function(e){var t={family:e.family,src:e.src,style:e.style||"normal",weight:e.weight||"normal"};return t.id=t.family+";"+t.style+";"+t.weight,t},t._cssFromDef=function(e){return"@font-face {\n\tfont-family: '"+e.family+"';\n\tfont-style: "+e.style+";\n\tfont-weight: "+e.weight+";\n\tsrc: "+e.src+";\n}"},t._getTextWidth=function(t,i,n){var r=e._ctx;return r.font=n+" "+i+" 72px "+t,r.measureText(e.sampleText).width},t._getCSSValue=function(e,t){var i=new RegExp(t+":s*([^;}]+?)s*[;}]").exec(e);return i&&i[1]?i[1]:null},createjs.FontLoader=createjs.promote(e,"AbstractLoader")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e,t){this.AbstractLoader_constructor(e,t,createjs.Types.IMAGE),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",createjs.DomUtils.isImageTag(e)?this._tag=e:createjs.DomUtils.isImageTag(e.src)?this._tag=e.src:createjs.DomUtils.isImageTag(e.tag)&&(this._tag=e.tag),null!=this._tag?this._preferXHR=!1:this._tag=createjs.Elements.img(),this.on("initialize",this._updateXHR,this)}var t=createjs.extend(e,createjs.AbstractLoader);e.canLoadItem=function(e){return e.type==createjs.Types.IMAGE},t.load=function(){if(""!=this._tag.src&&this._tag.complete)this._sendComplete();else{var e=this._item.crossOrigin;1==e&&(e="Anonymous"),null==e||createjs.URLUtils.isLocal(this._item)||(this._tag.crossOrigin=e),this.AbstractLoader_load()}},t._updateXHR=function(e){e.loader.mimeType="text/plain; charset=x-user-defined-binary",e.loader.setResponseType&&e.loader.setResponseType("blob")},t._formatResult=function(e){return this._formatImage},t._formatImage=function(e,t){var i=this._tag,n=window.URL||window.webkitURL;if(this._preferXHR)if(n){var r=n.createObjectURL(this.getResult(!0));i.src=r,i.addEventListener("load",this._cleanUpURL,!1),i.addEventListener("error",this._cleanUpURL,!1)}else i.src=this._item.src;i.complete?e(i):(i.onload=createjs.proxy((function(){e(this._tag),i.onload=i.onerror=null}),this),i.onerror=createjs.proxy((function(e){t(new createjs.ErrorEvent("IMAGE_FORMAT",null,e)),i.onload=i.onerror=null}),this))},t._cleanUpURL=function(e){(window.URL||window.webkitURL).revokeObjectURL(e.target.src)},createjs.ImageLoader=createjs.promote(e,"AbstractLoader")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e,t){this.AbstractLoader_constructor(e,t,createjs.Types.JAVASCRIPT),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.setTag(createjs.Elements.script())}var t=createjs.extend(e,createjs.AbstractLoader);e.canLoadItem=function(e){return e.type==createjs.Types.JAVASCRIPT},t._formatResult=function(e){var t=e.getTag();return this._preferXHR&&(t.text=e.getResult(!0)),t},createjs.JavaScriptLoader=createjs.promote(e,"AbstractLoader")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e){this.AbstractLoader_constructor(e,!0,createjs.Types.JSON),this.resultFormatter=this._formatResult}var t=createjs.extend(e,createjs.AbstractLoader);e.canLoadItem=function(e){return e.type==createjs.Types.JSON},t._formatResult=function(e){var t=null;try{t=createjs.DataUtils.parseJSON(e.getResult(!0))}catch(e){var i=new createjs.ErrorEvent("JSON_FORMAT",null,e);return this._sendError(i),e}return t},createjs.JSONLoader=createjs.promote(e,"AbstractLoader")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e){this.AbstractLoader_constructor(e,!1,createjs.Types.JSONP),this.setTag(createjs.Elements.script()),this.getTag().type="text/javascript"}var t=createjs.extend(e,createjs.AbstractLoader);e.canLoadItem=function(e){return e.type==createjs.Types.JSONP},t.cancel=function(){this.AbstractLoader_cancel(),this._dispose()},t.load=function(){if(null==this._item.callback)throw new Error("callback is required for loading JSONP requests.");if(null!=window[this._item.callback])throw new Error("JSONP callback '"+this._item.callback+"' already exists on window. You need to specify a different callback or re-name the current one.");window[this._item.callback]=createjs.proxy(this._handleLoad,this),createjs.DomUtils.appendToBody(this._tag),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag.src=this._item.src},t._handleLoad=function(e){this._result=this._rawResult=e,this._sendComplete(),this._dispose()},t._handleTimeout=function(){this._dispose(),this.dispatchEvent(new createjs.ErrorEvent("timeout"))},t._dispose=function(){createjs.DomUtils.removeChild(this._tag),delete window[this._item.callback],clearTimeout(this._loadTimeout)},createjs.JSONPLoader=createjs.promote(e,"AbstractLoader")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e,t){this.AbstractLoader_constructor(e,t,createjs.Types.MANIFEST),this.plugins=null,this._manifestQueue=null}var t=createjs.extend(e,createjs.AbstractLoader),i=e;i.MANIFEST_PROGRESS=.25,i.canLoadItem=function(e){return e.type==createjs.Types.MANIFEST},t.load=function(){this.AbstractLoader_load()},t._createRequest=function(){var e=this._item.callback;this._request=null!=e?new createjs.JSONPLoader(this._item):new createjs.JSONLoader(this._item)},t.handleEvent=function(e){switch(e.type){case"complete":return this._rawResult=e.target.getResult(!0),this._result=e.target.getResult(),this._sendProgress(i.MANIFEST_PROGRESS),void this._loadManifest(this._result);case"progress":return e.loaded*=i.MANIFEST_PROGRESS,this.progress=e.loaded/e.total,(isNaN(this.progress)||this.progress==1/0)&&(this.progress=0),void this._sendProgress(e)}this.AbstractLoader_handleEvent(e)},t.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},t._loadManifest=function(e){if(e&&e.manifest){var t=this._manifestQueue=new createjs.LoadQueue(this._preferXHR);t.on("fileload",this._handleManifestFileLoad,this),t.on("progress",this._handleManifestProgress,this),t.on("complete",this._handleManifestComplete,this,!0),t.on("error",this._handleManifestError,this,!0);for(var i=0,n=this.plugins.length;i<n;i++)t.installPlugin(this.plugins[i]);t.loadManifest(e)}else this._sendComplete()},t._handleManifestFileLoad=function(e){e.target=null,this.dispatchEvent(e)},t._handleManifestComplete=function(e){this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},t._handleManifestProgress=function(e){this.progress=e.progress*(1-i.MANIFEST_PROGRESS)+i.MANIFEST_PROGRESS,this._sendProgress(this.progress)},t._handleManifestError=function(e){var t=new createjs.Event("fileerror");t.item=e.data,this.dispatchEvent(t)},createjs.ManifestLoader=createjs.promote(e,"AbstractLoader")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e,t){this.AbstractMediaLoader_constructor(e,t,createjs.Types.SOUND),createjs.DomUtils.isAudioTag(e)||createjs.DomUtils.isAudioTag(e.src)?this._tag=e:createjs.DomUtils.isAudioTag(e.tag)&&(this._tag=createjs.DomUtils.isAudioTag(e)?e:e.src),null!=this._tag&&(this._preferXHR=!1)}var t=createjs.extend(e,createjs.AbstractMediaLoader);e.canLoadItem=function(e){return e.type==createjs.Types.SOUND},t._createTag=function(e){var t=createjs.Elements.audio();return t.autoplay=!1,t.preload="none",t.src=e,t},createjs.SoundLoader=createjs.promote(e,"AbstractMediaLoader")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e,t){this.AbstractMediaLoader_constructor(e,t,createjs.Types.VIDEO),createjs.DomUtils.isVideoTag(e)||createjs.DomUtils.isVideoTag(e.src)?(this.setTag(createjs.DomUtils.isVideoTag(e)?e:e.src),this._preferXHR=!1):this.setTag(this._createTag())}var t=e;createjs.extend(e,createjs.AbstractMediaLoader)._createTag=function(){return createjs.Elements.video()},t.canLoadItem=function(e){return e.type==createjs.Types.VIDEO},createjs.VideoLoader=createjs.promote(e,"AbstractMediaLoader")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e,t){this.AbstractLoader_constructor(e,t,createjs.Types.SPRITESHEET),this._manifestQueue=null}var t=createjs.extend(e,createjs.AbstractLoader),i=e;i.SPRITESHEET_PROGRESS=.25,i.canLoadItem=function(e){return e.type==createjs.Types.SPRITESHEET},t.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},t._createRequest=function(){var e=this._item.callback;this._request=null!=e?new createjs.JSONPLoader(this._item):new createjs.JSONLoader(this._item)},t.handleEvent=function(e){switch(e.type){case"complete":return this._rawResult=e.target.getResult(!0),this._result=e.target.getResult(),this._sendProgress(i.SPRITESHEET_PROGRESS),void this._loadManifest(this._result);case"progress":return e.loaded*=i.SPRITESHEET_PROGRESS,this.progress=e.loaded/e.total,(isNaN(this.progress)||this.progress==1/0)&&(this.progress=0),void this._sendProgress(e)}this.AbstractLoader_handleEvent(e)},t._loadManifest=function(e){if(e&&e.images){var t=this._manifestQueue=new createjs.LoadQueue(this._preferXHR,this._item.path,this._item.crossOrigin);t.on("complete",this._handleManifestComplete,this,!0),t.on("fileload",this._handleManifestFileLoad,this),t.on("progress",this._handleManifestProgress,this),t.on("error",this._handleManifestError,this,!0),t.loadManifest(e.images)}},t._handleManifestFileLoad=function(e){var t=e.result;if(null!=t){var i=this.getResult().images,n=i.indexOf(e.item.src);i[n]=t}},t._handleManifestComplete=function(e){this._result=new createjs.SpriteSheet(this._result),this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},t._handleManifestProgress=function(e){this.progress=e.progress*(1-i.SPRITESHEET_PROGRESS)+i.SPRITESHEET_PROGRESS,this._sendProgress(this.progress)},t._handleManifestError=function(e){var t=new createjs.Event("fileerror");t.item=e.data,this.dispatchEvent(t)},createjs.SpriteSheetLoader=createjs.promote(e,"AbstractLoader")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e,t){this.AbstractLoader_constructor(e,t,createjs.Types.SVG),this.resultFormatter=this._formatResult,this._tagSrcAttribute="data",t?this.setTag(createjs.Elements.svg()):(this.setTag(createjs.Elements.object()),this.getTag().type="image/svg+xml")}var t=createjs.extend(e,createjs.AbstractLoader);e.canLoadItem=function(e){return e.type==createjs.Types.SVG},t._formatResult=function(e){var t=createjs.DataUtils.parseXML(e.getResult(!0)),i=e.getTag();if(!this._preferXHR&&document.body.contains(i)&&document.body.removeChild(i),null!=t.documentElement){var n=t.documentElement;return document.importNode&&(n=document.importNode(n,!0)),i.appendChild(n),i}return t},createjs.SVGLoader=createjs.promote(e,"AbstractLoader")}(),window.createjs=window.createjs||{},function(){"use strict";function e(e){this.AbstractLoader_constructor(e,!0,createjs.Types.XML),this.resultFormatter=this._formatResult}var t=createjs.extend(e,createjs.AbstractLoader);e.canLoadItem=function(e){return e.type==createjs.Types.XML},t._formatResult=function(e){return createjs.DataUtils.parseXML(e.getResult(!0))},createjs.XMLLoader=createjs.promote(e,"AbstractLoader")}()}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}i.amdO={},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";function e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var n,r,s,a,o,l,c,h,d,u,p,f={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},m={duration:.5,overwrite:!1,delay:0},g=1e8,v=1e-8,_=2*Math.PI,y=_/4,b=0,x=Math.sqrt,w=Math.cos,E=Math.sin,S=function(e){return"string"==typeof e},T=function(e){return"function"==typeof e},M=function(e){return"number"==typeof e},A=function(e){return void 0===e},C=function(e){return"object"==typeof e},L=function(e){return!1!==e},P=function(){return"undefined"!=typeof window},R=function(e){return T(e)||S(e)},O="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},I=Array.isArray,D=/(?:-?\.?\d|\.)+/gi,N=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,U=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,F=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,z=/[+-]=-?[.\d]+/,k=/[^,'"\[\]\s]+/gi,H=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,B={},V={},j=function(e){return(V=_e(e,B))&&vi},G=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},W=function(e,t){return!t&&console.warn(e)},X=function(e,t){return e&&(B[e]=t)&&V&&(V[e]=t)||B},q=function(){return 0},Y={suppressEvents:!0,isStart:!0,kill:!1},$={suppressEvents:!0,kill:!1},Z={suppressEvents:!0},K={},J=[],Q={},ee={},te={},ie=30,ne=[],re="",se=function(e){var t,i,n=e[0];if(C(n)||T(n)||(e=[e]),!(t=(n._gsap||{}).harness)){for(i=ne.length;i--&&!ne[i].targetTest(n););t=ne[i]}for(i=e.length;i--;)e[i]&&(e[i]._gsap||(e[i]._gsap=new Ot(e[i],t)))||e.splice(i,1);return e},ae=function(e){return e._gsap||se($e(e))[0]._gsap},oe=function(e,t,i){return(i=e[t])&&T(i)?e[t]():A(i)&&e.getAttribute&&e.getAttribute(t)||i},le=function(e,t){return(e=e.split(",")).forEach(t)||e},ce=function(e){return Math.round(1e5*e)/1e5||0},he=function(e){return Math.round(1e7*e)/1e7||0},de=function(e,t){var i=t.charAt(0),n=parseFloat(t.substr(2));return e=parseFloat(e),"+"===i?e+n:"-"===i?e-n:"*"===i?e*n:e/n},ue=function(e,t){for(var i=t.length,n=0;e.indexOf(t[n])<0&&++n<i;);return n<i},pe=function(){var e,t,i=J.length,n=J.slice(0);for(Q={},J.length=0,e=0;e<i;e++)(t=n[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},fe=function(e,t,i,n){J.length&&!r&&pe(),e.render(t,i,n||r&&t<0&&(e._initted||e._startAt)),J.length&&!r&&pe()},me=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(k).length<2?t:S(e)?e.trim():e},ge=function(e){return e},ve=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},_e=function(e,t){for(var i in t)e[i]=t[i];return e},ye=function e(t,i){for(var n in i)"__proto__"!==n&&"constructor"!==n&&"prototype"!==n&&(t[n]=C(i[n])?e(t[n]||(t[n]={}),i[n]):i[n]);return t},be=function(e,t){var i,n={};for(i in e)i in t||(n[i]=e[i]);return n},xe=function(e){var t,i=e.parent||a,n=e.keyframes?(t=I(e.keyframes),function(e,i){for(var n in i)n in e||"duration"===n&&t||"ease"===n||(e[n]=i[n])}):ve;if(L(e.inherit))for(;i;)n(e,i.vars.defaults),i=i.parent||i._dp;return e},we=function(e,t,i,n,r){void 0===i&&(i="_first"),void 0===n&&(n="_last");var s,a=e[n];if(r)for(s=t[r];a&&a[r]>s;)a=a._prev;return a?(t._next=a._next,a._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[n]=t,t._prev=a,t.parent=t._dp=e,t},Ee=function(e,t,i,n){void 0===i&&(i="_first"),void 0===n&&(n="_last");var r=t._prev,s=t._next;r?r._next=s:e[i]===t&&(e[i]=s),s?s._prev=r:e[n]===t&&(e[n]=r),t._next=t._prev=t.parent=null},Se=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},Te=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},Me=function(e,t,i,n){return e._startAt&&(r?e._startAt.revert($):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,n))},Ae=function e(t){return!t||t._ts&&e(t.parent)},Ce=function(e){return e._repeat?Le(e._tTime,e=e.duration()+e._rDelay)*e:0},Le=function(e,t){var i=Math.floor(e/=t);return e&&i===e?i-1:i},Pe=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Re=function(e){return e._end=he(e._start+(e._tDur/Math.abs(e._ts||e._rts||v)||0))},Oe=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=he(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Re(e),i._dirty||Te(i,e)),e},Ie=function(e,t){var i;if((t._time||t._initted&&!t._dur)&&(i=Pe(e.rawTime(),t),(!t._dur||We(0,t.totalDuration(),i)-t._tTime>v)&&t.render(i,!0)),Te(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-1e-8}},De=function(e,t,i,n){return t.parent&&Se(t),t._start=he((M(i)?i:i||e!==a?Ve(e,i,t):e._time)+t._delay),t._end=he(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),we(e,t,"_first","_last",e._sort?"_start":0),ze(t)||(e._recent=t),n||Ie(e,t),e._ts<0&&Oe(e,e._tTime),e},Ne=function(e,t){return(B.ScrollTrigger||G("scrollTrigger",t))&&B.ScrollTrigger.create(t,e)},Ue=function(e,t,i,n,s){return Ht(e,t,s),e._initted?!i&&e._pt&&!r&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&d!==yt.frame?(J.push(e),e._lazy=[s,n],1):void 0:1},Fe=function e(t){var i=t.parent;return i&&i._ts&&i._initted&&!i._lock&&(i.rawTime()<0||e(i))},ze=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},ke=function(e,t,i,n){var r=e._repeat,s=he(t)||0,a=e._tTime/e._tDur;return a&&!n&&(e._time*=s/e._dur),e._dur=s,e._tDur=r?r<0?1e10:he(s*(r+1)+e._rDelay*r):s,a>0&&!n&&Oe(e,e._tTime=e._tDur*a),e.parent&&Re(e),i||Te(e.parent,e),e},He=function(e){return e instanceof Dt?Te(e):ke(e,e._dur)},Be={_start:0,endTime:q,totalDuration:q},Ve=function e(t,i,n){var r,s,a,o=t.labels,l=t._recent||Be,c=t.duration()>=g?l.endTime(!1):t._dur;return S(i)&&(isNaN(i)||i in o)?(s=i.charAt(0),a="%"===i.substr(-1),r=i.indexOf("="),"<"===s||">"===s?(r>=0&&(i=i.replace(/=/,"")),("<"===s?l._start:l.endTime(l._repeat>=0))+(parseFloat(i.substr(1))||0)*(a?(r<0?l:n).totalDuration()/100:1)):r<0?(i in o||(o[i]=c),o[i]):(s=parseFloat(i.charAt(r-1)+i.substr(r+1)),a&&n&&(s=s/100*(I(n)?n[0]:n).totalDuration()),r>1?e(t,i.substr(0,r-1),n)+s:c+s)):null==i?c:+i},je=function(e,t,i){var n,r,s=M(t[1]),a=(s?2:1)+(e<2?0:1),o=t[a];if(s&&(o.duration=t[1]),o.parent=i,e){for(n=o,r=i;r&&!("immediateRender"in n);)n=r.vars.defaults||{},r=L(r.vars.inherit)&&r.parent;o.immediateRender=L(n.immediateRender),e<2?o.runBackwards=1:o.startAt=t[a-1]}return new Wt(t[0],o,t[a+1])},Ge=function(e,t){return e||0===e?t(e):t},We=function(e,t,i){return i<e?e:i>t?t:i},Xe=function(e,t){return S(e)&&(t=H.exec(e))?t[1]:""},qe=[].slice,Ye=function(e,t){return e&&C(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&C(e[0]))&&!e.nodeType&&e!==o},$e=function(e,t,i){return s&&!t&&s.selector?s.selector(e):!S(e)||i||!l&&bt()?I(e)?function(e,t,i){return void 0===i&&(i=[]),e.forEach((function(e){var n;return S(e)&&!t||Ye(e,1)?(n=i).push.apply(n,$e(e)):i.push(e)}))||i}(e,i):Ye(e)?qe.call(e,0):e?[e]:[]:qe.call((t||c).querySelectorAll(e),0)},Ze=function(e){return e=$e(e)[0]||W("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return $e(t,i.querySelectorAll?i:i===e?W("Invalid scope")||c.createElement("div"):e)}},Ke=function(e){return e.sort((function(){return.5-Math.random()}))},Je=function(e){if(T(e))return e;var t=C(e)?e:{each:e},i=At(t.ease),n=t.from||0,r=parseFloat(t.base)||0,s={},a=n>0&&n<1,o=isNaN(n)||a,l=t.axis,c=n,h=n;return S(n)?c=h={center:.5,edges:.5,end:1}[n]||0:!a&&o&&(c=n[0],h=n[1]),function(e,a,d){var u,p,f,m,v,_,y,b,w,E=(d||t).length,S=s[E];if(!S){if(!(w="auto"===t.grid?0:(t.grid||[1,g])[1])){for(y=-g;y<(y=d[w++].getBoundingClientRect().left)&&w<E;);w--}for(S=s[E]=[],u=o?Math.min(w,E)*c-.5:n%w,p=w===g?0:o?E*h/w-.5:n/w|0,y=0,b=g,_=0;_<E;_++)f=_%w-u,m=p-(_/w|0),S[_]=v=l?Math.abs("y"===l?m:f):x(f*f+m*m),v>y&&(y=v),v<b&&(b=v);"random"===n&&Ke(S),S.max=y-b,S.min=b,S.v=E=(parseFloat(t.amount)||parseFloat(t.each)*(w>E?E-1:l?"y"===l?E/w:w:Math.max(w,E/w))||0)*("edges"===n?-1:1),S.b=E<0?r-E:r,S.u=Xe(t.amount||t.each)||0,i=i&&E<0?Tt(i):i}return E=(S[e]-S.min)/S.max||0,he(S.b+(i?i(E):E)*S.v)+S.u}},Qe=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var n=he(Math.round(parseFloat(i)/e)*e*t);return(n-n%1)/t+(M(i)?0:Xe(i))}},et=function(e,t){var i,n,r=I(e);return!r&&C(e)&&(i=r=e.radius||g,e.values?(e=$e(e.values),(n=!M(e[0]))&&(i*=i)):e=Qe(e.increment)),Ge(t,r?T(e)?function(t){return n=e(t),Math.abs(n-t)<=i?n:t}:function(t){for(var r,s,a=parseFloat(n?t.x:t),o=parseFloat(n?t.y:0),l=g,c=0,h=e.length;h--;)(r=n?(r=e[h].x-a)*r+(s=e[h].y-o)*s:Math.abs(e[h]-a))<l&&(l=r,c=h);return c=!i||l<=i?e[c]:t,n||c===t||M(t)?c:c+Xe(t)}:Qe(e))},tt=function(e,t,i,n){return Ge(I(e)?!t:!0===i?!!(i=0):!n,(function(){return I(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(n=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+.99*i))/i)*i*n)/n}))},it=function(e,t,i){return Ge(i,(function(i){return e[~~t(i)]}))},nt=function(e){for(var t,i,n,r,s=0,a="";~(t=e.indexOf("random(",s));)n=e.indexOf(")",t),r="["===e.charAt(t+7),i=e.substr(t+7,n-t-7).match(r?k:D),a+=e.substr(s,t-s)+tt(r?i:+i[0],r?0:+i[1],+i[2]||1e-5),s=n+1;return a+e.substr(s,e.length-s)},rt=function(e,t,i,n,r){var s=t-e,a=n-i;return Ge(r,(function(t){return i+((t-e)/s*a||0)}))},st=function(e,t,i){var n,r,s,a=e.labels,o=g;for(n in a)(r=a[n]-t)<0==!!i&&r&&o>(r=Math.abs(r))&&(s=n,o=r);return s},at=function(e,t,i){var n,r,a,o=e.vars,l=o[t],c=s,h=e._ctx;if(l)return n=o[t+"Params"],r=o.callbackScope||e,i&&J.length&&pe(),h&&(s=h),a=n?l.apply(r,n):l.call(r),s=c,a},ot=function(e){return Se(e),e.scrollTrigger&&e.scrollTrigger.kill(!!r),e.progress()<1&&at(e,"onInterrupt"),e},lt=[],ct=function(e){if(P()){var t=(e=!e.name&&e.default||e).name,i=T(e),n=t&&!i&&e.init?function(){this._props=[]}:e,r={init:q,render:ei,add:zt,kill:ii,modifier:ti,rawVars:0},s={targetTest:0,get:0,getSetter:Zt,aliases:{},register:0};if(bt(),e!==n){if(ee[t])return;ve(n,ve(be(e,r),s)),_e(n.prototype,_e(r,be(e,s))),ee[n.prop=t]=n,e.targetTest&&(ne.push(n),K[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}X(t,n),e.register&&e.register(vi,n,si)}else lt.push(e)},ht=255,dt={aqua:[0,ht,ht],lime:[0,ht,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,ht],navy:[0,0,128],white:[ht,ht,ht],olive:[128,128,0],yellow:[ht,ht,0],orange:[ht,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[ht,0,0],pink:[ht,192,203],cyan:[0,ht,ht],transparent:[ht,ht,ht,0]},ut=function(e,t,i){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(i-t)*e*6:e<.5?i:3*e<2?t+(i-t)*(2/3-e)*6:t)*ht+.5|0},pt=function(e,t,i){var n,r,s,a,o,l,c,h,d,u,p=e?M(e)?[e>>16,e>>8&ht,e&ht]:0:dt.black;if(!p){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),dt[e])p=dt[e];else if("#"===e.charAt(0)){if(e.length<6&&(n=e.charAt(1),r=e.charAt(2),s=e.charAt(3),e="#"+n+n+r+r+s+s+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(p=parseInt(e.substr(1,6),16))>>16,p>>8&ht,p&ht,parseInt(e.substr(7),16)/255];p=[(e=parseInt(e.substr(1),16))>>16,e>>8&ht,e&ht]}else if("hsl"===e.substr(0,3))if(p=u=e.match(D),t){if(~e.indexOf("="))return p=e.match(N),i&&p.length<4&&(p[3]=1),p}else a=+p[0]%360/360,o=+p[1]/100,n=2*(l=+p[2]/100)-(r=l<=.5?l*(o+1):l+o-l*o),p.length>3&&(p[3]*=1),p[0]=ut(a+1/3,n,r),p[1]=ut(a,n,r),p[2]=ut(a-1/3,n,r);else p=e.match(D)||dt.transparent;p=p.map(Number)}return t&&!u&&(n=p[0]/ht,r=p[1]/ht,s=p[2]/ht,l=((c=Math.max(n,r,s))+(h=Math.min(n,r,s)))/2,c===h?a=o=0:(d=c-h,o=l>.5?d/(2-c-h):d/(c+h),a=c===n?(r-s)/d+(r<s?6:0):c===r?(s-n)/d+2:(n-r)/d+4,a*=60),p[0]=~~(a+.5),p[1]=~~(100*o+.5),p[2]=~~(100*l+.5)),i&&p.length<4&&(p[3]=1),p},ft=function(e){var t=[],i=[],n=-1;return e.split(gt).forEach((function(e){var r=e.match(U)||[];t.push.apply(t,r),i.push(n+=r.length+1)})),t.c=i,t},mt=function(e,t,i){var n,r,s,a,o="",l=(e+o).match(gt),c=t?"hsla(":"rgba(",h=0;if(!l)return e;if(l=l.map((function(e){return(e=pt(e,t,1))&&c+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"})),i&&(s=ft(e),(n=i.c).join(o)!==s.c.join(o)))for(a=(r=e.replace(gt,"1").split(U)).length-1;h<a;h++)o+=r[h]+(~n.indexOf(h)?l.shift()||c+"0,0,0,0)":(s.length?s:l.length?l:i).shift());if(!r)for(a=(r=e.split(gt)).length-1;h<a;h++)o+=r[h]+l[h];return o+r[a]},gt=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in dt)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),vt=/hsl[a]?\(/,_t=function(e){var t,i=e.join(" ");if(gt.lastIndex=0,gt.test(i))return t=vt.test(i),e[1]=mt(e[1],t),e[0]=mt(e[0],t,ft(e[1])),!0},yt=function(){var e,t,i,n,r,s,a=Date.now,d=500,u=33,f=a(),m=f,g=1e3/240,v=g,_=[],y=function i(o){var l,c,h,p,y=a()-m,b=!0===o;if(y>d&&(f+=y-u),((l=(h=(m+=y)-f)-v)>0||b)&&(p=++n.frame,r=h-1e3*n.time,n.time=h/=1e3,v+=l+(l>=g?4:g-l),c=1),b||(e=t(i)),c)for(s=0;s<_.length;s++)_[s](h,r,p,o)};return n={time:0,frame:0,tick:function(){y(!0)},deltaRatio:function(e){return r/(1e3/(e||60))},wake:function(){h&&(!l&&P()&&(o=l=window,c=o.document||{},B.gsap=vi,(o.gsapVersions||(o.gsapVersions=[])).push(vi.version),j(V||o.GreenSockGlobals||!o.gsap&&o||{}),i=o.requestAnimationFrame,lt.forEach(ct)),e&&n.sleep(),t=i||function(e){return setTimeout(e,v-1e3*n.time+1|0)},p=1,y(2))},sleep:function(){(i?o.cancelAnimationFrame:clearTimeout)(e),p=0,t=q},lagSmoothing:function(e,t){d=e||1/0,u=Math.min(t||33,d)},fps:function(e){g=1e3/(e||240),v=1e3*n.time+g},add:function(e,t,i){var r=t?function(t,i,s,a){e(t,i,s,a),n.remove(r)}:e;return n.remove(e),_[i?"unshift":"push"](r),bt(),r},remove:function(e,t){~(t=_.indexOf(e))&&_.splice(t,1)&&s>=t&&s--},_listeners:_},n}(),bt=function(){return!p&&yt.wake()},xt={},wt=/^[\d.\-M][\d.\-,\s]/,Et=/["']/g,St=function(e){for(var t,i,n,r={},s=e.substr(1,e.length-3).split(":"),a=s[0],o=1,l=s.length;o<l;o++)i=s[o],t=o!==l-1?i.lastIndexOf(","):i.length,n=i.substr(0,t),r[a]=isNaN(n)?n.replace(Et,"").trim():+n,a=i.substr(t+1).trim();return r},Tt=function(e){return function(t){return 1-e(1-t)}},Mt=function e(t,i){for(var n,r=t._first;r;)r instanceof Dt?e(r,i):!r.vars.yoyoEase||r._yoyo&&r._repeat||r._yoyo===i||(r.timeline?e(r.timeline,i):(n=r._ease,r._ease=r._yEase,r._yEase=n,r._yoyo=i)),r=r._next},At=function(e,t){return e&&(T(e)?e:xt[e]||function(e){var t,i,n,r,s=(e+"").split("("),a=xt[s[0]];return a&&s.length>1&&a.config?a.config.apply(null,~e.indexOf("{")?[St(s[1])]:(t=e,i=t.indexOf("(")+1,n=t.indexOf(")"),r=t.indexOf("(",i),t.substring(i,~r&&r<n?t.indexOf(")",n+1):n)).split(",").map(me)):xt._CE&&wt.test(e)?xt._CE("",e):a}(e))||t},Ct=function(e,t,i,n){void 0===i&&(i=function(e){return 1-t(1-e)}),void 0===n&&(n=function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2});var r,s={easeIn:t,easeOut:i,easeInOut:n};return le(e,(function(e){for(var t in xt[e]=B[e]=s,xt[r=e.toLowerCase()]=i,s)xt[r+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=xt[e+"."+t]=s[t]})),s},Lt=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},Pt=function e(t,i,n){var r=i>=1?i:1,s=(n||(t?.3:.45))/(i<1?i:1),a=s/_*(Math.asin(1/r)||0),o=function(e){return 1===e?1:r*Math.pow(2,-10*e)*E((e-a)*s)+1},l="out"===t?o:"in"===t?function(e){return 1-o(1-e)}:Lt(o);return s=_/s,l.config=function(i,n){return e(t,i,n)},l},Rt=function e(t,i){void 0===i&&(i=1.70158);var n=function(e){return e?--e*e*((i+1)*e+i)+1:0},r="out"===t?n:"in"===t?function(e){return 1-n(1-e)}:Lt(n);return r.config=function(i){return e(t,i)},r};le("Linear,Quad,Cubic,Quart,Quint,Strong",(function(e,t){var i=t<5?t+1:t;Ct(e+",Power"+(i-1),t?function(e){return Math.pow(e,i)}:function(e){return e},(function(e){return 1-Math.pow(1-e,i)}),(function(e){return e<.5?Math.pow(2*e,i)/2:1-Math.pow(2*(1-e),i)/2}))})),xt.Linear.easeNone=xt.none=xt.Linear.easeIn,Ct("Elastic",Pt("in"),Pt("out"),Pt()),function(e,t){var i=function(i){return i<.36363636363636365?e*i*i:i<.7272727272727273?e*Math.pow(i-1.5/t,2)+.75:i<.9090909090909092?e*(i-=2.25/t)*i+.9375:e*Math.pow(i-2.625/t,2)+.984375};Ct("Bounce",(function(e){return 1-i(1-e)}),i)}(7.5625,2.75),Ct("Expo",(function(e){return e?Math.pow(2,10*(e-1)):0})),Ct("Circ",(function(e){return-(x(1-e*e)-1)})),Ct("Sine",(function(e){return 1===e?1:1-w(e*y)})),Ct("Back",Rt("in"),Rt("out"),Rt()),xt.SteppedEase=xt.steps=B.SteppedEase={config:function(e,t){void 0===e&&(e=1);var i=1/e,n=e+(t?0:1),r=t?1:0;return function(e){return((n*We(0,.99999999,e)|0)+r)*i}}},m.ease=xt["quad.out"],le("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(e){return re+=e+","+e+"Params,"}));var Ot=function(e,t){this.id=b++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:oe,this.set=t?t.getSetter:Zt},It=function(){function e(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,ke(this,+e.duration,1,1),this.data=e.data,s&&(this._ctx=s,s.data.push(this)),p||yt.wake()}var t=e.prototype;return t.delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,ke(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(bt(),!arguments.length)return this._tTime;var i=this._dp;if(i&&i.smoothChildTiming&&this._ts){for(Oe(this,e),!i._dp||i.parent||Ie(i,this);i&&i.parent;)i.parent._time!==i._start+(i._ts>=0?i._tTime/i._ts:(i.totalDuration()-i._tTime)/-i._ts)&&i.totalTime(i._tTime,!0),i=i.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&De(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===v||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),fe(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+Ce(this))%(this._dur+this._rDelay)||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+Ce(this),t):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(e,t){var i=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*i,t):this._repeat?Le(this._tTime,i)+1:1},t.timeScale=function(e){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===e)return this;var t=this.parent&&this._ts?Pe(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||-1e-8===e?0:this._rts,this.totalTime(We(-Math.abs(this._delay),this._tDur,t),!0),Re(this),function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e}(this)},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(bt(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==v&&(this._tTime-=v)))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=e;var t=this.parent||this._dp;return t&&(t._sort||!this.parent)&&De(t,this,e-this._delay),this}return this._start},t.endTime=function(e){return this._start+(L(e)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Pe(t.rawTime(e),this):this._tTime:this._tTime},t.revert=function(e){void 0===e&&(e=Z);var t=r;return r=e,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(e),this.totalTime(-.01,e.suppressEvents)),"nested"!==this.data&&!1!==e.kill&&this.kill(),r=t,this},t.globalTime=function(e){for(var t=this,i=arguments.length?e:t.rawTime();t;)i=t._start+i/(t._ts||1),t=t._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(e):i},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,He(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){if(arguments.length){var t=this._time;return this._rDelay=e,He(this),t?this.time(t):this}return this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(Ve(this,e),L(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,L(t))},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-1e-8:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},t.isActive=function(){var e,t=this.parent||this._dp,i=this._start;return!(t&&!(this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=i&&e<this.endTime(!0)-v))},t.eventCallback=function(e,t,i){var n=this.vars;return arguments.length>1?(t?(n[e]=t,i&&(n[e+"Params"]=i),"onUpdate"===e&&(this._onUpdate=t)):delete n[e],this):n[e]},t.then=function(e){var t=this;return new Promise((function(i){var n=T(e)?e:ge,r=function(){var e=t.then;t.then=null,T(n)&&(n=n(t))&&(n.then||n===t)&&(t.then=e),i(n),t.then=e};t._initted&&1===t.totalProgress()&&t._ts>=0||!t._tTime&&t._ts<0?r():t._prom=r}))},t.kill=function(){ot(this)},e}();ve(It.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var Dt=function(i){function n(t,n){var r;return void 0===t&&(t={}),(r=i.call(this,t)||this).labels={},r.smoothChildTiming=!!t.smoothChildTiming,r.autoRemoveChildren=!!t.autoRemoveChildren,r._sort=L(t.sortChildren),a&&De(t.parent||a,e(r),n),t.reversed&&r.reverse(),t.paused&&r.paused(!0),t.scrollTrigger&&Ne(e(r),t.scrollTrigger),r}t(n,i);var s=n.prototype;return s.to=function(e,t,i){return je(0,arguments,this),this},s.from=function(e,t,i){return je(1,arguments,this),this},s.fromTo=function(e,t,i,n){return je(2,arguments,this),this},s.set=function(e,t,i){return t.duration=0,t.parent=this,xe(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new Wt(e,t,Ve(this,i),1),this},s.call=function(e,t,i){return De(this,Wt.delayedCall(0,e,t),i)},s.staggerTo=function(e,t,i,n,r,s,a){return i.duration=t,i.stagger=i.stagger||n,i.onComplete=s,i.onCompleteParams=a,i.parent=this,new Wt(e,i,Ve(this,r)),this},s.staggerFrom=function(e,t,i,n,r,s,a){return i.runBackwards=1,xe(i).immediateRender=L(i.immediateRender),this.staggerTo(e,t,i,n,r,s,a)},s.staggerFromTo=function(e,t,i,n,r,s,a,o){return n.startAt=i,xe(n).immediateRender=L(n.immediateRender),this.staggerTo(e,t,n,r,s,a,o)},s.render=function(e,t,i){var n,s,o,l,c,h,d,u,p,f,m,g,_=this._time,y=this._dirty?this.totalDuration():this._tDur,b=this._dur,x=e<=0?0:he(e),w=this._zTime<0!=e<0&&(this._initted||!b);if(this!==a&&x>y&&e>=0&&(x=y),x!==this._tTime||i||w){if(_!==this._time&&b&&(x+=this._time-_,e+=this._time-_),n=x,p=this._start,h=!(u=this._ts),w&&(b||(_=this._zTime),(e||!t)&&(this._zTime=e)),this._repeat){if(m=this._yoyo,c=b+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*c+e,t,i);if(n=he(x%c),x===y?(l=this._repeat,n=b):((l=~~(x/c))&&l===x/c&&(n=b,l--),n>b&&(n=b)),f=Le(this._tTime,c),!_&&this._tTime&&f!==l&&this._tTime-f*c-this._dur<=0&&(f=l),m&&1&l&&(n=b-n,g=1),l!==f&&!this._lock){var E=m&&1&f,S=E===(m&&1&l);if(l<f&&(E=!E),_=E?0:b,this._lock=1,this.render(_||(g?0:he(l*c)),t,!b)._lock=0,this._tTime=x,!t&&this.parent&&at(this,"onRepeat"),this.vars.repeatRefresh&&!g&&(this.invalidate()._lock=1),_&&_!==this._time||h!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(b=this._dur,y=this._tDur,S&&(this._lock=2,_=E?b:-1e-4,this.render(_,!0),this.vars.repeatRefresh&&!g&&this.invalidate()),this._lock=0,!this._ts&&!h)return this;Mt(this,g)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(d=function(e,t,i){var n;if(i>t)for(n=e._first;n&&n._start<=i;){if("isPause"===n.data&&n._start>t)return n;n=n._next}else for(n=e._last;n&&n._start>=i;){if("isPause"===n.data&&n._start<t)return n;n=n._prev}}(this,he(_),he(n)),d&&(x-=n-(n=d._start))),this._tTime=x,this._time=n,this._act=!u,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,_=0),!_&&n&&!t&&!l&&(at(this,"onStart"),this._tTime!==x))return this;if(n>=_&&e>=0)for(s=this._first;s;){if(o=s._next,(s._act||n>=s._start)&&s._ts&&d!==s){if(s.parent!==this)return this.render(e,t,i);if(s.render(s._ts>0?(n-s._start)*s._ts:(s._dirty?s.totalDuration():s._tDur)+(n-s._start)*s._ts,t,i),n!==this._time||!this._ts&&!h){d=0,o&&(x+=this._zTime=-1e-8);break}}s=o}else{s=this._last;for(var T=e<0?e:n;s;){if(o=s._prev,(s._act||T<=s._end)&&s._ts&&d!==s){if(s.parent!==this)return this.render(e,t,i);if(s.render(s._ts>0?(T-s._start)*s._ts:(s._dirty?s.totalDuration():s._tDur)+(T-s._start)*s._ts,t,i||r&&(s._initted||s._startAt)),n!==this._time||!this._ts&&!h){d=0,o&&(x+=this._zTime=T?-1e-8:v);break}}s=o}}if(d&&!t&&(this.pause(),d.render(n>=_?0:-1e-8)._zTime=n>=_?1:-1,this._ts))return this._start=p,Re(this),this.render(e,t,i);this._onUpdate&&!t&&at(this,"onUpdate",!0),(x===y&&this._tTime>=this.totalDuration()||!x&&_)&&(p!==this._start&&Math.abs(u)===Math.abs(this._ts)||this._lock||((e||!b)&&(x===y&&this._ts>0||!x&&this._ts<0)&&Se(this,1),t||e<0&&!_||!x&&!_&&y||(at(this,x===y&&e>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(x<y&&this.timeScale()>0)&&this._prom())))}return this},s.add=function(e,t){var i=this;if(M(t)||(t=Ve(this,t,e)),!(e instanceof It)){if(I(e))return e.forEach((function(e){return i.add(e,t)})),this;if(S(e))return this.addLabel(e,t);if(!T(e))return this;e=Wt.delayedCall(0,e)}return this!==e?De(this,e,t):this},s.getChildren=function(e,t,i,n){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===i&&(i=!0),void 0===n&&(n=-g);for(var r=[],s=this._first;s;)s._start>=n&&(s instanceof Wt?t&&r.push(s):(i&&r.push(s),e&&r.push.apply(r,s.getChildren(!0,t,i)))),s=s._next;return r},s.getById=function(e){for(var t=this.getChildren(1,1,1),i=t.length;i--;)if(t[i].vars.id===e)return t[i]},s.remove=function(e){return S(e)?this.removeLabel(e):T(e)?this.killTweensOf(e):(Ee(this,e),e===this._recent&&(this._recent=this._last),Te(this))},s.totalTime=function(e,t){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=he(yt.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts))),i.prototype.totalTime.call(this,e,t),this._forcing=0,this):this._tTime},s.addLabel=function(e,t){return this.labels[e]=Ve(this,t),this},s.removeLabel=function(e){return delete this.labels[e],this},s.addPause=function(e,t,i){var n=Wt.delayedCall(0,t||q,i);return n.data="isPause",this._hasPause=1,De(this,n,Ve(this,e))},s.removePause=function(e){var t=this._first;for(e=Ve(this,e);t;)t._start===e&&"isPause"===t.data&&Se(t),t=t._next},s.killTweensOf=function(e,t,i){for(var n=this.getTweensOf(e,i),r=n.length;r--;)Nt!==n[r]&&n[r].kill(e,t);return this},s.getTweensOf=function(e,t){for(var i,n=[],r=$e(e),s=this._first,a=M(t);s;)s instanceof Wt?ue(s._targets,r)&&(a?(!Nt||s._initted&&s._ts)&&s.globalTime(0)<=t&&s.globalTime(s.totalDuration())>t:!t||s.isActive())&&n.push(s):(i=s.getTweensOf(r,t)).length&&n.push.apply(n,i),s=s._next;return n},s.tweenTo=function(e,t){t=t||{};var i,n=this,r=Ve(n,e),s=t,a=s.startAt,o=s.onStart,l=s.onStartParams,c=s.immediateRender,h=Wt.to(n,ve({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:t.duration||Math.abs((r-(a&&"time"in a?a.time:n._time))/n.timeScale())||v,onStart:function(){if(n.pause(),!i){var e=t.duration||Math.abs((r-(a&&"time"in a?a.time:n._time))/n.timeScale());h._dur!==e&&ke(h,e,0,1).render(h._time,!0,!0),i=1}o&&o.apply(h,l||[])}},t));return c?h.render(0):h},s.tweenFromTo=function(e,t,i){return this.tweenTo(t,ve({startAt:{time:Ve(this,e)}},i))},s.recent=function(){return this._recent},s.nextLabel=function(e){return void 0===e&&(e=this._time),st(this,Ve(this,e))},s.previousLabel=function(e){return void 0===e&&(e=this._time),st(this,Ve(this,e),1)},s.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+v)},s.shiftChildren=function(e,t,i){void 0===i&&(i=0);for(var n,r=this._first,s=this.labels;r;)r._start>=i&&(r._start+=e,r._end+=e),r=r._next;if(t)for(n in s)s[n]>=i&&(s[n]+=e);return Te(this)},s.invalidate=function(e){var t=this._first;for(this._lock=0;t;)t.invalidate(e),t=t._next;return i.prototype.invalidate.call(this,e)},s.clear=function(e){void 0===e&&(e=!0);for(var t,i=this._first;i;)t=i._next,this.remove(i),i=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),Te(this)},s.totalDuration=function(e){var t,i,n,r=0,s=this,o=s._last,l=g;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-e:e));if(s._dirty){for(n=s.parent;o;)t=o._prev,o._dirty&&o.totalDuration(),(i=o._start)>l&&s._sort&&o._ts&&!s._lock?(s._lock=1,De(s,o,i-o._delay,1)._lock=0):l=i,i<0&&o._ts&&(r-=i,(!n&&!s._dp||n&&n.smoothChildTiming)&&(s._start+=i/s._ts,s._time-=i,s._tTime-=i),s.shiftChildren(-i,!1,-Infinity),l=0),o._end>r&&o._ts&&(r=o._end),o=t;ke(s,s===a&&s._time>r?s._time:r,1,1),s._dirty=0}return s._tDur},n.updateRoot=function(e){if(a._ts&&(fe(a,Pe(e,a)),d=yt.frame),yt.frame>=ie){ie+=f.autoSleep||120;var t=a._first;if((!t||!t._ts)&&f.autoSleep&&yt._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||yt.sleep()}}},n}(It);ve(Dt.prototype,{_lock:0,_hasPause:0,_forcing:0});var Nt,Ut,Ft=function(e,t,i,n,r,s,a){var o,l,c,h,d,u,p,f,m=new si(this._pt,e,t,0,1,Qt,null,r),g=0,v=0;for(m.b=i,m.e=n,i+="",(p=~(n+="").indexOf("random("))&&(n=nt(n)),s&&(s(f=[i,n],e,t),i=f[0],n=f[1]),l=i.match(F)||[];o=F.exec(n);)h=o[0],d=n.substring(g,o.index),c?c=(c+1)%5:"rgba("===d.substr(-5)&&(c=1),h!==l[v++]&&(u=parseFloat(l[v-1])||0,m._pt={_next:m._pt,p:d||1===v?d:",",s:u,c:"="===h.charAt(1)?de(u,h)-u:parseFloat(h)-u,m:c&&c<4?Math.round:0},g=F.lastIndex);return m.c=g<n.length?n.substring(g,n.length):"",m.fp=a,(z.test(n)||p)&&(m.e=0),this._pt=m,m},zt=function(e,t,i,n,r,s,a,o,l,c){T(n)&&(n=n(r||0,e,s));var h,d=e[t],u="get"!==i?i:T(d)?l?e[t.indexOf("set")||!T(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():d,p=T(d)?l?Yt:qt:Xt;if(S(n)&&(~n.indexOf("random(")&&(n=nt(n)),"="===n.charAt(1)&&((h=de(u,n)+(Xe(u)||0))||0===h)&&(n=h)),!c||u!==n||Ut)return isNaN(u*n)||""===n?(!d&&!(t in e)&&G(t,n),Ft.call(this,e,t,u,n,p,o||f.stringFilter,l)):(h=new si(this._pt,e,t,+u||0,n-(u||0),"boolean"==typeof d?Jt:Kt,0,p),l&&(h.fp=l),a&&h.modifier(a,this,e),this._pt=h)},kt=function(e,t,i,n,r,s){var a,o,l,c;if(ee[e]&&!1!==(a=new ee[e]).init(r,a.rawVars?t[e]:function(e,t,i,n,r){if(T(e)&&(e=Vt(e,r,t,i,n)),!C(e)||e.style&&e.nodeType||I(e)||O(e))return S(e)?Vt(e,r,t,i,n):e;var s,a={};for(s in e)a[s]=Vt(e[s],r,t,i,n);return a}(t[e],n,r,s,i),i,n,s)&&(i._pt=o=new si(i._pt,r,e,0,1,a.render,a,0,a.priority),i!==u))for(l=i._ptLookup[i._targets.indexOf(r)],c=a._props.length;c--;)l[a._props[c]]=o;return a},Ht=function e(t,i,s){var o,l,c,h,d,u,p,f,_,y,b,x,w,E=t.vars,S=E.ease,T=E.startAt,M=E.immediateRender,A=E.lazy,C=E.onUpdate,P=E.onUpdateParams,R=E.callbackScope,O=E.runBackwards,I=E.yoyoEase,D=E.keyframes,N=E.autoRevert,U=t._dur,F=t._startAt,z=t._targets,k=t.parent,H=k&&"nested"===k.data?k.vars.targets:z,B="auto"===t._overwrite&&!n,V=t.timeline;if(V&&(!D||!S)&&(S="none"),t._ease=At(S,m.ease),t._yEase=I?Tt(At(!0===I?S:I,m.ease)):0,I&&t._yoyo&&!t._repeat&&(I=t._yEase,t._yEase=t._ease,t._ease=I),t._from=!V&&!!E.runBackwards,!V||D&&!E.stagger){if(x=(f=z[0]?ae(z[0]).harness:0)&&E[f.prop],o=be(E,K),F&&(F._zTime<0&&F.progress(1),i<0&&O&&M&&!N?F.render(-1,!0):F.revert(O&&U?$:Y),F._lazy=0),T){if(Se(t._startAt=Wt.set(z,ve({data:"isStart",overwrite:!1,parent:k,immediateRender:!0,lazy:!F&&L(A),startAt:null,delay:0,onUpdate:C,onUpdateParams:P,callbackScope:R,stagger:0},T))),t._startAt._dp=0,t._startAt._sat=t,i<0&&(r||!M&&!N)&&t._startAt.revert($),M&&U&&i<=0&&s<=0)return void(i&&(t._zTime=i))}else if(O&&U&&!F)if(i&&(M=!1),c=ve({overwrite:!1,data:"isFromStart",lazy:M&&!F&&L(A),immediateRender:M,stagger:0,parent:k},o),x&&(c[f.prop]=x),Se(t._startAt=Wt.set(z,c)),t._startAt._dp=0,t._startAt._sat=t,i<0&&(r?t._startAt.revert($):t._startAt.render(-1,!0)),t._zTime=i,M){if(!i)return}else e(t._startAt,v,v);for(t._pt=t._ptCache=0,A=U&&L(A)||A&&!U,l=0;l<z.length;l++){if(p=(d=z[l])._gsap||se(z)[l]._gsap,t._ptLookup[l]=y={},Q[p.id]&&J.length&&pe(),b=H===z?l:H.indexOf(d),f&&!1!==(_=new f).init(d,x||o,t,b,H)&&(t._pt=h=new si(t._pt,d,_.name,0,1,_.render,_,0,_.priority),_._props.forEach((function(e){y[e]=h})),_.priority&&(u=1)),!f||x)for(c in o)ee[c]&&(_=kt(c,o,t,b,d,H))?_.priority&&(u=1):y[c]=h=zt.call(t,d,c,"get",o[c],b,H,0,E.stringFilter);t._op&&t._op[l]&&t.kill(d,t._op[l]),B&&t._pt&&(Nt=t,a.killTweensOf(d,y,t.globalTime(i)),w=!t.parent,Nt=0),t._pt&&A&&(Q[p.id]=1)}u&&ri(t),t._onInit&&t._onInit(t)}t._onUpdate=C,t._initted=(!t._op||t._pt)&&!w,D&&i<=0&&V.render(g,!0,!0)},Bt=function(e,t,i,n){var r,s,a=t.ease||n||"power1.inOut";if(I(t))s=i[e]||(i[e]=[]),t.forEach((function(e,i){return s.push({t:i/(t.length-1)*100,v:e,e:a})}));else for(r in t)s=i[r]||(i[r]=[]),"ease"===r||s.push({t:parseFloat(e),v:t[r],e:a})},Vt=function(e,t,i,n,r){return T(e)?e.call(t,i,n,r):S(e)&&~e.indexOf("random(")?nt(e):e},jt=re+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Gt={};le(jt+",id,stagger,delay,duration,paused,scrollTrigger",(function(e){return Gt[e]=1}));var Wt=function(i){function s(t,r,s,o){var l;"number"==typeof r&&(s.duration=r,r=s,s=null);var c,h,d,u,p,m,g,v,_=(l=i.call(this,o?r:xe(r))||this).vars,y=_.duration,b=_.delay,x=_.immediateRender,w=_.stagger,E=_.overwrite,S=_.keyframes,T=_.defaults,A=_.scrollTrigger,P=_.yoyoEase,D=r.parent||a,N=(I(t)||O(t)?M(t[0]):"length"in r)?[t]:$e(t);if(l._targets=N.length?se(N):W("GSAP target "+t+" not found. https://greensock.com",!f.nullTargetWarn)||[],l._ptLookup=[],l._overwrite=E,S||w||R(y)||R(b)){if(r=l.vars,(c=l.timeline=new Dt({data:"nested",defaults:T||{},targets:D&&"nested"===D.data?D.vars.targets:N})).kill(),c.parent=c._dp=e(l),c._start=0,w||R(y)||R(b)){if(u=N.length,g=w&&Je(w),C(w))for(p in w)~jt.indexOf(p)&&(v||(v={}),v[p]=w[p]);for(h=0;h<u;h++)(d=be(r,Gt)).stagger=0,P&&(d.yoyoEase=P),v&&_e(d,v),m=N[h],d.duration=+Vt(y,e(l),h,m,N),d.delay=(+Vt(b,e(l),h,m,N)||0)-l._delay,!w&&1===u&&d.delay&&(l._delay=b=d.delay,l._start+=b,d.delay=0),c.to(m,d,g?g(h,m,N):0),c._ease=xt.none;c.duration()?y=b=0:l.timeline=0}else if(S){xe(ve(c.vars.defaults,{ease:"none"})),c._ease=At(S.ease||r.ease||"none");var U,F,z,k=0;if(I(S))S.forEach((function(e){return c.to(N,e,">")})),c.duration();else{for(p in d={},S)"ease"===p||"easeEach"===p||Bt(p,S[p],d,S.easeEach);for(p in d)for(U=d[p].sort((function(e,t){return e.t-t.t})),k=0,h=0;h<U.length;h++)(z={ease:(F=U[h]).e,duration:(F.t-(h?U[h-1].t:0))/100*y})[p]=F.v,c.to(N,z,k),k+=z.duration;c.duration()<y&&c.to({},{duration:y-c.duration()})}}y||l.duration(y=c.duration())}else l.timeline=0;return!0!==E||n||(Nt=e(l),a.killTweensOf(N),Nt=0),De(D,e(l),s),r.reversed&&l.reverse(),r.paused&&l.paused(!0),(x||!y&&!S&&l._start===he(D._time)&&L(x)&&Ae(e(l))&&"nested"!==D.data)&&(l._tTime=-1e-8,l.render(Math.max(0,-b)||0)),A&&Ne(e(l),A),l}t(s,i);var o=s.prototype;return o.render=function(e,t,i){var n,s,a,o,l,c,h,d,u,p=this._time,f=this._tDur,m=this._dur,g=e<0,_=e>f-v&&!g?f:e<v?0:e;if(m){if(_!==this._tTime||!e||i||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==g){if(n=_,d=this.timeline,this._repeat){if(o=m+this._rDelay,this._repeat<-1&&g)return this.totalTime(100*o+e,t,i);if(n=he(_%o),_===f?(a=this._repeat,n=m):((a=~~(_/o))&&a===_/o&&(n=m,a--),n>m&&(n=m)),(c=this._yoyo&&1&a)&&(u=this._yEase,n=m-n),l=Le(this._tTime,o),n===p&&!i&&this._initted)return this._tTime=_,this;a!==l&&(d&&this._yEase&&Mt(d,c),!this.vars.repeatRefresh||c||this._lock||(this._lock=i=1,this.render(he(o*a),!0).invalidate()._lock=0))}if(!this._initted){if(Ue(this,g?e:n,i,t,_))return this._tTime=0,this;if(p!==this._time)return this;if(m!==this._dur)return this.render(e,t,i)}if(this._tTime=_,this._time=n,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=h=(u||this._ease)(n/m),this._from&&(this.ratio=h=1-h),n&&!p&&!t&&!a&&(at(this,"onStart"),this._tTime!==_))return this;for(s=this._pt;s;)s.r(h,s.d),s=s._next;d&&d.render(e<0?e:!n&&c?-1e-8:d._dur*d._ease(n/this._dur),t,i)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(g&&Me(this,e,0,i),at(this,"onUpdate")),this._repeat&&a!==l&&this.vars.onRepeat&&!t&&this.parent&&at(this,"onRepeat"),_!==this._tDur&&_||this._tTime!==_||(g&&!this._onUpdate&&Me(this,e,0,!0),(e||!m)&&(_===this._tDur&&this._ts>0||!_&&this._ts<0)&&Se(this,1),t||g&&!p||!(_||p||c)||(at(this,_===f?"onComplete":"onReverseComplete",!0),this._prom&&!(_<f&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,i,n){var s,a,o,l=e.ratio,c=t<0||!t&&(!e._start&&Fe(e)&&(e._initted||!ze(e))||(e._ts<0||e._dp._ts<0)&&!ze(e))?0:1,h=e._rDelay,d=0;if(h&&e._repeat&&(d=We(0,e._tDur,t),a=Le(d,h),e._yoyo&&1&a&&(c=1-c),a!==Le(e._tTime,h)&&(l=1-c,e.vars.repeatRefresh&&e._initted&&e.invalidate())),c!==l||r||n||e._zTime===v||!t&&e._zTime){if(!e._initted&&Ue(e,t,n,i,d))return;for(o=e._zTime,e._zTime=t||(i?v:0),i||(i=t&&!o),e.ratio=c,e._from&&(c=1-c),e._time=0,e._tTime=d,s=e._pt;s;)s.r(c,s.d),s=s._next;t<0&&Me(e,t,0,!0),e._onUpdate&&!i&&at(e,"onUpdate"),d&&e._repeat&&!i&&e.parent&&at(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===c&&(c&&Se(e,1),i||r||(at(e,c?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,e,t,i);return this},o.targets=function(){return this._targets},o.invalidate=function(e){return(!e||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(e),i.prototype.invalidate.call(this,e)},o.resetTo=function(e,t,i,n){p||yt.wake(),this._ts||this.play();var r=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||Ht(this,r),function(e,t,i,n,r,s,a){var o,l,c,h,d=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!d)for(d=e._ptCache[t]=[],c=e._ptLookup,h=e._targets.length;h--;){if((o=c[h][t])&&o.d&&o.d._pt)for(o=o.d._pt;o&&o.p!==t&&o.fp!==t;)o=o._next;if(!o)return Ut=1,e.vars[t]="+=0",Ht(e,a),Ut=0,1;d.push(o)}for(h=d.length;h--;)(o=(l=d[h])._pt||l).s=!n&&0!==n||r?o.s+(n||0)+s*o.c:n,o.c=i-o.s,l.e&&(l.e=ce(i)+Xe(l.e)),l.b&&(l.b=o.s+Xe(l.b))}(this,e,t,i,n,this._ease(r/this._dur),r)?this.resetTo(e,t,i,n):(Oe(this,0),this.parent||we(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},o.kill=function(e,t){if(void 0===t&&(t="all"),!(e||t&&"all"!==t))return this._lazy=this._pt=0,this.parent?ot(this):this;if(this.timeline){var i=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,Nt&&!0!==Nt.vars.overwrite)._first||ot(this),this.parent&&i!==this.timeline.totalDuration()&&ke(this,this._dur*this.timeline._tDur/i,0,1),this}var n,r,s,a,o,l,c,h=this._targets,d=e?$e(e):h,u=this._ptLookup,p=this._pt;if((!t||"all"===t)&&function(e,t){for(var i=e.length,n=i===t.length;n&&i--&&e[i]===t[i];);return i<0}(h,d))return"all"===t&&(this._pt=0),ot(this);for(n=this._op=this._op||[],"all"!==t&&(S(t)&&(o={},le(t,(function(e){return o[e]=1})),t=o),t=function(e,t){var i,n,r,s,a=e[0]?ae(e[0]).harness:0,o=a&&a.aliases;if(!o)return t;for(n in i=_e({},t),o)if(n in i)for(r=(s=o[n].split(",")).length;r--;)i[s[r]]=i[n];return i}(h,t)),c=h.length;c--;)if(~d.indexOf(h[c]))for(o in r=u[c],"all"===t?(n[c]=t,a=r,s={}):(s=n[c]=n[c]||{},a=t),a)(l=r&&r[o])&&("kill"in l.d&&!0!==l.d.kill(o)||Ee(this,l,"_pt"),delete r[o]),"all"!==s&&(s[o]=1);return this._initted&&!this._pt&&p&&ot(this),this},s.to=function(e,t){return new s(e,t,arguments[2])},s.from=function(e,t){return je(1,arguments)},s.delayedCall=function(e,t,i,n){return new s(t,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:t,onReverseComplete:t,onCompleteParams:i,onReverseCompleteParams:i,callbackScope:n})},s.fromTo=function(e,t,i){return je(2,arguments)},s.set=function(e,t){return t.duration=0,t.repeatDelay||(t.repeat=0),new s(e,t)},s.killTweensOf=function(e,t,i){return a.killTweensOf(e,t,i)},s}(It);ve(Wt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),le("staggerTo,staggerFrom,staggerFromTo",(function(e){Wt[e]=function(){var t=new Dt,i=qe.call(arguments,0);return i.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,i)}}));var Xt=function(e,t,i){return e[t]=i},qt=function(e,t,i){return e[t](i)},Yt=function(e,t,i,n){return e[t](n.fp,i)},$t=function(e,t,i){return e.setAttribute(t,i)},Zt=function(e,t){return T(e[t])?qt:A(e[t])&&e.setAttribute?$t:Xt},Kt=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},Jt=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},Qt=function(e,t){var i=t._pt,n="";if(!e&&t.b)n=t.b;else if(1===e&&t.e)n=t.e;else{for(;i;)n=i.p+(i.m?i.m(i.s+i.c*e):Math.round(1e4*(i.s+i.c*e))/1e4)+n,i=i._next;n+=t.c}t.set(t.t,t.p,n,t)},ei=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},ti=function(e,t,i,n){for(var r,s=this._pt;s;)r=s._next,s.p===n&&s.modifier(e,t,i),s=r},ii=function(e){for(var t,i,n=this._pt;n;)i=n._next,n.p===e&&!n.op||n.op===e?Ee(this,n,"_pt"):n.dep||(t=1),n=i;return!t},ni=function(e,t,i,n){n.mSet(e,t,n.m.call(n.tween,i,n.mt),n)},ri=function(e){for(var t,i,n,r,s=e._pt;s;){for(t=s._next,i=n;i&&i.pr>s.pr;)i=i._next;(s._prev=i?i._prev:r)?s._prev._next=s:n=s,(s._next=i)?i._prev=s:r=s,s=t}e._pt=n},si=function(){function e(e,t,i,n,r,s,a,o,l){this.t=t,this.s=n,this.c=r,this.p=i,this.r=s||Kt,this.d=a||this,this.set=o||Xt,this.pr=l||0,this._next=e,e&&(e._prev=this)}return e.prototype.modifier=function(e,t,i){this.mSet=this.mSet||this.set,this.set=ni,this.m=e,this.mt=i,this.tween=t},e}();le(re+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(e){return K[e]=1})),B.TweenMax=B.TweenLite=Wt,B.TimelineLite=B.TimelineMax=Dt,a=new Dt({sortChildren:!1,defaults:m,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),f.stringFilter=_t;var ai=[],oi={},li=[],ci=0,hi=function(e){return(oi[e]||li).map((function(e){return e()}))},di=function(){var e=Date.now(),t=[];e-ci>2&&(hi("matchMediaInit"),ai.forEach((function(e){var i,n,r,s,a=e.queries,l=e.conditions;for(n in a)(i=o.matchMedia(a[n]).matches)&&(r=1),i!==l[n]&&(l[n]=i,s=1);s&&(e.revert(),r&&t.push(e))})),hi("matchMediaRevert"),t.forEach((function(e){return e.onMatch(e)})),ci=e,hi("matchMedia"))},ui=function(){function e(e,t){this.selector=t&&Ze(t),this.data=[],this._r=[],this.isReverted=!1,e&&this.add(e)}var t=e.prototype;return t.add=function(e,t,i){T(e)&&(i=t,t=e,e=T);var n=this,r=function(){var e,r=s,a=n.selector;return r&&r!==n&&r.data.push(n),i&&(n.selector=Ze(i)),s=n,e=t.apply(n,arguments),T(e)&&n._r.push(e),s=r,n.selector=a,n.isReverted=!1,e};return n.last=r,e===T?r(n):e?n[e]=r:r},t.ignore=function(e){var t=s;s=null,e(this),s=t},t.getTweens=function(){var t=[];return this.data.forEach((function(i){return i instanceof e?t.push.apply(t,i.getTweens()):i instanceof Wt&&!(i.parent&&"nested"===i.parent.data)&&t.push(i)})),t},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(e,t){var i=this;if(e){var n=this.getTweens();this.data.forEach((function(e){"isFlip"===e.data&&(e.revert(),e.getChildren(!0,!0,!1).forEach((function(e){return n.splice(n.indexOf(e),1)})))})),n.map((function(e){return{g:e.globalTime(0),t:e}})).sort((function(e,t){return t.g-e.g||-1})).forEach((function(t){return t.t.revert(e)})),this.data.forEach((function(t){return!(t instanceof It)&&t.revert&&t.revert(e)})),this._r.forEach((function(t){return t(e,i)})),this.isReverted=!0}else this.data.forEach((function(e){return e.kill&&e.kill()}));if(this.clear(),t){var r=ai.indexOf(this);~r&&ai.splice(r,1)}},t.revert=function(e){this.kill(e||{})},e}(),pi=function(){function e(e){this.contexts=[],this.scope=e}var t=e.prototype;return t.add=function(e,t,i){C(e)||(e={matches:e});var n,r,s,a=new ui(0,i||this.scope),l=a.conditions={};for(r in this.contexts.push(a),t=a.add("onMatch",t),a.queries=e,e)"all"===r?s=1:(n=o.matchMedia(e[r]))&&(ai.indexOf(a)<0&&ai.push(a),(l[r]=n.matches)&&(s=1),n.addListener?n.addListener(di):n.addEventListener("change",di));return s&&t(a),this},t.revert=function(e){this.kill(e||{})},t.kill=function(e){this.contexts.forEach((function(t){return t.kill(e,!0)}))},e}(),fi={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach((function(e){return ct(e)}))},timeline:function(e){return new Dt(e)},getTweensOf:function(e,t){return a.getTweensOf(e,t)},getProperty:function(e,t,i,n){S(e)&&(e=$e(e)[0]);var r=ae(e||{}).get,s=i?ge:me;return"native"===i&&(i=""),e?t?s((ee[t]&&ee[t].get||r)(e,t,i,n)):function(t,i,n){return s((ee[t]&&ee[t].get||r)(e,t,i,n))}:e},quickSetter:function(e,t,i){if((e=$e(e)).length>1){var n=e.map((function(e){return vi.quickSetter(e,t,i)})),r=n.length;return function(e){for(var t=r;t--;)n[t](e)}}e=e[0]||{};var s=ee[t],a=ae(e),o=a.harness&&(a.harness.aliases||{})[t]||t,l=s?function(t){var n=new s;u._pt=0,n.init(e,i?t+i:t,u,0,[e]),n.render(1,n),u._pt&&ei(1,u)}:a.set(e,o);return s?l:function(t){return l(e,o,i?t+i:t,a,1)}},quickTo:function(e,t,i){var n,r=vi.to(e,_e(((n={})[t]="+=0.1",n.paused=!0,n),i||{})),s=function(e,i,n){return r.resetTo(t,e,i,n)};return s.tween=r,s},isTweening:function(e){return a.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=At(e.ease,m.ease)),ye(m,e||{})},config:function(e){return ye(f,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,n=e.plugins,r=e.defaults,s=e.extendTimeline;(n||"").split(",").forEach((function(e){return e&&!ee[e]&&!B[e]&&W(t+" effect requires "+e+" plugin.")})),te[t]=function(e,t,n){return i($e(e),ve(t||{},r),n)},s&&(Dt.prototype[t]=function(e,i,n){return this.add(te[t](e,C(i)?i:(n=i)&&{},this),n)})},registerEase:function(e,t){xt[e]=At(t)},parseEase:function(e,t){return arguments.length?At(e,t):xt},getById:function(e){return a.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var i,n,r=new Dt(e);for(r.smoothChildTiming=L(e.smoothChildTiming),a.remove(r),r._dp=0,r._time=r._tTime=a._time,i=a._first;i;)n=i._next,!t&&!i._dur&&i instanceof Wt&&i.vars.onComplete===i._targets[0]||De(r,i,i._start-i._delay),i=n;return De(a,r,0),r},context:function(e,t){return e?new ui(e,t):s},matchMedia:function(e){return new pi(e)},matchMediaRefresh:function(){return ai.forEach((function(e){var t,i,n=e.conditions;for(i in n)n[i]&&(n[i]=!1,t=1);t&&e.revert()}))||di()},addEventListener:function(e,t){var i=oi[e]||(oi[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=oi[e],n=i&&i.indexOf(t);n>=0&&i.splice(n,1)},utils:{wrap:function e(t,i,n){var r=i-t;return I(t)?it(t,e(0,t.length),i):Ge(n,(function(e){return(r+(e-t)%r)%r+t}))},wrapYoyo:function e(t,i,n){var r=i-t,s=2*r;return I(t)?it(t,e(0,t.length-1),i):Ge(n,(function(e){return t+((e=(s+(e-t)%s)%s||0)>r?s-e:e)}))},distribute:Je,random:tt,snap:et,normalize:function(e,t,i){return rt(e,t,0,1,i)},getUnit:Xe,clamp:function(e,t,i){return Ge(i,(function(i){return We(e,t,i)}))},splitColor:pt,toArray:$e,selector:Ze,mapRange:rt,pipe:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e){return t.reduce((function(e,t){return t(e)}),e)}},unitize:function(e,t){return function(i){return e(parseFloat(i))+(t||Xe(i))}},interpolate:function e(t,i,n,r){var s=isNaN(t+i)?0:function(e){return(1-e)*t+e*i};if(!s){var a,o,l,c,h,d=S(t),u={};if(!0===n&&(r=1)&&(n=null),d)t={p:t},i={p:i};else if(I(t)&&!I(i)){for(l=[],c=t.length,h=c-2,o=1;o<c;o++)l.push(e(t[o-1],t[o]));c--,s=function(e){e*=c;var t=Math.min(h,~~e);return l[t](e-t)},n=i}else r||(t=_e(I(t)?[]:{},t));if(!l){for(a in i)zt.call(u,t,a,"get",i[a]);s=function(e){return ei(e,u)||(d?t.p:t)}}}return Ge(n,s)},shuffle:Ke},install:j,effects:te,ticker:yt,updateRoot:Dt.updateRoot,plugins:ee,globalTimeline:a,core:{PropTween:si,globals:X,Tween:Wt,Timeline:Dt,Animation:It,getCache:ae,_removeLinkedListItem:Ee,reverting:function(){return r},context:function(e){return e&&s&&(s.data.push(e),e._ctx=s),s},suppressOverwrites:function(e){return n=e}}};le("to,from,fromTo,delayedCall,set,killTweensOf",(function(e){return fi[e]=Wt[e]})),yt.add(Dt.updateRoot),u=fi.to({},{duration:0});var mi=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},gi=function(e,t){return{name:e,rawVars:1,init:function(e,i,n){n._onInit=function(e){var n,r;if(S(i)&&(n={},le(i,(function(e){return n[e]=1})),i=n),t){for(r in n={},i)n[r]=t(i[r]);i=n}!function(e,t){var i,n,r,s=e._targets;for(i in t)for(n=s.length;n--;)(r=e._ptLookup[n][i])&&(r=r.d)&&(r._pt&&(r=mi(r,i)),r&&r.modifier&&r.modifier(t[i],e,s[n],i))}(e,i)}}}},vi=fi.registerPlugin({name:"attr",init:function(e,t,i,n,r){var s,a,o;for(s in this.tween=i,t)o=e.getAttribute(s)||"",(a=this.add(e,"setAttribute",(o||0)+"",t[s],n,r,0,0,s)).op=s,a.b=o,this._props.push(s)},render:function(e,t){for(var i=t._pt;i;)r?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},gi("roundProps",Qe),gi("modifiers"),gi("snap",et))||fi;Wt.version=Dt.version=vi.version="3.11.5",h=1,P()&&bt(),xt.Power0,xt.Power1,xt.Power2,xt.Power3,xt.Power4,xt.Linear,xt.Quad,xt.Cubic,xt.Quart,xt.Quint,xt.Strong,xt.Elastic,xt.Back,xt.SteppedEase,xt.Bounce,xt.Sine,xt.Expo,xt.Circ;var _i,yi,bi,xi,wi,Ei,Si,Ti,Mi={},Ai=180/Math.PI,Ci=Math.PI/180,Li=Math.atan2,Pi=/([A-Z])/g,Ri=/(left|right|width|margin|padding|x)/i,Oi=/[\s,\(]\S/,Ii={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Di=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},Ni=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},Ui=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},Fi=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},zi=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},ki=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},Hi=function(e,t,i){return e.style[t]=i},Bi=function(e,t,i){return e.style.setProperty(t,i)},Vi=function(e,t,i){return e._gsap[t]=i},ji=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},Gi=function(e,t,i,n,r){var s=e._gsap;s.scaleX=s.scaleY=i,s.renderTransform(r,s)},Wi=function(e,t,i,n,r){var s=e._gsap;s[t]=i,s.renderTransform(r,s)},Xi="transform",qi=Xi+"Origin",Yi=function e(t,i){var n=this,r=this.target,s=r.style;if(t in Mi){if(this.tfm=this.tfm||{},"transform"===t)return Ii.transform.split(",").forEach((function(t){return e.call(n,t,i)}));if(~(t=Ii[t]||t).indexOf(",")?t.split(",").forEach((function(e){return n.tfm[e]=pn(r,e)})):this.tfm[t]=r._gsap.x?r._gsap[t]:pn(r,t),this.props.indexOf(Xi)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(qi,i,"")),t=Xi}(s||i)&&this.props.push(t,i,s[t])},$i=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},Zi=function(){var e,t,i=this.props,n=this.target,r=n.style,s=n._gsap;for(e=0;e<i.length;e+=3)i[e+1]?n[i[e]]=i[e+2]:i[e+2]?r[i[e]]=i[e+2]:r.removeProperty("--"===i[e].substr(0,2)?i[e]:i[e].replace(Pi,"-$1").toLowerCase());if(this.tfm){for(t in this.tfm)s[t]=this.tfm[t];s.svg&&(s.renderTransform(),n.setAttribute("data-svg-origin",this.svgo||"")),(e=Si())&&e.isStart||r[Xi]||($i(r),s.uncache=1)}},Ki=function(e,t){var i={target:e,props:[],revert:Zi,save:Yi};return e._gsap||vi.core.getCache(e),t&&t.split(",").forEach((function(e){return i.save(e)})),i},Ji=function(e,t){var i=yi.createElementNS?yi.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):yi.createElement(e);return i.style?i:yi.createElement(e)},Qi=function e(t,i,n){var r=getComputedStyle(t);return r[i]||r.getPropertyValue(i.replace(Pi,"-$1").toLowerCase())||r.getPropertyValue(i)||!n&&e(t,tn(i)||i,1)||""},en="O,Moz,ms,Ms,Webkit".split(","),tn=function(e,t,i){var n=(t||wi).style,r=5;if(e in n&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);r--&&!(en[r]+e in n););return r<0?null:(3===r?"ms":r>=0?en[r]:"")+e},nn=function(){"undefined"!=typeof window&&window.document&&(_i=window,yi=_i.document,bi=yi.documentElement,wi=Ji("div")||{style:{}},Ji("div"),Xi=tn(Xi),qi=Xi+"Origin",wi.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Ti=!!tn("perspective"),Si=vi.core.reverting,xi=1)},rn=function e(t){var i,n=Ji("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=this.parentNode,s=this.nextSibling,a=this.style.cssText;if(bi.appendChild(n),n.appendChild(this),this.style.display="block",t)try{i=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=e}catch(e){}else this._gsapBBox&&(i=this._gsapBBox());return r&&(s?r.insertBefore(this,s):r.appendChild(this)),bi.removeChild(n),this.style.cssText=a,i},sn=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},an=function(e){var t;try{t=e.getBBox()}catch(i){t=rn.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===rn||(t=rn.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+sn(e,["x","cx","x1"])||0,y:+sn(e,["y","cy","y1"])||0,width:0,height:0}},on=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!an(e))},ln=function(e,t){if(t){var i=e.style;t in Mi&&t!==qi&&(t=Xi),i.removeProperty?("ms"!==t.substr(0,2)&&"webkit"!==t.substr(0,6)||(t="-"+t),i.removeProperty(t.replace(Pi,"-$1").toLowerCase())):i.removeAttribute(t)}},cn=function(e,t,i,n,r,s){var a=new si(e._pt,t,i,0,1,s?ki:zi);return e._pt=a,a.b=n,a.e=r,e._props.push(i),a},hn={deg:1,rad:1,turn:1},dn={grid:1,flex:1},un=function e(t,i,n,r){var s,a,o,l,c=parseFloat(n)||0,h=(n+"").trim().substr((c+"").length)||"px",d=wi.style,u=Ri.test(i),p="svg"===t.tagName.toLowerCase(),f=(p?"client":"offset")+(u?"Width":"Height"),m=100,g="px"===r,v="%"===r;return r===h||!c||hn[r]||hn[h]?c:("px"!==h&&!g&&(c=e(t,i,n,"px")),l=t.getCTM&&on(t),!v&&"%"!==h||!Mi[i]&&!~i.indexOf("adius")?(d[u?"width":"height"]=m+(g?h:r),a=~i.indexOf("adius")||"em"===r&&t.appendChild&&!p?t:t.parentNode,l&&(a=(t.ownerSVGElement||{}).parentNode),a&&a!==yi&&a.appendChild||(a=yi.body),(o=a._gsap)&&v&&o.width&&u&&o.time===yt.time&&!o.uncache?ce(c/o.width*m):((v||"%"===h)&&!dn[Qi(a,"display")]&&(d.position=Qi(t,"position")),a===t&&(d.position="static"),a.appendChild(wi),s=wi[f],a.removeChild(wi),d.position="absolute",u&&v&&((o=ae(a)).time=yt.time,o.width=a[f]),ce(g?s*c/m:s&&c?m/s*c:0))):(s=l?t.getBBox()[u?"width":"height"]:t[f],ce(v?c/s*m:c/100*s)))},pn=function(e,t,i,n){var r;return xi||nn(),t in Ii&&"transform"!==t&&~(t=Ii[t]).indexOf(",")&&(t=t.split(",")[0]),Mi[t]&&"transform"!==t?(r=Tn(e,n),r="transformOrigin"!==t?r[t]:r.svg?r.origin:Mn(Qi(e,qi))+" "+r.zOrigin+"px"):(!(r=e.style[t])||"auto"===r||n||~(r+"").indexOf("calc("))&&(r=_n[t]&&_n[t](e,t,i)||Qi(e,t)||oe(e,t)||("opacity"===t?1:0)),i&&!~(r+"").trim().indexOf(" ")?un(e,t,r,i)+i:r},fn=function(e,t,i,n){if(!i||"none"===i){var r=tn(t,e,1),s=r&&Qi(e,r,1);s&&s!==i?(t=r,i=s):"borderColor"===t&&(i=Qi(e,"borderTopColor"))}var a,o,l,c,h,d,u,p,m,g,v,_=new si(this._pt,e.style,t,0,1,Qt),y=0,b=0;if(_.b=i,_.e=n,i+="","auto"==(n+="")&&(e.style[t]=n,n=Qi(e,t)||n,e.style[t]=i),_t(a=[i,n]),n=a[1],l=(i=a[0]).match(U)||[],(n.match(U)||[]).length){for(;o=U.exec(n);)u=o[0],m=n.substring(y,o.index),h?h=(h+1)%5:"rgba("!==m.substr(-5)&&"hsla("!==m.substr(-5)||(h=1),u!==(d=l[b++]||"")&&(c=parseFloat(d)||0,v=d.substr((c+"").length),"="===u.charAt(1)&&(u=de(c,u)+v),p=parseFloat(u),g=u.substr((p+"").length),y=U.lastIndex-g.length,g||(g=g||f.units[t]||v,y===n.length&&(n+=g,_.e+=g)),v!==g&&(c=un(e,t,d,g)||0),_._pt={_next:_._pt,p:m||1===b?m:",",s:c,c:p-c,m:h&&h<4||"zIndex"===t?Math.round:0});_.c=y<n.length?n.substring(y,n.length):""}else _.r="display"===t&&"none"===n?ki:zi;return z.test(n)&&(_.e=0),this._pt=_,_},mn={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},gn=function(e){var t=e.split(" "),i=t[0],n=t[1]||"50%";return"top"!==i&&"bottom"!==i&&"left"!==n&&"right"!==n||(e=i,i=n,n=e),t[0]=mn[i]||i,t[1]=mn[n]||n,t.join(" ")},vn=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i,n,r,s=t.t,a=s.style,o=t.u,l=s._gsap;if("all"===o||!0===o)a.cssText="",n=1;else for(r=(o=o.split(",")).length;--r>-1;)i=o[r],Mi[i]&&(n=1,i="transformOrigin"===i?qi:Xi),ln(s,i);n&&(ln(s,Xi),l&&(l.svg&&s.removeAttribute("transform"),Tn(s,1),l.uncache=1,$i(a)))}},_n={clearProps:function(e,t,i,n,r){if("isFromStart"!==r.data){var s=e._pt=new si(e._pt,t,i,0,0,vn);return s.u=n,s.pr=-10,s.tween=r,e._props.push(i),1}}},yn=[1,0,0,1,0,0],bn={},xn=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},wn=function(e){var t=Qi(e,Xi);return xn(t)?yn:t.substr(7).match(N).map(ce)},En=function(e,t){var i,n,r,s,a=e._gsap||ae(e),o=e.style,l=wn(e);return a.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(r=e.transform.baseVal.consolidate().matrix).a,r.b,r.c,r.d,r.e,r.f]).join(",")?yn:l:(l!==yn||e.offsetParent||e===bi||a.svg||(r=o.display,o.display="block",(i=e.parentNode)&&e.offsetParent||(s=1,n=e.nextElementSibling,bi.appendChild(e)),l=wn(e),r?o.display=r:ln(e,"display"),s&&(n?i.insertBefore(e,n):i?i.appendChild(e):bi.removeChild(e))),t&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},Sn=function(e,t,i,n,r,s){var a,o,l,c=e._gsap,h=r||En(e,!0),d=c.xOrigin||0,u=c.yOrigin||0,p=c.xOffset||0,f=c.yOffset||0,m=h[0],g=h[1],v=h[2],_=h[3],y=h[4],b=h[5],x=t.split(" "),w=parseFloat(x[0])||0,E=parseFloat(x[1])||0;i?h!==yn&&(o=m*_-g*v)&&(l=w*(-g/o)+E*(m/o)-(m*b-g*y)/o,w=w*(_/o)+E*(-v/o)+(v*b-_*y)/o,E=l):(w=(a=an(e)).x+(~x[0].indexOf("%")?w/100*a.width:w),E=a.y+(~(x[1]||x[0]).indexOf("%")?E/100*a.height:E)),n||!1!==n&&c.smooth?(y=w-d,b=E-u,c.xOffset=p+(y*m+b*v)-y,c.yOffset=f+(y*g+b*_)-b):c.xOffset=c.yOffset=0,c.xOrigin=w,c.yOrigin=E,c.smooth=!!n,c.origin=t,c.originIsAbsolute=!!i,e.style[qi]="0px 0px",s&&(cn(s,c,"xOrigin",d,w),cn(s,c,"yOrigin",u,E),cn(s,c,"xOffset",p,c.xOffset),cn(s,c,"yOffset",f,c.yOffset)),e.setAttribute("data-svg-origin",w+" "+E)},Tn=function(e,t){var i=e._gsap||new Ot(e);if("x"in i&&!t&&!i.uncache)return i;var n,r,s,a,o,l,c,h,d,u,p,m,g,v,_,y,b,x,w,E,S,T,M,A,C,L,P,R,O,I,D,N,U=e.style,F=i.scaleX<0,z="px",k="deg",H=getComputedStyle(e),B=Qi(e,qi)||"0";return n=r=s=l=c=h=d=u=p=0,a=o=1,i.svg=!(!e.getCTM||!on(e)),H.translate&&("none"===H.translate&&"none"===H.scale&&"none"===H.rotate||(U[Xi]=("none"!==H.translate?"translate3d("+(H.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==H.rotate?"rotate("+H.rotate+") ":"")+("none"!==H.scale?"scale("+H.scale.split(" ").join(",")+") ":"")+("none"!==H[Xi]?H[Xi]:"")),U.scale=U.rotate=U.translate="none"),v=En(e,i.svg),i.svg&&(i.uncache?(C=e.getBBox(),B=i.xOrigin-C.x+"px "+(i.yOrigin-C.y)+"px",A=""):A=!t&&e.getAttribute("data-svg-origin"),Sn(e,A||B,!!A||i.originIsAbsolute,!1!==i.smooth,v)),m=i.xOrigin||0,g=i.yOrigin||0,v!==yn&&(x=v[0],w=v[1],E=v[2],S=v[3],n=T=v[4],r=M=v[5],6===v.length?(a=Math.sqrt(x*x+w*w),o=Math.sqrt(S*S+E*E),l=x||w?Li(w,x)*Ai:0,(d=E||S?Li(E,S)*Ai+l:0)&&(o*=Math.abs(Math.cos(d*Ci))),i.svg&&(n-=m-(m*x+g*E),r-=g-(m*w+g*S))):(N=v[6],I=v[7],P=v[8],R=v[9],O=v[10],D=v[11],n=v[12],r=v[13],s=v[14],c=(_=Li(N,O))*Ai,_&&(A=T*(y=Math.cos(-_))+P*(b=Math.sin(-_)),C=M*y+R*b,L=N*y+O*b,P=T*-b+P*y,R=M*-b+R*y,O=N*-b+O*y,D=I*-b+D*y,T=A,M=C,N=L),h=(_=Li(-E,O))*Ai,_&&(y=Math.cos(-_),D=S*(b=Math.sin(-_))+D*y,x=A=x*y-P*b,w=C=w*y-R*b,E=L=E*y-O*b),l=(_=Li(w,x))*Ai,_&&(A=x*(y=Math.cos(_))+w*(b=Math.sin(_)),C=T*y+M*b,w=w*y-x*b,M=M*y-T*b,x=A,T=C),c&&Math.abs(c)+Math.abs(l)>359.9&&(c=l=0,h=180-h),a=ce(Math.sqrt(x*x+w*w+E*E)),o=ce(Math.sqrt(M*M+N*N)),_=Li(T,M),d=Math.abs(_)>2e-4?_*Ai:0,p=D?1/(D<0?-D:D):0),i.svg&&(A=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!xn(Qi(e,Xi)),A&&e.setAttribute("transform",A))),Math.abs(d)>90&&Math.abs(d)<270&&(F?(a*=-1,d+=l<=0?180:-180,l+=l<=0?180:-180):(o*=-1,d+=d<=0?180:-180)),t=t||i.uncache,i.x=n-((i.xPercent=n&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-n)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+z,i.y=r-((i.yPercent=r&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-r)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+z,i.z=s+z,i.scaleX=ce(a),i.scaleY=ce(o),i.rotation=ce(l)+k,i.rotationX=ce(c)+k,i.rotationY=ce(h)+k,i.skewX=d+k,i.skewY=u+k,i.transformPerspective=p+z,(i.zOrigin=parseFloat(B.split(" ")[2])||0)&&(U[qi]=Mn(B)),i.xOffset=i.yOffset=0,i.force3D=f.force3D,i.renderTransform=i.svg?In:Ti?On:Cn,i.uncache=0,i},Mn=function(e){return(e=e.split(" "))[0]+" "+e[1]},An=function(e,t,i){var n=Xe(t);return ce(parseFloat(t)+parseFloat(un(e,"x",i+"px",n)))+n},Cn=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,On(e,t)},Ln="0deg",Pn="0px",Rn=") ",On=function(e,t){var i=t||this,n=i.xPercent,r=i.yPercent,s=i.x,a=i.y,o=i.z,l=i.rotation,c=i.rotationY,h=i.rotationX,d=i.skewX,u=i.skewY,p=i.scaleX,f=i.scaleY,m=i.transformPerspective,g=i.force3D,v=i.target,_=i.zOrigin,y="",b="auto"===g&&e&&1!==e||!0===g;if(_&&(h!==Ln||c!==Ln)){var x,w=parseFloat(c)*Ci,E=Math.sin(w),S=Math.cos(w);w=parseFloat(h)*Ci,x=Math.cos(w),s=An(v,s,E*x*-_),a=An(v,a,-Math.sin(w)*-_),o=An(v,o,S*x*-_+_)}m!==Pn&&(y+="perspective("+m+Rn),(n||r)&&(y+="translate("+n+"%, "+r+"%) "),(b||s!==Pn||a!==Pn||o!==Pn)&&(y+=o!==Pn||b?"translate3d("+s+", "+a+", "+o+") ":"translate("+s+", "+a+Rn),l!==Ln&&(y+="rotate("+l+Rn),c!==Ln&&(y+="rotateY("+c+Rn),h!==Ln&&(y+="rotateX("+h+Rn),d===Ln&&u===Ln||(y+="skew("+d+", "+u+Rn),1===p&&1===f||(y+="scale("+p+", "+f+Rn),v.style[Xi]=y||"translate(0, 0)"},In=function(e,t){var i,n,r,s,a,o=t||this,l=o.xPercent,c=o.yPercent,h=o.x,d=o.y,u=o.rotation,p=o.skewX,f=o.skewY,m=o.scaleX,g=o.scaleY,v=o.target,_=o.xOrigin,y=o.yOrigin,b=o.xOffset,x=o.yOffset,w=o.forceCSS,E=parseFloat(h),S=parseFloat(d);u=parseFloat(u),p=parseFloat(p),(f=parseFloat(f))&&(p+=f=parseFloat(f),u+=f),u||p?(u*=Ci,p*=Ci,i=Math.cos(u)*m,n=Math.sin(u)*m,r=Math.sin(u-p)*-g,s=Math.cos(u-p)*g,p&&(f*=Ci,a=Math.tan(p-f),r*=a=Math.sqrt(1+a*a),s*=a,f&&(a=Math.tan(f),i*=a=Math.sqrt(1+a*a),n*=a)),i=ce(i),n=ce(n),r=ce(r),s=ce(s)):(i=m,s=g,n=r=0),(E&&!~(h+"").indexOf("px")||S&&!~(d+"").indexOf("px"))&&(E=un(v,"x",h,"px"),S=un(v,"y",d,"px")),(_||y||b||x)&&(E=ce(E+_-(_*i+y*r)+b),S=ce(S+y-(_*n+y*s)+x)),(l||c)&&(a=v.getBBox(),E=ce(E+l/100*a.width),S=ce(S+c/100*a.height)),a="matrix("+i+","+n+","+r+","+s+","+E+","+S+")",v.setAttribute("transform",a),w&&(v.style[Xi]=a)},Dn=function(e,t,i,n,r){var s,a,o=360,l=S(r),c=parseFloat(r)*(l&&~r.indexOf("rad")?Ai:1)-n,h=n+c+"deg";return l&&("short"===(s=r.split("_")[1])&&(c%=o)!=c%180&&(c+=c<0?o:-360),"cw"===s&&c<0?c=(c+36e9)%o-~~(c/o)*o:"ccw"===s&&c>0&&(c=(c-36e9)%o-~~(c/o)*o)),e._pt=a=new si(e._pt,t,i,n,c,Ni),a.e=h,a.u="deg",e._props.push(i),a},Nn=function(e,t){for(var i in t)e[i]=t[i];return e},Un=function(e,t,i){var n,r,s,a,o,l,c,h=Nn({},i._gsap),d=i.style;for(r in h.svg?(s=i.getAttribute("transform"),i.setAttribute("transform",""),d[Xi]=t,n=Tn(i,1),ln(i,Xi),i.setAttribute("transform",s)):(s=getComputedStyle(i)[Xi],d[Xi]=t,n=Tn(i,1),d[Xi]=s),Mi)(s=h[r])!==(a=n[r])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(r)<0&&(o=Xe(s)!==(c=Xe(a))?un(i,r,s,c):parseFloat(s),l=parseFloat(a),e._pt=new si(e._pt,n,r,o,l-o,Di),e._pt.u=c||0,e._props.push(r));Nn(n,h)};le("padding,margin,Width,Radius",(function(e,t){var i="Top",n="Right",r="Bottom",s="Left",a=(t<3?[i,n,r,s]:[i+s,i+n,r+n,r+s]).map((function(i){return t<2?e+i:"border"+i+e}));_n[t>1?"border"+e:e]=function(e,t,i,n,r){var s,o;if(arguments.length<4)return s=a.map((function(t){return pn(e,t,i)})),5===(o=s.join(" ")).split(s[0]).length?s[0]:o;s=(n+"").split(" "),o={},a.forEach((function(e,t){return o[e]=s[t]=s[t]||s[(t-1)/2|0]})),e.init(t,o,r)}}));var Fn,zn,kn={name:"css",register:nn,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,n,r){var s,a,o,l,c,h,d,u,p,m,g,v,_,y,b,x,w=this._props,E=e.style,T=i.vars.startAt;for(d in xi||nn(),this.styles=this.styles||Ki(e),x=this.styles.props,this.tween=i,t)if("autoRound"!==d&&(a=t[d],!ee[d]||!kt(d,t,i,n,e,r)))if(c=typeof a,h=_n[d],"function"===c&&(c=typeof(a=a.call(i,n,e,r))),"string"===c&&~a.indexOf("random(")&&(a=nt(a)),h)h(this,e,d,a,i)&&(b=1);else if("--"===d.substr(0,2))s=(getComputedStyle(e).getPropertyValue(d)+"").trim(),a+="",gt.lastIndex=0,gt.test(s)||(u=Xe(s),p=Xe(a)),p?u!==p&&(s=un(e,d,s,p)+p):u&&(a+=u),this.add(E,"setProperty",s,a,n,r,0,0,d),w.push(d),x.push(d,0,E[d]);else if("undefined"!==c){if(T&&d in T?(s="function"==typeof T[d]?T[d].call(i,n,e,r):T[d],S(s)&&~s.indexOf("random(")&&(s=nt(s)),Xe(s+"")||(s+=f.units[d]||Xe(pn(e,d))||""),"="===(s+"").charAt(1)&&(s=pn(e,d))):s=pn(e,d),l=parseFloat(s),(m="string"===c&&"="===a.charAt(1)&&a.substr(0,2))&&(a=a.substr(2)),o=parseFloat(a),d in Ii&&("autoAlpha"===d&&(1===l&&"hidden"===pn(e,"visibility")&&o&&(l=0),x.push("visibility",0,E.visibility),cn(this,E,"visibility",l?"inherit":"hidden",o?"inherit":"hidden",!o)),"scale"!==d&&"transform"!==d&&~(d=Ii[d]).indexOf(",")&&(d=d.split(",")[0])),g=d in Mi)if(this.styles.save(d),v||((_=e._gsap).renderTransform&&!t.parseTransform||Tn(e,t.parseTransform),y=!1!==t.smoothOrigin&&_.smooth,(v=this._pt=new si(this._pt,E,Xi,0,1,_.renderTransform,_,0,-1)).dep=1),"scale"===d)this._pt=new si(this._pt,_,"scaleY",_.scaleY,(m?de(_.scaleY,m+o):o)-_.scaleY||0,Di),this._pt.u=0,w.push("scaleY",d),d+="X";else{if("transformOrigin"===d){x.push(qi,0,E[qi]),a=gn(a),_.svg?Sn(e,a,0,y,0,this):((p=parseFloat(a.split(" ")[2])||0)!==_.zOrigin&&cn(this,_,"zOrigin",_.zOrigin,p),cn(this,E,d,Mn(s),Mn(a)));continue}if("svgOrigin"===d){Sn(e,a,1,y,0,this);continue}if(d in bn){Dn(this,_,d,l,m?de(l,m+a):a);continue}if("smoothOrigin"===d){cn(this,_,"smooth",_.smooth,a);continue}if("force3D"===d){_[d]=a;continue}if("transform"===d){Un(this,a,e);continue}}else d in E||(d=tn(d)||d);if(g||(o||0===o)&&(l||0===l)&&!Oi.test(a)&&d in E)o||(o=0),(u=(s+"").substr((l+"").length))!==(p=Xe(a)||(d in f.units?f.units[d]:u))&&(l=un(e,d,s,p)),this._pt=new si(this._pt,g?_:E,d,l,(m?de(l,m+o):o)-l,g||"px"!==p&&"zIndex"!==d||!1===t.autoRound?Di:Fi),this._pt.u=p||0,u!==p&&"%"!==p&&(this._pt.b=s,this._pt.r=Ui);else if(d in E)fn.call(this,e,d,s,m?m+a:a);else if(d in e)this.add(e,d,s||e[d],m?m+a:a,n,r);else if("parseTransform"!==d){G(d,a);continue}g||(d in E?x.push(d,0,E[d]):x.push(d,1,s||e[d])),w.push(d)}b&&ri(this)},render:function(e,t){if(t.tween._time||!Si())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:pn,aliases:Ii,getSetter:function(e,t,i){var n=Ii[t];return n&&n.indexOf(",")<0&&(t=n),t in Mi&&t!==qi&&(e._gsap.x||pn(e,"x"))?i&&Ei===i?"scale"===t?ji:Vi:(Ei=i||{})&&("scale"===t?Gi:Wi):e.style&&!A(e.style[t])?Hi:~t.indexOf("-")?Bi:Zt(e,t)},core:{_removeProperty:ln,_getMatrix:En}};vi.utils.checkPrefix=tn,vi.core.getStyleSaver=Ki,zn=le("x,y,z,scale,scaleX,scaleY,xPercent,yPercent"+","+(Fn="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(e){Mi[e]=1})),le(Fn,(function(e){f.units[e]="deg",bn[e]=1})),Ii[zn[13]]="x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+Fn,le("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(e){var t=e.split(":");Ii[t[1]]=zn[t[0]]})),le("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(e){f.units[e]="px"})),vi.registerPlugin(kn);var Hn=vi.registerPlugin(kn)||vi;function Bn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Hn.core.Tween;var Vn,jn,Gn,Wn,Xn,qn,Yn,$n,Zn,Kn,Jn,Qn,er,tr=function(){return Vn||"undefined"!=typeof window&&(Vn=window.gsap)&&Vn.registerPlugin&&Vn},ir=1,nr=[],rr=[],sr=[],ar=Date.now,or=function(e,t){return t},lr=function(e,t){return~sr.indexOf(e)&&sr[sr.indexOf(e)+1][t]},cr=function(e){return!!~Kn.indexOf(e)},hr=function(e,t,i,n,r){return e.addEventListener(t,i,{passive:!n,capture:!!r})},dr=function(e,t,i,n){return e.removeEventListener(t,i,!!n)},ur="scrollLeft",pr="scrollTop",fr=function(){return Jn&&Jn.isPressed||rr.cache++},mr=function(e,t){var i=function i(n){if(n||0===n){ir&&(Gn.history.scrollRestoration="manual");var r=Jn&&Jn.isPressed;n=i.v=Math.round(n)||(Jn&&Jn.iOS?1:0),e(n),i.cacheID=rr.cache,r&&or("ss",n)}else(t||rr.cache!==i.cacheID||or("ref"))&&(i.cacheID=rr.cache,i.v=e());return i.v+i.offset};return i.offset=0,e&&i},gr={s:ur,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:mr((function(e){return arguments.length?Gn.scrollTo(e,vr.sc()):Gn.pageXOffset||Wn[ur]||Xn[ur]||qn[ur]||0}))},vr={s:pr,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:gr,sc:mr((function(e){return arguments.length?Gn.scrollTo(gr.sc(),e):Gn.pageYOffset||Wn[pr]||Xn[pr]||qn[pr]||0}))},_r=function(e){return Vn.utils.toArray(e)[0]||("string"==typeof e&&!1!==Vn.config().nullTargetWarn?console.warn("Element not found:",e):null)},yr=function(e,t){var i=t.s,n=t.sc;cr(e)&&(e=Wn.scrollingElement||Xn);var r=rr.indexOf(e),s=n===vr.sc?1:2;!~r&&(r=rr.push(e)-1),rr[r+s]||e.addEventListener("scroll",fr);var a=rr[r+s],o=a||(rr[r+s]=mr(lr(e,i),!0)||(cr(e)?n:mr((function(t){return arguments.length?e[i]=t:e[i]}))));return o.target=e,a||(o.smooth="smooth"===Vn.getProperty(e,"scrollBehavior")),o},br=function(e,t,i){var n=e,r=e,s=ar(),a=s,o=t||50,l=Math.max(500,3*o),c=function(e,t){var l=ar();t||l-s>o?(r=n,n=e,a=s,s=l):i?n+=e:n=r+(e-r)/(l-a)*(s-a)};return{update:c,reset:function(){r=n=i?0:n,a=s=0},getVelocity:function(e){var t=a,o=r,h=ar();return(e||0===e)&&e!==n&&c(e),s===a||h-a>l?0:(n+(i?o:-o))/((i?h:s)-t)*1e3}}},xr=function(e,t){return t&&!e._gsapAllow&&e.preventDefault(),e.changedTouches?e.changedTouches[0]:e},wr=function(e){var t=Math.max.apply(Math,e),i=Math.min.apply(Math,e);return Math.abs(t)>=Math.abs(i)?t:i},Er=function(){(Zn=Vn.core.globals().ScrollTrigger)&&Zn.core&&function(){var e=Zn.core,t=e.bridge||{},i=e._scrollers,n=e._proxies;i.push.apply(i,rr),n.push.apply(n,sr),rr=i,sr=n,or=function(e,i){return t[e](i)}}()},Sr=function(e){return(Vn=e||tr())&&"undefined"!=typeof document&&document.body&&(Gn=window,Wn=document,Xn=Wn.documentElement,qn=Wn.body,Kn=[Gn,Wn,Xn,qn],Vn.utils.clamp,er=Vn.core.context||function(){},$n="onpointerenter"in qn?"pointer":"mouse",Yn=Tr.isTouch=Gn.matchMedia&&Gn.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in Gn||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,Qn=Tr.eventTypes=("ontouchstart"in Xn?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in Xn?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout((function(){return ir=0}),500),Er(),jn=1),jn};gr.op=vr,rr.cache=0;var Tr=function(){function e(e){this.init(e)}var t,i;return e.prototype.init=function(e){jn||Sr(Vn)||console.warn("Please gsap.registerPlugin(Observer)"),Zn||Er();var t=e.tolerance,i=e.dragMinimum,n=e.type,r=e.target,s=e.lineHeight,a=e.debounce,o=e.preventDefault,l=e.onStop,c=e.onStopDelay,h=e.ignore,d=e.wheelSpeed,u=e.event,p=e.onDragStart,f=e.onDragEnd,m=e.onDrag,g=e.onPress,v=e.onRelease,_=e.onRight,y=e.onLeft,b=e.onUp,x=e.onDown,w=e.onChangeX,E=e.onChangeY,S=e.onChange,T=e.onToggleX,M=e.onToggleY,A=e.onHover,C=e.onHoverEnd,L=e.onMove,P=e.ignoreCheck,R=e.isNormalizer,O=e.onGestureStart,I=e.onGestureEnd,D=e.onWheel,N=e.onEnable,U=e.onDisable,F=e.onClick,z=e.scrollSpeed,k=e.capture,H=e.allowClicks,B=e.lockAxis,V=e.onLockAxis;this.target=r=_r(r)||Xn,this.vars=e,h&&(h=Vn.utils.toArray(h)),t=t||1e-9,i=i||0,d=d||1,z=z||1,n=n||"wheel,touch,pointer",a=!1!==a,s||(s=parseFloat(Gn.getComputedStyle(qn).lineHeight)||22);var j,G,W,X,q,Y,$,Z=this,K=0,J=0,Q=yr(r,gr),ee=yr(r,vr),te=Q(),ie=ee(),ne=~n.indexOf("touch")&&!~n.indexOf("pointer")&&"pointerdown"===Qn[0],re=cr(r),se=r.ownerDocument||Wn,ae=[0,0,0],oe=[0,0,0],le=0,ce=function(){return le=ar()},he=function(e,t){return(Z.event=e)&&h&&~h.indexOf(e.target)||t&&ne&&"touch"!==e.pointerType||P&&P(e,t)},de=function(){var e=Z.deltaX=wr(ae),i=Z.deltaY=wr(oe),n=Math.abs(e)>=t,r=Math.abs(i)>=t;S&&(n||r)&&S(Z,e,i,ae,oe),n&&(_&&Z.deltaX>0&&_(Z),y&&Z.deltaX<0&&y(Z),w&&w(Z),T&&Z.deltaX<0!=K<0&&T(Z),K=Z.deltaX,ae[0]=ae[1]=ae[2]=0),r&&(x&&Z.deltaY>0&&x(Z),b&&Z.deltaY<0&&b(Z),E&&E(Z),M&&Z.deltaY<0!=J<0&&M(Z),J=Z.deltaY,oe[0]=oe[1]=oe[2]=0),(X||W)&&(L&&L(Z),W&&(m(Z),W=!1),X=!1),Y&&!(Y=!1)&&V&&V(Z),q&&(D(Z),q=!1),j=0},ue=function(e,t,i){ae[i]+=e,oe[i]+=t,Z._vx.update(e),Z._vy.update(t),a?j||(j=requestAnimationFrame(de)):de()},pe=function(e,t){B&&!$&&(Z.axis=$=Math.abs(e)>Math.abs(t)?"x":"y",Y=!0),"y"!==$&&(ae[2]+=e,Z._vx.update(e,!0)),"x"!==$&&(oe[2]+=t,Z._vy.update(t,!0)),a?j||(j=requestAnimationFrame(de)):de()},fe=function(e){if(!he(e,1)){var t=(e=xr(e,o)).clientX,n=e.clientY,r=t-Z.x,s=n-Z.y,a=Z.isDragging;Z.x=t,Z.y=n,(a||Math.abs(Z.startX-t)>=i||Math.abs(Z.startY-n)>=i)&&(m&&(W=!0),a||(Z.isDragging=!0),pe(r,s),a||p&&p(Z))}},me=Z.onPress=function(e){he(e,1)||e&&e.button||(Z.axis=$=null,G.pause(),Z.isPressed=!0,e=xr(e),K=J=0,Z.startX=Z.x=e.clientX,Z.startY=Z.y=e.clientY,Z._vx.reset(),Z._vy.reset(),hr(R?r:se,Qn[1],fe,o,!0),Z.deltaX=Z.deltaY=0,g&&g(Z))},ge=Z.onRelease=function(e){if(!he(e,1)){dr(R?r:se,Qn[1],fe,!0);var t=!isNaN(Z.y-Z.startY),i=Z.isDragging&&(Math.abs(Z.x-Z.startX)>3||Math.abs(Z.y-Z.startY)>3),n=xr(e);!i&&t&&(Z._vx.reset(),Z._vy.reset(),o&&H&&Vn.delayedCall(.08,(function(){if(ar()-le>300&&!e.defaultPrevented)if(e.target.click)e.target.click();else if(se.createEvent){var t=se.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,Gn,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(t)}}))),Z.isDragging=Z.isGesturing=Z.isPressed=!1,l&&!R&&G.restart(!0),f&&i&&f(Z),v&&v(Z,i)}},ve=function(e){return e.touches&&e.touches.length>1&&(Z.isGesturing=!0)&&O(e,Z.isDragging)},_e=function(){return(Z.isGesturing=!1)||I(Z)},ye=function(e){if(!he(e)){var t=Q(),i=ee();ue((t-te)*z,(i-ie)*z,1),te=t,ie=i,l&&G.restart(!0)}},be=function(e){if(!he(e)){e=xr(e,o),D&&(q=!0);var t=(1===e.deltaMode?s:2===e.deltaMode?Gn.innerHeight:1)*d;ue(e.deltaX*t,e.deltaY*t,0),l&&!R&&G.restart(!0)}},xe=function(e){if(!he(e)){var t=e.clientX,i=e.clientY,n=t-Z.x,r=i-Z.y;Z.x=t,Z.y=i,X=!0,(n||r)&&pe(n,r)}},we=function(e){Z.event=e,A(Z)},Ee=function(e){Z.event=e,C(Z)},Se=function(e){return he(e)||xr(e,o)&&F(Z)};G=Z._dc=Vn.delayedCall(c||.25,(function(){Z._vx.reset(),Z._vy.reset(),G.pause(),l&&l(Z)})).pause(),Z.deltaX=Z.deltaY=0,Z._vx=br(0,50,!0),Z._vy=br(0,50,!0),Z.scrollX=Q,Z.scrollY=ee,Z.isDragging=Z.isGesturing=Z.isPressed=!1,er(this),Z.enable=function(e){return Z.isEnabled||(hr(re?se:r,"scroll",fr),n.indexOf("scroll")>=0&&hr(re?se:r,"scroll",ye,o,k),n.indexOf("wheel")>=0&&hr(r,"wheel",be,o,k),(n.indexOf("touch")>=0&&Yn||n.indexOf("pointer")>=0)&&(hr(r,Qn[0],me,o,k),hr(se,Qn[2],ge),hr(se,Qn[3],ge),H&&hr(r,"click",ce,!1,!0),F&&hr(r,"click",Se),O&&hr(se,"gesturestart",ve),I&&hr(se,"gestureend",_e),A&&hr(r,$n+"enter",we),C&&hr(r,$n+"leave",Ee),L&&hr(r,$n+"move",xe)),Z.isEnabled=!0,e&&e.type&&me(e),N&&N(Z)),Z},Z.disable=function(){Z.isEnabled&&(nr.filter((function(e){return e!==Z&&cr(e.target)})).length||dr(re?se:r,"scroll",fr),Z.isPressed&&(Z._vx.reset(),Z._vy.reset(),dr(R?r:se,Qn[1],fe,!0)),dr(re?se:r,"scroll",ye,k),dr(r,"wheel",be,k),dr(r,Qn[0],me,k),dr(se,Qn[2],ge),dr(se,Qn[3],ge),dr(r,"click",ce,!0),dr(r,"click",Se),dr(se,"gesturestart",ve),dr(se,"gestureend",_e),dr(r,$n+"enter",we),dr(r,$n+"leave",Ee),dr(r,$n+"move",xe),Z.isEnabled=Z.isPressed=Z.isDragging=!1,U&&U(Z))},Z.kill=Z.revert=function(){Z.disable();var e=nr.indexOf(Z);e>=0&&nr.splice(e,1),Jn===Z&&(Jn=0)},nr.push(Z),R&&cr(r)&&(Jn=Z),Z.enable(u)},t=e,(i=[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}])&&Bn(t.prototype,i),e}();Tr.version="3.11.5",Tr.create=function(e){return new Tr(e)},Tr.register=Sr,Tr.getAll=function(){return nr.slice()},Tr.getById=function(e){return nr.filter((function(t){return t.vars.id===e}))[0]},tr()&&Vn.registerPlugin(Tr);var Mr,Ar,Cr,Lr,Pr,Rr,Or,Ir,Dr,Nr,Ur,Fr,zr,kr,Hr,Br,Vr,jr,Gr,Wr,Xr,qr,Yr,$r,Zr,Kr,Jr,Qr,es,ts,is,ns,rs,ss,as=1,os=Date.now,ls=os(),cs=0,hs=0,ds=function e(){return hs&&requestAnimationFrame(e)},us=function(){return kr=1},ps=function(){return kr=0},fs=function(e){return e},ms=function(e){return Math.round(1e5*e)/1e5||0},gs=function(){return"undefined"!=typeof window},vs=function(){return Mr||gs()&&(Mr=window.gsap)&&Mr.registerPlugin&&Mr},_s=function(e){return!!~Or.indexOf(e)},ys=function(e){return lr(e,"getBoundingClientRect")||(_s(e)?function(){return Pa.width=Cr.innerWidth,Pa.height=Cr.innerHeight,Pa}:function(){return Ws(e)})},bs=function(e,t){var i=t.s,n=t.d2,r=t.d,s=t.a;return Math.max(0,(i="scroll"+n)&&(s=lr(e,i))?s()-ys(e)()[r]:_s(e)?(Pr[i]||Rr[i])-(Cr["inner"+n]||Pr["client"+n]||Rr["client"+n]):e[i]-e["offset"+n])},xs=function(e,t){for(var i=0;i<Gr.length;i+=3)(!t||~t.indexOf(Gr[i+1]))&&e(Gr[i],Gr[i+1],Gr[i+2])},ws=function(e){return"string"==typeof e},Es=function(e){return"function"==typeof e},Ss=function(e){return"number"==typeof e},Ts=function(e){return"object"==typeof e},Ms=function(e,t,i){return e&&e.progress(t?0:1)&&i&&e.pause()},As=function(e,t){if(e.enabled){var i=t(e);i&&i.totalTime&&(e.callbackAnimation=i)}},Cs=Math.abs,Ls="left",Ps="right",Rs="bottom",Os="width",Is="height",Ds="Right",Ns="Left",Us="Top",Fs="Bottom",zs="padding",ks="margin",Hs="Width",Bs="Height",Vs="px",js=function(e){return Cr.getComputedStyle(e)},Gs=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},Ws=function(e,t){var i=t&&"matrix(1, 0, 0, 1, 0, 0)"!==js(e)[Hr]&&Mr.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),n=e.getBoundingClientRect();return i&&i.progress(0).kill(),n},Xs=function(e,t){var i=t.d2;return e["offset"+i]||e["client"+i]||0},qs=function(e){var t,i=[],n=e.labels,r=e.duration();for(t in n)i.push(n[t]/r);return i},Ys=function(e){var t=Mr.utils.snap(e),i=Array.isArray(e)&&e.slice(0).sort((function(e,t){return e-t}));return i?function(e,n,r){var s;if(void 0===r&&(r=.001),!n)return t(e);if(n>0){for(e-=r,s=0;s<i.length;s++)if(i[s]>=e)return i[s];return i[s-1]}for(s=i.length,e+=r;s--;)if(i[s]<=e)return i[s];return i[0]}:function(i,n,r){void 0===r&&(r=.001);var s=t(i);return!n||Math.abs(s-i)<r||s-i<0==n<0?s:t(n<0?i-e:i+e)}},$s=function(e,t,i,n){return i.split(",").forEach((function(i){return e(t,i,n)}))},Zs=function(e,t,i,n,r){return e.addEventListener(t,i,{passive:!n,capture:!!r})},Ks=function(e,t,i,n){return e.removeEventListener(t,i,!!n)},Js=function(e,t,i){(i=i&&i.wheelHandler)&&(e(t,"wheel",i),e(t,"touchmove",i))},Qs={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},ea={toggleActions:"play",anticipatePin:0},ta={top:0,left:0,center:.5,bottom:1,right:1},ia=function(e,t){if(ws(e)){var i=e.indexOf("="),n=~i?+(e.charAt(i-1)+1)*parseFloat(e.substr(i+1)):0;~i&&(e.indexOf("%")>i&&(n*=t/100),e=e.substr(0,i-1)),e=n+(e in ta?ta[e]*t:~e.indexOf("%")?parseFloat(e)*t/100:parseFloat(e)||0)}return e},na=function(e,t,i,n,r,s,a,o){var l=r.startColor,c=r.endColor,h=r.fontSize,d=r.indent,u=r.fontWeight,p=Lr.createElement("div"),f=_s(i)||"fixed"===lr(i,"pinType"),m=-1!==e.indexOf("scroller"),g=f?Rr:i,v=-1!==e.indexOf("start"),_=v?l:c,y="border-color:"+_+";font-size:"+h+";color:"+_+";font-weight:"+u+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return y+="position:"+((m||o)&&f?"fixed;":"absolute;"),(m||o||!f)&&(y+=(n===vr?Ps:Rs)+":"+(s+parseFloat(d))+"px;"),a&&(y+="box-sizing:border-box;text-align:left;width:"+a.offsetWidth+"px;"),p._isStart=v,p.setAttribute("class","gsap-marker-"+e+(t?" marker-"+t:"")),p.style.cssText=y,p.innerText=t||0===t?e+"-"+t:e,g.children[0]?g.insertBefore(p,g.children[0]):g.appendChild(p),p._offset=p["offset"+n.op.d2],ra(p,0,n,v),p},ra=function(e,t,i,n){var r={display:"block"},s=i[n?"os2":"p2"],a=i[n?"p2":"os2"];e._isFlipped=n,r[i.a+"Percent"]=n?-100:0,r[i.a]=n?"1px":0,r["border"+s+Hs]=1,r["border"+a+Hs]=0,r[i.p]=t+"px",Mr.set(e,r)},sa=[],aa={},oa=function(){return os()-cs>34&&(is||(is=requestAnimationFrame(Ea)))},la=function(){(!Yr||!Yr.isPressed||Yr.startX>Rr.clientWidth)&&(rr.cache++,Yr?is||(is=requestAnimationFrame(Ea)):Ea(),cs||fa("scrollStart"),cs=os())},ca=function(){Kr=Cr.innerWidth,Zr=Cr.innerHeight},ha=function(){rr.cache++,!zr&&!qr&&!Lr.fullscreenElement&&!Lr.webkitFullscreenElement&&(!$r||Kr!==Cr.innerWidth||Math.abs(Cr.innerHeight-Zr)>.25*Cr.innerHeight)&&Ir.restart(!0)},da={},ua=[],pa=function e(){return Ks(Ua,"scrollEnd",e)||ba(!0)},fa=function(e){return da[e]&&da[e].map((function(e){return e()}))||ua},ma=[],ga=function(e){for(var t=0;t<ma.length;t+=5)(!e||ma[t+4]&&ma[t+4].query===e)&&(ma[t].style.cssText=ma[t+1],ma[t].getBBox&&ma[t].setAttribute("transform",ma[t+2]||""),ma[t+3].uncache=1)},va=function(e,t){var i;for(Br=0;Br<sa.length;Br++)!(i=sa[Br])||t&&i._ctx!==t||(e?i.kill(1):i.revert(!0,!0));t&&ga(t),t||fa("revert")},_a=function(e,t){rr.cache++,(t||!ns)&&rr.forEach((function(e){return Es(e)&&e.cacheID++&&(e.rec=0)})),ws(e)&&(Cr.history.scrollRestoration=es=e)},ya=0,ba=function(e,t){if(!cs||e){ns=Ua.isRefreshing=!0,rr.forEach((function(e){return Es(e)&&e.cacheID++&&(e.rec=e())}));var i=fa("refreshInit");Wr&&Ua.sort(),t||va(),rr.forEach((function(e){Es(e)&&(e.smooth&&(e.target.style.scrollBehavior="auto"),e(0))})),sa.slice(0).forEach((function(e){return e.refresh()})),sa.forEach((function(e,t){if(e._subPinOffset&&e.pin){var i=e.vars.horizontal?"offsetWidth":"offsetHeight",n=e.pin[i];e.revert(!0,1),e.adjustPinSpacing(e.pin[i]-n),e.refresh()}})),sa.forEach((function(e){return"max"===e.vars.end&&e.setPositions(e.start,Math.max(e.start+1,bs(e.scroller,e._dir)))})),i.forEach((function(e){return e&&e.render&&e.render(-1)})),rr.forEach((function(e){Es(e)&&(e.smooth&&requestAnimationFrame((function(){return e.target.style.scrollBehavior="smooth"})),e.rec&&e(e.rec))})),_a(es,1),Ir.pause(),ya++,ns=2,Ea(2),sa.forEach((function(e){return Es(e.vars.onRefresh)&&e.vars.onRefresh(e)})),ns=Ua.isRefreshing=!1,fa("refresh")}else Zs(Ua,"scrollEnd",pa)},xa=0,wa=1,Ea=function(e){if(!ns||2===e){Ua.isUpdating=!0,ss&&ss.update(0);var t=sa.length,i=os(),n=i-ls>=50,r=t&&sa[0].scroll();if(wa=xa>r?-1:1,ns||(xa=r),n&&(cs&&!kr&&i-cs>200&&(cs=0,fa("scrollEnd")),Ur=ls,ls=i),wa<0){for(Br=t;Br-- >0;)sa[Br]&&sa[Br].update(0,n);wa=1}else for(Br=0;Br<t;Br++)sa[Br]&&sa[Br].update(0,n);Ua.isUpdating=!1}is=0},Sa=[Ls,"top",Rs,Ps,ks+Fs,ks+Ds,ks+Us,ks+Ns,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],Ta=Sa.concat([Os,Is,"boxSizing","max"+Hs,"max"+Bs,"position",ks,zs,zs+Us,zs+Ds,zs+Fs,zs+Ns]),Ma=function(e,t,i,n){if(!e._gsap.swappedIn){for(var r,s=Sa.length,a=t.style,o=e.style;s--;)a[r=Sa[s]]=i[r];a.position="absolute"===i.position?"absolute":"relative","inline"===i.display&&(a.display="inline-block"),o[Rs]=o[Ps]="auto",a.flexBasis=i.flexBasis||"auto",a.overflow="visible",a.boxSizing="border-box",a[Os]=Xs(e,gr)+Vs,a[Is]=Xs(e,vr)+Vs,a[zs]=o[ks]=o.top=o[Ls]="0",Ca(n),o[Os]=o["max"+Hs]=i[Os],o[Is]=o["max"+Bs]=i[Is],o[zs]=i[zs],e.parentNode!==t&&(e.parentNode.insertBefore(t,e),t.appendChild(e)),e._gsap.swappedIn=!0}},Aa=/([A-Z])/g,Ca=function(e){if(e){var t,i,n=e.t.style,r=e.length,s=0;for((e.t._gsap||Mr.core.getCache(e.t)).uncache=1;s<r;s+=2)i=e[s+1],t=e[s],i?n[t]=i:n[t]&&n.removeProperty(t.replace(Aa,"-$1").toLowerCase())}},La=function(e){for(var t=Ta.length,i=e.style,n=[],r=0;r<t;r++)n.push(Ta[r],i[Ta[r]]);return n.t=e,n},Pa={left:0,top:0},Ra=function(e,t,i,n,r,s,a,o,l,c,h,d,u){Es(e)&&(e=e(o)),ws(e)&&"max"===e.substr(0,3)&&(e=d+("="===e.charAt(4)?ia("0"+e.substr(3),i):0));var p,f,m,g=u?u.time():0;if(u&&u.seek(0),Ss(e))u&&(e=Mr.utils.mapRange(u.scrollTrigger.start,u.scrollTrigger.end,0,d,e)),a&&ra(a,i,n,!0);else{Es(t)&&(t=t(o));var v,_,y,b,x=(e||"0").split(" ");m=_r(t)||Rr,(v=Ws(m)||{})&&(v.left||v.top)||"none"!==js(m).display||(b=m.style.display,m.style.display="block",v=Ws(m),b?m.style.display=b:m.style.removeProperty("display")),_=ia(x[0],v[n.d]),y=ia(x[1]||"0",i),e=v[n.p]-l[n.p]-c+_+r-y,a&&ra(a,y,n,i-y<20||a._isStart&&y>20),i-=i-y}if(s){var w=e+i,E=s._isStart;p="scroll"+n.d2,ra(s,w,n,E&&w>20||!E&&(h?Math.max(Rr[p],Pr[p]):s.parentNode[p])<=w+1),h&&(l=Ws(a),h&&(s.style[n.op.p]=l[n.op.p]-n.op.m-s._offset+Vs))}return u&&m&&(p=Ws(m),u.seek(d),f=Ws(m),u._caScrollDist=p[n.p]-f[n.p],e=e/u._caScrollDist*d),u&&u.seek(g),u?e:Math.round(e)},Oa=/(webkit|moz|length|cssText|inset)/i,Ia=function(e,t,i,n){if(e.parentNode!==t){var r,s,a=e.style;if(t===Rr){for(r in e._stOrig=a.cssText,s=js(e))+r||Oa.test(r)||!s[r]||"string"!=typeof a[r]||"0"===r||(a[r]=s[r]);a.top=i,a.left=n}else a.cssText=e._stOrig;Mr.core.getCache(e).uncache=1,t.appendChild(e)}},Da=function(e,t,i){var n=t,r=n;return function(t){var s=Math.round(e());return s!==n&&s!==r&&Math.abs(s-n)>3&&Math.abs(s-r)>3&&(t=s,i&&i()),r=n,n=t,t}},Na=function(e,t){var i=yr(e,t),n="_scroll"+t.p2,r=function t(r,s,a,o,l){var c=t.tween,h=s.onComplete,d={};a=a||i();var u=Da(i,a,(function(){c.kill(),t.tween=0}));return l=o&&l||0,o=o||r-a,c&&c.kill(),Math.round(a),s[n]=r,s.modifiers=d,d[n]=function(){return u(a+o*c.ratio+l*c.ratio*c.ratio)},s.onUpdate=function(){rr.cache++,Ea()},s.onComplete=function(){t.tween=0,h&&h.call(c)},c=t.tween=Mr.to(e,s)};return e[n]=i,i.wheelHandler=function(){return r.tween&&r.tween.kill()&&(r.tween=0)},Zs(e,"wheel",i.wheelHandler),Ua.isTouch&&Zs(e,"touchmove",i.wheelHandler),r},Ua=function(){function e(t,i){Ar||e.register(Mr)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),this.init(t,i)}return e.prototype.init=function(t,i){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),hs){var n,r,s,a,o,l,c,h,d,u,p,f,m,g,v,_,y,b,x,w,E,S,T,M,A,C,L,P,R,O,I,D,N,U,F,z,k,H,B,V,j,G,W=t=Gs(ws(t)||Ss(t)||t.nodeType?{trigger:t}:t,ea),X=W.onUpdate,q=W.toggleClass,Y=W.id,$=W.onToggle,Z=W.onRefresh,K=W.scrub,J=W.trigger,Q=W.pin,ee=W.pinSpacing,te=W.invalidateOnRefresh,ie=W.anticipatePin,ne=W.onScrubComplete,re=W.onSnapComplete,se=W.once,ae=W.snap,oe=W.pinReparent,le=W.pinSpacer,ce=W.containerAnimation,he=W.fastScrollEnd,de=W.preventOverlaps,ue=t.horizontal||t.containerAnimation&&!1!==t.horizontal?gr:vr,pe=!K&&0!==K,fe=_r(t.scroller||Cr),me=Mr.core.getCache(fe),ge=_s(fe),ve="fixed"===("pinType"in t?t.pinType:lr(fe,"pinType")||ge&&"fixed"),_e=[t.onEnter,t.onLeave,t.onEnterBack,t.onLeaveBack],ye=pe&&t.toggleActions.split(" "),be="markers"in t?t.markers:ea.markers,xe=ge?0:parseFloat(js(fe)["border"+ue.p2+Hs])||0,we=this,Ee=t.onRefreshInit&&function(){return t.onRefreshInit(we)},Se=function(e,t,i){var n=i.d,r=i.d2,s=i.a;return(s=lr(e,"getBoundingClientRect"))?function(){return s()[n]}:function(){return(t?Cr["inner"+r]:e["client"+r])||0}}(fe,ge,ue),Te=function(e,t){return!t||~sr.indexOf(e)?ys(e):function(){return Pa}}(fe,ge),Me=0,Ae=0,Ce=yr(fe,ue);if(Qr(we),we._dir=ue,ie*=45,we.scroller=fe,we.scroll=ce?ce.time.bind(ce):Ce,a=Ce(),we.vars=t,i=i||t.animation,"refreshPriority"in t&&(Wr=1,-9999===t.refreshPriority&&(ss=we)),me.tweenScroll=me.tweenScroll||{top:Na(fe,vr),left:Na(fe,gr)},we.tweenTo=n=me.tweenScroll[ue.p],we.scrubDuration=function(e){(D=Ss(e)&&e)?I?I.duration(e):I=Mr.to(i,{ease:"expo",totalProgress:"+=0.001",duration:D,paused:!0,onComplete:function(){return ne&&ne(we)}}):(I&&I.progress(1).kill(),I=0)},i&&(i.vars.lazy=!1,i._initted||!1!==i.vars.immediateRender&&!1!==t.immediateRender&&i.duration()&&i.render(0,!0,!0),we.animation=i.pause(),i.scrollTrigger=we,we.scrubDuration(K),I&&I.resetTo&&I.resetTo("totalProgress",0),R=0,Y||(Y=i.vars.id)),sa.push(we),ae&&(Ts(ae)&&!ae.push||(ae={snapTo:ae}),"scrollBehavior"in Rr.style&&Mr.set(ge?[Rr,Pr]:fe,{scrollBehavior:"auto"}),rr.forEach((function(e){return Es(e)&&e.target===(ge?Lr.scrollingElement||Pr:fe)&&(e.smooth=!1)})),s=Es(ae.snapTo)?ae.snapTo:"labels"===ae.snapTo?function(e){return function(t){return Mr.utils.snap(qs(e),t)}}(i):"labelsDirectional"===ae.snapTo?(V=i,function(e,t){return Ys(qs(V))(e,t.direction)}):!1!==ae.directional?function(e,t){return Ys(ae.snapTo)(e,os()-Ae<500?0:t.direction)}:Mr.utils.snap(ae.snapTo),N=ae.duration||{min:.1,max:2},N=Ts(N)?Nr(N.min,N.max):Nr(N,N),U=Mr.delayedCall(ae.delay||D/2||.1,(function(){var e=Ce(),t=os()-Ae<500,r=n.tween;if(!(t||Math.abs(we.getVelocity())<10)||r||kr||Me===e)we.isActive&&Me!==e&&U.restart(!0);else{var a=(e-l)/m,o=i&&!pe?i.totalProgress():a,h=t?0:(o-O)/(os()-Ur)*1e3||0,d=Mr.utils.clamp(-a,1-a,Cs(h/2)*h/.185),u=a+(!1===ae.inertia?0:d),p=Nr(0,1,s(u,we)),f=Math.round(l+p*m),g=ae,v=g.onStart,_=g.onInterrupt,y=g.onComplete;if(e<=c&&e>=l&&f!==e){if(r&&!r._initted&&r.data<=Cs(f-e))return;!1===ae.inertia&&(d=p-a),n(f,{duration:N(Cs(.185*Math.max(Cs(u-o),Cs(p-o))/h/.05||0)),ease:ae.ease||"power3",data:Cs(f-e),onInterrupt:function(){return U.restart(!0)&&_&&_(we)},onComplete:function(){we.update(),Me=Ce(),R=O=i&&!pe?i.totalProgress():we.progress,re&&re(we),y&&y(we)}},e,d*m,f-e-d*m),v&&v(we,n.tween)}}})).pause()),Y&&(aa[Y]=we),(B=(J=we.trigger=_r(J||Q))&&J._gsap&&J._gsap.stRevert)&&(B=B(we)),Q=!0===Q?J:_r(Q),ws(q)&&(q={targets:J,className:q}),Q&&(!1===ee||ee===ks||(ee=!(!ee&&Q.parentNode&&Q.parentNode.style&&"flex"===js(Q.parentNode).display)&&zs),we.pin=Q,(r=Mr.core.getCache(Q)).spacer?g=r.pinState:(le&&((le=_r(le))&&!le.nodeType&&(le=le.current||le.nativeElement),r.spacerIsNative=!!le,le&&(r.spacerState=La(le))),r.spacer=y=le||Lr.createElement("div"),y.classList.add("pin-spacer"),Y&&y.classList.add("pin-spacer-"+Y),r.pinState=g=La(Q)),!1!==t.force3D&&Mr.set(Q,{force3D:!0}),we.spacer=y=r.spacer,P=js(Q),T=P[ee+ue.os2],x=Mr.getProperty(Q),w=Mr.quickSetter(Q,ue.a,Vs),Ma(Q,y,P),_=La(Q)),be){f=Ts(be)?Gs(be,Qs):Qs,u=na("scroller-start",Y,fe,ue,f,0),p=na("scroller-end",Y,fe,ue,f,0,u),b=u["offset"+ue.op.d2];var Le=_r(lr(fe,"content")||fe);h=this.markerStart=na("start",Y,Le,ue,f,b,0,ce),d=this.markerEnd=na("end",Y,Le,ue,f,b,0,ce),ce&&(H=Mr.quickSetter([h,d],ue.a,Vs)),ve||sr.length&&!0===lr(fe,"fixedMarkers")||(G=js(j=ge?Rr:fe).position,j.style.position="absolute"===G||"fixed"===G?G:"relative",Mr.set([u,p],{force3D:!0}),A=Mr.quickSetter(u,ue.a,Vs),L=Mr.quickSetter(p,ue.a,Vs))}if(ce){var Pe=ce.vars.onUpdate,Re=ce.vars.onUpdateParams;ce.eventCallback("onUpdate",(function(){we.update(0,0,1),Pe&&Pe.apply(ce,Re||[])}))}we.previous=function(){return sa[sa.indexOf(we)-1]},we.next=function(){return sa[sa.indexOf(we)+1]},we.revert=function(e,t){if(!t)return we.kill(!0);var n=!1!==e||!we.enabled,r=zr;n!==we.isReverted&&(n&&(z=Math.max(Ce(),we.scroll.rec||0),F=we.progress,k=i&&i.progress()),h&&[h,d,u,p].forEach((function(e){return e.style.display=n?"none":"block"})),n&&(zr=we,we.update(n)),!Q||oe&&we.isActive||(n?function(e,t,i){Ca(i);var n=e._gsap;if(n.spacerIsNative)Ca(n.spacerState);else if(e._gsap.swappedIn){var r=t.parentNode;r&&(r.insertBefore(e,t),r.removeChild(t))}e._gsap.swappedIn=!1}(Q,y,g):Ma(Q,y,js(Q),M)),n||we.update(n),zr=r,we.isReverted=n)},we.refresh=function(r,s){if(!zr&&we.enabled||s)if(Q&&r&&cs)Zs(e,"scrollEnd",pa);else{!ns&&Ee&&Ee(we),zr=we,Ae=os(),n.tween&&(n.tween.kill(),n.tween=0),I&&I.pause(),te&&i&&i.revert({kill:!1}).invalidate(),we.isReverted||we.revert(!0,!0),we._subPinOffset=!1;for(var f,b,w,T,A,L,P,R,O,D,N,H=Se(),B=Te(),V=ce?ce.duration():bs(fe,ue),j=m<=.01,G=0,W=0,X=t.end,q=t.endTrigger||J,Y=t.start||(0!==t.start&&J?Q?"0 0":"0 100%":0),$=we.pinnedContainer=t.pinnedContainer&&_r(t.pinnedContainer),K=J&&Math.max(0,sa.indexOf(we))||0,ie=K;ie--;)(L=sa[ie]).end||L.refresh(0,1)||(zr=we),!(P=L.pin)||P!==J&&P!==Q&&P!==$||L.isReverted||(D||(D=[]),D.unshift(L),L.revert(!0,!0)),L!==sa[ie]&&(K--,ie--);for(Es(Y)&&(Y=Y(we)),l=Ra(Y,J,H,ue,Ce(),h,u,we,B,xe,ve,V,ce)||(Q?-.001:0),Es(X)&&(X=X(we)),ws(X)&&!X.indexOf("+=")&&(~X.indexOf(" ")?X=(ws(Y)?Y.split(" ")[0]:"")+X:(G=ia(X.substr(2),H),X=ws(Y)?Y:(ce?Mr.utils.mapRange(0,ce.duration(),ce.scrollTrigger.start,ce.scrollTrigger.end,l):l)+G,q=J)),c=Math.max(l,Ra(X||(q?"100% 0":V),q,H,ue,Ce()+G,d,p,we,B,xe,ve,V,ce))||-.001,m=c-l||(l-=.01)&&.001,G=0,ie=K;ie--;)(P=(L=sa[ie]).pin)&&L.start-L._pinPush<=l&&!ce&&L.end>0&&(f=L.end-L.start,(P===J&&L.start-L._pinPush<l||P===$)&&!Ss(Y)&&(G+=f*(1-L.progress)),P===Q&&(W+=f));if(l+=G,c+=G,j&&(F=Mr.utils.clamp(0,1,Mr.utils.normalize(l,c,z))),we._pinPush=W,h&&G&&((f={})[ue.a]="+="+G,$&&(f[ue.p]="-="+Ce()),Mr.set([h,d],f)),Q)f=js(Q),T=ue===vr,w=Ce(),E=parseFloat(x(ue.a))+W,!V&&c>1&&((N={style:N=(ge?Lr.scrollingElement||Pr:fe).style,value:N["overflow"+ue.a.toUpperCase()]}).style["overflow"+ue.a.toUpperCase()]="scroll"),Ma(Q,y,f),_=La(Q),b=Ws(Q,!0),R=ve&&yr(fe,T?gr:vr)(),ee&&((M=[ee+ue.os2,m+W+Vs]).t=y,(ie=ee===zs?Xs(Q,ue)+m+W:0)&&M.push(ue.d,ie+Vs),Ca(M),$&&sa.forEach((function(e){e.pin===$&&!1!==e.vars.pinSpacing&&(e._subPinOffset=!0)})),ve&&Ce(z)),ve&&((A={top:b.top+(T?w-l:R)+Vs,left:b.left+(T?R:w-l)+Vs,boxSizing:"border-box",position:"fixed"})[Os]=A["max"+Hs]=Math.ceil(b.width)+Vs,A[Is]=A["max"+Bs]=Math.ceil(b.height)+Vs,A[ks]=A[ks+Us]=A[ks+Ds]=A[ks+Fs]=A[ks+Ns]="0",A[zs]=f[zs],A[zs+Us]=f[zs+Us],A[zs+Ds]=f[zs+Ds],A[zs+Fs]=f[zs+Fs],A[zs+Ns]=f[zs+Ns],v=function(e,t,i){for(var n,r=[],s=e.length,a=i?8:0;a<s;a+=2)n=e[a],r.push(n,n in t?t[n]:e[a+1]);return r.t=e.t,r}(g,A,oe),ns&&Ce(0)),i?(O=i._initted,Xr(1),i.render(i.duration(),!0,!0),S=x(ue.a)-E+m+W,C=Math.abs(m-S)>1,ve&&C&&v.splice(v.length-2,2),i.render(0,!0,!0),O||i.invalidate(!0),i.parent||i.totalTime(i.totalTime()),Xr(0)):S=m,N&&(N.value?N.style["overflow"+ue.a.toUpperCase()]=N.value:N.style.removeProperty("overflow-"+ue.a));else if(J&&Ce()&&!ce)for(b=J.parentNode;b&&b!==Rr;)b._pinOffset&&(l-=b._pinOffset,c-=b._pinOffset),b=b.parentNode;D&&D.forEach((function(e){return e.revert(!1,!0)})),we.start=l,we.end=c,a=o=ns?z:Ce(),ce||ns||(a<z&&Ce(z),we.scroll.rec=0),we.revert(!1,!0),U&&(Me=-1,we.isActive&&Ce(l+m*F),U.restart(!0)),zr=0,i&&pe&&(i._initted||k)&&i.progress()!==k&&i.progress(k,!0).render(i.time(),!0,!0),(j||F!==we.progress||ce)&&(i&&!pe&&i.totalProgress(ce&&l<-.001&&!F?Mr.utils.normalize(l,c,0):F,!0),we.progress=(a-l)/m===F?0:F),Q&&ee&&(y._pinOffset=Math.round(we.progress*S)),I&&I.invalidate(),Z&&!ns&&Z(we)}},we.getVelocity=function(){return(Ce()-o)/(os()-Ur)*1e3||0},we.endAnimation=function(){Ms(we.callbackAnimation),i&&(I?I.progress(1):i.paused()?pe||Ms(i,we.direction<0,1):Ms(i,i.reversed()))},we.labelToScroll=function(e){return i&&i.labels&&(l||we.refresh()||l)+i.labels[e]/i.duration()*m||0},we.getTrailing=function(e){var t=sa.indexOf(we),i=we.direction>0?sa.slice(0,t).reverse():sa.slice(t+1);return(ws(e)?i.filter((function(t){return t.vars.preventOverlaps===e})):i).filter((function(e){return we.direction>0?e.end<=l:e.start>=c}))},we.update=function(e,t,r){if(!ce||r||e){var s,h,d,p,f,g,b,x=!0===ns?z:we.scroll(),M=e?0:(x-l)/m,P=M<0?0:M>1?1:M||0,D=we.progress;if(t&&(o=a,a=ce?Ce():x,ae&&(O=R,R=i&&!pe?i.totalProgress():P)),ie&&!P&&Q&&!zr&&!as&&cs&&l<x+(x-o)/(os()-Ur)*ie&&(P=1e-4),P!==D&&we.enabled){if(p=(f=(s=we.isActive=!!P&&P<1)!=(!!D&&D<1))||!!P!=!!D,we.direction=P>D?1:-1,we.progress=P,p&&!zr&&(h=P&&!D?0:1===P?1:1===D?2:3,pe&&(d=!f&&"none"!==ye[h+1]&&ye[h+1]||ye[h],b=i&&("complete"===d||"reset"===d||d in i))),de&&(f||b)&&(b||K||!i)&&(Es(de)?de(we):we.getTrailing(de).forEach((function(e){return e.endAnimation()}))),pe||(!I||zr||as?i&&i.totalProgress(P,!!zr):(I._dp._time-I._start!==I._time&&I.render(I._dp._time-I._start),I.resetTo?I.resetTo("totalProgress",P,i._tTime/i._tDur):(I.vars.totalProgress=P,I.invalidate().restart()))),Q)if(e&&ee&&(y.style[ee+ue.os2]=T),ve){if(p){if(g=!e&&P>D&&c+1>x&&x+1>=bs(fe,ue),oe)if(e||!s&&!g)Ia(Q,y);else{var N=Ws(Q,!0),F=x-l;Ia(Q,Rr,N.top+(ue===vr?F:0)+Vs,N.left+(ue===vr?0:F)+Vs)}Ca(s||g?v:_),C&&P<1&&s||w(E+(1!==P||g?0:S))}}else w(ms(E+S*P));ae&&!n.tween&&!zr&&!as&&U.restart(!0),q&&(f||se&&P&&(P<1||!ts))&&Dr(q.targets).forEach((function(e){return e.classList[s||se?"add":"remove"](q.className)})),X&&!pe&&!e&&X(we),p&&!zr?(pe&&(b&&("complete"===d?i.pause().totalProgress(1):"reset"===d?i.restart(!0).pause():"restart"===d?i.restart(!0):i[d]()),X&&X(we)),!f&&ts||($&&f&&As(we,$),_e[h]&&As(we,_e[h]),se&&(1===P?we.kill(!1,1):_e[h]=0),f||_e[h=1===P?1:3]&&As(we,_e[h])),he&&!s&&Math.abs(we.getVelocity())>(Ss(he)?he:2500)&&(Ms(we.callbackAnimation),I?I.progress(1):Ms(i,"reverse"===d?1:!P,1))):pe&&X&&!zr&&X(we)}if(L){var k=ce?x/ce.duration()*(ce._caScrollDist||0):x;A(k+(u._isFlipped?1:0)),L(k)}H&&H(-x/ce.duration()*(ce._caScrollDist||0))}},we.enable=function(t,i){we.enabled||(we.enabled=!0,Zs(fe,"resize",ha),Zs(ge?Lr:fe,"scroll",la),Ee&&Zs(e,"refreshInit",Ee),!1!==t&&(we.progress=F=0,a=o=Me=Ce()),!1!==i&&we.refresh())},we.getTween=function(e){return e&&n?n.tween:I},we.setPositions=function(e,t){Q&&(E+=e-l,S+=t-e-m,ee===zs&&we.adjustPinSpacing(t-e-m)),we.start=l=e,we.end=c=t,m=t-e,we.update()},we.adjustPinSpacing=function(e){if(M&&e){var t=M.indexOf(ue.d)+1;M[t]=parseFloat(M[t])+e+Vs,M[1]=parseFloat(M[1])+e+Vs,Ca(M)}},we.disable=function(t,i){if(we.enabled&&(!1!==t&&we.revert(!0,!0),we.enabled=we.isActive=!1,i||I&&I.pause(),z=0,r&&(r.uncache=1),Ee&&Ks(e,"refreshInit",Ee),U&&(U.pause(),n.tween&&n.tween.kill()&&(n.tween=0)),!ge)){for(var s=sa.length;s--;)if(sa[s].scroller===fe&&sa[s]!==we)return;Ks(fe,"resize",ha),Ks(fe,"scroll",la)}},we.kill=function(e,n){we.disable(e,n),I&&!n&&I.kill(),Y&&delete aa[Y];var s=sa.indexOf(we);s>=0&&sa.splice(s,1),s===Br&&wa>0&&Br--,s=0,sa.forEach((function(e){return e.scroller===we.scroller&&(s=1)})),s||ns||(we.scroll.rec=0),i&&(i.scrollTrigger=null,e&&i.revert({kill:!1}),n||i.kill()),h&&[h,d,u,p].forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),ss===we&&(ss=0),Q&&(r&&(r.uncache=1),s=0,sa.forEach((function(e){return e.pin===Q&&s++})),s||(r.spacer=0)),t.onKill&&t.onKill(we)},we.enable(!1,!1),B&&B(we),i&&i.add&&!m?Mr.delayedCall(.01,(function(){return l||c||we.refresh()}))&&(m=.01)&&(l=c=0):we.refresh(),Q&&function(){if(rs!==ya){var e=rs=ya;requestAnimationFrame((function(){return e===ya&&ba(!0)}))}}()}else this.update=this.refresh=this.kill=fs},e.register=function(t){return Ar||(Mr=t||vs(),gs()&&window.document&&e.enable(),Ar=hs),Ar},e.defaults=function(e){if(e)for(var t in e)ea[t]=e[t];return ea},e.disable=function(e,t){hs=0,sa.forEach((function(i){return i[t?"kill":"disable"](e)})),Ks(Cr,"wheel",la),Ks(Lr,"scroll",la),clearInterval(Fr),Ks(Lr,"touchcancel",fs),Ks(Rr,"touchstart",fs),$s(Ks,Lr,"pointerdown,touchstart,mousedown",us),$s(Ks,Lr,"pointerup,touchend,mouseup",ps),Ir.kill(),xs(Ks);for(var i=0;i<rr.length;i+=3)Js(Ks,rr[i],rr[i+1]),Js(Ks,rr[i],rr[i+2])},e.enable=function(){if(Cr=window,Lr=document,Pr=Lr.documentElement,Rr=Lr.body,Mr&&(Dr=Mr.utils.toArray,Nr=Mr.utils.clamp,Qr=Mr.core.context||fs,Xr=Mr.core.suppressOverwrites||fs,es=Cr.history.scrollRestoration||"auto",xa=Cr.pageYOffset,Mr.core.globals("ScrollTrigger",e),Rr)){hs=1,ds(),Tr.register(Mr),e.isTouch=Tr.isTouch,Jr=Tr.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),Zs(Cr,"wheel",la),Or=[Cr,Lr,Pr,Rr],Mr.matchMedia?(e.matchMedia=function(e){var t,i=Mr.matchMedia();for(t in e)i.add(t,e[t]);return i},Mr.addEventListener("matchMediaInit",(function(){return va()})),Mr.addEventListener("matchMediaRevert",(function(){return ga()})),Mr.addEventListener("matchMedia",(function(){ba(0,1),fa("matchMedia")})),Mr.matchMedia("(orientation: portrait)",(function(){return ca(),ca}))):console.warn("Requires GSAP 3.11.0 or later"),ca(),Zs(Lr,"scroll",la);var t,i,n=Rr.style,r=n.borderTopStyle,s=Mr.core.Animation.prototype;for(s.revert||Object.defineProperty(s,"revert",{value:function(){return this.time(-.01,!0)}}),n.borderTopStyle="solid",t=Ws(Rr),vr.m=Math.round(t.top+vr.sc())||0,gr.m=Math.round(t.left+gr.sc())||0,r?n.borderTopStyle=r:n.removeProperty("border-top-style"),Fr=setInterval(oa,250),Mr.delayedCall(.5,(function(){return as=0})),Zs(Lr,"touchcancel",fs),Zs(Rr,"touchstart",fs),$s(Zs,Lr,"pointerdown,touchstart,mousedown",us),$s(Zs,Lr,"pointerup,touchend,mouseup",ps),Hr=Mr.utils.checkPrefix("transform"),Ta.push(Hr),Ar=os(),Ir=Mr.delayedCall(.2,ba).pause(),Gr=[Lr,"visibilitychange",function(){var e=Cr.innerWidth,t=Cr.innerHeight;Lr.hidden?(Vr=e,jr=t):Vr===e&&jr===t||ha()},Lr,"DOMContentLoaded",ba,Cr,"load",ba,Cr,"resize",ha],xs(Zs),sa.forEach((function(e){return e.enable(0,1)})),i=0;i<rr.length;i+=3)Js(Ks,rr[i],rr[i+1]),Js(Ks,rr[i],rr[i+2])}},e.config=function(t){"limitCallbacks"in t&&(ts=!!t.limitCallbacks);var i=t.syncInterval;i&&clearInterval(Fr)||(Fr=i)&&setInterval(oa,i),"ignoreMobileResize"in t&&($r=1===e.isTouch&&t.ignoreMobileResize),"autoRefreshEvents"in t&&(xs(Ks)||xs(Zs,t.autoRefreshEvents||"none"),qr=-1===(t.autoRefreshEvents+"").indexOf("resize"))},e.scrollerProxy=function(e,t){var i=_r(e),n=rr.indexOf(i),r=_s(i);~n&&rr.splice(n,r?6:2),t&&(r?sr.unshift(Cr,t,Rr,t,Pr,t):sr.unshift(i,t))},e.clearMatchMedia=function(e){sa.forEach((function(t){return t._ctx&&t._ctx.query===e&&t._ctx.kill(!0,!0)}))},e.isInViewport=function(e,t,i){var n=(ws(e)?_r(e):e).getBoundingClientRect(),r=n[i?Os:Is]*t||0;return i?n.right-r>0&&n.left+r<Cr.innerWidth:n.bottom-r>0&&n.top+r<Cr.innerHeight},e.positionInViewport=function(e,t,i){ws(e)&&(e=_r(e));var n=e.getBoundingClientRect(),r=n[i?Os:Is],s=null==t?r/2:t in ta?ta[t]*r:~t.indexOf("%")?parseFloat(t)*r/100:parseFloat(t)||0;return i?(n.left+s)/Cr.innerWidth:(n.top+s)/Cr.innerHeight},e.killAll=function(e){if(sa.slice(0).forEach((function(e){return"ScrollSmoother"!==e.vars.id&&e.kill()})),!0!==e){var t=da.killAll||[];da={},t.forEach((function(e){return e()}))}},e}();Ua.version="3.11.5",Ua.saveStyles=function(e){return e?Dr(e).forEach((function(e){if(e&&e.style){var t=ma.indexOf(e);t>=0&&ma.splice(t,5),ma.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),Mr.core.getCache(e),Qr())}})):ma},Ua.revert=function(e,t){return va(!e,t)},Ua.create=function(e,t){return new Ua(e,t)},Ua.refresh=function(e){return e?ha():(Ar||Ua.register())&&ba(!0)},Ua.update=function(e){return++rr.cache&&Ea(!0===e?2:0)},Ua.clearScrollMemory=_a,Ua.maxScroll=function(e,t){return bs(e,t?gr:vr)},Ua.getScrollFunc=function(e,t){return yr(_r(e),t?gr:vr)},Ua.getById=function(e){return aa[e]},Ua.getAll=function(){return sa.filter((function(e){return"ScrollSmoother"!==e.vars.id}))},Ua.isScrolling=function(){return!!cs},Ua.snapDirectional=Ys,Ua.addEventListener=function(e,t){var i=da[e]||(da[e]=[]);~i.indexOf(t)||i.push(t)},Ua.removeEventListener=function(e,t){var i=da[e],n=i&&i.indexOf(t);n>=0&&i.splice(n,1)},Ua.batch=function(e,t){var i,n=[],r={},s=t.interval||.016,a=t.batchMax||1e9,o=function(e,t){var i=[],n=[],r=Mr.delayedCall(s,(function(){t(i,n),i=[],n=[]})).pause();return function(e){i.length||r.restart(!0),i.push(e.trigger),n.push(e),a<=i.length&&r.progress(1)}};for(i in t)r[i]="on"===i.substr(0,2)&&Es(t[i])&&"onRefreshInit"!==i?o(0,t[i]):t[i];return Es(a)&&(a=a(),Zs(Ua,"refresh",(function(){return a=t.batchMax()}))),Dr(e).forEach((function(e){var t={};for(i in r)t[i]=r[i];t.trigger=e,n.push(Ua.create(t))})),n};var Fa,za=function(e,t,i,n){return t>n?e(n):t<0&&e(0),i>n?(n-t)/(i-t):i<0?t/(t-i):1},ka=function e(t,i){!0===i?t.style.removeProperty("touch-action"):t.style.touchAction=!0===i?"auto":i?"pan-"+i+(Tr.isTouch?" pinch-zoom":""):"none",t===Pr&&e(Rr,i)},Ha={auto:1,scroll:1},Ba=function(e){var t,i=e.event,n=e.target,r=e.axis,s=(i.changedTouches?i.changedTouches[0]:i).target,a=s._gsap||Mr.core.getCache(s),o=os();if(!a._isScrollT||o-a._isScrollT>2e3){for(;s&&s!==Rr&&(s.scrollHeight<=s.clientHeight&&s.scrollWidth<=s.clientWidth||!Ha[(t=js(s)).overflowY]&&!Ha[t.overflowX]);)s=s.parentNode;a._isScroll=s&&s!==n&&!_s(s)&&(Ha[(t=js(s)).overflowY]||Ha[t.overflowX]),a._isScrollT=o}(a._isScroll||"x"===r)&&(i.stopPropagation(),i._gsapAllow=!0)},Va=function(e,t,i,n){return Tr.create({target:e,capture:!0,debounce:!1,lockAxis:!0,type:t,onWheel:n=n&&Ba,onPress:n,onDrag:n,onScroll:n,onEnable:function(){return i&&Zs(Lr,Tr.eventTypes[0],Ga,!1,!0)},onDisable:function(){return Ks(Lr,Tr.eventTypes[0],Ga,!0)}})},ja=/(input|label|select|textarea)/i,Ga=function(e){var t=ja.test(e.target.tagName);(t||Fa)&&(e._gsapAllow=!0,Fa=t)};Ua.sort=function(e){return sa.sort(e||function(e,t){return-1e6*(e.vars.refreshPriority||0)+e.start-(t.start+-1e6*(t.vars.refreshPriority||0))})},Ua.observe=function(e){return new Tr(e)},Ua.normalizeScroll=function(e){if(void 0===e)return Yr;if(!0===e&&Yr)return Yr.enable();if(!1===e)return Yr&&Yr.kill();var t=e instanceof Tr?e:function(e){Ts(e)||(e={}),e.preventDefault=e.isNormalizer=e.allowClicks=!0,e.type||(e.type="wheel,touch"),e.debounce=!!e.debounce,e.id=e.id||"normalizer";var t,i,n,r,s,a,o,l,c=e,h=c.normalizeScrollX,d=c.momentum,u=c.allowNestedScroll,p=c.onRelease,f=_r(e.target)||Pr,m=Mr.core.globals().ScrollSmoother,g=m&&m.get(),v=Jr&&(e.content&&_r(e.content)||g&&!1!==e.content&&!g.smooth()&&g.content()),_=yr(f,vr),y=yr(f,gr),b=1,x=(Tr.isTouch&&Cr.visualViewport?Cr.visualViewport.scale*Cr.visualViewport.width:Cr.outerWidth)/Cr.innerWidth,w=0,E=Es(d)?function(){return d(t)}:function(){return d||2.8},S=Va(f,e.type,!0,u),T=function(){return r=!1},M=fs,A=fs,C=function(){i=bs(f,vr),A=Nr(Jr?1:0,i),h&&(M=Nr(0,bs(f,gr))),n=ya},L=function(){v._gsap.y=ms(parseFloat(v._gsap.y)+_.offset)+"px",v.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(v._gsap.y)+", 0, 1)",_.offset=_.cacheID=0},P=function(){C(),s.isActive()&&s.vars.scrollY>i&&(_()>i?s.progress(1)&&_(i):s.resetTo("scrollY",i))};return v&&Mr.set(v,{y:"+=0"}),e.ignoreCheck=function(e){return Jr&&"touchmove"===e.type&&function(){if(r){requestAnimationFrame(T);var e=ms(t.deltaY/2),i=A(_.v-e);if(v&&i!==_.v+_.offset){_.offset=i-_.v;var n=ms((parseFloat(v&&v._gsap.y)||0)-_.offset);v.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+n+", 0, 1)",v._gsap.y=n+"px",_.cacheID=rr.cache,Ea()}return!0}_.offset&&L(),r=!0}()||b>1.05&&"touchstart"!==e.type||t.isGesturing||e.touches&&e.touches.length>1},e.onPress=function(){r=!1;var e=b;b=ms((Cr.visualViewport&&Cr.visualViewport.scale||1)/x),s.pause(),e!==b&&ka(f,b>1.01||!h&&"x"),a=y(),o=_(),C(),n=ya},e.onRelease=e.onGestureStart=function(e,t){if(_.offset&&L(),t){rr.cache++;var n,r,a=E();h&&(r=(n=y())+.05*a*-e.velocityX/.227,a*=za(y,n,r,bs(f,gr)),s.vars.scrollX=M(r)),r=(n=_())+.05*a*-e.velocityY/.227,a*=za(_,n,r,bs(f,vr)),s.vars.scrollY=A(r),s.invalidate().duration(a).play(.01),(Jr&&s.vars.scrollY>=i||n>=i-1)&&Mr.to({},{onUpdate:P,duration:a})}else l.restart(!0);p&&p(e)},e.onWheel=function(){s._ts&&s.pause(),os()-w>1e3&&(n=0,w=os())},e.onChange=function(e,t,i,r,s){if(ya!==n&&C(),t&&h&&y(M(r[2]===t?a+(e.startX-e.x):y()+t-r[1])),i){_.offset&&L();var l=s[2]===i,c=l?o+e.startY-e.y:_()+i-s[1],d=A(c);l&&c!==d&&(o+=d-c),_(d)}(i||t)&&Ea()},e.onEnable=function(){ka(f,!h&&"x"),Ua.addEventListener("refresh",P),Zs(Cr,"resize",P),_.smooth&&(_.target.style.scrollBehavior="auto",_.smooth=y.smooth=!1),S.enable()},e.onDisable=function(){ka(f,!0),Ks(Cr,"resize",P),Ua.removeEventListener("refresh",P),S.kill()},e.lockAxis=!1!==e.lockAxis,(t=new Tr(e)).iOS=Jr,Jr&&!_()&&_(1),Jr&&Mr.ticker.add(fs),l=t._dc,s=Mr.to(t,{ease:"power4",paused:!0,scrollX:h?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:Da(_,_(),(function(){return s.pause()}))},onUpdate:Ea,onComplete:l.vars.onComplete}),t}(e);return Yr&&Yr.target===t.target&&Yr.kill(),_s(t.target)&&(Yr=t),t},Ua.core={_getVelocityProp:br,_inputObserver:Va,_scrollers:rr,_proxies:sr,bridge:{ss:function(){cs||fa("scrollStart"),cs=os()},ref:function(){return zr}}},vs()&&Mr.registerPlugin(Ua);var Wa,Xa,qa,Ya,$a,Za,Ka,Ja,Qa=function(){return"undefined"!=typeof window},eo=function(){return Wa||Qa()&&(Wa=window.gsap)&&Wa.registerPlugin&&Wa},to=function(e){return"string"==typeof e},io=function(e){return"function"==typeof e},no=function(e,t){var i="x"===t?"Width":"Height",n="scroll"+i,r="client"+i;return e===qa||e===Ya||e===$a?Math.max(Ya[n],$a[n])-(qa["inner"+i]||Ya[r]||$a[r]):e[n]-e["offset"+i]},ro=function(e,t){var i="scroll"+("x"===t?"Left":"Top");return e===qa&&(null!=e.pageXOffset?i="page"+t.toUpperCase()+"Offset":e=null!=Ya[i]?Ya:$a),function(){return e[i]}},so=function(e,t){if(!(e=Za(e)[0])||!e.getBoundingClientRect)return console.warn("scrollTo target doesn't exist. Using 0")||{x:0,y:0};var i=e.getBoundingClientRect(),n=!t||t===qa||t===$a,r=n?{top:Ya.clientTop-(qa.pageYOffset||Ya.scrollTop||$a.scrollTop||0),left:Ya.clientLeft-(qa.pageXOffset||Ya.scrollLeft||$a.scrollLeft||0)}:t.getBoundingClientRect(),s={x:i.left-r.left,y:i.top-r.top};return!n&&t&&(s.x+=ro(t,"x")(),s.y+=ro(t,"y")()),s},ao=function(e,t,i,n,r){return isNaN(e)||"object"==typeof e?to(e)&&"="===e.charAt(1)?parseFloat(e.substr(2))*("-"===e.charAt(0)?-1:1)+n-r:"max"===e?no(t,i)-r:Math.min(no(t,i),so(e,t)[i]-r):parseFloat(e)-r},oo=function(){Wa=eo(),Qa()&&Wa&&"undefined"!=typeof document&&document.body&&(qa=window,$a=document.body,Ya=document.documentElement,Za=Wa.utils.toArray,Wa.config({autoKillThreshold:7}),Ka=Wa.config(),Xa=1)},lo={version:"3.11.5",name:"scrollTo",rawVars:1,register:function(e){Wa=e,oo()},init:function(e,t,i,n,r){Xa||oo();var s=this,a=Wa.getProperty(e,"scrollSnapType");s.isWin=e===qa,s.target=e,s.tween=i,t=function(e,t,i,n){if(io(e)&&(e=e(t,i,n)),"object"!=typeof e)return to(e)&&"max"!==e&&"="!==e.charAt(1)?{x:e,y:e}:{y:e};if(e.nodeType)return{y:e,x:e};var r,s={};for(r in e)s[r]="onAutoKill"!==r&&io(e[r])?e[r](t,i,n):e[r];return s}(t,n,e,r),s.vars=t,s.autoKill=!!t.autoKill,s.getX=ro(e,"x"),s.getY=ro(e,"y"),s.x=s.xPrev=s.getX(),s.y=s.yPrev=s.getY(),Ja||(Ja=Wa.core.globals().ScrollTrigger),"smooth"===Wa.getProperty(e,"scrollBehavior")&&Wa.set(e,{scrollBehavior:"auto"}),a&&"none"!==a&&(s.snap=1,s.snapInline=e.style.scrollSnapType,e.style.scrollSnapType="none"),null!=t.x?(s.add(s,"x",s.x,ao(t.x,e,"x",s.x,t.offsetX||0),n,r),s._props.push("scrollTo_x")):s.skipX=1,null!=t.y?(s.add(s,"y",s.y,ao(t.y,e,"y",s.y,t.offsetY||0),n,r),s._props.push("scrollTo_y")):s.skipY=1},render:function(e,t){for(var i,n,r,s,a,o=t._pt,l=t.target,c=t.tween,h=t.autoKill,d=t.xPrev,u=t.yPrev,p=t.isWin,f=t.snap,m=t.snapInline;o;)o.r(e,o.d),o=o._next;i=p||!t.skipX?t.getX():d,r=(n=p||!t.skipY?t.getY():u)-u,s=i-d,a=Ka.autoKillThreshold,t.x<0&&(t.x=0),t.y<0&&(t.y=0),h&&(!t.skipX&&(s>a||s<-a)&&i<no(l,"x")&&(t.skipX=1),!t.skipY&&(r>a||r<-a)&&n<no(l,"y")&&(t.skipY=1),t.skipX&&t.skipY&&(c.kill(),t.vars.onAutoKill&&t.vars.onAutoKill.apply(c,t.vars.onAutoKillParams||[]))),p?qa.scrollTo(t.skipX?i:t.x,t.skipY?n:t.y):(t.skipY||(l.scrollTop=t.y),t.skipX||(l.scrollLeft=t.x)),!f||1!==e&&0!==e||(n=l.scrollTop,i=l.scrollLeft,m?l.style.scrollSnapType=m:l.style.removeProperty("scroll-snap-type"),l.scrollTop=n+1,l.scrollLeft=i+1,l.scrollTop=n,l.scrollLeft=i),t.xPrev=t.x,t.yPrev=t.y,Ja&&Ja.update()},kill:function(e){var t="scrollTo"===e;(t||"scrollTo_x"===e)&&(this.skipX=1),(t||"scrollTo_y"===e)&&(this.skipY=1)}};function co(e){return null!==e&&"object"==typeof e&&"constructor"in e&&e.constructor===Object}function ho(e={},t={}){Object.keys(t).forEach((i=>{void 0===e[i]?e[i]=t[i]:co(t[i])&&co(e[i])&&Object.keys(t[i]).length>0&&ho(e[i],t[i])}))}lo.max=no,lo.getOffset=so,lo.buildGetter=ro,eo()&&Wa.registerPlugin(lo);const uo={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector:()=>null,querySelectorAll:()=>[],getElementById:()=>null,createEvent:()=>({initEvent(){}}),createElement:()=>({children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName:()=>[]}),createElementNS:()=>({}),importNode:()=>null,location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function po(){const e="undefined"!=typeof document?document:{};return ho(e,uo),e}const fo={document:uo,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle:()=>({getPropertyValue:()=>""}),Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia:()=>({}),requestAnimationFrame:e=>"undefined"==typeof setTimeout?(e(),null):setTimeout(e,0),cancelAnimationFrame(e){"undefined"!=typeof setTimeout&&clearTimeout(e)}};function mo(){const e="undefined"!=typeof window?window:{};return ho(e,fo),e}function go(e,t=0){return setTimeout(e,t)}function vo(){return Date.now()}function _o(e){return"object"==typeof e&&null!==e&&e.constructor&&"Object"===Object.prototype.toString.call(e).slice(8,-1)}function yo(...e){const t=Object(e[0]),i=["__proto__","constructor","prototype"];for(let r=1;r<e.length;r+=1){const s=e[r];if(null!=s&&(n=s,!("undefined"!=typeof window&&void 0!==window.HTMLElement?n instanceof HTMLElement:n&&(1===n.nodeType||11===n.nodeType)))){const e=Object.keys(Object(s)).filter((e=>i.indexOf(e)<0));for(let i=0,n=e.length;i<n;i+=1){const n=e[i],r=Object.getOwnPropertyDescriptor(s,n);void 0!==r&&r.enumerable&&(_o(t[n])&&_o(s[n])?s[n].__swiper__?t[n]=s[n]:yo(t[n],s[n]):!_o(t[n])&&_o(s[n])?(t[n]={},s[n].__swiper__?t[n]=s[n]:yo(t[n],s[n])):t[n]=s[n])}}}var n;return t}function bo(e,t,i){e.style.setProperty(t,i)}function xo({swiper:e,targetPosition:t,side:i}){const n=mo(),r=-e.translate;let s,a=null;const o=e.params.speed;e.wrapperEl.style.scrollSnapType="none",n.cancelAnimationFrame(e.cssModeFrameID);const l=t>r?"next":"prev",c=(e,t)=>"next"===l&&e>=t||"prev"===l&&e<=t,h=()=>{s=(new Date).getTime(),null===a&&(a=s);const l=Math.max(Math.min((s-a)/o,1),0),d=.5-Math.cos(l*Math.PI)/2;let u=r+d*(t-r);if(c(u,t)&&(u=t),e.wrapperEl.scrollTo({[i]:u}),c(u,t))return e.wrapperEl.style.overflow="hidden",e.wrapperEl.style.scrollSnapType="",setTimeout((()=>{e.wrapperEl.style.overflow="",e.wrapperEl.scrollTo({[i]:u})})),void n.cancelAnimationFrame(e.cssModeFrameID);e.cssModeFrameID=n.requestAnimationFrame(h)};h()}function wo(e){return e.querySelector(".swiper-slide-transform")||e.shadowEl&&e.shadowEl.querySelector(".swiper-slide-transform")||e}function Eo(e,t=""){return[...e.children].filter((e=>e.matches(t)))}function So(e,t=[]){const i=document.createElement(e);return i.classList.add(...Array.isArray(t)?t:[t]),i}function To(e,t){return mo().getComputedStyle(e,null).getPropertyValue(t)}function Mo(e){let t,i=e;if(i){for(t=0;null!==(i=i.previousSibling);)1===i.nodeType&&(t+=1);return t}}function Ao(e,t){const i=[];let n=e.parentElement;for(;n;)t?n.matches(t)&&i.push(n):i.push(n),n=n.parentElement;return i}function Co(e,t,i){const n=mo();return i?e["width"===t?"offsetWidth":"offsetHeight"]+parseFloat(n.getComputedStyle(e,null).getPropertyValue("width"===t?"margin-right":"margin-top"))+parseFloat(n.getComputedStyle(e,null).getPropertyValue("width"===t?"margin-left":"margin-bottom")):e.offsetWidth}let Lo,Po,Ro;function Oo(){return Lo||(Lo=function(){const e=mo(),t=po();return{smoothScroll:t.documentElement&&"scrollBehavior"in t.documentElement.style,touch:!!("ontouchstart"in e||e.DocumentTouch&&t instanceof e.DocumentTouch)}}()),Lo}const Io={on(e,t,i){const n=this;if(!n.eventsListeners||n.destroyed)return n;if("function"!=typeof t)return n;const r=i?"unshift":"push";return e.split(" ").forEach((e=>{n.eventsListeners[e]||(n.eventsListeners[e]=[]),n.eventsListeners[e][r](t)})),n},once(e,t,i){const n=this;if(!n.eventsListeners||n.destroyed)return n;if("function"!=typeof t)return n;function r(...i){n.off(e,r),r.__emitterProxy&&delete r.__emitterProxy,t.apply(n,i)}return r.__emitterProxy=t,n.on(e,r,i)},onAny(e,t){const i=this;if(!i.eventsListeners||i.destroyed)return i;if("function"!=typeof e)return i;const n=t?"unshift":"push";return i.eventsAnyListeners.indexOf(e)<0&&i.eventsAnyListeners[n](e),i},offAny(e){const t=this;if(!t.eventsListeners||t.destroyed)return t;if(!t.eventsAnyListeners)return t;const i=t.eventsAnyListeners.indexOf(e);return i>=0&&t.eventsAnyListeners.splice(i,1),t},off(e,t){const i=this;return!i.eventsListeners||i.destroyed?i:i.eventsListeners?(e.split(" ").forEach((e=>{void 0===t?i.eventsListeners[e]=[]:i.eventsListeners[e]&&i.eventsListeners[e].forEach(((n,r)=>{(n===t||n.__emitterProxy&&n.__emitterProxy===t)&&i.eventsListeners[e].splice(r,1)}))})),i):i},emit(...e){const t=this;if(!t.eventsListeners||t.destroyed)return t;if(!t.eventsListeners)return t;let i,n,r;return"string"==typeof e[0]||Array.isArray(e[0])?(i=e[0],n=e.slice(1,e.length),r=t):(i=e[0].events,n=e[0].data,r=e[0].context||t),n.unshift(r),(Array.isArray(i)?i:i.split(" ")).forEach((e=>{t.eventsAnyListeners&&t.eventsAnyListeners.length&&t.eventsAnyListeners.forEach((t=>{t.apply(r,[e,...n])})),t.eventsListeners&&t.eventsListeners[e]&&t.eventsListeners[e].forEach((e=>{e.apply(r,n)}))})),t}},Do=(e,t)=>{if(!e||e.destroyed||!e.params)return;const i=t.closest(e.isElement?"swiper-slide":`.${e.params.slideClass}`);if(i){const t=i.querySelector(`.${e.params.lazyPreloaderClass}`);t&&t.remove()}},No=(e,t)=>{if(!e.slides[t])return;const i=e.slides[t].querySelector('[loading="lazy"]');i&&i.removeAttribute("loading")},Uo=e=>{if(!e||e.destroyed||!e.params)return;let t=e.params.lazyPreloadPrevNext;const i=e.slides.length;if(!i||!t||t<0)return;t=Math.min(t,i);const n="auto"===e.params.slidesPerView?e.slidesPerViewDynamic():Math.ceil(e.params.slidesPerView),r=e.activeIndex,s=r+n-1;if(e.params.rewind)for(let n=r-t;n<=s+t;n+=1){const t=(n%i+i)%i;t!==r&&t>s&&No(e,t)}else for(let n=Math.max(s-t,0);n<=Math.min(s+t,i-1);n+=1)n!==r&&n>s&&No(e,n)},Fo={updateSize:function(){const e=this;let t,i;const n=e.el;t=void 0!==e.params.width&&null!==e.params.width?e.params.width:n.clientWidth,i=void 0!==e.params.height&&null!==e.params.height?e.params.height:n.clientHeight,0===t&&e.isHorizontal()||0===i&&e.isVertical()||(t=t-parseInt(To(n,"padding-left")||0,10)-parseInt(To(n,"padding-right")||0,10),i=i-parseInt(To(n,"padding-top")||0,10)-parseInt(To(n,"padding-bottom")||0,10),Number.isNaN(t)&&(t=0),Number.isNaN(i)&&(i=0),Object.assign(e,{width:t,height:i,size:e.isHorizontal()?t:i}))},updateSlides:function(){const e=this;function t(t){return e.isHorizontal()?t:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[t]}function i(e,i){return parseFloat(e.getPropertyValue(t(i))||0)}const n=e.params,{wrapperEl:r,slidesEl:s,size:a,rtlTranslate:o,wrongRTL:l}=e,c=e.virtual&&n.virtual.enabled,h=c?e.virtual.slides.length:e.slides.length,d=Eo(s,`.${e.params.slideClass}, swiper-slide`),u=c?e.virtual.slides.length:d.length;let p=[];const f=[],m=[];let g=n.slidesOffsetBefore;"function"==typeof g&&(g=n.slidesOffsetBefore.call(e));let v=n.slidesOffsetAfter;"function"==typeof v&&(v=n.slidesOffsetAfter.call(e));const _=e.snapGrid.length,y=e.slidesGrid.length;let b=n.spaceBetween,x=-g,w=0,E=0;if(void 0===a)return;"string"==typeof b&&b.indexOf("%")>=0&&(b=parseFloat(b.replace("%",""))/100*a),e.virtualSize=-b,d.forEach((e=>{o?e.style.marginLeft="":e.style.marginRight="",e.style.marginBottom="",e.style.marginTop=""})),n.centeredSlides&&n.cssMode&&(bo(r,"--swiper-centered-offset-before",""),bo(r,"--swiper-centered-offset-after",""));const S=n.grid&&n.grid.rows>1&&e.grid;let T;S&&e.grid.initSlides(u);const M="auto"===n.slidesPerView&&n.breakpoints&&Object.keys(n.breakpoints).filter((e=>void 0!==n.breakpoints[e].slidesPerView)).length>0;for(let r=0;r<u;r+=1){let s;if(T=0,d[r]&&(s=d[r]),S&&e.grid.updateSlide(r,s,u,t),!d[r]||"none"!==To(s,"display")){if("auto"===n.slidesPerView){M&&(d[r].style[t("width")]="");const a=getComputedStyle(s),o=s.style.transform,l=s.style.webkitTransform;if(o&&(s.style.transform="none"),l&&(s.style.webkitTransform="none"),n.roundLengths)T=e.isHorizontal()?Co(s,"width",!0):Co(s,"height",!0);else{const e=i(a,"width"),t=i(a,"padding-left"),n=i(a,"padding-right"),r=i(a,"margin-left"),o=i(a,"margin-right"),l=a.getPropertyValue("box-sizing");if(l&&"border-box"===l)T=e+r+o;else{const{clientWidth:i,offsetWidth:a}=s;T=e+t+n+r+o+(a-i)}}o&&(s.style.transform=o),l&&(s.style.webkitTransform=l),n.roundLengths&&(T=Math.floor(T))}else T=(a-(n.slidesPerView-1)*b)/n.slidesPerView,n.roundLengths&&(T=Math.floor(T)),d[r]&&(d[r].style[t("width")]=`${T}px`);d[r]&&(d[r].swiperSlideSize=T),m.push(T),n.centeredSlides?(x=x+T/2+w/2+b,0===w&&0!==r&&(x=x-a/2-b),0===r&&(x=x-a/2-b),Math.abs(x)<.001&&(x=0),n.roundLengths&&(x=Math.floor(x)),E%n.slidesPerGroup==0&&p.push(x),f.push(x)):(n.roundLengths&&(x=Math.floor(x)),(E-Math.min(e.params.slidesPerGroupSkip,E))%e.params.slidesPerGroup==0&&p.push(x),f.push(x),x=x+T+b),e.virtualSize+=T+b,w=T,E+=1}}if(e.virtualSize=Math.max(e.virtualSize,a)+v,o&&l&&("slide"===n.effect||"coverflow"===n.effect)&&(r.style.width=`${e.virtualSize+n.spaceBetween}px`),n.setWrapperSize&&(r.style[t("width")]=`${e.virtualSize+n.spaceBetween}px`),S&&e.grid.updateWrapperSize(T,p,t),!n.centeredSlides){const t=[];for(let i=0;i<p.length;i+=1){let r=p[i];n.roundLengths&&(r=Math.floor(r)),p[i]<=e.virtualSize-a&&t.push(r)}p=t,Math.floor(e.virtualSize-a)-Math.floor(p[p.length-1])>1&&p.push(e.virtualSize-a)}if(c&&n.loop){const t=m[0]+b;if(n.slidesPerGroup>1){const i=Math.ceil((e.virtual.slidesBefore+e.virtual.slidesAfter)/n.slidesPerGroup),r=t*n.slidesPerGroup;for(let e=0;e<i;e+=1)p.push(p[p.length-1]+r)}for(let i=0;i<e.virtual.slidesBefore+e.virtual.slidesAfter;i+=1)1===n.slidesPerGroup&&p.push(p[p.length-1]+t),f.push(f[f.length-1]+t),e.virtualSize+=t}if(0===p.length&&(p=[0]),0!==n.spaceBetween){const i=e.isHorizontal()&&o?"marginLeft":t("marginRight");d.filter(((e,t)=>!(n.cssMode&&!n.loop)||t!==d.length-1)).forEach((e=>{e.style[i]=`${b}px`}))}if(n.centeredSlides&&n.centeredSlidesBounds){let e=0;m.forEach((t=>{e+=t+(n.spaceBetween?n.spaceBetween:0)})),e-=n.spaceBetween;const t=e-a;p=p.map((e=>e<0?-g:e>t?t+v:e))}if(n.centerInsufficientSlides){let e=0;if(m.forEach((t=>{e+=t+(n.spaceBetween?n.spaceBetween:0)})),e-=n.spaceBetween,e<a){const t=(a-e)/2;p.forEach(((e,i)=>{p[i]=e-t})),f.forEach(((e,i)=>{f[i]=e+t}))}}if(Object.assign(e,{slides:d,snapGrid:p,slidesGrid:f,slidesSizesGrid:m}),n.centeredSlides&&n.cssMode&&!n.centeredSlidesBounds){bo(r,"--swiper-centered-offset-before",-p[0]+"px"),bo(r,"--swiper-centered-offset-after",e.size/2-m[m.length-1]/2+"px");const t=-e.snapGrid[0],i=-e.slidesGrid[0];e.snapGrid=e.snapGrid.map((e=>e+t)),e.slidesGrid=e.slidesGrid.map((e=>e+i))}if(u!==h&&e.emit("slidesLengthChange"),p.length!==_&&(e.params.watchOverflow&&e.checkOverflow(),e.emit("snapGridLengthChange")),f.length!==y&&e.emit("slidesGridLengthChange"),n.watchSlidesProgress&&e.updateSlidesOffset(),!(c||n.cssMode||"slide"!==n.effect&&"fade"!==n.effect)){const t=`${n.containerModifierClass}backface-hidden`,i=e.el.classList.contains(t);u<=n.maxBackfaceHiddenSlides?i||e.el.classList.add(t):i&&e.el.classList.remove(t)}},updateAutoHeight:function(e){const t=this,i=[],n=t.virtual&&t.params.virtual.enabled;let r,s=0;"number"==typeof e?t.setTransition(e):!0===e&&t.setTransition(t.params.speed);const a=e=>n?t.slides[t.getSlideIndexByData(e)]:t.slides[e];if("auto"!==t.params.slidesPerView&&t.params.slidesPerView>1)if(t.params.centeredSlides)(t.visibleSlides||[]).forEach((e=>{i.push(e)}));else for(r=0;r<Math.ceil(t.params.slidesPerView);r+=1){const e=t.activeIndex+r;if(e>t.slides.length&&!n)break;i.push(a(e))}else i.push(a(t.activeIndex));for(r=0;r<i.length;r+=1)if(void 0!==i[r]){const e=i[r].offsetHeight;s=e>s?e:s}(s||0===s)&&(t.wrapperEl.style.height=`${s}px`)},updateSlidesOffset:function(){const e=this,t=e.slides,i=e.isElement?e.isHorizontal()?e.wrapperEl.offsetLeft:e.wrapperEl.offsetTop:0;for(let n=0;n<t.length;n+=1)t[n].swiperSlideOffset=(e.isHorizontal()?t[n].offsetLeft:t[n].offsetTop)-i-e.cssOverflowAdjustment()},updateSlidesProgress:function(e=this&&this.translate||0){const t=this,i=t.params,{slides:n,rtlTranslate:r,snapGrid:s}=t;if(0===n.length)return;void 0===n[0].swiperSlideOffset&&t.updateSlidesOffset();let a=-e;r&&(a=e),n.forEach((e=>{e.classList.remove(i.slideVisibleClass)})),t.visibleSlidesIndexes=[],t.visibleSlides=[];for(let e=0;e<n.length;e+=1){const o=n[e];let l=o.swiperSlideOffset;i.cssMode&&i.centeredSlides&&(l-=n[0].swiperSlideOffset);const c=(a+(i.centeredSlides?t.minTranslate():0)-l)/(o.swiperSlideSize+i.spaceBetween),h=(a-s[0]+(i.centeredSlides?t.minTranslate():0)-l)/(o.swiperSlideSize+i.spaceBetween),d=-(a-l),u=d+t.slidesSizesGrid[e];(d>=0&&d<t.size-1||u>1&&u<=t.size||d<=0&&u>=t.size)&&(t.visibleSlides.push(o),t.visibleSlidesIndexes.push(e),n[e].classList.add(i.slideVisibleClass)),o.progress=r?-c:c,o.originalProgress=r?-h:h}},updateProgress:function(e){const t=this;if(void 0===e){const i=t.rtlTranslate?-1:1;e=t&&t.translate&&t.translate*i||0}const i=t.params,n=t.maxTranslate()-t.minTranslate();let{progress:r,isBeginning:s,isEnd:a,progressLoop:o}=t;const l=s,c=a;if(0===n)r=0,s=!0,a=!0;else{r=(e-t.minTranslate())/n;const i=Math.abs(e-t.minTranslate())<1,o=Math.abs(e-t.maxTranslate())<1;s=i||r<=0,a=o||r>=1,i&&(r=0),o&&(r=1)}if(i.loop){const i=t.getSlideIndexByData(0),n=t.getSlideIndexByData(t.slides.length-1),r=t.slidesGrid[i],s=t.slidesGrid[n],a=t.slidesGrid[t.slidesGrid.length-1],l=Math.abs(e);o=l>=r?(l-r)/a:(l+a-s)/a,o>1&&(o-=1)}Object.assign(t,{progress:r,progressLoop:o,isBeginning:s,isEnd:a}),(i.watchSlidesProgress||i.centeredSlides&&i.autoHeight)&&t.updateSlidesProgress(e),s&&!l&&t.emit("reachBeginning toEdge"),a&&!c&&t.emit("reachEnd toEdge"),(l&&!s||c&&!a)&&t.emit("fromEdge"),t.emit("progress",r)},updateSlidesClasses:function(){const e=this,{slides:t,params:i,slidesEl:n,activeIndex:r}=e,s=e.virtual&&i.virtual.enabled,a=e=>Eo(n,`.${i.slideClass}${e}, swiper-slide${e}`)[0];let o;if(t.forEach((e=>{e.classList.remove(i.slideActiveClass,i.slideNextClass,i.slidePrevClass)})),s)if(i.loop){let t=r-e.virtual.slidesBefore;t<0&&(t=e.virtual.slides.length+t),t>=e.virtual.slides.length&&(t-=e.virtual.slides.length),o=a(`[data-swiper-slide-index="${t}"]`)}else o=a(`[data-swiper-slide-index="${r}"]`);else o=t[r];if(o){o.classList.add(i.slideActiveClass);let e=function(e,t){const i=[];for(;e.nextElementSibling;){const n=e.nextElementSibling;t?n.matches(t)&&i.push(n):i.push(n),e=n}return i}(o,`.${i.slideClass}, swiper-slide`)[0];i.loop&&!e&&(e=t[0]),e&&e.classList.add(i.slideNextClass);let n=function(e,t){const i=[];for(;e.previousElementSibling;){const n=e.previousElementSibling;t?n.matches(t)&&i.push(n):i.push(n),e=n}return i}(o,`.${i.slideClass}, swiper-slide`)[0];i.loop&&0===!n&&(n=t[t.length-1]),n&&n.classList.add(i.slidePrevClass)}e.emitSlidesClasses()},updateActiveIndex:function(e){const t=this,i=t.rtlTranslate?t.translate:-t.translate,{snapGrid:n,params:r,activeIndex:s,realIndex:a,snapIndex:o}=t;let l,c=e;const h=e=>{let i=e-t.virtual.slidesBefore;return i<0&&(i=t.virtual.slides.length+i),i>=t.virtual.slides.length&&(i-=t.virtual.slides.length),i};if(void 0===c&&(c=function(e){const{slidesGrid:t,params:i}=e,n=e.rtlTranslate?e.translate:-e.translate;let r;for(let e=0;e<t.length;e+=1)void 0!==t[e+1]?n>=t[e]&&n<t[e+1]-(t[e+1]-t[e])/2?r=e:n>=t[e]&&n<t[e+1]&&(r=e+1):n>=t[e]&&(r=e);return i.normalizeSlideIndex&&(r<0||void 0===r)&&(r=0),r}(t)),n.indexOf(i)>=0)l=n.indexOf(i);else{const e=Math.min(r.slidesPerGroupSkip,c);l=e+Math.floor((c-e)/r.slidesPerGroup)}if(l>=n.length&&(l=n.length-1),c===s)return l!==o&&(t.snapIndex=l,t.emit("snapIndexChange")),void(t.params.loop&&t.virtual&&t.params.virtual.enabled&&(t.realIndex=h(c)));let d;d=t.virtual&&r.virtual.enabled&&r.loop?h(c):t.slides[c]?parseInt(t.slides[c].getAttribute("data-swiper-slide-index")||c,10):c,Object.assign(t,{previousSnapIndex:o,snapIndex:l,previousRealIndex:a,realIndex:d,previousIndex:s,activeIndex:c}),t.initialized&&Uo(t),t.emit("activeIndexChange"),t.emit("snapIndexChange"),a!==d&&t.emit("realIndexChange"),(t.initialized||t.params.runCallbacksOnInit)&&t.emit("slideChange")},updateClickedSlide:function(e){const t=this,i=t.params,n=e.closest(`.${i.slideClass}, swiper-slide`);let r,s=!1;if(n)for(let e=0;e<t.slides.length;e+=1)if(t.slides[e]===n){s=!0,r=e;break}if(!n||!s)return t.clickedSlide=void 0,void(t.clickedIndex=void 0);t.clickedSlide=n,t.virtual&&t.params.virtual.enabled?t.clickedIndex=parseInt(n.getAttribute("data-swiper-slide-index"),10):t.clickedIndex=r,i.slideToClickedSlide&&void 0!==t.clickedIndex&&t.clickedIndex!==t.activeIndex&&t.slideToClickedSlide()}},zo={getTranslate:function(e=(this.isHorizontal()?"x":"y")){const{params:t,rtlTranslate:i,translate:n,wrapperEl:r}=this;if(t.virtualTranslate)return i?-n:n;if(t.cssMode)return n;let s=function(e,t="x"){const i=mo();let n,r,s;const a=function(e){const t=mo();let i;return t.getComputedStyle&&(i=t.getComputedStyle(e,null)),!i&&e.currentStyle&&(i=e.currentStyle),i||(i=e.style),i}(e);return i.WebKitCSSMatrix?(r=a.transform||a.webkitTransform,r.split(",").length>6&&(r=r.split(", ").map((e=>e.replace(",","."))).join(", ")),s=new i.WebKitCSSMatrix("none"===r?"":r)):(s=a.MozTransform||a.OTransform||a.MsTransform||a.msTransform||a.transform||a.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),n=s.toString().split(",")),"x"===t&&(r=i.WebKitCSSMatrix?s.m41:16===n.length?parseFloat(n[12]):parseFloat(n[4])),"y"===t&&(r=i.WebKitCSSMatrix?s.m42:16===n.length?parseFloat(n[13]):parseFloat(n[5])),r||0}(r,e);return s+=this.cssOverflowAdjustment(),i&&(s=-s),s||0},setTranslate:function(e,t){const i=this,{rtlTranslate:n,params:r,wrapperEl:s,progress:a}=i;let o,l=0,c=0;i.isHorizontal()?l=n?-e:e:c=e,r.roundLengths&&(l=Math.floor(l),c=Math.floor(c)),i.previousTranslate=i.translate,i.translate=i.isHorizontal()?l:c,r.cssMode?s[i.isHorizontal()?"scrollLeft":"scrollTop"]=i.isHorizontal()?-l:-c:r.virtualTranslate||(i.isHorizontal()?l-=i.cssOverflowAdjustment():c-=i.cssOverflowAdjustment(),s.style.transform=`translate3d(${l}px, ${c}px, 0px)`);const h=i.maxTranslate()-i.minTranslate();o=0===h?0:(e-i.minTranslate())/h,o!==a&&i.updateProgress(e),i.emit("setTranslate",i.translate,t)},minTranslate:function(){return-this.snapGrid[0]},maxTranslate:function(){return-this.snapGrid[this.snapGrid.length-1]},translateTo:function(e=0,t=this.params.speed,i=!0,n=!0,r){const s=this,{params:a,wrapperEl:o}=s;if(s.animating&&a.preventInteractionOnTransition)return!1;const l=s.minTranslate(),c=s.maxTranslate();let h;if(h=n&&e>l?l:n&&e<c?c:e,s.updateProgress(h),a.cssMode){const e=s.isHorizontal();if(0===t)o[e?"scrollLeft":"scrollTop"]=-h;else{if(!s.support.smoothScroll)return xo({swiper:s,targetPosition:-h,side:e?"left":"top"}),!0;o.scrollTo({[e?"left":"top"]:-h,behavior:"smooth"})}return!0}return 0===t?(s.setTransition(0),s.setTranslate(h),i&&(s.emit("beforeTransitionStart",t,r),s.emit("transitionEnd"))):(s.setTransition(t),s.setTranslate(h),i&&(s.emit("beforeTransitionStart",t,r),s.emit("transitionStart")),s.animating||(s.animating=!0,s.onTranslateToWrapperTransitionEnd||(s.onTranslateToWrapperTransitionEnd=function(e){s&&!s.destroyed&&e.target===this&&(s.wrapperEl.removeEventListener("transitionend",s.onTranslateToWrapperTransitionEnd),s.onTranslateToWrapperTransitionEnd=null,delete s.onTranslateToWrapperTransitionEnd,i&&s.emit("transitionEnd"))}),s.wrapperEl.addEventListener("transitionend",s.onTranslateToWrapperTransitionEnd))),!0}};function ko({swiper:e,runCallbacks:t,direction:i,step:n}){const{activeIndex:r,previousIndex:s}=e;let a=i;if(a||(a=r>s?"next":r<s?"prev":"reset"),e.emit(`transition${n}`),t&&r!==s){if("reset"===a)return void e.emit(`slideResetTransition${n}`);e.emit(`slideChangeTransition${n}`),"next"===a?e.emit(`slideNextTransition${n}`):e.emit(`slidePrevTransition${n}`)}}const Ho={setTransition:function(e,t){const i=this;i.params.cssMode||(i.wrapperEl.style.transitionDuration=`${e}ms`),i.emit("setTransition",e,t)},transitionStart:function(e=!0,t){const i=this,{params:n}=i;n.cssMode||(n.autoHeight&&i.updateAutoHeight(),ko({swiper:i,runCallbacks:e,direction:t,step:"Start"}))},transitionEnd:function(e=!0,t){const i=this,{params:n}=i;i.animating=!1,n.cssMode||(i.setTransition(0),ko({swiper:i,runCallbacks:e,direction:t,step:"End"}))}},Bo={slideTo:function(e=0,t=this.params.speed,i=!0,n,r){"string"==typeof e&&(e=parseInt(e,10));const s=this;let a=e;a<0&&(a=0);const{params:o,snapGrid:l,slidesGrid:c,previousIndex:h,activeIndex:d,rtlTranslate:u,wrapperEl:p,enabled:f}=s;if(s.animating&&o.preventInteractionOnTransition||!f&&!n&&!r)return!1;const m=Math.min(s.params.slidesPerGroupSkip,a);let g=m+Math.floor((a-m)/s.params.slidesPerGroup);g>=l.length&&(g=l.length-1);const v=-l[g];if(o.normalizeSlideIndex)for(let e=0;e<c.length;e+=1){const t=-Math.floor(100*v),i=Math.floor(100*c[e]),n=Math.floor(100*c[e+1]);void 0!==c[e+1]?t>=i&&t<n-(n-i)/2?a=e:t>=i&&t<n&&(a=e+1):t>=i&&(a=e)}if(s.initialized&&a!==d){if(!s.allowSlideNext&&v<s.translate&&v<s.minTranslate())return!1;if(!s.allowSlidePrev&&v>s.translate&&v>s.maxTranslate()&&(d||0)!==a)return!1}let _;if(a!==(h||0)&&i&&s.emit("beforeSlideChangeStart"),s.updateProgress(v),_=a>d?"next":a<d?"prev":"reset",u&&-v===s.translate||!u&&v===s.translate)return s.updateActiveIndex(a),o.autoHeight&&s.updateAutoHeight(),s.updateSlidesClasses(),"slide"!==o.effect&&s.setTranslate(v),"reset"!==_&&(s.transitionStart(i,_),s.transitionEnd(i,_)),!1;if(o.cssMode){const e=s.isHorizontal(),i=u?v:-v;if(0===t){const t=s.virtual&&s.params.virtual.enabled;t&&(s.wrapperEl.style.scrollSnapType="none",s._immediateVirtual=!0),t&&!s._cssModeVirtualInitialSet&&s.params.initialSlide>0?(s._cssModeVirtualInitialSet=!0,requestAnimationFrame((()=>{p[e?"scrollLeft":"scrollTop"]=i}))):p[e?"scrollLeft":"scrollTop"]=i,t&&requestAnimationFrame((()=>{s.wrapperEl.style.scrollSnapType="",s._immediateVirtual=!1}))}else{if(!s.support.smoothScroll)return xo({swiper:s,targetPosition:i,side:e?"left":"top"}),!0;p.scrollTo({[e?"left":"top"]:i,behavior:"smooth"})}return!0}return s.setTransition(t),s.setTranslate(v),s.updateActiveIndex(a),s.updateSlidesClasses(),s.emit("beforeTransitionStart",t,n),s.transitionStart(i,_),0===t?s.transitionEnd(i,_):s.animating||(s.animating=!0,s.onSlideToWrapperTransitionEnd||(s.onSlideToWrapperTransitionEnd=function(e){s&&!s.destroyed&&e.target===this&&(s.wrapperEl.removeEventListener("transitionend",s.onSlideToWrapperTransitionEnd),s.onSlideToWrapperTransitionEnd=null,delete s.onSlideToWrapperTransitionEnd,s.transitionEnd(i,_))}),s.wrapperEl.addEventListener("transitionend",s.onSlideToWrapperTransitionEnd)),!0},slideToLoop:function(e=0,t=this.params.speed,i=!0,n){"string"==typeof e&&(e=parseInt(e,10));const r=this;let s=e;return r.params.loop&&(r.virtual&&r.params.virtual.enabled?s+=r.virtual.slidesBefore:s=r.getSlideIndexByData(s)),r.slideTo(s,t,i,n)},slideNext:function(e=this.params.speed,t=!0,i){const n=this,{enabled:r,params:s,animating:a}=n;if(!r)return n;let o=s.slidesPerGroup;"auto"===s.slidesPerView&&1===s.slidesPerGroup&&s.slidesPerGroupAuto&&(o=Math.max(n.slidesPerViewDynamic("current",!0),1));const l=n.activeIndex<s.slidesPerGroupSkip?1:o,c=n.virtual&&s.virtual.enabled;if(s.loop){if(a&&!c&&s.loopPreventsSliding)return!1;n.loopFix({direction:"next"}),n._clientLeft=n.wrapperEl.clientLeft}return s.rewind&&n.isEnd?n.slideTo(0,e,t,i):n.slideTo(n.activeIndex+l,e,t,i)},slidePrev:function(e=this.params.speed,t=!0,i){const n=this,{params:r,snapGrid:s,slidesGrid:a,rtlTranslate:o,enabled:l,animating:c}=n;if(!l)return n;const h=n.virtual&&r.virtual.enabled;if(r.loop){if(c&&!h&&r.loopPreventsSliding)return!1;n.loopFix({direction:"prev"}),n._clientLeft=n.wrapperEl.clientLeft}function d(e){return e<0?-Math.floor(Math.abs(e)):Math.floor(e)}const u=d(o?n.translate:-n.translate),p=s.map((e=>d(e)));let f=s[p.indexOf(u)-1];if(void 0===f&&r.cssMode){let e;s.forEach(((t,i)=>{u>=t&&(e=i)})),void 0!==e&&(f=s[e>0?e-1:e])}let m=0;if(void 0!==f&&(m=a.indexOf(f),m<0&&(m=n.activeIndex-1),"auto"===r.slidesPerView&&1===r.slidesPerGroup&&r.slidesPerGroupAuto&&(m=m-n.slidesPerViewDynamic("previous",!0)+1,m=Math.max(m,0))),r.rewind&&n.isBeginning){const r=n.params.virtual&&n.params.virtual.enabled&&n.virtual?n.virtual.slides.length-1:n.slides.length-1;return n.slideTo(r,e,t,i)}return n.slideTo(m,e,t,i)},slideReset:function(e=this.params.speed,t=!0,i){return this.slideTo(this.activeIndex,e,t,i)},slideToClosest:function(e=this.params.speed,t=!0,i,n=.5){const r=this;let s=r.activeIndex;const a=Math.min(r.params.slidesPerGroupSkip,s),o=a+Math.floor((s-a)/r.params.slidesPerGroup),l=r.rtlTranslate?r.translate:-r.translate;if(l>=r.snapGrid[o]){const e=r.snapGrid[o];l-e>(r.snapGrid[o+1]-e)*n&&(s+=r.params.slidesPerGroup)}else{const e=r.snapGrid[o-1];l-e<=(r.snapGrid[o]-e)*n&&(s-=r.params.slidesPerGroup)}return s=Math.max(s,0),s=Math.min(s,r.slidesGrid.length-1),r.slideTo(s,e,t,i)},slideToClickedSlide:function(){const e=this,{params:t,slidesEl:i}=e,n="auto"===t.slidesPerView?e.slidesPerViewDynamic():t.slidesPerView;let r,s=e.clickedIndex;const a=e.isElement?"swiper-slide":`.${t.slideClass}`;if(t.loop){if(e.animating)return;r=parseInt(e.clickedSlide.getAttribute("data-swiper-slide-index"),10),t.centeredSlides?s<e.loopedSlides-n/2||s>e.slides.length-e.loopedSlides+n/2?(e.loopFix(),s=e.getSlideIndex(Eo(i,`${a}[data-swiper-slide-index="${r}"]`)[0]),go((()=>{e.slideTo(s)}))):e.slideTo(s):s>e.slides.length-n?(e.loopFix(),s=e.getSlideIndex(Eo(i,`${a}[data-swiper-slide-index="${r}"]`)[0]),go((()=>{e.slideTo(s)}))):e.slideTo(s)}else e.slideTo(s)}},Vo={loopCreate:function(e){const t=this,{params:i,slidesEl:n}=t;!i.loop||t.virtual&&t.params.virtual.enabled||(Eo(n,`.${i.slideClass}, swiper-slide`).forEach(((e,t)=>{e.setAttribute("data-swiper-slide-index",t)})),t.loopFix({slideRealIndex:e,direction:i.centeredSlides?void 0:"next"}))},loopFix:function({slideRealIndex:e,slideTo:t=!0,direction:i,setTranslate:n,activeSlideIndex:r,byController:s,byMousewheel:a}={}){const o=this;if(!o.params.loop)return;o.emit("beforeLoopFix");const{slides:l,allowSlidePrev:c,allowSlideNext:h,slidesEl:d,params:u}=o;if(o.allowSlidePrev=!0,o.allowSlideNext=!0,o.virtual&&u.virtual.enabled)return t&&(u.centeredSlides||0!==o.snapIndex?u.centeredSlides&&o.snapIndex<u.slidesPerView?o.slideTo(o.virtual.slides.length+o.snapIndex,0,!1,!0):o.snapIndex===o.snapGrid.length-1&&o.slideTo(o.virtual.slidesBefore,0,!1,!0):o.slideTo(o.virtual.slides.length,0,!1,!0)),o.allowSlidePrev=c,o.allowSlideNext=h,void o.emit("loopFix");const p="auto"===u.slidesPerView?o.slidesPerViewDynamic():Math.ceil(parseFloat(u.slidesPerView,10));let f=u.loopedSlides||p;f%u.slidesPerGroup!=0&&(f+=u.slidesPerGroup-f%u.slidesPerGroup),o.loopedSlides=f;const m=[],g=[];let v=o.activeIndex;void 0===r?r=o.getSlideIndex(o.slides.filter((e=>e.classList.contains(u.slideActiveClass)))[0]):v=r;const _="next"===i||!i,y="prev"===i||!i;let b=0,x=0;if(r<f){b=Math.max(f-r,u.slidesPerGroup);for(let e=0;e<f-r;e+=1){const t=e-Math.floor(e/l.length)*l.length;m.push(l.length-t-1)}}else if(r>o.slides.length-2*f){x=Math.max(r-(o.slides.length-2*f),u.slidesPerGroup);for(let e=0;e<x;e+=1){const t=e-Math.floor(e/l.length)*l.length;g.push(t)}}if(y&&m.forEach((e=>{d.prepend(o.slides[e])})),_&&g.forEach((e=>{d.append(o.slides[e])})),o.recalcSlides(),"auto"===u.slidesPerView&&o.updateSlides(),u.watchSlidesProgress&&o.updateSlidesOffset(),t)if(m.length>0&&y)if(void 0===e){const e=o.slidesGrid[v],t=o.slidesGrid[v+b]-e;a?o.setTranslate(o.translate-t):(o.slideTo(v+b,0,!1,!0),n&&(o.touches[o.isHorizontal()?"startX":"startY"]+=t))}else n&&o.slideToLoop(e,0,!1,!0);else if(g.length>0&&_)if(void 0===e){const e=o.slidesGrid[v],t=o.slidesGrid[v-x]-e;a?o.setTranslate(o.translate-t):(o.slideTo(v-x,0,!1,!0),n&&(o.touches[o.isHorizontal()?"startX":"startY"]+=t))}else o.slideToLoop(e,0,!1,!0);if(o.allowSlidePrev=c,o.allowSlideNext=h,o.controller&&o.controller.control&&!s){const t={slideRealIndex:e,slideTo:!1,direction:i,setTranslate:n,activeSlideIndex:r,byController:!0};Array.isArray(o.controller.control)?o.controller.control.forEach((e=>{!e.destroyed&&e.params.loop&&e.loopFix(t)})):o.controller.control instanceof o.constructor&&o.controller.control.params.loop&&o.controller.control.loopFix(t)}o.emit("loopFix")},loopDestroy:function(){const e=this,{params:t,slidesEl:i}=e;if(!t.loop||e.virtual&&e.params.virtual.enabled)return;e.recalcSlides();const n=[];e.slides.forEach((e=>{const t=void 0===e.swiperSlideIndex?1*e.getAttribute("data-swiper-slide-index"):e.swiperSlideIndex;n[t]=e})),e.slides.forEach((e=>{e.removeAttribute("data-swiper-slide-index")})),n.forEach((e=>{i.append(e)})),e.recalcSlides(),e.slideTo(e.realIndex,0)}};function jo(e){const t=this,i=po(),n=mo(),r=t.touchEventsData;r.evCache.push(e);const{params:s,touches:a,enabled:o}=t;if(!o)return;if(!s.simulateTouch&&"mouse"===e.pointerType)return;if(t.animating&&s.preventInteractionOnTransition)return;!t.animating&&s.cssMode&&s.loop&&t.loopFix();let l=e;l.originalEvent&&(l=l.originalEvent);let c=l.target;if("wrapper"===s.touchEventsTarget&&!t.wrapperEl.contains(c))return;if("which"in l&&3===l.which)return;if("button"in l&&l.button>0)return;if(r.isTouched&&r.isMoved)return;const h=!!s.noSwipingClass&&""!==s.noSwipingClass,d=e.composedPath?e.composedPath():e.path;h&&l.target&&l.target.shadowRoot&&d&&(c=d[0]);const u=s.noSwipingSelector?s.noSwipingSelector:`.${s.noSwipingClass}`,p=!(!l.target||!l.target.shadowRoot);if(s.noSwiping&&(p?function(e,t=this){return function t(i){if(!i||i===po()||i===mo())return null;i.assignedSlot&&(i=i.assignedSlot);const n=i.closest(e);return n||i.getRootNode?n||t(i.getRootNode().host):null}(t)}(u,c):c.closest(u)))return void(t.allowClick=!0);if(s.swipeHandler&&!c.closest(s.swipeHandler))return;a.currentX=l.pageX,a.currentY=l.pageY;const f=a.currentX,m=a.currentY,g=s.edgeSwipeDetection||s.iOSEdgeSwipeDetection,v=s.edgeSwipeThreshold||s.iOSEdgeSwipeThreshold;if(g&&(f<=v||f>=n.innerWidth-v)){if("prevent"!==g)return;e.preventDefault()}Object.assign(r,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),a.startX=f,a.startY=m,r.touchStartTime=vo(),t.allowClick=!0,t.updateSize(),t.swipeDirection=void 0,s.threshold>0&&(r.allowThresholdMove=!1);let _=!0;c.matches(r.focusableElements)&&(_=!1,"SELECT"===c.nodeName&&(r.isTouched=!1)),i.activeElement&&i.activeElement.matches(r.focusableElements)&&i.activeElement!==c&&i.activeElement.blur();const y=_&&t.allowTouchMove&&s.touchStartPreventDefault;!s.touchStartForcePreventDefault&&!y||c.isContentEditable||l.preventDefault(),t.params.freeMode&&t.params.freeMode.enabled&&t.freeMode&&t.animating&&!s.cssMode&&t.freeMode.onTouchStart(),t.emit("touchStart",l)}function Go(e){const t=po(),i=this,n=i.touchEventsData,{params:r,touches:s,rtlTranslate:a,enabled:o}=i;if(!o)return;if(!r.simulateTouch&&"mouse"===e.pointerType)return;let l=e;if(l.originalEvent&&(l=l.originalEvent),!n.isTouched)return void(n.startMoving&&n.isScrolling&&i.emit("touchMoveOpposite",l));const c=n.evCache.findIndex((e=>e.pointerId===l.pointerId));c>=0&&(n.evCache[c]=l);const h=n.evCache.length>1?n.evCache[0]:l,d=h.pageX,u=h.pageY;if(l.preventedByNestedSwiper)return s.startX=d,void(s.startY=u);if(!i.allowTouchMove)return l.target.matches(n.focusableElements)||(i.allowClick=!1),void(n.isTouched&&(Object.assign(s,{startX:d,startY:u,prevX:i.touches.currentX,prevY:i.touches.currentY,currentX:d,currentY:u}),n.touchStartTime=vo()));if(r.touchReleaseOnEdges&&!r.loop)if(i.isVertical()){if(u<s.startY&&i.translate<=i.maxTranslate()||u>s.startY&&i.translate>=i.minTranslate())return n.isTouched=!1,void(n.isMoved=!1)}else if(d<s.startX&&i.translate<=i.maxTranslate()||d>s.startX&&i.translate>=i.minTranslate())return;if(t.activeElement&&l.target===t.activeElement&&l.target.matches(n.focusableElements))return n.isMoved=!0,void(i.allowClick=!1);if(n.allowTouchCallbacks&&i.emit("touchMove",l),l.targetTouches&&l.targetTouches.length>1)return;s.currentX=d,s.currentY=u;const p=s.currentX-s.startX,f=s.currentY-s.startY;if(i.params.threshold&&Math.sqrt(p**2+f**2)<i.params.threshold)return;if(void 0===n.isScrolling){let e;i.isHorizontal()&&s.currentY===s.startY||i.isVertical()&&s.currentX===s.startX?n.isScrolling=!1:p*p+f*f>=25&&(e=180*Math.atan2(Math.abs(f),Math.abs(p))/Math.PI,n.isScrolling=i.isHorizontal()?e>r.touchAngle:90-e>r.touchAngle)}if(n.isScrolling&&i.emit("touchMoveOpposite",l),void 0===n.startMoving&&(s.currentX===s.startX&&s.currentY===s.startY||(n.startMoving=!0)),n.isScrolling||i.zoom&&i.params.zoom&&i.params.zoom.enabled&&n.evCache.length>1)return void(n.isTouched=!1);if(!n.startMoving)return;i.allowClick=!1,!r.cssMode&&l.cancelable&&l.preventDefault(),r.touchMoveStopPropagation&&!r.nested&&l.stopPropagation();let m=i.isHorizontal()?p:f,g=i.isHorizontal()?s.currentX-s.previousX:s.currentY-s.previousY;r.oneWayMovement&&(m=Math.abs(m)*(a?1:-1),g=Math.abs(g)*(a?1:-1)),s.diff=m,m*=r.touchRatio,a&&(m=-m,g=-g);const v=i.touchesDirection;i.swipeDirection=m>0?"prev":"next",i.touchesDirection=g>0?"prev":"next";const _=i.params.loop&&!r.cssMode;if(!n.isMoved){if(_&&i.loopFix({direction:i.swipeDirection}),n.startTranslate=i.getTranslate(),i.setTransition(0),i.animating){const e=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0});i.wrapperEl.dispatchEvent(e)}n.allowMomentumBounce=!1,!r.grabCursor||!0!==i.allowSlideNext&&!0!==i.allowSlidePrev||i.setGrabCursor(!0),i.emit("sliderFirstMove",l)}let y;n.isMoved&&v!==i.touchesDirection&&_&&Math.abs(m)>=1&&(i.loopFix({direction:i.swipeDirection,setTranslate:!0}),y=!0),i.emit("sliderMove",l),n.isMoved=!0,n.currentTranslate=m+n.startTranslate;let b=!0,x=r.resistanceRatio;if(r.touchReleaseOnEdges&&(x=0),m>0?(_&&!y&&n.currentTranslate>(r.centeredSlides?i.minTranslate()-i.size/2:i.minTranslate())&&i.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),n.currentTranslate>i.minTranslate()&&(b=!1,r.resistance&&(n.currentTranslate=i.minTranslate()-1+(-i.minTranslate()+n.startTranslate+m)**x))):m<0&&(_&&!y&&n.currentTranslate<(r.centeredSlides?i.maxTranslate()+i.size/2:i.maxTranslate())&&i.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:i.slides.length-("auto"===r.slidesPerView?i.slidesPerViewDynamic():Math.ceil(parseFloat(r.slidesPerView,10)))}),n.currentTranslate<i.maxTranslate()&&(b=!1,r.resistance&&(n.currentTranslate=i.maxTranslate()+1-(i.maxTranslate()-n.startTranslate-m)**x))),b&&(l.preventedByNestedSwiper=!0),!i.allowSlideNext&&"next"===i.swipeDirection&&n.currentTranslate<n.startTranslate&&(n.currentTranslate=n.startTranslate),!i.allowSlidePrev&&"prev"===i.swipeDirection&&n.currentTranslate>n.startTranslate&&(n.currentTranslate=n.startTranslate),i.allowSlidePrev||i.allowSlideNext||(n.currentTranslate=n.startTranslate),r.threshold>0){if(!(Math.abs(m)>r.threshold||n.allowThresholdMove))return void(n.currentTranslate=n.startTranslate);if(!n.allowThresholdMove)return n.allowThresholdMove=!0,s.startX=s.currentX,s.startY=s.currentY,n.currentTranslate=n.startTranslate,void(s.diff=i.isHorizontal()?s.currentX-s.startX:s.currentY-s.startY)}r.followFinger&&!r.cssMode&&((r.freeMode&&r.freeMode.enabled&&i.freeMode||r.watchSlidesProgress)&&(i.updateActiveIndex(),i.updateSlidesClasses()),i.params.freeMode&&r.freeMode.enabled&&i.freeMode&&i.freeMode.onTouchMove(),i.updateProgress(n.currentTranslate),i.setTranslate(n.currentTranslate))}function Wo(e){const t=this,i=t.touchEventsData,n=i.evCache.findIndex((t=>t.pointerId===e.pointerId));if(n>=0&&i.evCache.splice(n,1),["pointercancel","pointerout","pointerleave"].includes(e.type)&&("pointercancel"!==e.type||!t.browser.isSafari&&!t.browser.isWebView))return;const{params:r,touches:s,rtlTranslate:a,slidesGrid:o,enabled:l}=t;if(!l)return;if(!r.simulateTouch&&"mouse"===e.pointerType)return;let c=e;if(c.originalEvent&&(c=c.originalEvent),i.allowTouchCallbacks&&t.emit("touchEnd",c),i.allowTouchCallbacks=!1,!i.isTouched)return i.isMoved&&r.grabCursor&&t.setGrabCursor(!1),i.isMoved=!1,void(i.startMoving=!1);r.grabCursor&&i.isMoved&&i.isTouched&&(!0===t.allowSlideNext||!0===t.allowSlidePrev)&&t.setGrabCursor(!1);const h=vo(),d=h-i.touchStartTime;if(t.allowClick){const e=c.path||c.composedPath&&c.composedPath();t.updateClickedSlide(e&&e[0]||c.target),t.emit("tap click",c),d<300&&h-i.lastClickTime<300&&t.emit("doubleTap doubleClick",c)}if(i.lastClickTime=vo(),go((()=>{t.destroyed||(t.allowClick=!0)})),!i.isTouched||!i.isMoved||!t.swipeDirection||0===s.diff||i.currentTranslate===i.startTranslate)return i.isTouched=!1,i.isMoved=!1,void(i.startMoving=!1);let u;if(i.isTouched=!1,i.isMoved=!1,i.startMoving=!1,u=r.followFinger?a?t.translate:-t.translate:-i.currentTranslate,r.cssMode)return;if(t.params.freeMode&&r.freeMode.enabled)return void t.freeMode.onTouchEnd({currentPos:u});let p=0,f=t.slidesSizesGrid[0];for(let e=0;e<o.length;e+=e<r.slidesPerGroupSkip?1:r.slidesPerGroup){const t=e<r.slidesPerGroupSkip-1?1:r.slidesPerGroup;void 0!==o[e+t]?u>=o[e]&&u<o[e+t]&&(p=e,f=o[e+t]-o[e]):u>=o[e]&&(p=e,f=o[o.length-1]-o[o.length-2])}let m=null,g=null;r.rewind&&(t.isBeginning?g=t.params.virtual&&t.params.virtual.enabled&&t.virtual?t.virtual.slides.length-1:t.slides.length-1:t.isEnd&&(m=0));const v=(u-o[p])/f,_=p<r.slidesPerGroupSkip-1?1:r.slidesPerGroup;if(d>r.longSwipesMs){if(!r.longSwipes)return void t.slideTo(t.activeIndex);"next"===t.swipeDirection&&(v>=r.longSwipesRatio?t.slideTo(r.rewind&&t.isEnd?m:p+_):t.slideTo(p)),"prev"===t.swipeDirection&&(v>1-r.longSwipesRatio?t.slideTo(p+_):null!==g&&v<0&&Math.abs(v)>r.longSwipesRatio?t.slideTo(g):t.slideTo(p))}else{if(!r.shortSwipes)return void t.slideTo(t.activeIndex);!t.navigation||c.target!==t.navigation.nextEl&&c.target!==t.navigation.prevEl?("next"===t.swipeDirection&&t.slideTo(null!==m?m:p+_),"prev"===t.swipeDirection&&t.slideTo(null!==g?g:p)):c.target===t.navigation.nextEl?t.slideTo(p+_):t.slideTo(p)}}function Xo(){const e=this,{params:t,el:i}=e;if(i&&0===i.offsetWidth)return;t.breakpoints&&e.setBreakpoint();const{allowSlideNext:n,allowSlidePrev:r,snapGrid:s}=e,a=e.virtual&&e.params.virtual.enabled;e.allowSlideNext=!0,e.allowSlidePrev=!0,e.updateSize(),e.updateSlides(),e.updateSlidesClasses();const o=a&&t.loop;!("auto"===t.slidesPerView||t.slidesPerView>1)||!e.isEnd||e.isBeginning||e.params.centeredSlides||o?e.params.loop&&!a?e.slideToLoop(e.realIndex,0,!1,!0):e.slideTo(e.activeIndex,0,!1,!0):e.slideTo(e.slides.length-1,0,!1,!0),e.autoplay&&e.autoplay.running&&e.autoplay.paused&&(clearTimeout(e.autoplay.resizeTimeout),e.autoplay.resizeTimeout=setTimeout((()=>{e.autoplay&&e.autoplay.running&&e.autoplay.paused&&e.autoplay.resume()}),500)),e.allowSlidePrev=r,e.allowSlideNext=n,e.params.watchOverflow&&s!==e.snapGrid&&e.checkOverflow()}function qo(e){const t=this;t.enabled&&(t.allowClick||(t.params.preventClicks&&e.preventDefault(),t.params.preventClicksPropagation&&t.animating&&(e.stopPropagation(),e.stopImmediatePropagation())))}function Yo(){const e=this,{wrapperEl:t,rtlTranslate:i,enabled:n}=e;if(!n)return;let r;e.previousTranslate=e.translate,e.isHorizontal()?e.translate=-t.scrollLeft:e.translate=-t.scrollTop,0===e.translate&&(e.translate=0),e.updateActiveIndex(),e.updateSlidesClasses();const s=e.maxTranslate()-e.minTranslate();r=0===s?0:(e.translate-e.minTranslate())/s,r!==e.progress&&e.updateProgress(i?-e.translate:e.translate),e.emit("setTranslate",e.translate,!1)}function $o(e){Do(this,e.target),this.update()}let Zo=!1;function Ko(){}const Jo=(e,t)=>{const i=po(),{params:n,el:r,wrapperEl:s,device:a}=e,o=!!n.nested,l="on"===t?"addEventListener":"removeEventListener",c=t;r[l]("pointerdown",e.onTouchStart,{passive:!1}),i[l]("pointermove",e.onTouchMove,{passive:!1,capture:o}),i[l]("pointerup",e.onTouchEnd,{passive:!0}),i[l]("pointercancel",e.onTouchEnd,{passive:!0}),i[l]("pointerout",e.onTouchEnd,{passive:!0}),i[l]("pointerleave",e.onTouchEnd,{passive:!0}),(n.preventClicks||n.preventClicksPropagation)&&r[l]("click",e.onClick,!0),n.cssMode&&s[l]("scroll",e.onScroll),n.updateOnWindowResize?e[c](a.ios||a.android?"resize orientationchange observerUpdate":"resize observerUpdate",Xo,!0):e[c]("observerUpdate",Xo,!0),r[l]("load",e.onLoad,{capture:!0})},Qo=(e,t)=>e.grid&&t.grid&&t.grid.rows>1,el={setBreakpoint:function(){const e=this,{realIndex:t,initialized:i,params:n,el:r}=e,s=n.breakpoints;if(!s||s&&0===Object.keys(s).length)return;const a=e.getBreakpoint(s,e.params.breakpointsBase,e.el);if(!a||e.currentBreakpoint===a)return;const o=(a in s?s[a]:void 0)||e.originalParams,l=Qo(e,n),c=Qo(e,o),h=n.enabled;l&&!c?(r.classList.remove(`${n.containerModifierClass}grid`,`${n.containerModifierClass}grid-column`),e.emitContainerClasses()):!l&&c&&(r.classList.add(`${n.containerModifierClass}grid`),(o.grid.fill&&"column"===o.grid.fill||!o.grid.fill&&"column"===n.grid.fill)&&r.classList.add(`${n.containerModifierClass}grid-column`),e.emitContainerClasses()),["navigation","pagination","scrollbar"].forEach((t=>{const i=n[t]&&n[t].enabled,r=o[t]&&o[t].enabled;i&&!r&&e[t].disable(),!i&&r&&e[t].enable()}));const d=o.direction&&o.direction!==n.direction,u=n.loop&&(o.slidesPerView!==n.slidesPerView||d);d&&i&&e.changeDirection(),yo(e.params,o);const p=e.params.enabled;Object.assign(e,{allowTouchMove:e.params.allowTouchMove,allowSlideNext:e.params.allowSlideNext,allowSlidePrev:e.params.allowSlidePrev}),h&&!p?e.disable():!h&&p&&e.enable(),e.currentBreakpoint=a,e.emit("_beforeBreakpoint",o),u&&i&&(e.loopDestroy(),e.loopCreate(t),e.updateSlides()),e.emit("breakpoint",o)},getBreakpoint:function(e,t="window",i){if(!e||"container"===t&&!i)return;let n=!1;const r=mo(),s="window"===t?r.innerHeight:i.clientHeight,a=Object.keys(e).map((e=>{if("string"==typeof e&&0===e.indexOf("@")){const t=parseFloat(e.substr(1));return{value:s*t,point:e}}return{value:e,point:e}}));a.sort(((e,t)=>parseInt(e.value,10)-parseInt(t.value,10)));for(let e=0;e<a.length;e+=1){const{point:s,value:o}=a[e];"window"===t?r.matchMedia(`(min-width: ${o}px)`).matches&&(n=s):o<=i.clientWidth&&(n=s)}return n||"max"}},tl={init:!0,direction:"horizontal",oneWayMovement:!1,touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopedSlides:null,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function il(e,t){return function(i={}){const n=Object.keys(i)[0],r=i[n];"object"==typeof r&&null!==r?(["navigation","pagination","scrollbar"].indexOf(n)>=0&&!0===e[n]&&(e[n]={auto:!0}),n in e&&"enabled"in r?(!0===e[n]&&(e[n]={enabled:!0}),"object"!=typeof e[n]||"enabled"in e[n]||(e[n].enabled=!0),e[n]||(e[n]={enabled:!1}),yo(t,i)):yo(t,i)):yo(t,i)}}const nl={eventsEmitter:Io,update:Fo,translate:zo,transition:Ho,slide:Bo,loop:Vo,grabCursor:{setGrabCursor:function(e){const t=this;if(!t.params.simulateTouch||t.params.watchOverflow&&t.isLocked||t.params.cssMode)return;const i="container"===t.params.touchEventsTarget?t.el:t.wrapperEl;t.isElement&&(t.__preventObserver__=!0),i.style.cursor="move",i.style.cursor=e?"grabbing":"grab",t.isElement&&requestAnimationFrame((()=>{t.__preventObserver__=!1}))},unsetGrabCursor:function(){const e=this;e.params.watchOverflow&&e.isLocked||e.params.cssMode||(e.isElement&&(e.__preventObserver__=!0),e["container"===e.params.touchEventsTarget?"el":"wrapperEl"].style.cursor="",e.isElement&&requestAnimationFrame((()=>{e.__preventObserver__=!1})))}},events:{attachEvents:function(){const e=this,t=po(),{params:i}=e;e.onTouchStart=jo.bind(e),e.onTouchMove=Go.bind(e),e.onTouchEnd=Wo.bind(e),i.cssMode&&(e.onScroll=Yo.bind(e)),e.onClick=qo.bind(e),e.onLoad=$o.bind(e),Zo||(t.addEventListener("touchstart",Ko),Zo=!0),Jo(e,"on")},detachEvents:function(){Jo(this,"off")}},breakpoints:el,checkOverflow:{checkOverflow:function(){const e=this,{isLocked:t,params:i}=e,{slidesOffsetBefore:n}=i;if(n){const t=e.slides.length-1,i=e.slidesGrid[t]+e.slidesSizesGrid[t]+2*n;e.isLocked=e.size>i}else e.isLocked=1===e.snapGrid.length;!0===i.allowSlideNext&&(e.allowSlideNext=!e.isLocked),!0===i.allowSlidePrev&&(e.allowSlidePrev=!e.isLocked),t&&t!==e.isLocked&&(e.isEnd=!1),t!==e.isLocked&&e.emit(e.isLocked?"lock":"unlock")}},classes:{addClasses:function(){const e=this,{classNames:t,params:i,rtl:n,el:r,device:s}=e,a=function(e,t){const i=[];return e.forEach((e=>{"object"==typeof e?Object.keys(e).forEach((n=>{e[n]&&i.push(t+n)})):"string"==typeof e&&i.push(t+e)})),i}(["initialized",i.direction,{"free-mode":e.params.freeMode&&i.freeMode.enabled},{autoheight:i.autoHeight},{rtl:n},{grid:i.grid&&i.grid.rows>1},{"grid-column":i.grid&&i.grid.rows>1&&"column"===i.grid.fill},{android:s.android},{ios:s.ios},{"css-mode":i.cssMode},{centered:i.cssMode&&i.centeredSlides},{"watch-progress":i.watchSlidesProgress}],i.containerModifierClass);t.push(...a),r.classList.add(...t),e.emitContainerClasses()},removeClasses:function(){const{el:e,classNames:t}=this;e.classList.remove(...t),this.emitContainerClasses()}}},rl={};class sl{constructor(...e){let t,i;1===e.length&&e[0].constructor&&"Object"===Object.prototype.toString.call(e[0]).slice(8,-1)?i=e[0]:[t,i]=e,i||(i={}),i=yo({},i),t&&!i.el&&(i.el=t);const n=po();if(i.el&&"string"==typeof i.el&&n.querySelectorAll(i.el).length>1){const e=[];return n.querySelectorAll(i.el).forEach((t=>{const n=yo({},i,{el:t});e.push(new sl(n))})),e}const r=this;r.__swiper__=!0,r.support=Oo(),r.device=function(e={}){return Po||(Po=function({userAgent:e}={}){const t=Oo(),i=mo(),n=i.navigator.platform,r=e||i.navigator.userAgent,s={ios:!1,android:!1},a=i.screen.width,o=i.screen.height,l=r.match(/(Android);?[\s\/]+([\d.]+)?/);let c=r.match(/(iPad).*OS\s([\d_]+)/);const h=r.match(/(iPod)(.*OS\s([\d_]+))?/),d=!c&&r.match(/(iPhone\sOS|iOS)\s([\d_]+)/),u="Win32"===n;let p="MacIntel"===n;return!c&&p&&t.touch&&["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"].indexOf(`${a}x${o}`)>=0&&(c=r.match(/(Version)\/([\d.]+)/),c||(c=[0,1,"13_0_0"]),p=!1),l&&!u&&(s.os="android",s.android=!0),(c||d||h)&&(s.os="ios",s.ios=!0),s}(e)),Po}({userAgent:i.userAgent}),r.browser=(Ro||(Ro=function(){const e=mo();let t=!1;function i(){const t=e.navigator.userAgent.toLowerCase();return t.indexOf("safari")>=0&&t.indexOf("chrome")<0&&t.indexOf("android")<0}if(i()){const i=String(e.navigator.userAgent);if(i.includes("Version/")){const[e,n]=i.split("Version/")[1].split(" ")[0].split(".").map((e=>Number(e)));t=e<16||16===e&&n<2}}return{isSafari:t||i(),needPerspectiveFix:t,isWebView:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(e.navigator.userAgent)}}()),Ro),r.eventsListeners={},r.eventsAnyListeners=[],r.modules=[...r.__modules__],i.modules&&Array.isArray(i.modules)&&r.modules.push(...i.modules);const s={};r.modules.forEach((e=>{e({params:i,swiper:r,extendParams:il(i,s),on:r.on.bind(r),once:r.once.bind(r),off:r.off.bind(r),emit:r.emit.bind(r)})}));const a=yo({},tl,s);return r.params=yo({},a,rl,i),r.originalParams=yo({},r.params),r.passedParams=yo({},i),r.params&&r.params.on&&Object.keys(r.params.on).forEach((e=>{r.on(e,r.params.on[e])})),r.params&&r.params.onAny&&r.onAny(r.params.onAny),Object.assign(r,{enabled:r.params.enabled,el:t,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal:()=>"horizontal"===r.params.direction,isVertical:()=>"vertical"===r.params.direction,activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:r.params.allowSlideNext,allowSlidePrev:r.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:r.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,evCache:[]},allowClick:!0,allowTouchMove:r.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),r.emit("_swiper"),r.params.init&&r.init(),r}getSlideIndex(e){const{slidesEl:t,params:i}=this,n=Mo(Eo(t,`.${i.slideClass}, swiper-slide`)[0]);return Mo(e)-n}getSlideIndexByData(e){return this.getSlideIndex(this.slides.filter((t=>1*t.getAttribute("data-swiper-slide-index")===e))[0])}recalcSlides(){const{slidesEl:e,params:t}=this;this.slides=Eo(e,`.${t.slideClass}, swiper-slide`)}enable(){const e=this;e.enabled||(e.enabled=!0,e.params.grabCursor&&e.setGrabCursor(),e.emit("enable"))}disable(){const e=this;e.enabled&&(e.enabled=!1,e.params.grabCursor&&e.unsetGrabCursor(),e.emit("disable"))}setProgress(e,t){const i=this;e=Math.min(Math.max(e,0),1);const n=i.minTranslate(),r=(i.maxTranslate()-n)*e+n;i.translateTo(r,void 0===t?0:t),i.updateActiveIndex(),i.updateSlidesClasses()}emitContainerClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const t=e.el.className.split(" ").filter((t=>0===t.indexOf("swiper")||0===t.indexOf(e.params.containerModifierClass)));e.emit("_containerClasses",t.join(" "))}getSlideClasses(e){const t=this;return t.destroyed?"":e.className.split(" ").filter((e=>0===e.indexOf("swiper-slide")||0===e.indexOf(t.params.slideClass))).join(" ")}emitSlidesClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const t=[];e.slides.forEach((i=>{const n=e.getSlideClasses(i);t.push({slideEl:i,classNames:n}),e.emit("_slideClass",i,n)})),e.emit("_slideClasses",t)}slidesPerViewDynamic(e="current",t=!1){const{params:i,slides:n,slidesGrid:r,slidesSizesGrid:s,size:a,activeIndex:o}=this;let l=1;if(i.centeredSlides){let e,t=n[o].swiperSlideSize;for(let i=o+1;i<n.length;i+=1)n[i]&&!e&&(t+=n[i].swiperSlideSize,l+=1,t>a&&(e=!0));for(let i=o-1;i>=0;i-=1)n[i]&&!e&&(t+=n[i].swiperSlideSize,l+=1,t>a&&(e=!0))}else if("current"===e)for(let e=o+1;e<n.length;e+=1)(t?r[e]+s[e]-r[o]<a:r[e]-r[o]<a)&&(l+=1);else for(let e=o-1;e>=0;e-=1)r[o]-r[e]<a&&(l+=1);return l}update(){const e=this;if(!e||e.destroyed)return;const{snapGrid:t,params:i}=e;function n(){const t=e.rtlTranslate?-1*e.translate:e.translate,i=Math.min(Math.max(t,e.maxTranslate()),e.minTranslate());e.setTranslate(i),e.updateActiveIndex(),e.updateSlidesClasses()}let r;if(i.breakpoints&&e.setBreakpoint(),[...e.el.querySelectorAll('[loading="lazy"]')].forEach((t=>{t.complete&&Do(e,t)})),e.updateSize(),e.updateSlides(),e.updateProgress(),e.updateSlidesClasses(),e.params.freeMode&&e.params.freeMode.enabled)n(),e.params.autoHeight&&e.updateAutoHeight();else{if(("auto"===e.params.slidesPerView||e.params.slidesPerView>1)&&e.isEnd&&!e.params.centeredSlides){const t=e.virtual&&e.params.virtual.enabled?e.virtual.slides:e.slides;r=e.slideTo(t.length-1,0,!1,!0)}else r=e.slideTo(e.activeIndex,0,!1,!0);r||n()}i.watchOverflow&&t!==e.snapGrid&&e.checkOverflow(),e.emit("update")}changeDirection(e,t=!0){const i=this,n=i.params.direction;return e||(e="horizontal"===n?"vertical":"horizontal"),e===n||"horizontal"!==e&&"vertical"!==e||(i.el.classList.remove(`${i.params.containerModifierClass}${n}`),i.el.classList.add(`${i.params.containerModifierClass}${e}`),i.emitContainerClasses(),i.params.direction=e,i.slides.forEach((t=>{"vertical"===e?t.style.width="":t.style.height=""})),i.emit("changeDirection"),t&&i.update()),i}changeLanguageDirection(e){const t=this;t.rtl&&"rtl"===e||!t.rtl&&"ltr"===e||(t.rtl="rtl"===e,t.rtlTranslate="horizontal"===t.params.direction&&t.rtl,t.rtl?(t.el.classList.add(`${t.params.containerModifierClass}rtl`),t.el.dir="rtl"):(t.el.classList.remove(`${t.params.containerModifierClass}rtl`),t.el.dir="ltr"),t.update())}mount(e){const t=this;if(t.mounted)return!0;let i=e||t.params.el;if("string"==typeof i&&(i=document.querySelector(i)),!i)return!1;i.swiper=t,i.shadowEl&&(t.isElement=!0);const n=()=>`.${(t.params.wrapperClass||"").trim().split(" ").join(".")}`;let r=i&&i.shadowRoot&&i.shadowRoot.querySelector?i.shadowRoot.querySelector(n()):Eo(i,n())[0];return!r&&t.params.createElements&&(r=So("div",t.params.wrapperClass),i.append(r),Eo(i,`.${t.params.slideClass}`).forEach((e=>{r.append(e)}))),Object.assign(t,{el:i,wrapperEl:r,slidesEl:t.isElement?i:r,mounted:!0,rtl:"rtl"===i.dir.toLowerCase()||"rtl"===To(i,"direction"),rtlTranslate:"horizontal"===t.params.direction&&("rtl"===i.dir.toLowerCase()||"rtl"===To(i,"direction")),wrongRTL:"-webkit-box"===To(r,"display")}),!0}init(e){const t=this;return t.initialized||!1===t.mount(e)||(t.emit("beforeInit"),t.params.breakpoints&&t.setBreakpoint(),t.addClasses(),t.updateSize(),t.updateSlides(),t.params.watchOverflow&&t.checkOverflow(),t.params.grabCursor&&t.enabled&&t.setGrabCursor(),t.params.loop&&t.virtual&&t.params.virtual.enabled?t.slideTo(t.params.initialSlide+t.virtual.slidesBefore,0,t.params.runCallbacksOnInit,!1,!0):t.slideTo(t.params.initialSlide,0,t.params.runCallbacksOnInit,!1,!0),t.params.loop&&t.loopCreate(),t.attachEvents(),[...t.el.querySelectorAll('[loading="lazy"]')].forEach((e=>{e.complete?Do(t,e):e.addEventListener("load",(e=>{Do(t,e.target)}))})),Uo(t),t.initialized=!0,Uo(t),t.emit("init"),t.emit("afterInit")),t}destroy(e=!0,t=!0){const i=this,{params:n,el:r,wrapperEl:s,slides:a}=i;return void 0===i.params||i.destroyed||(i.emit("beforeDestroy"),i.initialized=!1,i.detachEvents(),n.loop&&i.loopDestroy(),t&&(i.removeClasses(),r.removeAttribute("style"),s.removeAttribute("style"),a&&a.length&&a.forEach((e=>{e.classList.remove(n.slideVisibleClass,n.slideActiveClass,n.slideNextClass,n.slidePrevClass),e.removeAttribute("style"),e.removeAttribute("data-swiper-slide-index")}))),i.emit("destroy"),Object.keys(i.eventsListeners).forEach((e=>{i.off(e)})),!1!==e&&(i.el.swiper=null,function(e){const t=e;Object.keys(t).forEach((e=>{try{t[e]=null}catch(e){}try{delete t[e]}catch(e){}}))}(i)),i.destroyed=!0),null}static extendDefaults(e){yo(rl,e)}static get extendedDefaults(){return rl}static get defaults(){return tl}static installModule(e){sl.prototype.__modules__||(sl.prototype.__modules__=[]);const t=sl.prototype.__modules__;"function"==typeof e&&t.indexOf(e)<0&&t.push(e)}static use(e){return Array.isArray(e)?(e.forEach((e=>sl.installModule(e))),sl):(sl.installModule(e),sl)}}Object.keys(nl).forEach((e=>{Object.keys(nl[e]).forEach((t=>{sl.prototype[t]=nl[e][t]}))})),sl.use([function({swiper:e,on:t,emit:i}){const n=mo();let r=null,s=null;const a=()=>{e&&!e.destroyed&&e.initialized&&(i("beforeResize"),i("resize"))},o=()=>{e&&!e.destroyed&&e.initialized&&i("orientationchange")};t("init",(()=>{e.params.resizeObserver&&void 0!==n.ResizeObserver?e&&!e.destroyed&&e.initialized&&(r=new ResizeObserver((t=>{s=n.requestAnimationFrame((()=>{const{width:i,height:n}=e;let r=i,s=n;t.forEach((({contentBoxSize:t,contentRect:i,target:n})=>{n&&n!==e.el||(r=i?i.width:(t[0]||t).inlineSize,s=i?i.height:(t[0]||t).blockSize)})),r===i&&s===n||a()}))})),r.observe(e.el)):(n.addEventListener("resize",a),n.addEventListener("orientationchange",o))})),t("destroy",(()=>{s&&n.cancelAnimationFrame(s),r&&r.unobserve&&e.el&&(r.unobserve(e.el),r=null),n.removeEventListener("resize",a),n.removeEventListener("orientationchange",o)}))},function({swiper:e,extendParams:t,on:i,emit:n}){const r=[],s=mo(),a=(t,i={})=>{const a=new(s.MutationObserver||s.WebkitMutationObserver)((t=>{if(e.__preventObserver__)return;if(1===t.length)return void n("observerUpdate",t[0]);const i=function(){n("observerUpdate",t[0])};s.requestAnimationFrame?s.requestAnimationFrame(i):s.setTimeout(i,0)}));a.observe(t,{attributes:void 0===i.attributes||i.attributes,childList:void 0===i.childList||i.childList,characterData:void 0===i.characterData||i.characterData}),r.push(a)};t({observer:!1,observeParents:!1,observeSlideChildren:!1}),i("init",(()=>{if(e.params.observer){if(e.params.observeParents){const t=Ao(e.el);for(let e=0;e<t.length;e+=1)a(t[e])}a(e.el,{childList:e.params.observeSlideChildren}),a(e.wrapperEl,{attributes:!1})}})),i("destroy",(()=>{r.forEach((e=>{e.disconnect()})),r.splice(0,r.length)}))}]);const al=sl;function ol(e,t,i,n){return e.params.createElements&&Object.keys(n).forEach((r=>{if(!i[r]&&!0===i.auto){let s=Eo(e.el,`.${n[r]}`)[0];s||(s=So("div",n[r]),s.className=n[r],e.el.append(s)),i[r]=s,t[r]=s}})),i}function ll({swiper:e,extendParams:t,on:i,emit:n}){t({navigation:{nextEl:null,prevEl:null,hideOnClick:!1,disabledClass:"swiper-button-disabled",hiddenClass:"swiper-button-hidden",lockClass:"swiper-button-lock",navigationDisabledClass:"swiper-navigation-disabled"}}),e.navigation={nextEl:null,prevEl:null};const r=e=>(Array.isArray(e)||(e=[e].filter((e=>!!e))),e);function s(t){let i;return t&&"string"==typeof t&&e.isElement&&(i=e.el.shadowRoot.querySelector(t),i)?i:(t&&("string"==typeof t&&(i=[...document.querySelectorAll(t)]),e.params.uniqueNavElements&&"string"==typeof t&&i.length>1&&1===e.el.querySelectorAll(t).length&&(i=e.el.querySelector(t))),t&&!i?t:i)}function a(t,i){const n=e.params.navigation;(t=r(t)).forEach((t=>{t&&(t.classList[i?"add":"remove"](...n.disabledClass.split(" ")),"BUTTON"===t.tagName&&(t.disabled=i),e.params.watchOverflow&&e.enabled&&t.classList[e.isLocked?"add":"remove"](n.lockClass))}))}function o(){const{nextEl:t,prevEl:i}=e.navigation;if(e.params.loop)return a(i,!1),void a(t,!1);a(i,e.isBeginning&&!e.params.rewind),a(t,e.isEnd&&!e.params.rewind)}function l(t){t.preventDefault(),(!e.isBeginning||e.params.loop||e.params.rewind)&&(e.slidePrev(),n("navigationPrev"))}function c(t){t.preventDefault(),(!e.isEnd||e.params.loop||e.params.rewind)&&(e.slideNext(),n("navigationNext"))}function h(){const t=e.params.navigation;if(e.params.navigation=ol(e,e.originalParams.navigation,e.params.navigation,{nextEl:"swiper-button-next",prevEl:"swiper-button-prev"}),!t.nextEl&&!t.prevEl)return;let i=s(t.nextEl),n=s(t.prevEl);Object.assign(e.navigation,{nextEl:i,prevEl:n}),i=r(i),n=r(n);const a=(i,n)=>{i&&i.addEventListener("click","next"===n?c:l),!e.enabled&&i&&i.classList.add(...t.lockClass.split(" "))};i.forEach((e=>a(e,"next"))),n.forEach((e=>a(e,"prev")))}function d(){let{nextEl:t,prevEl:i}=e.navigation;t=r(t),i=r(i);const n=(t,i)=>{t.removeEventListener("click","next"===i?c:l),t.classList.remove(...e.params.navigation.disabledClass.split(" "))};t.forEach((e=>n(e,"next"))),i.forEach((e=>n(e,"prev")))}i("init",(()=>{!1===e.params.navigation.enabled?u():(h(),o())})),i("toEdge fromEdge lock unlock",(()=>{o()})),i("destroy",(()=>{d()})),i("enable disable",(()=>{let{nextEl:t,prevEl:i}=e.navigation;t=r(t),i=r(i),[...t,...i].filter((e=>!!e)).forEach((t=>t.classList[e.enabled?"remove":"add"](e.params.navigation.lockClass)))})),i("click",((t,i)=>{let{nextEl:s,prevEl:a}=e.navigation;s=r(s),a=r(a);const o=i.target;if(e.params.navigation.hideOnClick&&!a.includes(o)&&!s.includes(o)){if(e.pagination&&e.params.pagination&&e.params.pagination.clickable&&(e.pagination.el===o||e.pagination.el.contains(o)))return;let t;s.length?t=s[0].classList.contains(e.params.navigation.hiddenClass):a.length&&(t=a[0].classList.contains(e.params.navigation.hiddenClass)),n(!0===t?"navigationShow":"navigationHide"),[...s,...a].filter((e=>!!e)).forEach((t=>t.classList.toggle(e.params.navigation.hiddenClass)))}}));const u=()=>{e.el.classList.add(...e.params.navigation.navigationDisabledClass.split(" ")),d()};Object.assign(e.navigation,{enable:()=>{e.el.classList.remove(...e.params.navigation.navigationDisabledClass.split(" ")),h(),o()},disable:u,update:o,init:h,destroy:d})}function cl(e=""){return`.${e.trim().replace(/([\.:!+\/])/g,"\\$1").replace(/ /g,".")}`}function hl({swiper:e,extendParams:t,on:i,emit:n}){const r="swiper-pagination";let s;t({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:e=>e,formatFractionTotal:e=>e,bulletClass:`${r}-bullet`,bulletActiveClass:`${r}-bullet-active`,modifierClass:`${r}-`,currentClass:`${r}-current`,totalClass:`${r}-total`,hiddenClass:`${r}-hidden`,progressbarFillClass:`${r}-progressbar-fill`,progressbarOppositeClass:`${r}-progressbar-opposite`,clickableClass:`${r}-clickable`,lockClass:`${r}-lock`,horizontalClass:`${r}-horizontal`,verticalClass:`${r}-vertical`,paginationDisabledClass:`${r}-disabled`}}),e.pagination={el:null,bullets:[]};let a=0;const o=e=>(Array.isArray(e)||(e=[e].filter((e=>!!e))),e);function l(){return!e.params.pagination.el||!e.pagination.el||Array.isArray(e.pagination.el)&&0===e.pagination.el.length}function c(t,i){const{bulletActiveClass:n}=e.params.pagination;t&&(t=t[("prev"===i?"previous":"next")+"ElementSibling"])&&(t.classList.add(`${n}-${i}`),(t=t[("prev"===i?"previous":"next")+"ElementSibling"])&&t.classList.add(`${n}-${i}-${i}`))}function h(t){const i=t.target.closest(cl(e.params.pagination.bulletClass));if(!i)return;t.preventDefault();const n=Mo(i)*e.params.slidesPerGroup;if(e.params.loop){if(e.realIndex===n)return;const t=e.getSlideIndexByData(n),i=e.getSlideIndexByData(e.realIndex);t>e.slides.length-e.loopedSlides&&e.loopFix({direction:t>i?"next":"prev",activeSlideIndex:t,slideTo:!1}),e.slideToLoop(n)}else e.slideTo(n)}function d(){const t=e.rtl,i=e.params.pagination;if(l())return;let r,h,d=e.pagination.el;d=o(d);const u=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.slides.length,p=e.params.loop?Math.ceil(u/e.params.slidesPerGroup):e.snapGrid.length;if(e.params.loop?(h=e.previousRealIndex||0,r=e.params.slidesPerGroup>1?Math.floor(e.realIndex/e.params.slidesPerGroup):e.realIndex):void 0!==e.snapIndex?(r=e.snapIndex,h=e.previousSnapIndex):(h=e.previousIndex||0,r=e.activeIndex||0),"bullets"===i.type&&e.pagination.bullets&&e.pagination.bullets.length>0){const n=e.pagination.bullets;let o,l,u;if(i.dynamicBullets&&(s=Co(n[0],e.isHorizontal()?"width":"height",!0),d.forEach((t=>{t.style[e.isHorizontal()?"width":"height"]=s*(i.dynamicMainBullets+4)+"px"})),i.dynamicMainBullets>1&&void 0!==h&&(a+=r-(h||0),a>i.dynamicMainBullets-1?a=i.dynamicMainBullets-1:a<0&&(a=0)),o=Math.max(r-a,0),l=o+(Math.min(n.length,i.dynamicMainBullets)-1),u=(l+o)/2),n.forEach((e=>{const t=[...["","-next","-next-next","-prev","-prev-prev","-main"].map((e=>`${i.bulletActiveClass}${e}`))].map((e=>"string"==typeof e&&e.includes(" ")?e.split(" "):e)).flat();e.classList.remove(...t)})),d.length>1)n.forEach((e=>{const t=Mo(e);t===r&&e.classList.add(...i.bulletActiveClass.split(" ")),i.dynamicBullets&&(t>=o&&t<=l&&e.classList.add(...`${i.bulletActiveClass}-main`.split(" ")),t===o&&c(e,"prev"),t===l&&c(e,"next"))}));else{const e=n[r];if(e&&e.classList.add(...i.bulletActiveClass.split(" ")),i.dynamicBullets){const e=n[o],t=n[l];for(let e=o;e<=l;e+=1)n[e]&&n[e].classList.add(...`${i.bulletActiveClass}-main`.split(" "));c(e,"prev"),c(t,"next")}}if(i.dynamicBullets){const r=Math.min(n.length,i.dynamicMainBullets+4),a=(s*r-s)/2-u*s,o=t?"right":"left";n.forEach((t=>{t.style[e.isHorizontal()?o:"top"]=`${a}px`}))}}d.forEach(((t,s)=>{if("fraction"===i.type&&(t.querySelectorAll(cl(i.currentClass)).forEach((e=>{e.textContent=i.formatFractionCurrent(r+1)})),t.querySelectorAll(cl(i.totalClass)).forEach((e=>{e.textContent=i.formatFractionTotal(p)}))),"progressbar"===i.type){let n;n=i.progressbarOpposite?e.isHorizontal()?"vertical":"horizontal":e.isHorizontal()?"horizontal":"vertical";const s=(r+1)/p;let a=1,o=1;"horizontal"===n?a=s:o=s,t.querySelectorAll(cl(i.progressbarFillClass)).forEach((t=>{t.style.transform=`translate3d(0,0,0) scaleX(${a}) scaleY(${o})`,t.style.transitionDuration=`${e.params.speed}ms`}))}"custom"===i.type&&i.renderCustom?(t.innerHTML=i.renderCustom(e,r+1,p),0===s&&n("paginationRender",t)):(0===s&&n("paginationRender",t),n("paginationUpdate",t)),e.params.watchOverflow&&e.enabled&&t.classList[e.isLocked?"add":"remove"](i.lockClass)}))}function u(){const t=e.params.pagination;if(l())return;const i=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.slides.length;let r=e.pagination.el;r=o(r);let s="";if("bullets"===t.type){let n=e.params.loop?Math.ceil(i/e.params.slidesPerGroup):e.snapGrid.length;e.params.freeMode&&e.params.freeMode.enabled&&n>i&&(n=i);for(let i=0;i<n;i+=1)t.renderBullet?s+=t.renderBullet.call(e,i,t.bulletClass):s+=`<${t.bulletElement} class="${t.bulletClass}"></${t.bulletElement}>`}"fraction"===t.type&&(s=t.renderFraction?t.renderFraction.call(e,t.currentClass,t.totalClass):`<span class="${t.currentClass}"></span> / <span class="${t.totalClass}"></span>`),"progressbar"===t.type&&(s=t.renderProgressbar?t.renderProgressbar.call(e,t.progressbarFillClass):`<span class="${t.progressbarFillClass}"></span>`),e.pagination.bullets=[],r.forEach((i=>{"custom"!==t.type&&(i.innerHTML=s||""),"bullets"===t.type&&e.pagination.bullets.push(...i.querySelectorAll(cl(t.bulletClass)))})),"custom"!==t.type&&n("paginationRender",r[0])}function p(){e.params.pagination=ol(e,e.originalParams.pagination,e.params.pagination,{el:"swiper-pagination"});const t=e.params.pagination;if(!t.el)return;let i;"string"==typeof t.el&&e.isElement&&(i=e.el.shadowRoot.querySelector(t.el)),i||"string"!=typeof t.el||(i=[...document.querySelectorAll(t.el)]),i||(i=t.el),i&&0!==i.length&&(e.params.uniqueNavElements&&"string"==typeof t.el&&Array.isArray(i)&&i.length>1&&(i=[...e.el.querySelectorAll(t.el)],i.length>1&&(i=i.filter((t=>Ao(t,".swiper")[0]===e.el))[0])),Array.isArray(i)&&1===i.length&&(i=i[0]),Object.assign(e.pagination,{el:i}),i=o(i),i.forEach((i=>{"bullets"===t.type&&t.clickable&&i.classList.add(t.clickableClass),i.classList.add(t.modifierClass+t.type),i.classList.add(e.isHorizontal()?t.horizontalClass:t.verticalClass),"bullets"===t.type&&t.dynamicBullets&&(i.classList.add(`${t.modifierClass}${t.type}-dynamic`),a=0,t.dynamicMainBullets<1&&(t.dynamicMainBullets=1)),"progressbar"===t.type&&t.progressbarOpposite&&i.classList.add(t.progressbarOppositeClass),t.clickable&&i.addEventListener("click",h),e.enabled||i.classList.add(t.lockClass)})))}function f(){const t=e.params.pagination;if(l())return;let i=e.pagination.el;i&&(i=o(i),i.forEach((i=>{i.classList.remove(t.hiddenClass),i.classList.remove(t.modifierClass+t.type),i.classList.remove(e.isHorizontal()?t.horizontalClass:t.verticalClass),t.clickable&&i.removeEventListener("click",h)}))),e.pagination.bullets&&e.pagination.bullets.forEach((e=>e.classList.remove(...t.bulletActiveClass.split(" "))))}i("changeDirection",(()=>{if(!e.pagination||!e.pagination.el)return;const t=e.params.pagination;let{el:i}=e.pagination;i=o(i),i.forEach((i=>{i.classList.remove(t.horizontalClass,t.verticalClass),i.classList.add(e.isHorizontal()?t.horizontalClass:t.verticalClass)}))})),i("init",(()=>{!1===e.params.pagination.enabled?m():(p(),u(),d())})),i("activeIndexChange",(()=>{void 0===e.snapIndex&&d()})),i("snapIndexChange",(()=>{d()})),i("snapGridLengthChange",(()=>{u(),d()})),i("destroy",(()=>{f()})),i("enable disable",(()=>{let{el:t}=e.pagination;t&&(t=o(t),t.forEach((t=>t.classList[e.enabled?"remove":"add"](e.params.pagination.lockClass))))})),i("lock unlock",(()=>{d()})),i("click",((t,i)=>{const r=i.target;let{el:s}=e.pagination;if(Array.isArray(s)||(s=[s].filter((e=>!!e))),e.params.pagination.el&&e.params.pagination.hideOnClick&&s&&s.length>0&&!r.classList.contains(e.params.pagination.bulletClass)){if(e.navigation&&(e.navigation.nextEl&&r===e.navigation.nextEl||e.navigation.prevEl&&r===e.navigation.prevEl))return;const t=s[0].classList.contains(e.params.pagination.hiddenClass);n(!0===t?"paginationShow":"paginationHide"),s.forEach((t=>t.classList.toggle(e.params.pagination.hiddenClass)))}}));const m=()=>{e.el.classList.add(e.params.pagination.paginationDisabledClass);let{el:t}=e.pagination;t&&(t=o(t),t.forEach((t=>t.classList.add(e.params.pagination.paginationDisabledClass)))),f()};Object.assign(e.pagination,{enable:()=>{e.el.classList.remove(e.params.pagination.paginationDisabledClass);let{el:t}=e.pagination;t&&(t=o(t),t.forEach((t=>t.classList.remove(e.params.pagination.paginationDisabledClass)))),p(),u(),d()},disable:m,render:u,update:d,init:p,destroy:f})}function dl({swiper:e,extendParams:t,on:i,emit:n,params:r}){let s,a;e.autoplay={running:!1,paused:!1,timeLeft:0},t({autoplay:{enabled:!1,delay:3e3,waitForTransition:!0,disableOnInteraction:!0,stopOnLastSlide:!1,reverseDirection:!1,pauseOnMouseEnter:!1}});let o,l,c,h,d,u,p,f=r&&r.autoplay?r.autoplay.delay:3e3,m=r&&r.autoplay?r.autoplay.delay:3e3,g=(new Date).getTime;function v(t){e&&!e.destroyed&&e.wrapperEl&&t.target===e.wrapperEl&&(e.wrapperEl.removeEventListener("transitionend",v),E())}const _=()=>{if(e.destroyed||!e.autoplay.running)return;e.autoplay.paused?l=!0:l&&(m=o,l=!1);const t=e.autoplay.paused?o:g+m-(new Date).getTime();e.autoplay.timeLeft=t,n("autoplayTimeLeft",t,t/f),a=requestAnimationFrame((()=>{_()}))},y=t=>{if(e.destroyed||!e.autoplay.running)return;cancelAnimationFrame(a),_();let i=void 0===t?e.params.autoplay.delay:t;f=e.params.autoplay.delay,m=e.params.autoplay.delay;const r=(()=>{let t;if(t=e.virtual&&e.params.virtual.enabled?e.slides.filter((e=>e.classList.contains("swiper-slide-active")))[0]:e.slides[e.activeIndex],t)return parseInt(t.getAttribute("data-swiper-autoplay"),10)})();!Number.isNaN(r)&&r>0&&void 0===t&&(i=r,f=r,m=r),o=i;const l=e.params.speed,c=()=>{e&&!e.destroyed&&(e.params.autoplay.reverseDirection?!e.isBeginning||e.params.loop||e.params.rewind?(e.slidePrev(l,!0,!0),n("autoplay")):e.params.autoplay.stopOnLastSlide||(e.slideTo(e.slides.length-1,l,!0,!0),n("autoplay")):!e.isEnd||e.params.loop||e.params.rewind?(e.slideNext(l,!0,!0),n("autoplay")):e.params.autoplay.stopOnLastSlide||(e.slideTo(0,l,!0,!0),n("autoplay")),e.params.cssMode&&(g=(new Date).getTime(),requestAnimationFrame((()=>{y()}))))};return i>0?(clearTimeout(s),s=setTimeout((()=>{c()}),i)):requestAnimationFrame((()=>{c()})),i},b=()=>{e.autoplay.running=!0,y(),n("autoplayStart")},x=()=>{e.autoplay.running=!1,clearTimeout(s),cancelAnimationFrame(a),n("autoplayStop")},w=(t,i)=>{if(e.destroyed||!e.autoplay.running)return;clearTimeout(s),t||(p=!0);const r=()=>{n("autoplayPause"),e.params.autoplay.waitForTransition?e.wrapperEl.addEventListener("transitionend",v):E()};if(e.autoplay.paused=!0,i)return u&&(o=e.params.autoplay.delay),u=!1,void r();const a=o||e.params.autoplay.delay;o=a-((new Date).getTime()-g),e.isEnd&&o<0&&!e.params.loop||(o<0&&(o=0),r())},E=()=>{e.isEnd&&o<0&&!e.params.loop||e.destroyed||!e.autoplay.running||(g=(new Date).getTime(),p?(p=!1,y(o)):y(),e.autoplay.paused=!1,n("autoplayResume"))},S=()=>{if(e.destroyed||!e.autoplay.running)return;const t=po();"hidden"===t.visibilityState&&(p=!0,w(!0)),"visible"===t.visibilityState&&E()},T=e=>{"mouse"===e.pointerType&&(p=!0,w(!0))},M=t=>{"mouse"===t.pointerType&&e.autoplay.paused&&E()};i("init",(()=>{e.params.autoplay.enabled&&(e.params.autoplay.pauseOnMouseEnter&&(e.el.addEventListener("pointerenter",T),e.el.addEventListener("pointerleave",M)),po().addEventListener("visibilitychange",S),g=(new Date).getTime(),b())})),i("destroy",(()=>{e.el.removeEventListener("pointerenter",T),e.el.removeEventListener("pointerleave",M),po().removeEventListener("visibilitychange",S),e.autoplay.running&&x()})),i("beforeTransitionStart",((t,i,n)=>{!e.destroyed&&e.autoplay.running&&(n||!e.params.autoplay.disableOnInteraction?w(!0,!0):x())})),i("sliderFirstMove",(()=>{!e.destroyed&&e.autoplay.running&&(e.params.autoplay.disableOnInteraction?x():(c=!0,h=!1,p=!1,d=setTimeout((()=>{p=!0,h=!0,w(!0)}),200)))})),i("touchEnd",(()=>{if(!e.destroyed&&e.autoplay.running&&c){if(clearTimeout(d),clearTimeout(s),e.params.autoplay.disableOnInteraction)return h=!1,void(c=!1);h&&e.params.cssMode&&E(),h=!1,c=!1}})),i("slideChange",(()=>{!e.destroyed&&e.autoplay.running&&(u=!0)})),Object.assign(e.autoplay,{start:b,stop:x,pause:w,resume:E})}function ul(e,t){const i=wo(t);return i!==t&&(i.style.backfaceVisibility="hidden",i.style["-webkit-backface-visibility"]="hidden"),i}function pl({swiper:e,extendParams:t,on:i}){t({fadeEffect:{crossFade:!1}}),function(e){const{effect:t,swiper:i,on:n,setTranslate:r,setTransition:s,overwriteParams:a,perspective:o,recreateShadows:l,getEffectParams:c}=e;let h;n("beforeInit",(()=>{if(i.params.effect!==t)return;i.classNames.push(`${i.params.containerModifierClass}${t}`),o&&o()&&i.classNames.push(`${i.params.containerModifierClass}3d`);const e=a?a():{};Object.assign(i.params,e),Object.assign(i.originalParams,e)})),n("setTranslate",(()=>{i.params.effect===t&&r()})),n("setTransition",((e,n)=>{i.params.effect===t&&s(n)})),n("transitionEnd",(()=>{if(i.params.effect===t&&l){if(!c||!c().slideShadows)return;i.slides.forEach((e=>{e.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach((e=>e.remove()))})),l()}})),n("virtualUpdate",(()=>{i.params.effect===t&&(i.slides.length||(h=!0),requestAnimationFrame((()=>{h&&i.slides&&i.slides.length&&(r(),h=!1)})))}))}({effect:"fade",swiper:e,on:i,setTranslate:()=>{const{slides:t}=e;e.params.fadeEffect;for(let i=0;i<t.length;i+=1){const t=e.slides[i];let n=-t.swiperSlideOffset;e.params.virtualTranslate||(n-=e.translate);let r=0;e.isHorizontal()||(r=n,n=0);const s=e.params.fadeEffect.crossFade?Math.max(1-Math.abs(t.progress),0):1+Math.min(Math.max(t.progress,-1),0),a=ul(0,t);a.style.opacity=s,a.style.transform=`translate3d(${n}px, ${r}px, 0px)`}},setTransition:t=>{const i=e.slides.map((e=>wo(e)));i.forEach((e=>{e.style.transitionDuration=`${t}ms`})),function({swiper:e,duration:t,transformElements:i,allSlides:n}){const{activeIndex:r}=e;if(e.params.virtualTranslate&&0!==t){let t,s=!1;t=n?i:i.filter((t=>{const i=t.classList.contains("swiper-slide-transform")?(t=>t.parentElement?t.parentElement:e.slides.filter((e=>e.shadowEl&&e.shadowEl===t.parentNode))[0])(t):t;return e.getSlideIndex(i)===r})),t.forEach((t=>{!function(e,t){t&&e.addEventListener("transitionend",(function i(n){n.target===e&&(t.call(e,n),e.removeEventListener("transitionend",i))}))}(t,(()=>{if(s)return;if(!e||e.destroyed)return;s=!0,e.animating=!1;const t=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0});e.wrapperEl.dispatchEvent(t)}))}))}}({swiper:e,duration:t,transformElements:i,allSlides:!0})},overwriteParams:()=>({slidesPerView:1,slidesPerGroup:1,watchSlidesProgress:!0,spaceBetween:0,virtualTranslate:!e.params.cssMode})})}const fl="161",ml=1,gl=2,vl=3,_l=0,yl=1,bl=2,xl=0,wl=100,El=0,Sl=1,Tl=2,Ml=0,Al=1,Cl=2,Ll=3,Pl=4,Rl=5,Ol=6,Il=301,Dl=302,Nl=306,Ul=1e3,Fl=1001,zl=1002,kl=1003,Hl=1005,Bl=1006,Vl=1007,jl=1008,Gl=1009,Wl=1012,Xl=1014,ql=1015,Yl=1016,$l=1017,Zl=1018,Kl=1020,Jl=1023,Ql=1026,ec=1027,tc=1029,ic=1031,nc=1033,rc=33776,sc=33777,ac=33778,oc=33779,lc=36492,cc=2300,hc=2301,dc=2302,uc=3001,pc="",fc="srgb",mc="srgb-linear",gc="display-p3",vc="display-p3-linear",_c="linear",yc="srgb",bc="rec709",xc="p3",wc=7680,Ec="300 es",Sc=1035,Tc=2e3,Mc=2001;class Ac{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const i=this._listeners[e];if(void 0!==i){const e=i.indexOf(t);-1!==e&&i.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const i=t.slice(0);for(let t=0,n=i.length;t<n;t++)i[t].call(this,e);e.target=null}}}const Cc=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Lc=1234567;const Pc=Math.PI/180,Rc=180/Math.PI;function Oc(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Cc[255&e]+Cc[e>>8&255]+Cc[e>>16&255]+Cc[e>>24&255]+"-"+Cc[255&t]+Cc[t>>8&255]+"-"+Cc[t>>16&15|64]+Cc[t>>24&255]+"-"+Cc[63&i|128]+Cc[i>>8&255]+"-"+Cc[i>>16&255]+Cc[i>>24&255]+Cc[255&n]+Cc[n>>8&255]+Cc[n>>16&255]+Cc[n>>24&255]).toLowerCase()}function Ic(e,t,i){return Math.max(t,Math.min(i,e))}function Dc(e,t){return(e%t+t)%t}function Nc(e,t,i){return(1-i)*e+i*t}function Uc(e){return 0==(e&e-1)&&0!==e}function Fc(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function zc(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function kc(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const Hc={DEG2RAD:Pc,RAD2DEG:Rc,generateUUID:Oc,clamp:Ic,euclideanModulo:Dc,mapLinear:function(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)},inverseLerp:function(e,t,i){return e!==t?(i-e)/(t-e):0},lerp:Nc,damp:function(e,t,i,n){return Nc(e,t,1-Math.exp(-i*n))},pingpong:function(e,t=1){return t-Math.abs(Dc(e,2*t)-t)},smoothstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*(3-2*e)},smootherstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(Lc=e);let t=Lc+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*Pc},radToDeg:function(e){return e*Rc},isPowerOfTwo:Uc,ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:Fc,setQuaternionFromProperEuler:function(e,t,i,n,r){const s=Math.cos,a=Math.sin,o=s(i/2),l=a(i/2),c=s((t+n)/2),h=a((t+n)/2),d=s((t-n)/2),u=a((t-n)/2),p=s((n-t)/2),f=a((n-t)/2);switch(r){case"XYX":e.set(o*h,l*d,l*u,o*c);break;case"YZY":e.set(l*u,o*h,l*d,o*c);break;case"ZXZ":e.set(l*d,l*u,o*h,o*c);break;case"XZX":e.set(o*h,l*f,l*p,o*c);break;case"YXY":e.set(l*p,o*h,l*f,o*c);break;case"ZYZ":e.set(l*f,l*p,o*h,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:kc,denormalize:zc};class Bc{constructor(e=0,t=0){Bc.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,n=e.elements;return this.x=n[0]*t+n[3]*i+n[6],this.y=n[1]*t+n[4]*i+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Ic(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),n=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*i-s*n+e.x,this.y=r*n+s*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Vc{constructor(e,t,i,n,r,s,a,o,l){Vc.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,n,r,s,a,o,l)}set(e,t,i,n,r,s,a,o,l){const c=this.elements;return c[0]=e,c[1]=n,c[2]=a,c[3]=t,c[4]=r,c[5]=o,c[6]=i,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,n=t.elements,r=this.elements,s=i[0],a=i[3],o=i[6],l=i[1],c=i[4],h=i[7],d=i[2],u=i[5],p=i[8],f=n[0],m=n[3],g=n[6],v=n[1],_=n[4],y=n[7],b=n[2],x=n[5],w=n[8];return r[0]=s*f+a*v+o*b,r[3]=s*m+a*_+o*x,r[6]=s*g+a*y+o*w,r[1]=l*f+c*v+h*b,r[4]=l*m+c*_+h*x,r[7]=l*g+c*y+h*w,r[2]=d*f+u*v+p*b,r[5]=d*m+u*_+p*x,r[8]=d*g+u*y+p*w,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*s*c-t*a*l-i*r*c+i*a*o+n*r*l-n*s*o}invert(){const e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],h=c*s-a*l,d=a*o-c*r,u=l*r-s*o,p=t*h+i*d+n*u;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return e[0]=h*f,e[1]=(n*l-c*i)*f,e[2]=(a*i-n*s)*f,e[3]=d*f,e[4]=(c*t-n*o)*f,e[5]=(n*r-a*t)*f,e[6]=u*f,e[7]=(i*o-l*t)*f,e[8]=(s*t-i*r)*f,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,n,r,s,a){const o=Math.cos(r),l=Math.sin(r);return this.set(i*o,i*l,-i*(o*s+l*a)+s+e,-n*l,n*o,-n*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(jc.makeScale(e,t)),this}rotate(e){return this.premultiply(jc.makeRotation(-e)),this}translate(e,t){return this.premultiply(jc.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let e=0;e<9;e++)if(t[e]!==i[e])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const jc=new Vc;function Gc(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}function Wc(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Xc(){const e=Wc("canvas");return e.style.display="block",e}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const qc={};function Yc(e){e in qc||(qc[e]=!0,console.warn(e))}const $c=(new Vc).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Zc=(new Vc).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Kc={[mc]:{transfer:_c,primaries:bc,toReference:e=>e,fromReference:e=>e},[fc]:{transfer:yc,primaries:bc,toReference:e=>e.convertSRGBToLinear(),fromReference:e=>e.convertLinearToSRGB()},[vc]:{transfer:_c,primaries:xc,toReference:e=>e.applyMatrix3(Zc),fromReference:e=>e.applyMatrix3($c)},[gc]:{transfer:yc,primaries:xc,toReference:e=>e.convertSRGBToLinear().applyMatrix3(Zc),fromReference:e=>e.applyMatrix3($c).convertLinearToSRGB()}},Jc=new Set([mc,vc]),Qc={enabled:!0,_workingColorSpace:mc,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(e){if(!Jc.has(e))throw new Error(`Unsupported working color space, "${e}".`);this._workingColorSpace=e},convert:function(e,t,i){if(!1===this.enabled||t===i||!t||!i)return e;const n=Kc[t].toReference;return(0,Kc[i].fromReference)(n(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this._workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this._workingColorSpace)},getPrimaries:function(e){return Kc[e].primaries},getTransfer:function(e){return e===pc?_c:Kc[e].transfer}};function eh(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function th(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let ih;class nh{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===ih&&(ih=Wc("canvas")),ih.width=e.width,ih.height=e.height;const i=ih.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=ih}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=Wc("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const n=i.getImageData(0,0,e.width,e.height),r=n.data;for(let e=0;e<r.length;e++)r[e]=255*eh(r[e]/255);return i.putImageData(n,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*eh(t[e]/255)):t[e]=eh(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let rh=0;class sh{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:rh++}),this.uuid=Oc(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},n=this.data;if(null!==n){let e;if(Array.isArray(n)){e=[];for(let t=0,i=n.length;t<i;t++)n[t].isDataTexture?e.push(ah(n[t].image)):e.push(ah(n[t]))}else e=ah(n);i.url=e}return t||(e.images[this.uuid]=i),i}}function ah(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?nh.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let oh=0;class lh extends Ac{constructor(e=lh.DEFAULT_IMAGE,t=lh.DEFAULT_MAPPING,i=1001,n=1001,r=Bl,s=jl,a=Jl,o=Gl,l=lh.DEFAULT_ANISOTROPY,c=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:oh++}),this.uuid=Oc(),this.name="",this.source=new sh(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=n,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new Bc(0,0),this.repeat=new Bc(1,1),this.center=new Bc(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Vc,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof c?this.colorSpace=c:(Yc("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=c===uc?fc:pc),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Ul:e.x=e.x-Math.floor(e.x);break;case Fl:e.x=e.x<0?0:1;break;case zl:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case Ul:e.y=e.y-Math.floor(e.y);break;case Fl:e.y=e.y<0?0:1;break;case zl:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Yc("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===fc?uc:3e3}set encoding(e){Yc("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===uc?fc:pc}}lh.DEFAULT_IMAGE=null,lh.DEFAULT_MAPPING=300,lh.DEFAULT_ANISOTROPY=1;class ch{constructor(e=0,t=0,i=0,n=1){ch.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,n=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*n+s[12]*r,this.y=s[1]*t+s[5]*i+s[9]*n+s[13]*r,this.z=s[2]*t+s[6]*i+s[10]*n+s[14]*r,this.w=s[3]*t+s[7]*i+s[11]*n+s[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,n,r;const s=.01,a=.1,o=e.elements,l=o[0],c=o[4],h=o[8],d=o[1],u=o[5],p=o[9],f=o[2],m=o[6],g=o[10];if(Math.abs(c-d)<s&&Math.abs(h-f)<s&&Math.abs(p-m)<s){if(Math.abs(c+d)<a&&Math.abs(h+f)<a&&Math.abs(p+m)<a&&Math.abs(l+u+g-3)<a)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,o=(u+1)/2,v=(g+1)/2,_=(c+d)/4,y=(h+f)/4,b=(p+m)/4;return e>o&&e>v?e<s?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(e),n=_/i,r=y/i):o>v?o<s?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(o),i=_/n,r=b/n):v<s?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(v),i=y/r,n=b/r),this.set(i,n,r,t),this}let v=Math.sqrt((m-p)*(m-p)+(h-f)*(h-f)+(d-c)*(d-c));return Math.abs(v)<.001&&(v=1),this.x=(m-p)/v,this.y=(h-f)/v,this.z=(d-c)/v,this.w=Math.acos((l+u+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class hh extends Ac{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new ch(0,0,e,t),this.scissorTest=!1,this.viewport=new ch(0,0,e,t);const n={width:e,height:t,depth:1};void 0!==i.encoding&&(Yc("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===uc?fc:pc),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Bl,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new lh(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){this.width===e&&this.height===t&&this.depth===i||(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new sh(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class dh extends hh{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class uh extends lh{constructor(e=null,t=1,i=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:n},this.magFilter=kl,this.minFilter=kl,this.wrapR=Fl,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ph extends lh{constructor(e=null,t=1,i=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:n},this.magFilter=kl,this.minFilter=kl,this.wrapR=Fl,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class fh{constructor(e=0,t=0,i=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=n}static slerpFlat(e,t,i,n,r,s,a){let o=i[n+0],l=i[n+1],c=i[n+2],h=i[n+3];const d=r[s+0],u=r[s+1],p=r[s+2],f=r[s+3];if(0===a)return e[t+0]=o,e[t+1]=l,e[t+2]=c,void(e[t+3]=h);if(1===a)return e[t+0]=d,e[t+1]=u,e[t+2]=p,void(e[t+3]=f);if(h!==f||o!==d||l!==u||c!==p){let e=1-a;const t=o*d+l*u+c*p+h*f,i=t>=0?1:-1,n=1-t*t;if(n>Number.EPSILON){const r=Math.sqrt(n),s=Math.atan2(r,t*i);e=Math.sin(e*s)/r,a=Math.sin(a*s)/r}const r=a*i;if(o=o*e+d*r,l=l*e+u*r,c=c*e+p*r,h=h*e+f*r,e===1-a){const e=1/Math.sqrt(o*o+l*l+c*c+h*h);o*=e,l*=e,c*=e,h*=e}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,n,r,s){const a=i[n],o=i[n+1],l=i[n+2],c=i[n+3],h=r[s],d=r[s+1],u=r[s+2],p=r[s+3];return e[t]=a*p+c*h+o*u-l*d,e[t+1]=o*p+c*d+l*h-a*u,e[t+2]=l*p+c*u+a*d-o*h,e[t+3]=c*p-a*h-o*d-l*u,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,n=e._y,r=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(i/2),c=a(n/2),h=a(r/2),d=o(i/2),u=o(n/2),p=o(r/2);switch(s){case"XYZ":this._x=d*c*h+l*u*p,this._y=l*u*h-d*c*p,this._z=l*c*p+d*u*h,this._w=l*c*h-d*u*p;break;case"YXZ":this._x=d*c*h+l*u*p,this._y=l*u*h-d*c*p,this._z=l*c*p-d*u*h,this._w=l*c*h+d*u*p;break;case"ZXY":this._x=d*c*h-l*u*p,this._y=l*u*h+d*c*p,this._z=l*c*p+d*u*h,this._w=l*c*h-d*u*p;break;case"ZYX":this._x=d*c*h-l*u*p,this._y=l*u*h+d*c*p,this._z=l*c*p-d*u*h,this._w=l*c*h+d*u*p;break;case"YZX":this._x=d*c*h+l*u*p,this._y=l*u*h+d*c*p,this._z=l*c*p-d*u*h,this._w=l*c*h-d*u*p;break;case"XZY":this._x=d*c*h-l*u*p,this._y=l*u*h-d*c*p,this._z=l*c*p+d*u*h,this._w=l*c*h+d*u*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],n=t[4],r=t[8],s=t[1],a=t[5],o=t[9],l=t[2],c=t[6],h=t[10],d=i+a+h;if(d>0){const e=.5/Math.sqrt(d+1);this._w=.25/e,this._x=(c-o)*e,this._y=(r-l)*e,this._z=(s-n)*e}else if(i>a&&i>h){const e=2*Math.sqrt(1+i-a-h);this._w=(c-o)/e,this._x=.25*e,this._y=(n+s)/e,this._z=(r+l)/e}else if(a>h){const e=2*Math.sqrt(1+a-i-h);this._w=(r-l)/e,this._x=(n+s)/e,this._y=.25*e,this._z=(o+c)/e}else{const e=2*Math.sqrt(1+h-i-a);this._w=(s-n)/e,this._x=(r+l)/e,this._y=(o+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ic(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const n=Math.min(1,t/i);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,n=e._y,r=e._z,s=e._w,a=t._x,o=t._y,l=t._z,c=t._w;return this._x=i*c+s*a+n*l-r*o,this._y=n*c+s*o+r*a-i*l,this._z=r*c+s*l+i*o-n*a,this._w=s*c-i*a-n*o-r*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,n=this._y,r=this._z,s=this._w;let a=s*e._w+i*e._x+n*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=i,this._y=n,this._z=r,this;const o=1-a*a;if(o<=Number.EPSILON){const e=1-t;return this._w=e*s+t*this._w,this._x=e*i+t*this._x,this._y=e*n+t*this._y,this._z=e*r+t*this._z,this.normalize(),this}const l=Math.sqrt(o),c=Math.atan2(l,a),h=Math.sin((1-t)*c)/l,d=Math.sin(t*c)/l;return this._w=s*h+this._w*d,this._x=i*h+this._x*d,this._y=n*h+this._y*d,this._z=r*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),n=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(t*Math.cos(n),i*Math.sin(r),i*Math.cos(r),t*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class mh{constructor(e=0,t=0,i=0){mh.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(vh.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(vh.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*n,this.y=r[1]*t+r[4]*i+r[7]*n,this.z=r[2]*t+r[5]*i+r[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,n=this.z,r=e.elements,s=1/(r[3]*t+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*n+r[12])*s,this.y=(r[1]*t+r[5]*i+r[9]*n+r[13])*s,this.z=(r[2]*t+r[6]*i+r[10]*n+r[14])*s,this}applyQuaternion(e){const t=this.x,i=this.y,n=this.z,r=e.x,s=e.y,a=e.z,o=e.w,l=2*(s*n-a*i),c=2*(a*t-r*n),h=2*(r*i-s*t);return this.x=t+o*l+s*h-a*c,this.y=i+o*c+a*l-r*h,this.z=n+o*h+r*c-s*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n,this.y=r[1]*t+r[5]*i+r[9]*n,this.z=r[2]*t+r[6]*i+r[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,n=e.y,r=e.z,s=t.x,a=t.y,o=t.z;return this.x=n*o-r*a,this.y=r*s-i*o,this.z=i*a-n*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return gh.copy(this).projectOnVector(e),this.sub(gh)}reflect(e){return this.sub(gh.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Ic(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t*t+i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const n=Math.sin(t)*e;return this.x=n*Math.sin(i),this.y=Math.cos(t)*e,this.z=n*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const gh=new mh,vh=new fh;class _h{constructor(e=new mh(1/0,1/0,1/0),t=new mh(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(bh.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(bh.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=bh.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i){const n=i.getAttribute("position");if(!0===t&&void 0!==n&&!0!==e.isInstancedMesh)for(let t=0,i=n.count;t<i;t++)!0===e.isMesh?e.getVertexPosition(t,bh):bh.fromBufferAttribute(n,t),bh.applyMatrix4(e.matrixWorld),this.expandByPoint(bh);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),xh.copy(e.boundingBox)):(null===i.boundingBox&&i.computeBoundingBox(),xh.copy(i.boundingBox)),xh.applyMatrix4(e.matrixWorld),this.union(xh)}const n=e.children;for(let e=0,i=n.length;e<i;e++)this.expandByObject(n[e],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,bh),bh.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ch),Lh.subVectors(this.max,Ch),wh.subVectors(e.a,Ch),Eh.subVectors(e.b,Ch),Sh.subVectors(e.c,Ch),Th.subVectors(Eh,wh),Mh.subVectors(Sh,Eh),Ah.subVectors(wh,Sh);let t=[0,-Th.z,Th.y,0,-Mh.z,Mh.y,0,-Ah.z,Ah.y,Th.z,0,-Th.x,Mh.z,0,-Mh.x,Ah.z,0,-Ah.x,-Th.y,Th.x,0,-Mh.y,Mh.x,0,-Ah.y,Ah.x,0];return!!Oh(t,wh,Eh,Sh,Lh)&&(t=[1,0,0,0,1,0,0,0,1],!!Oh(t,wh,Eh,Sh,Lh)&&(Ph.crossVectors(Th,Mh),t=[Ph.x,Ph.y,Ph.z],Oh(t,wh,Eh,Sh,Lh)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,bh).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(bh).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(yh[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),yh[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),yh[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),yh[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),yh[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),yh[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),yh[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),yh[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(yh)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const yh=[new mh,new mh,new mh,new mh,new mh,new mh,new mh,new mh],bh=new mh,xh=new _h,wh=new mh,Eh=new mh,Sh=new mh,Th=new mh,Mh=new mh,Ah=new mh,Ch=new mh,Lh=new mh,Ph=new mh,Rh=new mh;function Oh(e,t,i,n,r){for(let s=0,a=e.length-3;s<=a;s+=3){Rh.fromArray(e,s);const a=r.x*Math.abs(Rh.x)+r.y*Math.abs(Rh.y)+r.z*Math.abs(Rh.z),o=t.dot(Rh),l=i.dot(Rh),c=n.dot(Rh);if(Math.max(-Math.max(o,l,c),Math.min(o,l,c))>a)return!1}return!0}const Ih=new _h,Dh=new mh,Nh=new mh;class Uh{constructor(e=new mh,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):Ih.setFromPoints(e).getCenter(i);let n=0;for(let t=0,r=e.length;t<r;t++)n=Math.max(n,i.distanceToSquared(e[t]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Dh.subVectors(e,this.center);const t=Dh.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),i=.5*(e-this.radius);this.center.addScaledVector(Dh,i/e),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Nh.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Dh.copy(e.center).add(Nh)),this.expandByPoint(Dh.copy(e.center).sub(Nh))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Fh=new mh,zh=new mh,kh=new mh,Hh=new mh,Bh=new mh,Vh=new mh,jh=new mh;class Gh{constructor(e=new mh,t=new mh(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Fh)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Fh.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Fh.copy(this.origin).addScaledVector(this.direction,t),Fh.distanceToSquared(e))}distanceSqToSegment(e,t,i,n){zh.copy(e).add(t).multiplyScalar(.5),kh.copy(t).sub(e).normalize(),Hh.copy(this.origin).sub(zh);const r=.5*e.distanceTo(t),s=-this.direction.dot(kh),a=Hh.dot(this.direction),o=-Hh.dot(kh),l=Hh.lengthSq(),c=Math.abs(1-s*s);let h,d,u,p;if(c>0)if(h=s*o-a,d=s*a-o,p=r*c,h>=0)if(d>=-p)if(d<=p){const e=1/c;h*=e,d*=e,u=h*(h+s*d+2*a)+d*(s*h+d+2*o)+l}else d=r,h=Math.max(0,-(s*d+a)),u=-h*h+d*(d+2*o)+l;else d=-r,h=Math.max(0,-(s*d+a)),u=-h*h+d*(d+2*o)+l;else d<=-p?(h=Math.max(0,-(-s*r+a)),d=h>0?-r:Math.min(Math.max(-r,-o),r),u=-h*h+d*(d+2*o)+l):d<=p?(h=0,d=Math.min(Math.max(-r,-o),r),u=d*(d+2*o)+l):(h=Math.max(0,-(s*r+a)),d=h>0?r:Math.min(Math.max(-r,-o),r),u=-h*h+d*(d+2*o)+l);else d=s>0?-r:r,h=Math.max(0,-(s*d+a)),u=-h*h+d*(d+2*o)+l;return i&&i.copy(this.origin).addScaledVector(this.direction,h),n&&n.copy(zh).addScaledVector(kh,d),u}intersectSphere(e,t){Fh.subVectors(e.center,this.origin);const i=Fh.dot(this.direction),n=Fh.dot(Fh)-i*i,r=e.radius*e.radius;if(n>r)return null;const s=Math.sqrt(r-n),a=i-s,o=i+s;return o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,n,r,s,a,o;const l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,d=this.origin;return l>=0?(i=(e.min.x-d.x)*l,n=(e.max.x-d.x)*l):(i=(e.max.x-d.x)*l,n=(e.min.x-d.x)*l),c>=0?(r=(e.min.y-d.y)*c,s=(e.max.y-d.y)*c):(r=(e.max.y-d.y)*c,s=(e.min.y-d.y)*c),i>s||r>n?null:((r>i||isNaN(i))&&(i=r),(s<n||isNaN(n))&&(n=s),h>=0?(a=(e.min.z-d.z)*h,o=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,o=(e.min.z-d.z)*h),i>o||a>n?null:((a>i||i!=i)&&(i=a),(o<n||n!=n)&&(n=o),n<0?null:this.at(i>=0?i:n,t)))}intersectsBox(e){return null!==this.intersectBox(e,Fh)}intersectTriangle(e,t,i,n,r){Bh.subVectors(t,e),Vh.subVectors(i,e),jh.crossVectors(Bh,Vh);let s,a=this.direction.dot(jh);if(a>0){if(n)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}Hh.subVectors(this.origin,e);const o=s*this.direction.dot(Vh.crossVectors(Hh,Vh));if(o<0)return null;const l=s*this.direction.dot(Bh.cross(Hh));if(l<0)return null;if(o+l>a)return null;const c=-s*Hh.dot(jh);return c<0?null:this.at(c/a,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Wh{constructor(e,t,i,n,r,s,a,o,l,c,h,d,u,p,f,m){Wh.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,n,r,s,a,o,l,c,h,d,u,p,f,m)}set(e,t,i,n,r,s,a,o,l,c,h,d,u,p,f,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=n,g[1]=r,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=c,g[10]=h,g[14]=d,g[3]=u,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Wh).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,n=1/Xh.setFromMatrixColumn(e,0).length(),r=1/Xh.setFromMatrixColumn(e,1).length(),s=1/Xh.setFromMatrixColumn(e,2).length();return t[0]=i[0]*n,t[1]=i[1]*n,t[2]=i[2]*n,t[3]=0,t[4]=i[4]*r,t[5]=i[5]*r,t[6]=i[6]*r,t[7]=0,t[8]=i[8]*s,t[9]=i[9]*s,t[10]=i[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,n=e.y,r=e.z,s=Math.cos(i),a=Math.sin(i),o=Math.cos(n),l=Math.sin(n),c=Math.cos(r),h=Math.sin(r);if("XYZ"===e.order){const e=s*c,i=s*h,n=a*c,r=a*h;t[0]=o*c,t[4]=-o*h,t[8]=l,t[1]=i+n*l,t[5]=e-r*l,t[9]=-a*o,t[2]=r-e*l,t[6]=n+i*l,t[10]=s*o}else if("YXZ"===e.order){const e=o*c,i=o*h,n=l*c,r=l*h;t[0]=e+r*a,t[4]=n*a-i,t[8]=s*l,t[1]=s*h,t[5]=s*c,t[9]=-a,t[2]=i*a-n,t[6]=r+e*a,t[10]=s*o}else if("ZXY"===e.order){const e=o*c,i=o*h,n=l*c,r=l*h;t[0]=e-r*a,t[4]=-s*h,t[8]=n+i*a,t[1]=i+n*a,t[5]=s*c,t[9]=r-e*a,t[2]=-s*l,t[6]=a,t[10]=s*o}else if("ZYX"===e.order){const e=s*c,i=s*h,n=a*c,r=a*h;t[0]=o*c,t[4]=n*l-i,t[8]=e*l+r,t[1]=o*h,t[5]=r*l+e,t[9]=i*l-n,t[2]=-l,t[6]=a*o,t[10]=s*o}else if("YZX"===e.order){const e=s*o,i=s*l,n=a*o,r=a*l;t[0]=o*c,t[4]=r-e*h,t[8]=n*h+i,t[1]=h,t[5]=s*c,t[9]=-a*c,t[2]=-l*c,t[6]=i*h+n,t[10]=e-r*h}else if("XZY"===e.order){const e=s*o,i=s*l,n=a*o,r=a*l;t[0]=o*c,t[4]=-h,t[8]=l*c,t[1]=e*h+r,t[5]=s*c,t[9]=i*h-n,t[2]=n*h-i,t[6]=a*c,t[10]=r*h+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Yh,e,$h)}lookAt(e,t,i){const n=this.elements;return Jh.subVectors(e,t),0===Jh.lengthSq()&&(Jh.z=1),Jh.normalize(),Zh.crossVectors(i,Jh),0===Zh.lengthSq()&&(1===Math.abs(i.z)?Jh.x+=1e-4:Jh.z+=1e-4,Jh.normalize(),Zh.crossVectors(i,Jh)),Zh.normalize(),Kh.crossVectors(Jh,Zh),n[0]=Zh.x,n[4]=Kh.x,n[8]=Jh.x,n[1]=Zh.y,n[5]=Kh.y,n[9]=Jh.y,n[2]=Zh.z,n[6]=Kh.z,n[10]=Jh.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,n=t.elements,r=this.elements,s=i[0],a=i[4],o=i[8],l=i[12],c=i[1],h=i[5],d=i[9],u=i[13],p=i[2],f=i[6],m=i[10],g=i[14],v=i[3],_=i[7],y=i[11],b=i[15],x=n[0],w=n[4],E=n[8],S=n[12],T=n[1],M=n[5],A=n[9],C=n[13],L=n[2],P=n[6],R=n[10],O=n[14],I=n[3],D=n[7],N=n[11],U=n[15];return r[0]=s*x+a*T+o*L+l*I,r[4]=s*w+a*M+o*P+l*D,r[8]=s*E+a*A+o*R+l*N,r[12]=s*S+a*C+o*O+l*U,r[1]=c*x+h*T+d*L+u*I,r[5]=c*w+h*M+d*P+u*D,r[9]=c*E+h*A+d*R+u*N,r[13]=c*S+h*C+d*O+u*U,r[2]=p*x+f*T+m*L+g*I,r[6]=p*w+f*M+m*P+g*D,r[10]=p*E+f*A+m*R+g*N,r[14]=p*S+f*C+m*O+g*U,r[3]=v*x+_*T+y*L+b*I,r[7]=v*w+_*M+y*P+b*D,r[11]=v*E+_*A+y*R+b*N,r[15]=v*S+_*C+y*O+b*U,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],n=e[8],r=e[12],s=e[1],a=e[5],o=e[9],l=e[13],c=e[2],h=e[6],d=e[10],u=e[14];return e[3]*(+r*o*h-n*l*h-r*a*d+i*l*d+n*a*u-i*o*u)+e[7]*(+t*o*u-t*l*d+r*s*d-n*s*u+n*l*c-r*o*c)+e[11]*(+t*l*h-t*a*u-r*s*h+i*s*u+r*a*c-i*l*c)+e[15]*(-n*a*c-t*o*h+t*a*d+n*s*h-i*s*d+i*o*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],h=e[9],d=e[10],u=e[11],p=e[12],f=e[13],m=e[14],g=e[15],v=h*m*l-f*d*l+f*o*u-a*m*u-h*o*g+a*d*g,_=p*d*l-c*m*l-p*o*u+s*m*u+c*o*g-s*d*g,y=c*f*l-p*h*l+p*a*u-s*f*u-c*a*g+s*h*g,b=p*h*o-c*f*o-p*a*d+s*f*d+c*a*m-s*h*m,x=t*v+i*_+n*y+r*b;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/x;return e[0]=v*w,e[1]=(f*d*r-h*m*r-f*n*u+i*m*u+h*n*g-i*d*g)*w,e[2]=(a*m*r-f*o*r+f*n*l-i*m*l-a*n*g+i*o*g)*w,e[3]=(h*o*r-a*d*r-h*n*l+i*d*l+a*n*u-i*o*u)*w,e[4]=_*w,e[5]=(c*m*r-p*d*r+p*n*u-t*m*u-c*n*g+t*d*g)*w,e[6]=(p*o*r-s*m*r-p*n*l+t*m*l+s*n*g-t*o*g)*w,e[7]=(s*d*r-c*o*r+c*n*l-t*d*l-s*n*u+t*o*u)*w,e[8]=y*w,e[9]=(p*h*r-c*f*r-p*i*u+t*f*u+c*i*g-t*h*g)*w,e[10]=(s*f*r-p*a*r+p*i*l-t*f*l-s*i*g+t*a*g)*w,e[11]=(c*a*r-s*h*r-c*i*l+t*h*l+s*i*u-t*a*u)*w,e[12]=b*w,e[13]=(c*f*n-p*h*n+p*i*d-t*f*d-c*i*m+t*h*m)*w,e[14]=(p*a*n-s*f*n-p*i*o+t*f*o+s*i*m-t*a*m)*w,e[15]=(s*h*n-c*a*n+c*i*o-t*h*o-s*i*d+t*a*d)*w,this}scale(e){const t=this.elements,i=e.x,n=e.y,r=e.z;return t[0]*=i,t[4]*=n,t[8]*=r,t[1]*=i,t[5]*=n,t[9]*=r,t[2]*=i,t[6]*=n,t[10]*=r,t[3]*=i,t[7]*=n,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,n))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),n=Math.sin(t),r=1-i,s=e.x,a=e.y,o=e.z,l=r*s,c=r*a;return this.set(l*s+i,l*a-n*o,l*o+n*a,0,l*a+n*o,c*a+i,c*o-n*s,0,l*o-n*a,c*o+n*s,r*o*o+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,n,r,s){return this.set(1,i,r,0,e,1,s,0,t,n,1,0,0,0,0,1),this}compose(e,t,i){const n=this.elements,r=t._x,s=t._y,a=t._z,o=t._w,l=r+r,c=s+s,h=a+a,d=r*l,u=r*c,p=r*h,f=s*c,m=s*h,g=a*h,v=o*l,_=o*c,y=o*h,b=i.x,x=i.y,w=i.z;return n[0]=(1-(f+g))*b,n[1]=(u+y)*b,n[2]=(p-_)*b,n[3]=0,n[4]=(u-y)*x,n[5]=(1-(d+g))*x,n[6]=(m+v)*x,n[7]=0,n[8]=(p+_)*w,n[9]=(m-v)*w,n[10]=(1-(d+f))*w,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,i){const n=this.elements;let r=Xh.set(n[0],n[1],n[2]).length();const s=Xh.set(n[4],n[5],n[6]).length(),a=Xh.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),e.x=n[12],e.y=n[13],e.z=n[14],qh.copy(this);const o=1/r,l=1/s,c=1/a;return qh.elements[0]*=o,qh.elements[1]*=o,qh.elements[2]*=o,qh.elements[4]*=l,qh.elements[5]*=l,qh.elements[6]*=l,qh.elements[8]*=c,qh.elements[9]*=c,qh.elements[10]*=c,t.setFromRotationMatrix(qh),i.x=r,i.y=s,i.z=a,this}makePerspective(e,t,i,n,r,s,a=2e3){const o=this.elements,l=2*r/(t-e),c=2*r/(i-n),h=(t+e)/(t-e),d=(i+n)/(i-n);let u,p;if(a===Tc)u=-(s+r)/(s-r),p=-2*s*r/(s-r);else{if(a!==Mc)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);u=-s/(s-r),p=-s*r/(s-r)}return o[0]=l,o[4]=0,o[8]=h,o[12]=0,o[1]=0,o[5]=c,o[9]=d,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=p,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,i,n,r,s,a=2e3){const o=this.elements,l=1/(t-e),c=1/(i-n),h=1/(s-r),d=(t+e)*l,u=(i+n)*c;let p,f;if(a===Tc)p=(s+r)*h,f=-2*h;else{if(a!==Mc)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);p=r*h,f=-1*h}return o[0]=2*l,o[4]=0,o[8]=0,o[12]=-d,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=f,o[14]=-p,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let e=0;e<16;e++)if(t[e]!==i[e])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Xh=new mh,qh=new Wh,Yh=new mh(0,0,0),$h=new mh(1,1,1),Zh=new mh,Kh=new mh,Jh=new mh,Qh=new Wh,ed=new fh;class td{constructor(e=0,t=0,i=0,n=td.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,n=this._order){return this._x=e,this._y=t,this._z=i,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const n=e.elements,r=n[0],s=n[4],a=n[8],o=n[1],l=n[5],c=n[9],h=n[2],d=n[6],u=n[10];switch(t){case"XYZ":this._y=Math.asin(Ic(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,u),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Ic(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,u),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-h,r),this._z=0);break;case"ZXY":this._x=Math.asin(Ic(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,u),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,r));break;case"ZYX":this._y=Math.asin(-Ic(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,u),this._z=Math.atan2(o,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Ic(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,r)):(this._x=0,this._y=Math.atan2(a,u));break;case"XZY":this._z=Math.asin(-Ic(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-c,u),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===i&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return Qh.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Qh,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return ed.setFromEuler(this),this.setFromQuaternion(ed,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}td.DEFAULT_ORDER="XYZ";class id{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let nd=0;const rd=new mh,sd=new fh,ad=new Wh,od=new mh,ld=new mh,cd=new mh,hd=new fh,dd=new mh(1,0,0),ud=new mh(0,1,0),pd=new mh(0,0,1),fd={type:"added"},md={type:"removed"};class gd extends Ac{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:nd++}),this.uuid=Oc(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=gd.DEFAULT_UP.clone();const e=new mh,t=new td,i=new fh,n=new mh(1,1,1);t._onChange((function(){i.setFromEuler(t,!1)})),i._onChange((function(){t.setFromQuaternion(i,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Wh},normalMatrix:{value:new Vc}}),this.matrix=new Wh,this.matrixWorld=new Wh,this.matrixAutoUpdate=gd.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=gd.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new id,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return sd.setFromAxisAngle(e,t),this.quaternion.multiply(sd),this}rotateOnWorldAxis(e,t){return sd.setFromAxisAngle(e,t),this.quaternion.premultiply(sd),this}rotateX(e){return this.rotateOnAxis(dd,e)}rotateY(e){return this.rotateOnAxis(ud,e)}rotateZ(e){return this.rotateOnAxis(pd,e)}translateOnAxis(e,t){return rd.copy(e).applyQuaternion(this.quaternion),this.position.add(rd.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(dd,e)}translateY(e){return this.translateOnAxis(ud,e)}translateZ(e){return this.translateOnAxis(pd,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ad.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?od.copy(e):od.set(e,t,i);const n=this.parent;this.updateWorldMatrix(!0,!1),ld.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ad.lookAt(ld,od,this.up):ad.lookAt(od,ld,this.up),this.quaternion.setFromRotationMatrix(ad),n&&(ad.extractRotation(n.matrixWorld),sd.setFromRotationMatrix(ad),this.quaternion.premultiply(sd.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(fd)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(md)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ad.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),ad.multiply(e.parent.matrixWorld)),e.applyMatrix4(ad),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,n=this.children.length;i<n;i++){const n=this.children[i].getObjectByProperty(e,t);if(void 0!==n)return n}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ld,e,cd),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ld,hd,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,n=t.length;i<n;i++)t[i].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let i=0,n=t.length;i<n;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,n=t.length;i<n;i++){const n=t[i];!0!==n.matrixWorldAutoUpdate&&!0!==e||n.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const i=this.parent;if(!0===e&&null!==i&&!0===i.matrixWorldAutoUpdate&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,i=e.length;t<i;t++){const i=e[t];!0===i.matrixWorldAutoUpdate&&i.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"==typeof e,i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const n={};function r(t,i){return void 0===t[i.uuid]&&(t[i.uuid]=i.toJSON(e)),i.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.visibility=this._visibility,n.active=this._active,n.bounds=this._bounds.map((e=>({boxInitialized:e.boxInitialized,boxMin:e.box.min.toArray(),boxMax:e.box.max.toArray(),sphereInitialized:e.sphereInitialized,sphereRadius:e.sphere.radius,sphereCenter:e.sphere.center.toArray()}))),n.maxGeometryCount=this._maxGeometryCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.geometryCount=this._geometryCount,n.matricesTexture=this._matricesTexture.toJSON(e),null!==this.boundingSphere&&(n.boundingSphere={center:n.boundingSphere.center.toArray(),radius:n.boundingSphere.radius}),null!==this.boundingBox&&(n.boundingBox={min:n.boundingBox.min.toArray(),max:n.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=r(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const i=t.shapes;if(Array.isArray(i))for(let t=0,n=i.length;t<n;t++){const n=i[t];r(e.shapes,n)}else r(e.shapes,i)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let i=0,n=this.material.length;i<n;i++)t.push(r(e.materials,this.material[i]));n.material=t}else n.material=r(e.materials,this.material);if(this.children.length>0){n.children=[];for(let t=0;t<this.children.length;t++)n.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let t=0;t<this.animations.length;t++){const i=this.animations[t];n.animations.push(r(e.animations,i))}}if(t){const t=s(e.geometries),n=s(e.materials),r=s(e.textures),a=s(e.images),o=s(e.shapes),l=s(e.skeletons),c=s(e.animations),h=s(e.nodes);t.length>0&&(i.geometries=t),n.length>0&&(i.materials=n),r.length>0&&(i.textures=r),a.length>0&&(i.images=a),o.length>0&&(i.shapes=o),l.length>0&&(i.skeletons=l),c.length>0&&(i.animations=c),h.length>0&&(i.nodes=h)}return i.object=n,i;function s(e){const t=[];for(const i in e){const n=e[i];delete n.metadata,t.push(n)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){const i=e.children[t];this.add(i.clone())}return this}}gd.DEFAULT_UP=new mh(0,1,0),gd.DEFAULT_MATRIX_AUTO_UPDATE=!0,gd.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const vd=new mh,_d=new mh,yd=new mh,bd=new mh,xd=new mh,wd=new mh,Ed=new mh,Sd=new mh,Td=new mh,Md=new mh;class Ad{constructor(e=new mh,t=new mh,i=new mh){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,n){n.subVectors(i,t),vd.subVectors(e,t),n.cross(vd);const r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)}static getBarycoord(e,t,i,n,r){vd.subVectors(n,t),_d.subVectors(i,t),yd.subVectors(e,t);const s=vd.dot(vd),a=vd.dot(_d),o=vd.dot(yd),l=_d.dot(_d),c=_d.dot(yd),h=s*l-a*a;if(0===h)return r.set(0,0,0),null;const d=1/h,u=(l*o-a*c)*d,p=(s*c-a*o)*d;return r.set(1-u-p,p,u)}static containsPoint(e,t,i,n){return null!==this.getBarycoord(e,t,i,n,bd)&&bd.x>=0&&bd.y>=0&&bd.x+bd.y<=1}static getInterpolation(e,t,i,n,r,s,a,o){return null===this.getBarycoord(e,t,i,n,bd)?(o.x=0,o.y=0,"z"in o&&(o.z=0),"w"in o&&(o.w=0),null):(o.setScalar(0),o.addScaledVector(r,bd.x),o.addScaledVector(s,bd.y),o.addScaledVector(a,bd.z),o)}static isFrontFacing(e,t,i,n){return vd.subVectors(i,t),_d.subVectors(e,t),vd.cross(_d).dot(n)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,n){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,i,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return vd.subVectors(this.c,this.b),_d.subVectors(this.a,this.b),.5*vd.cross(_d).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ad.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Ad.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,n,r){return Ad.getInterpolation(e,this.a,this.b,this.c,t,i,n,r)}containsPoint(e){return Ad.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ad.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,n=this.b,r=this.c;let s,a;xd.subVectors(n,i),wd.subVectors(r,i),Sd.subVectors(e,i);const o=xd.dot(Sd),l=wd.dot(Sd);if(o<=0&&l<=0)return t.copy(i);Td.subVectors(e,n);const c=xd.dot(Td),h=wd.dot(Td);if(c>=0&&h<=c)return t.copy(n);const d=o*h-c*l;if(d<=0&&o>=0&&c<=0)return s=o/(o-c),t.copy(i).addScaledVector(xd,s);Md.subVectors(e,r);const u=xd.dot(Md),p=wd.dot(Md);if(p>=0&&u<=p)return t.copy(r);const f=u*l-o*p;if(f<=0&&l>=0&&p<=0)return a=l/(l-p),t.copy(i).addScaledVector(wd,a);const m=c*p-u*h;if(m<=0&&h-c>=0&&u-p>=0)return Ed.subVectors(r,n),a=(h-c)/(h-c+(u-p)),t.copy(n).addScaledVector(Ed,a);const g=1/(m+f+d);return s=f*g,a=d*g,t.copy(i).addScaledVector(xd,s).addScaledVector(wd,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Cd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ld={h:0,s:0,l:0},Pd={h:0,s:0,l:0};function Rd(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+6*(t-e)*(2/3-i):e}class Od{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const t=e;t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=fc){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Qc.toWorkingColorSpace(this,t),this}setRGB(e,t,i,n=Qc.workingColorSpace){return this.r=e,this.g=t,this.b=i,Qc.toWorkingColorSpace(this,n),this}setHSL(e,t,i,n=Qc.workingColorSpace){if(e=Dc(e,1),t=Ic(t,0,1),i=Ic(i,0,1),0===t)this.r=this.g=this.b=i;else{const n=i<=.5?i*(1+t):i+t-i*t,r=2*i-n;this.r=Rd(r,n,e+1/3),this.g=Rd(r,n,e),this.b=Rd(r,n,e-1/3)}return Qc.toWorkingColorSpace(this,n),this}setStyle(e,t=fc){function i(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const s=n[1],a=n[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,t);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,t);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=n[1],r=i.length;if(3===r)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,t);if(6===r)return this.setHex(parseInt(i,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=fc){const i=Cd[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=eh(e.r),this.g=eh(e.g),this.b=eh(e.b),this}copyLinearToSRGB(e){return this.r=th(e.r),this.g=th(e.g),this.b=th(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=fc){return Qc.fromWorkingColorSpace(Id.copy(this),e),65536*Math.round(Ic(255*Id.r,0,255))+256*Math.round(Ic(255*Id.g,0,255))+Math.round(Ic(255*Id.b,0,255))}getHexString(e=fc){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Qc.workingColorSpace){Qc.fromWorkingColorSpace(Id.copy(this),t);const i=Id.r,n=Id.g,r=Id.b,s=Math.max(i,n,r),a=Math.min(i,n,r);let o,l;const c=(a+s)/2;if(a===s)o=0,l=0;else{const e=s-a;switch(l=c<=.5?e/(s+a):e/(2-s-a),s){case i:o=(n-r)/e+(n<r?6:0);break;case n:o=(r-i)/e+2;break;case r:o=(i-n)/e+4}o/=6}return e.h=o,e.s=l,e.l=c,e}getRGB(e,t=Qc.workingColorSpace){return Qc.fromWorkingColorSpace(Id.copy(this),t),e.r=Id.r,e.g=Id.g,e.b=Id.b,e}getStyle(e=fc){Qc.fromWorkingColorSpace(Id.copy(this),e);const t=Id.r,i=Id.g,n=Id.b;return e!==fc?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*n)})`}offsetHSL(e,t,i){return this.getHSL(Ld),this.setHSL(Ld.h+e,Ld.s+t,Ld.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Ld),e.getHSL(Pd);const i=Nc(Ld.h,Pd.h,t),n=Nc(Ld.s,Pd.s,t),r=Nc(Ld.l,Pd.l,t);return this.setHSL(i,n,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,n=this.b,r=e.elements;return this.r=r[0]*t+r[3]*i+r[6]*n,this.g=r[1]*t+r[4]*i+r[7]*n,this.b=r[2]*t+r[5]*i+r[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Id=new Od;Od.NAMES=Cd;let Dd=0;class Nd extends Ac{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Dd++}),this.uuid=Oc(),this.name="",this.type="Material",this.blending=1,this.side=_l,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=wl,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Od(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=wc,this.stencilZFail=wc,this.stencilZPass=wc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const n=this[t];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function n(e){const t=[];for(const i in e){const n=e[i];delete n.metadata,t.push(n)}return t}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),this.side!==_l&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),204!==this.blendSrc&&(i.blendSrc=this.blendSrc),205!==this.blendDst&&(i.blendDst=this.blendDst),this.blendEquation!==wl&&(i.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(i.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(i.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(i.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(i.depthFunc=this.depthFunc),!1===this.depthTest&&(i.depthTest=this.depthTest),!1===this.depthWrite&&(i.depthWrite=this.depthWrite),!1===this.colorWrite&&(i.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(i.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(i.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(i.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==wc&&(i.stencilFail=this.stencilFail),this.stencilZFail!==wc&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==wc&&(i.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(i.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const t=n(e.textures),r=n(e.images);t.length>0&&(i.textures=t),r.length>0&&(i.images=r)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const e=t.length;i=new Array(e);for(let n=0;n!==e;++n)i[n]=t[n].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Ud extends Nd{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Od(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=El,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Fd=new mh,zd=new Bc;class kd{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=ql,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return Yc("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let n=0,r=this.itemSize;n<r;n++)this.array[e+n]=t.array[i+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)zd.fromBufferAttribute(this,t),zd.applyMatrix3(e),this.setXY(t,zd.x,zd.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)Fd.fromBufferAttribute(this,t),Fd.applyMatrix3(e),this.setXYZ(t,Fd.x,Fd.y,Fd.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Fd.fromBufferAttribute(this,t),Fd.applyMatrix4(e),this.setXYZ(t,Fd.x,Fd.y,Fd.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Fd.fromBufferAttribute(this,t),Fd.applyNormalMatrix(e),this.setXYZ(t,Fd.x,Fd.y,Fd.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Fd.fromBufferAttribute(this,t),Fd.transformDirection(e),this.setXYZ(t,Fd.x,Fd.y,Fd.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=zc(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=kc(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=zc(t,this.array)),t}setX(e,t){return this.normalized&&(t=kc(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=zc(t,this.array)),t}setY(e,t){return this.normalized&&(t=kc(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=zc(t,this.array)),t}setZ(e,t){return this.normalized&&(t=kc(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=zc(t,this.array)),t}setW(e,t){return this.normalized&&(t=kc(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=kc(t,this.array),i=kc(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,n){return e*=this.itemSize,this.normalized&&(t=kc(t,this.array),i=kc(i,this.array),n=kc(n,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this}setXYZW(e,t,i,n,r){return e*=this.itemSize,this.normalized&&(t=kc(t,this.array),i=kc(i,this.array),n=kc(n,this.array),r=kc(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),e}}class Hd extends kd{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class Bd extends kd{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Vd extends kd{constructor(e,t,i){super(new Float32Array(e),t,i)}}let jd=0;const Gd=new Wh,Wd=new gd,Xd=new mh,qd=new _h,Yd=new _h,$d=new mh;class Zd extends Ac{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:jd++}),this.uuid=Oc(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Gc(e)?Bd:Hd)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const t=(new Vc).getNormalMatrix(e);i.applyNormalMatrix(t),i.needsUpdate=!0}const n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(e),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Gd.makeRotationFromQuaternion(e),this.applyMatrix4(Gd),this}rotateX(e){return Gd.makeRotationX(e),this.applyMatrix4(Gd),this}rotateY(e){return Gd.makeRotationY(e),this.applyMatrix4(Gd),this}rotateZ(e){return Gd.makeRotationZ(e),this.applyMatrix4(Gd),this}translate(e,t,i){return Gd.makeTranslation(e,t,i),this.applyMatrix4(Gd),this}scale(e,t,i){return Gd.makeScale(e,t,i),this.applyMatrix4(Gd),this}lookAt(e){return Wd.lookAt(e),Wd.updateMatrix(),this.applyMatrix4(Wd.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Xd).negate(),this.translate(Xd.x,Xd.y,Xd.z),this}setFromPoints(e){const t=[];for(let i=0,n=e.length;i<n;i++){const n=e[i];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new Vd(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new _h);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new mh(-1/0,-1/0,-1/0),new mh(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,i=t.length;e<i;e++){const i=t[e];qd.setFromBufferAttribute(i),this.morphTargetsRelative?($d.addVectors(this.boundingBox.min,qd.min),this.boundingBox.expandByPoint($d),$d.addVectors(this.boundingBox.max,qd.max),this.boundingBox.expandByPoint($d)):(this.boundingBox.expandByPoint(qd.min),this.boundingBox.expandByPoint(qd.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Uh);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new mh,1/0);if(e){const i=this.boundingSphere.center;if(qd.setFromBufferAttribute(e),t)for(let e=0,i=t.length;e<i;e++){const i=t[e];Yd.setFromBufferAttribute(i),this.morphTargetsRelative?($d.addVectors(qd.min,Yd.min),qd.expandByPoint($d),$d.addVectors(qd.max,Yd.max),qd.expandByPoint($d)):(qd.expandByPoint(Yd.min),qd.expandByPoint(Yd.max))}qd.getCenter(i);let n=0;for(let t=0,r=e.count;t<r;t++)$d.fromBufferAttribute(e,t),n=Math.max(n,i.distanceToSquared($d));if(t)for(let r=0,s=t.length;r<s;r++){const s=t[r],a=this.morphTargetsRelative;for(let t=0,r=s.count;t<r;t++)$d.fromBufferAttribute(s,t),a&&(Xd.fromBufferAttribute(e,t),$d.add(Xd)),n=Math.max(n,i.distanceToSquared($d))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,n=t.position.array,r=t.normal.array,s=t.uv.array,a=n.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new kd(new Float32Array(4*a),4));const o=this.getAttribute("tangent").array,l=[],c=[];for(let e=0;e<a;e++)l[e]=new mh,c[e]=new mh;const h=new mh,d=new mh,u=new mh,p=new Bc,f=new Bc,m=new Bc,g=new mh,v=new mh;function _(e,t,i){h.fromArray(n,3*e),d.fromArray(n,3*t),u.fromArray(n,3*i),p.fromArray(s,2*e),f.fromArray(s,2*t),m.fromArray(s,2*i),d.sub(h),u.sub(h),f.sub(p),m.sub(p);const r=1/(f.x*m.y-m.x*f.y);isFinite(r)&&(g.copy(d).multiplyScalar(m.y).addScaledVector(u,-f.y).multiplyScalar(r),v.copy(u).multiplyScalar(f.x).addScaledVector(d,-m.x).multiplyScalar(r),l[e].add(g),l[t].add(g),l[i].add(g),c[e].add(v),c[t].add(v),c[i].add(v))}let y=this.groups;0===y.length&&(y=[{start:0,count:i.length}]);for(let e=0,t=y.length;e<t;++e){const t=y[e],n=t.start;for(let e=n,r=n+t.count;e<r;e+=3)_(i[e+0],i[e+1],i[e+2])}const b=new mh,x=new mh,w=new mh,E=new mh;function S(e){w.fromArray(r,3*e),E.copy(w);const t=l[e];b.copy(t),b.sub(w.multiplyScalar(w.dot(t))).normalize(),x.crossVectors(E,t);const i=x.dot(c[e])<0?-1:1;o[4*e]=b.x,o[4*e+1]=b.y,o[4*e+2]=b.z,o[4*e+3]=i}for(let e=0,t=y.length;e<t;++e){const t=y[e],n=t.start;for(let e=n,r=n+t.count;e<r;e+=3)S(i[e+0]),S(i[e+1]),S(i[e+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new kd(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let e=0,t=i.count;e<t;e++)i.setXYZ(e,0,0,0);const n=new mh,r=new mh,s=new mh,a=new mh,o=new mh,l=new mh,c=new mh,h=new mh;if(e)for(let d=0,u=e.count;d<u;d+=3){const u=e.getX(d+0),p=e.getX(d+1),f=e.getX(d+2);n.fromBufferAttribute(t,u),r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,f),c.subVectors(s,r),h.subVectors(n,r),c.cross(h),a.fromBufferAttribute(i,u),o.fromBufferAttribute(i,p),l.fromBufferAttribute(i,f),a.add(c),o.add(c),l.add(c),i.setXYZ(u,a.x,a.y,a.z),i.setXYZ(p,o.x,o.y,o.z),i.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,a=t.count;e<a;e+=3)n.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),c.subVectors(s,r),h.subVectors(n,r),c.cross(h),i.setXYZ(e+0,c.x,c.y,c.z),i.setXYZ(e+1,c.x,c.y,c.z),i.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)$d.fromBufferAttribute(e,t),$d.normalize(),e.setXYZ(t,$d.x,$d.y,$d.z)}toNonIndexed(){function e(e,t){const i=e.array,n=e.itemSize,r=e.normalized,s=new i.constructor(t.length*n);let a=0,o=0;for(let r=0,l=t.length;r<l;r++){a=e.isInterleavedBufferAttribute?t[r]*e.data.stride+e.offset:t[r]*n;for(let e=0;e<n;e++)s[o++]=i[a++]}return new kd(s,n,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Zd,i=this.index.array,n=this.attributes;for(const r in n){const s=e(n[r],i);t.setAttribute(r,s)}const r=this.morphAttributes;for(const n in r){const s=[],a=r[n];for(let t=0,n=a.length;t<n;t++){const n=e(a[t],i);s.push(n)}t.morphAttributes[n]=s}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let e=0,i=s.length;e<i;e++){const i=s[e];t.addGroup(i.start,i.count,i.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const i in t)void 0!==t[i]&&(e[i]=t[i]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const t in i){const n=i[t];e.data.attributes[t]=n.toJSON(e.data)}const n={};let r=!1;for(const t in this.morphAttributes){const i=this.morphAttributes[t],s=[];for(let t=0,n=i.length;t<n;t++){const n=i[t];s.push(n.toJSON(e.data))}s.length>0&&(n[t]=s,r=!0)}r&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const n=e.attributes;for(const e in n){const i=n[e];this.setAttribute(e,i.clone(t))}const r=e.morphAttributes;for(const e in r){const i=[],n=r[e];for(let e=0,r=n.length;e<r;e++)i.push(n[e].clone(t));this.morphAttributes[e]=i}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let e=0,t=s.length;e<t;e++){const t=s[e];this.addGroup(t.start,t.count,t.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Kd=new Wh,Jd=new Gh,Qd=new Uh,eu=new mh,tu=new mh,iu=new mh,nu=new mh,ru=new mh,su=new mh,au=new Bc,ou=new Bc,lu=new Bc,cu=new mh,hu=new mh,du=new mh,uu=new mh,pu=new mh;class fu extends gd{constructor(e=new Zd,t=new Ud){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const i=e[t[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=i.length;e<t;e++){const t=i[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const i=this.geometry,n=i.attributes.position,r=i.morphAttributes.position,s=i.morphTargetsRelative;t.fromBufferAttribute(n,e);const a=this.morphTargetInfluences;if(r&&a){su.set(0,0,0);for(let i=0,n=r.length;i<n;i++){const n=a[i],o=r[i];0!==n&&(ru.fromBufferAttribute(o,e),s?su.addScaledVector(ru,n):su.addScaledVector(ru.sub(t),n))}t.add(su)}return t}raycast(e,t){const i=this.geometry,n=this.material,r=this.matrixWorld;if(void 0!==n){if(null===i.boundingSphere&&i.computeBoundingSphere(),Qd.copy(i.boundingSphere),Qd.applyMatrix4(r),Jd.copy(e.ray).recast(e.near),!1===Qd.containsPoint(Jd.origin)){if(null===Jd.intersectSphere(Qd,eu))return;if(Jd.origin.distanceToSquared(eu)>(e.far-e.near)**2)return}Kd.copy(r).invert(),Jd.copy(e.ray).applyMatrix4(Kd),null!==i.boundingBox&&!1===Jd.intersectsBox(i.boundingBox)||this._computeIntersections(e,t,Jd)}}_computeIntersections(e,t,i){let n;const r=this.geometry,s=this.material,a=r.index,o=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv1,h=r.attributes.normal,d=r.groups,u=r.drawRange;if(null!==a)if(Array.isArray(s))for(let r=0,o=d.length;r<o;r++){const o=d[r],p=s[o.materialIndex];for(let r=Math.max(o.start,u.start),s=Math.min(a.count,Math.min(o.start+o.count,u.start+u.count));r<s;r+=3)n=mu(this,p,e,i,l,c,h,a.getX(r),a.getX(r+1),a.getX(r+2)),n&&(n.faceIndex=Math.floor(r/3),n.face.materialIndex=o.materialIndex,t.push(n))}else for(let r=Math.max(0,u.start),o=Math.min(a.count,u.start+u.count);r<o;r+=3)n=mu(this,s,e,i,l,c,h,a.getX(r),a.getX(r+1),a.getX(r+2)),n&&(n.faceIndex=Math.floor(r/3),t.push(n));else if(void 0!==o)if(Array.isArray(s))for(let r=0,a=d.length;r<a;r++){const a=d[r],p=s[a.materialIndex];for(let r=Math.max(a.start,u.start),s=Math.min(o.count,Math.min(a.start+a.count,u.start+u.count));r<s;r+=3)n=mu(this,p,e,i,l,c,h,r,r+1,r+2),n&&(n.faceIndex=Math.floor(r/3),n.face.materialIndex=a.materialIndex,t.push(n))}else for(let r=Math.max(0,u.start),a=Math.min(o.count,u.start+u.count);r<a;r+=3)n=mu(this,s,e,i,l,c,h,r,r+1,r+2),n&&(n.faceIndex=Math.floor(r/3),t.push(n))}}function mu(e,t,i,n,r,s,a,o,l,c){e.getVertexPosition(o,tu),e.getVertexPosition(l,iu),e.getVertexPosition(c,nu);const h=function(e,t,i,n,r,s,a,o){let l;if(l=t.side===yl?n.intersectTriangle(a,s,r,!0,o):n.intersectTriangle(r,s,a,t.side===_l,o),null===l)return null;pu.copy(o),pu.applyMatrix4(e.matrixWorld);const c=i.ray.origin.distanceTo(pu);return c<i.near||c>i.far?null:{distance:c,point:pu.clone(),object:e}}(e,t,i,n,tu,iu,nu,uu);if(h){r&&(au.fromBufferAttribute(r,o),ou.fromBufferAttribute(r,l),lu.fromBufferAttribute(r,c),h.uv=Ad.getInterpolation(uu,tu,iu,nu,au,ou,lu,new Bc)),s&&(au.fromBufferAttribute(s,o),ou.fromBufferAttribute(s,l),lu.fromBufferAttribute(s,c),h.uv1=Ad.getInterpolation(uu,tu,iu,nu,au,ou,lu,new Bc),h.uv2=h.uv1),a&&(cu.fromBufferAttribute(a,o),hu.fromBufferAttribute(a,l),du.fromBufferAttribute(a,c),h.normal=Ad.getInterpolation(uu,tu,iu,nu,cu,hu,du,new mh),h.normal.dot(n.direction)>0&&h.normal.multiplyScalar(-1));const e={a:o,b:l,c,normal:new mh,materialIndex:0};Ad.getNormal(tu,iu,nu,e.normal),h.face=e}return h}class gu extends Zd{constructor(e=1,t=1,i=1,n=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:s};const a=this;n=Math.floor(n),r=Math.floor(r),s=Math.floor(s);const o=[],l=[],c=[],h=[];let d=0,u=0;function p(e,t,i,n,r,s,p,f,m,g,v){const _=s/m,y=p/g,b=s/2,x=p/2,w=f/2,E=m+1,S=g+1;let T=0,M=0;const A=new mh;for(let s=0;s<S;s++){const a=s*y-x;for(let o=0;o<E;o++){const d=o*_-b;A[e]=d*n,A[t]=a*r,A[i]=w,l.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[i]=f>0?1:-1,c.push(A.x,A.y,A.z),h.push(o/m),h.push(1-s/g),T+=1}}for(let e=0;e<g;e++)for(let t=0;t<m;t++){const i=d+t+E*e,n=d+t+E*(e+1),r=d+(t+1)+E*(e+1),s=d+(t+1)+E*e;o.push(i,n,s),o.push(n,r,s),M+=6}a.addGroup(u,M,v),u+=M,d+=T}p("z","y","x",-1,-1,i,t,e,s,r,0),p("z","y","x",1,-1,i,t,-e,s,r,1),p("x","z","y",1,1,e,i,t,n,s,2),p("x","z","y",1,-1,e,i,-t,n,s,3),p("x","y","z",1,-1,e,t,i,n,r,4),p("x","y","z",-1,-1,e,t,-i,n,r,5),this.setIndex(o),this.setAttribute("position",new Vd(l,3)),this.setAttribute("normal",new Vd(c,3)),this.setAttribute("uv",new Vd(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gu(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function vu(e){const t={};for(const i in e){t[i]={};for(const n in e[i]){const r=e[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[i][n]=null):t[i][n]=r.clone():Array.isArray(r)?t[i][n]=r.slice():t[i][n]=r}}return t}function _u(e){const t={};for(let i=0;i<e.length;i++){const n=vu(e[i]);for(const e in n)t[e]=n[e]}return t}function yu(e){return null===e.getRenderTarget()?e.outputColorSpace:Qc.workingColorSpace}const bu={clone:vu,merge:_u};class xu extends Nd{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=vu(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let i=0;i<e.length;i++)t.push(e[i].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const e in this.extensions)!0===this.extensions[e]&&(i[e]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class wu extends gd{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Wh,this.projectionMatrix=new Wh,this.projectionMatrixInverse=new Wh,this.coordinateSystem=Tc}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Eu=new mh,Su=new Bc,Tu=new Bc;class Mu extends wu{constructor(e=50,t=1,i=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Rc*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Pc*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Rc*Math.atan(Math.tan(.5*Pc*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){Eu.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Eu.x,Eu.y).multiplyScalar(-e/Eu.z),Eu.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Eu.x,Eu.y).multiplyScalar(-e/Eu.z)}getViewSize(e,t){return this.getViewBounds(e,Su,Tu),t.subVectors(Tu,Su)}setViewOffset(e,t,i,n,r,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Pc*this.fov)/this.zoom,i=2*t,n=this.aspect*i,r=-.5*n;const s=this.view;if(null!==this.view&&this.view.enabled){const e=s.fullWidth,a=s.fullHeight;r+=s.offsetX*n/e,t-=s.offsetY*i/a,n*=s.width/e,i*=s.height/a}const a=this.filmOffset;0!==a&&(r+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Au=-90;class Cu extends gd{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const n=new Mu(Au,1,e,t);n.layers=this.layers,this.add(n);const r=new Mu(Au,1,e,t);r.layers=this.layers,this.add(r);const s=new Mu(Au,1,e,t);s.layers=this.layers,this.add(s);const a=new Mu(Au,1,e,t);a.layers=this.layers,this.add(a);const o=new Mu(Au,1,e,t);o.layers=this.layers,this.add(o);const l=new Mu(Au,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,n,r,s,a,o]=t;for(const e of t)this.remove(e);if(e===Tc)i.up.set(0,1,0),i.lookAt(1,0,0),n.up.set(0,1,0),n.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else{if(e!==Mc)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),n.up.set(0,-1,0),n.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1)}for(const e of t)this.add(e),e.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:n}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,s,a,o,l,c]=this.children,h=e.getRenderTarget(),d=e.getActiveCubeFace(),u=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const f=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,n),e.render(t,r),e.setRenderTarget(i,1,n),e.render(t,s),e.setRenderTarget(i,2,n),e.render(t,a),e.setRenderTarget(i,3,n),e.render(t,o),e.setRenderTarget(i,4,n),e.render(t,l),i.texture.generateMipmaps=f,e.setRenderTarget(i,5,n),e.render(t,c),e.setRenderTarget(h,d,u),e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class Lu extends lh{constructor(e,t,i,n,r,s,a,o,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:Il,i,n,r,s,a,o,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Pu extends dh{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},n=[i,i,i,i,i,i];void 0!==t.encoding&&(Yc("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===uc?fc:pc),this.texture=new Lu(n,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Bl}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={tEquirect:{value:null}},n="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new gu(5,5,5),a=new xu({name:"CubemapFromEquirect",uniforms:vu(i),vertexShader:n,fragmentShader:r,side:yl,blending:xl});a.uniforms.tEquirect.value=t;const o=new fu(s,a),l=t.minFilter;return t.minFilter===jl&&(t.minFilter=Bl),new Cu(1,10,this).update(e,o),t.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,n){const r=e.getRenderTarget();for(let r=0;r<6;r++)e.setRenderTarget(this,r),e.clear(t,i,n);e.setRenderTarget(r)}}const Ru=new mh,Ou=new mh,Iu=new Vc;class Du{constructor(e=new mh(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,n){return this.normal.set(e,t,i),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const n=Ru.subVectors(i,t).cross(Ou.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(Ru),n=this.normal.dot(i);if(0===n)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/n;return r<0||r>1?null:t.copy(e.start).addScaledVector(i,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||Iu.getNormalMatrix(e),n=this.coplanarPoint(Ru).applyMatrix4(e),r=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Nu=new Uh,Uu=new mh;class Fu{constructor(e=new Du,t=new Du,i=new Du,n=new Du,r=new Du,s=new Du){this.planes=[e,t,i,n,r,s]}set(e,t,i,n,r,s){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(n),a[4].copy(r),a[5].copy(s),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=2e3){const i=this.planes,n=e.elements,r=n[0],s=n[1],a=n[2],o=n[3],l=n[4],c=n[5],h=n[6],d=n[7],u=n[8],p=n[9],f=n[10],m=n[11],g=n[12],v=n[13],_=n[14],y=n[15];if(i[0].setComponents(o-r,d-l,m-u,y-g).normalize(),i[1].setComponents(o+r,d+l,m+u,y+g).normalize(),i[2].setComponents(o+s,d+c,m+p,y+v).normalize(),i[3].setComponents(o-s,d-c,m-p,y-v).normalize(),i[4].setComponents(o-a,d-h,m-f,y-_).normalize(),t===Tc)i[5].setComponents(o+a,d+h,m+f,y+_).normalize();else{if(t!==Mc)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(a,h,f,_).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Nu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Nu.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Nu)}intersectsSprite(e){return Nu.center.set(0,0,0),Nu.radius=.7071067811865476,Nu.applyMatrix4(e.matrixWorld),this.intersectsSphere(Nu)}intersectsSphere(e){const t=this.planes,i=e.center,n=-e.radius;for(let e=0;e<6;e++)if(t[e].distanceToPoint(i)<n)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const n=t[i];if(Uu.x=n.normal.x>0?e.max.x:e.min.x,Uu.y=n.normal.y>0?e.max.y:e.min.y,Uu.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(Uu)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function zu(){let e=null,t=!1,i=null,n=null;function r(t,s){i(t,s),n=e.requestAnimationFrame(r)}return{start:function(){!0!==t&&null!==i&&(n=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(e){i=e},setContext:function(t){e=t}}}function ku(e,t){const i=t.isWebGL2,n=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),n.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const i=n.get(t);i&&(e.deleteBuffer(i.buffer),n.delete(t))},update:function(t,r){if(t.isGLBufferAttribute){const e=n.get(t);return void((!e||e.version<t.version)&&n.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);const s=n.get(t);if(void 0===s)n.set(t,function(t,n){const r=t.array,s=t.usage,a=r.byteLength,o=e.createBuffer();let l;if(e.bindBuffer(n,o),e.bufferData(n,r,s),t.onUploadCallback(),r instanceof Float32Array)l=e.FLOAT;else if(r instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!i)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");l=e.HALF_FLOAT}else l=e.UNSIGNED_SHORT;else if(r instanceof Int16Array)l=e.SHORT;else if(r instanceof Uint32Array)l=e.UNSIGNED_INT;else if(r instanceof Int32Array)l=e.INT;else if(r instanceof Int8Array)l=e.BYTE;else if(r instanceof Uint8Array)l=e.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);l=e.UNSIGNED_BYTE}return{buffer:o,type:l,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version,size:a}}(t,r));else if(s.version<t.version){if(s.size!==t.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,n,r){const s=n.array,a=n._updateRange,o=n.updateRanges;if(e.bindBuffer(r,t),-1===a.count&&0===o.length&&e.bufferSubData(r,0,s),0!==o.length){for(let t=0,n=o.length;t<n;t++){const n=o[t];i?e.bufferSubData(r,n.start*s.BYTES_PER_ELEMENT,s,n.start,n.count):e.bufferSubData(r,n.start*s.BYTES_PER_ELEMENT,s.subarray(n.start,n.start+n.count))}n.clearUpdateRanges()}-1!==a.count&&(i?e.bufferSubData(r,a.offset*s.BYTES_PER_ELEMENT,s,a.offset,a.count):e.bufferSubData(r,a.offset*s.BYTES_PER_ELEMENT,s.subarray(a.offset,a.offset+a.count)),a.count=-1),n.onUploadCallback()}(s.buffer,t,r),s.version=t.version}}}}class Hu extends Zd{constructor(e=1,t=1,i=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n};const r=e/2,s=t/2,a=Math.floor(i),o=Math.floor(n),l=a+1,c=o+1,h=e/a,d=t/o,u=[],p=[],f=[],m=[];for(let e=0;e<c;e++){const t=e*d-s;for(let i=0;i<l;i++){const n=i*h-r;p.push(n,-t,0),f.push(0,0,1),m.push(i/a),m.push(1-e/o)}}for(let e=0;e<o;e++)for(let t=0;t<a;t++){const i=t+l*e,n=t+l*(e+1),r=t+1+l*(e+1),s=t+1+l*e;u.push(i,n,s),u.push(n,r,s)}this.setIndex(u),this.setAttribute("position",new Vd(p,3)),this.setAttribute("normal",new Vd(f,3)),this.setAttribute("uv",new Vd(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Hu(e.width,e.height,e.widthSegments,e.heightSegments)}}const Bu={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\tattribute float batchId;\n\tuniform highp sampler2D batchingTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( batchId );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Vu={common:{diffuse:{value:new Od(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Vc},alphaMap:{value:null},alphaMapTransform:{value:new Vc},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Vc}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Vc}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Vc}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Vc},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Vc},normalScale:{value:new Bc(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Vc},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Vc}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Vc}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Vc}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Od(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Od(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Vc},alphaTest:{value:0},uvTransform:{value:new Vc}},sprite:{diffuse:{value:new Od(16777215)},opacity:{value:1},center:{value:new Bc(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Vc},alphaMap:{value:null},alphaMapTransform:{value:new Vc},alphaTest:{value:0}}},ju={basic:{uniforms:_u([Vu.common,Vu.specularmap,Vu.envmap,Vu.aomap,Vu.lightmap,Vu.fog]),vertexShader:Bu.meshbasic_vert,fragmentShader:Bu.meshbasic_frag},lambert:{uniforms:_u([Vu.common,Vu.specularmap,Vu.envmap,Vu.aomap,Vu.lightmap,Vu.emissivemap,Vu.bumpmap,Vu.normalmap,Vu.displacementmap,Vu.fog,Vu.lights,{emissive:{value:new Od(0)}}]),vertexShader:Bu.meshlambert_vert,fragmentShader:Bu.meshlambert_frag},phong:{uniforms:_u([Vu.common,Vu.specularmap,Vu.envmap,Vu.aomap,Vu.lightmap,Vu.emissivemap,Vu.bumpmap,Vu.normalmap,Vu.displacementmap,Vu.fog,Vu.lights,{emissive:{value:new Od(0)},specular:{value:new Od(1118481)},shininess:{value:30}}]),vertexShader:Bu.meshphong_vert,fragmentShader:Bu.meshphong_frag},standard:{uniforms:_u([Vu.common,Vu.envmap,Vu.aomap,Vu.lightmap,Vu.emissivemap,Vu.bumpmap,Vu.normalmap,Vu.displacementmap,Vu.roughnessmap,Vu.metalnessmap,Vu.fog,Vu.lights,{emissive:{value:new Od(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Bu.meshphysical_vert,fragmentShader:Bu.meshphysical_frag},toon:{uniforms:_u([Vu.common,Vu.aomap,Vu.lightmap,Vu.emissivemap,Vu.bumpmap,Vu.normalmap,Vu.displacementmap,Vu.gradientmap,Vu.fog,Vu.lights,{emissive:{value:new Od(0)}}]),vertexShader:Bu.meshtoon_vert,fragmentShader:Bu.meshtoon_frag},matcap:{uniforms:_u([Vu.common,Vu.bumpmap,Vu.normalmap,Vu.displacementmap,Vu.fog,{matcap:{value:null}}]),vertexShader:Bu.meshmatcap_vert,fragmentShader:Bu.meshmatcap_frag},points:{uniforms:_u([Vu.points,Vu.fog]),vertexShader:Bu.points_vert,fragmentShader:Bu.points_frag},dashed:{uniforms:_u([Vu.common,Vu.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Bu.linedashed_vert,fragmentShader:Bu.linedashed_frag},depth:{uniforms:_u([Vu.common,Vu.displacementmap]),vertexShader:Bu.depth_vert,fragmentShader:Bu.depth_frag},normal:{uniforms:_u([Vu.common,Vu.bumpmap,Vu.normalmap,Vu.displacementmap,{opacity:{value:1}}]),vertexShader:Bu.meshnormal_vert,fragmentShader:Bu.meshnormal_frag},sprite:{uniforms:_u([Vu.sprite,Vu.fog]),vertexShader:Bu.sprite_vert,fragmentShader:Bu.sprite_frag},background:{uniforms:{uvTransform:{value:new Vc},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Bu.background_vert,fragmentShader:Bu.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Bu.backgroundCube_vert,fragmentShader:Bu.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Bu.cube_vert,fragmentShader:Bu.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Bu.equirect_vert,fragmentShader:Bu.equirect_frag},distanceRGBA:{uniforms:_u([Vu.common,Vu.displacementmap,{referencePosition:{value:new mh},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Bu.distanceRGBA_vert,fragmentShader:Bu.distanceRGBA_frag},shadow:{uniforms:_u([Vu.lights,Vu.fog,{color:{value:new Od(0)},opacity:{value:1}}]),vertexShader:Bu.shadow_vert,fragmentShader:Bu.shadow_frag}};ju.physical={uniforms:_u([ju.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Vc},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Vc},clearcoatNormalScale:{value:new Bc(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Vc},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Vc},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Vc},sheen:{value:0},sheenColor:{value:new Od(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Vc},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Vc},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Vc},transmissionSamplerSize:{value:new Bc},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Vc},attenuationDistance:{value:0},attenuationColor:{value:new Od(0)},specularColor:{value:new Od(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Vc},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Vc},anisotropyVector:{value:new Bc},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Vc}}]),vertexShader:Bu.meshphysical_vert,fragmentShader:Bu.meshphysical_frag};const Gu={r:0,b:0,g:0};function Wu(e,t,i,n,r,s,a){const o=new Od(0);let l,c,h=!0===s?0:1,d=null,u=0,p=null;function f(t,i){t.getRGB(Gu,yu(e)),n.buffers.color.setClear(Gu.r,Gu.g,Gu.b,i,a)}return{getClearColor:function(){return o},setClearColor:function(e,t=1){o.set(e),h=t,f(o,h)},getClearAlpha:function(){return h},setClearAlpha:function(e){h=e,f(o,h)},render:function(s,m){let g=!1,v=!0===m.isScene?m.background:null;v&&v.isTexture&&(v=(m.backgroundBlurriness>0?i:t).get(v)),null===v?f(o,h):v&&v.isColor&&(f(v,1),g=!0);const _=e.xr.getEnvironmentBlendMode();"additive"===_?n.buffers.color.setClear(0,0,0,1,a):"alpha-blend"===_&&n.buffers.color.setClear(0,0,0,0,a),(e.autoClear||g)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),v&&(v.isCubeTexture||v.mapping===Nl)?(void 0===c&&(c=new fu(new gu(1,1,1),new xu({name:"BackgroundCubeMaterial",uniforms:vu(ju.backgroundCube.uniforms),vertexShader:ju.backgroundCube.vertexShader,fragmentShader:ju.backgroundCube.fragmentShader,side:yl,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(e,t,i){this.matrixWorld.copyPosition(i.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),c.material.uniforms.envMap.value=v,c.material.uniforms.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,c.material.toneMapped=Qc.getTransfer(v.colorSpace)!==yc,d===v&&u===v.version&&p===e.toneMapping||(c.material.needsUpdate=!0,d=v,u=v.version,p=e.toneMapping),c.layers.enableAll(),s.unshift(c,c.geometry,c.material,0,0,null)):v&&v.isTexture&&(void 0===l&&(l=new fu(new Hu(2,2),new xu({name:"BackgroundMaterial",uniforms:vu(ju.background.uniforms),vertexShader:ju.background.vertexShader,fragmentShader:ju.background.fragmentShader,side:_l,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=v,l.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,l.material.toneMapped=Qc.getTransfer(v.colorSpace)!==yc,!0===v.matrixAutoUpdate&&v.updateMatrix(),l.material.uniforms.uvTransform.value.copy(v.matrix),d===v&&u===v.version&&p===e.toneMapping||(l.material.needsUpdate=!0,d=v,u=v.version,p=e.toneMapping),l.layers.enableAll(),s.unshift(l,l.geometry,l.material,0,0,null))}}}function Xu(e,t,i,n){const r=e.getParameter(e.MAX_VERTEX_ATTRIBS),s=n.isWebGL2?null:t.get("OES_vertex_array_object"),a=n.isWebGL2||null!==s,o={},l=p(null);let c=l,h=!1;function d(t){return n.isWebGL2?e.bindVertexArray(t):s.bindVertexArrayOES(t)}function u(t){return n.isWebGL2?e.deleteVertexArray(t):s.deleteVertexArrayOES(t)}function p(e){const t=[],i=[],n=[];for(let e=0;e<r;e++)t[e]=0,i[e]=0,n[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:i,attributeDivisors:n,object:e,attributes:{},index:null}}function f(){const e=c.newAttributes;for(let t=0,i=e.length;t<i;t++)e[t]=0}function m(e){g(e,0)}function g(i,r){const s=c.newAttributes,a=c.enabledAttributes,o=c.attributeDivisors;s[i]=1,0===a[i]&&(e.enableVertexAttribArray(i),a[i]=1),o[i]!==r&&((n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](i,r),o[i]=r)}function v(){const t=c.newAttributes,i=c.enabledAttributes;for(let n=0,r=i.length;n<r;n++)i[n]!==t[n]&&(e.disableVertexAttribArray(n),i[n]=0)}function _(t,i,n,r,s,a,o){!0===o?e.vertexAttribIPointer(t,i,n,s,a):e.vertexAttribPointer(t,i,n,r,s,a)}function y(){b(),h=!0,c!==l&&(c=l,d(c.object))}function b(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(r,l,u,y,b){let x=!1;if(a){const t=function(t,i,r){const a=!0===r.wireframe;let l=o[t.id];void 0===l&&(l={},o[t.id]=l);let c=l[i.id];void 0===c&&(c={},l[i.id]=c);let h=c[a];return void 0===h&&(h=p(n.isWebGL2?e.createVertexArray():s.createVertexArrayOES()),c[a]=h),h}(y,u,l);c!==t&&(c=t,d(c.object)),x=function(e,t,i,n){const r=c.attributes,s=t.attributes;let a=0;const o=i.getAttributes();for(const t in o)if(o[t].location>=0){const i=r[t];let n=s[t];if(void 0===n&&("instanceMatrix"===t&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(n=e.instanceColor)),void 0===i)return!0;if(i.attribute!==n)return!0;if(n&&i.data!==n.data)return!0;a++}return c.attributesNum!==a||c.index!==n}(r,y,u,b),x&&function(e,t,i,n){const r={},s=t.attributes;let a=0;const o=i.getAttributes();for(const t in o)if(o[t].location>=0){let i=s[t];void 0===i&&("instanceMatrix"===t&&e.instanceMatrix&&(i=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(i=e.instanceColor));const n={};n.attribute=i,i&&i.data&&(n.data=i.data),r[t]=n,a++}c.attributes=r,c.attributesNum=a,c.index=n}(r,y,u,b)}else{const e=!0===l.wireframe;c.geometry===y.id&&c.program===u.id&&c.wireframe===e||(c.geometry=y.id,c.program=u.id,c.wireframe=e,x=!0)}null!==b&&i.update(b,e.ELEMENT_ARRAY_BUFFER),(x||h)&&(h=!1,function(r,s,a,o){if(!1===n.isWebGL2&&(r.isInstancedMesh||o.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;f();const l=o.attributes,c=a.getAttributes(),h=s.defaultAttributeValues;for(const t in c){const s=c[t];if(s.location>=0){let a=l[t];if(void 0===a&&("instanceMatrix"===t&&r.instanceMatrix&&(a=r.instanceMatrix),"instanceColor"===t&&r.instanceColor&&(a=r.instanceColor)),void 0!==a){const t=a.normalized,l=a.itemSize,c=i.get(a);if(void 0===c)continue;const h=c.buffer,d=c.type,u=c.bytesPerElement,p=!0===n.isWebGL2&&(d===e.INT||d===e.UNSIGNED_INT||1013===a.gpuType);if(a.isInterleavedBufferAttribute){const i=a.data,n=i.stride,c=a.offset;if(i.isInstancedInterleavedBuffer){for(let e=0;e<s.locationSize;e++)g(s.location+e,i.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=i.meshPerAttribute*i.count)}else for(let e=0;e<s.locationSize;e++)m(s.location+e);e.bindBuffer(e.ARRAY_BUFFER,h);for(let e=0;e<s.locationSize;e++)_(s.location+e,l/s.locationSize,d,t,n*u,(c+l/s.locationSize*e)*u,p)}else{if(a.isInstancedBufferAttribute){for(let e=0;e<s.locationSize;e++)g(s.location+e,a.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=a.meshPerAttribute*a.count)}else for(let e=0;e<s.locationSize;e++)m(s.location+e);e.bindBuffer(e.ARRAY_BUFFER,h);for(let e=0;e<s.locationSize;e++)_(s.location+e,l/s.locationSize,d,t,l*u,l/s.locationSize*e*u,p)}}else if(void 0!==h){const i=h[t];if(void 0!==i)switch(i.length){case 2:e.vertexAttrib2fv(s.location,i);break;case 3:e.vertexAttrib3fv(s.location,i);break;case 4:e.vertexAttrib4fv(s.location,i);break;default:e.vertexAttrib1fv(s.location,i)}}}}v()}(r,l,u,y),null!==b&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i.get(b).buffer))},reset:y,resetDefaultState:b,dispose:function(){y();for(const e in o){const t=o[e];for(const e in t){const i=t[e];for(const e in i)u(i[e].object),delete i[e];delete t[e]}delete o[e]}},releaseStatesOfGeometry:function(e){if(void 0===o[e.id])return;const t=o[e.id];for(const e in t){const i=t[e];for(const e in i)u(i[e].object),delete i[e];delete t[e]}delete o[e.id]},releaseStatesOfProgram:function(e){for(const t in o){const i=o[t];if(void 0===i[e.id])continue;const n=i[e.id];for(const e in n)u(n[e].object),delete n[e];delete i[e.id]}},initAttributes:f,enableAttribute:m,disableUnusedAttributes:v}}function qu(e,t,i,n){const r=n.isWebGL2;let s;this.setMode=function(e){s=e},this.render=function(t,n){e.drawArrays(s,t,n),i.update(n,s,1)},this.renderInstances=function(n,a,o){if(0===o)return;let l,c;if(r)l=e,c="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](s,n,a,o),i.update(a,s,o)},this.renderMultiDraw=function(e,n,r){if(0===r)return;const a=t.get("WEBGL_multi_draw");if(null===a)for(let t=0;t<r;t++)this.render(e[t],n[t]);else{a.multiDrawArraysWEBGL(s,e,0,n,0,r);let t=0;for(let e=0;e<r;e++)t+=n[e];i.update(t,s,1)}}}function Yu(e,t,i){let n;function r(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const s="undefined"!=typeof WebGL2RenderingContext&&"WebGL2RenderingContext"===e.constructor.name;let a=void 0!==i.precision?i.precision:"highp";const o=r(a);o!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",o,"instead."),a=o);const l=s||t.has("WEBGL_draw_buffers"),c=!0===i.logarithmicDepthBuffer,h=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),u=e.getParameter(e.MAX_TEXTURE_SIZE),p=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),f=e.getParameter(e.MAX_VERTEX_ATTRIBS),m=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),g=e.getParameter(e.MAX_VARYING_VECTORS),v=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),_=d>0,y=s||t.has("OES_texture_float");return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==n)return n;if(!0===t.has("EXT_texture_filter_anisotropic")){const i=t.get("EXT_texture_filter_anisotropic");n=e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:r,precision:a,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:d,maxTextureSize:u,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:_,floatFragmentTextures:y,floatVertexTextures:_&&y,maxSamples:s?e.getParameter(e.MAX_SAMPLES):0}}function $u(e){const t=this;let i=null,n=0,r=!1,s=!1;const a=new Du,o=new Vc,l={value:null,needsUpdate:!1};function c(e,i,n,r){const s=null!==e?e.length:0;let c=null;if(0!==s){if(c=l.value,!0!==r||null===c){const t=n+4*s,r=i.matrixWorldInverse;o.getNormalMatrix(r),(null===c||c.length<t)&&(c=new Float32Array(t));for(let t=0,i=n;t!==s;++t,i+=4)a.copy(e[t]).applyMatrix4(r,o),a.normal.toArray(c,i),c[i+3]=a.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const i=0!==e.length||t||0!==n||r;return r=t,n=e.length,i},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(e,t){i=c(e,t,0)},this.setState=function(a,o,h){const d=a.clippingPlanes,u=a.clipIntersection,p=a.clipShadows,f=e.get(a);if(!r||null===d||0===d.length||s&&!p)s?c(null):(l.value!==i&&(l.value=i,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0);else{const e=s?0:n,t=4*e;let r=f.clippingState||null;l.value=r,r=c(d,o,t,h);for(let e=0;e!==t;++e)r[e]=i[e];f.clippingState=r,this.numIntersection=u?this.numPlanes:0,this.numPlanes+=e}}}function Zu(e){let t=new WeakMap;function i(e,t){return 303===t?e.mapping=Il:304===t&&(e.mapping=Dl),e}function n(e){const i=e.target;i.removeEventListener("dispose",n);const r=t.get(i);void 0!==r&&(t.delete(i),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping;if(303===s||304===s){if(t.has(r))return i(t.get(r).texture,r.mapping);{const s=r.image;if(s&&s.height>0){const a=new Pu(s.height);return a.fromEquirectangularTexture(e,r),t.set(r,a),r.addEventListener("dispose",n),i(a.texture,r.mapping)}return null}}}return r},dispose:function(){t=new WeakMap}}}class Ku extends wu{constructor(e=-1,t=1,i=1,n=-1,r=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=n,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,n,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let r=i-e,s=i+e,a=n+t,o=n-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,s=r+e*this.view.width,a-=t*this.view.offsetY,o=a-t*this.view.height}this.projectionMatrix.makeOrthographic(r,s,a,o,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Ju=[.125,.215,.35,.446,.526,.582],Qu=20,ep=new Ku,tp=new Od;let ip=null,np=0,rp=0;const sp=(1+Math.sqrt(5))/2,ap=1/sp,op=[new mh(1,1,1),new mh(-1,1,1),new mh(1,1,-1),new mh(-1,1,-1),new mh(0,sp,ap),new mh(0,sp,-ap),new mh(ap,0,sp),new mh(-ap,0,sp),new mh(sp,ap,0),new mh(-sp,ap,0)];class lp{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,n=100){ip=this._renderer.getRenderTarget(),np=this._renderer.getActiveCubeFace(),rp=this._renderer.getActiveMipmapLevel(),this._setSize(256);const r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,i,n,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=up(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=dp(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(ip,np,rp),e.scissorTest=!1,hp(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Il||e.mapping===Dl?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),ip=this._renderer.getRenderTarget(),np=this._renderer.getActiveCubeFace(),rp=this._renderer.getActiveMipmapLevel();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Bl,minFilter:Bl,generateMipmaps:!1,type:Yl,format:Jl,colorSpace:mc,depthBuffer:!1},n=cp(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=cp(e,t,i);const{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],i=[],n=[];let r=e;const s=e-4+1+Ju.length;for(let a=0;a<s;a++){const s=Math.pow(2,r);i.push(s);let o=1/s;a>e-4?o=Ju[a-e+4-1]:0===a&&(o=0),n.push(o);const l=1/(s-2),c=-l,h=1+l,d=[c,c,h,c,h,h,c,c,h,h,c,h],u=6,p=6,f=3,m=2,g=1,v=new Float32Array(f*p*u),_=new Float32Array(m*p*u),y=new Float32Array(g*p*u);for(let e=0;e<u;e++){const t=e%3*2/3-1,i=e>2?0:-1,n=[t,i,0,t+2/3,i,0,t+2/3,i+1,0,t,i,0,t+2/3,i+1,0,t,i+1,0];v.set(n,f*p*e),_.set(d,m*p*e);const r=[e,e,e,e,e,e];y.set(r,g*p*e)}const b=new Zd;b.setAttribute("position",new kd(v,f)),b.setAttribute("uv",new kd(_,m)),b.setAttribute("faceIndex",new kd(y,g)),t.push(b),r>4&&r--}return{lodPlanes:t,sizeLods:i,sigmas:n}}(n)),this._blurMaterial=function(e,t,i){const n=new Float32Array(Qu),r=new mh(0,1,0);return new xu({name:"SphericalGaussianBlur",defines:{n:Qu,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:xl,depthTest:!1,depthWrite:!1})}(n,e,t)}return n}_compileMaterial(e){const t=new fu(this._lodPlanes[0],e);this._renderer.compile(t,ep)}_sceneToCubeUV(e,t,i,n){const r=new Mu(90,1,t,i),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,c=o.toneMapping;o.getClearColor(tp),o.toneMapping=Ml,o.autoClear=!1;const h=new Ud({name:"PMREM.Background",side:yl,depthWrite:!1,depthTest:!1}),d=new fu(new gu,h);let u=!1;const p=e.background;p?p.isColor&&(h.color.copy(p),e.background=null,u=!0):(h.color.copy(tp),u=!0);for(let t=0;t<6;t++){const i=t%3;0===i?(r.up.set(0,s[t],0),r.lookAt(a[t],0,0)):1===i?(r.up.set(0,0,s[t]),r.lookAt(0,a[t],0)):(r.up.set(0,s[t],0),r.lookAt(0,0,a[t]));const l=this._cubeSize;hp(n,i*l,t>2?l:0,l,l),o.setRenderTarget(n),u&&o.render(d,r),o.render(e,r)}d.geometry.dispose(),d.material.dispose(),o.toneMapping=c,o.autoClear=l,e.background=p}_textureToCubeUV(e,t){const i=this._renderer,n=e.mapping===Il||e.mapping===Dl;n?(null===this._cubemapMaterial&&(this._cubemapMaterial=up()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=dp());const r=n?this._cubemapMaterial:this._equirectMaterial,s=new fu(this._lodPlanes[0],r);r.uniforms.envMap.value=e;const a=this._cubeSize;hp(t,0,0,3*a,2*a),i.setRenderTarget(t),i.render(s,ep)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let t=1;t<this._lodPlanes.length;t++){const i=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),n=op[(t-1)%op.length];this._blur(e,t-1,t,i,n)}t.autoClear=i}_blur(e,t,i,n,r){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,i,n,"latitudinal",r),this._halfBlur(s,e,i,i,n,"longitudinal",r)}_halfBlur(e,t,i,n,r,s,a){const o=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new fu(this._lodPlanes[n],l),h=l.uniforms,d=this._sizeLods[i]-1,u=isFinite(r)?Math.PI/(2*d):2*Math.PI/39,p=r/u,f=isFinite(r)?1+Math.floor(3*p):Qu;f>Qu&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${f} samples when the maximum is set to 20`);const m=[];let g=0;for(let e=0;e<Qu;++e){const t=e/p,i=Math.exp(-t*t/2);m.push(i),0===e?g+=i:e<f&&(g+=2*i)}for(let e=0;e<m.length;e++)m[e]=m[e]/g;h.envMap.value=e.texture,h.samples.value=f,h.weights.value=m,h.latitudinal.value="latitudinal"===s,a&&(h.poleAxis.value=a);const{_lodMax:v}=this;h.dTheta.value=u,h.mipInt.value=v-i;const _=this._sizeLods[n];hp(t,3*_*(n>v-4?n-v+4:0),4*(this._cubeSize-_),3*_,2*_),o.setRenderTarget(t),o.render(c,ep)}}function cp(e,t,i){const n=new dh(e,t,i);return n.texture.mapping=Nl,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function hp(e,t,i,n,r){e.viewport.set(t,i,n,r),e.scissor.set(t,i,n,r)}function dp(){return new xu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:xl,depthTest:!1,depthWrite:!1})}function up(){return new xu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:xl,depthTest:!1,depthWrite:!1})}function pp(e){let t=new WeakMap,i=null;function n(e){const i=e.target;i.removeEventListener("dispose",n);const r=t.get(i);void 0!==r&&(t.delete(i),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping,a=303===s||304===s,o=s===Il||s===Dl;if(a||o){if(r.isRenderTargetTexture&&!0===r.needsPMREMUpdate){r.needsPMREMUpdate=!1;let n=t.get(r);return null===i&&(i=new lp(e)),n=a?i.fromEquirectangular(r,n):i.fromCubemap(r,n),t.set(r,n),n.texture}if(t.has(r))return t.get(r).texture;{const s=r.image;if(a&&s&&s.height>0||o&&s&&function(e){let t=0;for(let i=0;i<6;i++)void 0!==e[i]&&t++;return 6===t}(s)){null===i&&(i=new lp(e));const s=a?i.fromEquirectangular(r):i.fromCubemap(r);return t.set(r,s),r.addEventListener("dispose",n),s.texture}return null}}}return r},dispose:function(){t=new WeakMap,null!==i&&(i.dispose(),i=null)}}}function fp(e){const t={};function i(i){if(void 0!==t[i])return t[i];let n;switch(i){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(i)}return t[i]=n,n}return{has:function(e){return null!==i(e)},init:function(e){e.isWebGL2?(i("EXT_color_buffer_float"),i("WEBGL_clip_cull_distance")):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(e){const t=i(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function mp(e,t,i,n){const r={},s=new WeakMap;function a(e){const o=e.target;null!==o.index&&t.remove(o.index);for(const e in o.attributes)t.remove(o.attributes[e]);for(const e in o.morphAttributes){const i=o.morphAttributes[e];for(let e=0,n=i.length;e<n;e++)t.remove(i[e])}o.removeEventListener("dispose",a),delete r[o.id];const l=s.get(o);l&&(t.remove(l),s.delete(o)),n.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,i.memory.geometries--}function o(e){const i=[],n=e.index,r=e.attributes.position;let a=0;if(null!==n){const e=n.array;a=n.version;for(let t=0,n=e.length;t<n;t+=3){const n=e[t+0],r=e[t+1],s=e[t+2];i.push(n,r,r,s,s,n)}}else{if(void 0===r)return;{const e=r.array;a=r.version;for(let t=0,n=e.length/3-1;t<n;t+=3){const e=t+0,n=t+1,r=t+2;i.push(e,n,n,r,r,e)}}}const o=new(Gc(i)?Bd:Hd)(i,1);o.version=a;const l=s.get(e);l&&t.remove(l),s.set(e,o)}return{get:function(e,t){return!0===r[t.id]||(t.addEventListener("dispose",a),r[t.id]=!0,i.memory.geometries++),t},update:function(i){const n=i.attributes;for(const i in n)t.update(n[i],e.ARRAY_BUFFER);const r=i.morphAttributes;for(const i in r){const n=r[i];for(let i=0,r=n.length;i<r;i++)t.update(n[i],e.ARRAY_BUFFER)}},getWireframeAttribute:function(e){const t=s.get(e);if(t){const i=e.index;null!==i&&t.version<i.version&&o(e)}else o(e);return s.get(e)}}}function gp(e,t,i,n){const r=n.isWebGL2;let s,a,o;this.setMode=function(e){s=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,n){e.drawElements(s,n,a,t*o),i.update(n,s,1)},this.renderInstances=function(n,l,c){if(0===c)return;let h,d;if(r)h=e,d="drawElementsInstanced";else if(h=t.get("ANGLE_instanced_arrays"),d="drawElementsInstancedANGLE",null===h)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[d](s,l,a,n*o,c),i.update(l,s,c)},this.renderMultiDraw=function(e,n,r){if(0===r)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<r;t++)this.render(e[t]/o,n[t]);else{l.multiDrawElementsWEBGL(s,n,0,a,e,0,r);let t=0;for(let e=0;e<r;e++)t+=n[e];i.update(t,s,1)}}}function vp(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(i,n,r){switch(t.calls++,n){case e.TRIANGLES:t.triangles+=r*(i/3);break;case e.LINES:t.lines+=r*(i/2);break;case e.LINE_STRIP:t.lines+=r*(i-1);break;case e.LINE_LOOP:t.lines+=r*i;break;case e.POINTS:t.points+=r*i;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function _p(e,t){return e[0]-t[0]}function yp(e,t){return Math.abs(t[1])-Math.abs(e[1])}function bp(e,t,i){const n={},r=new Float32Array(8),s=new WeakMap,a=new ch,o=[];for(let e=0;e<8;e++)o[e]=[e,0];return{update:function(l,c,h){const d=l.morphTargetInfluences;if(!0===t.isWebGL2){const u=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,p=void 0!==u?u.length:0;let f=s.get(c);if(void 0===f||f.count!==p){void 0!==f&&f.texture.dispose();const v=void 0!==c.morphAttributes.position,_=void 0!==c.morphAttributes.normal,y=void 0!==c.morphAttributes.color,b=c.morphAttributes.position||[],x=c.morphAttributes.normal||[],w=c.morphAttributes.color||[];let E=0;!0===v&&(E=1),!0===_&&(E=2),!0===y&&(E=3);let S=c.attributes.position.count*E,T=1;S>t.maxTextureSize&&(T=Math.ceil(S/t.maxTextureSize),S=t.maxTextureSize);const M=new Float32Array(S*T*4*p),A=new uh(M,S,T,p);A.type=ql,A.needsUpdate=!0;const C=4*E;for(let P=0;P<p;P++){const R=b[P],O=x[P],I=w[P],D=S*T*4*P;for(let N=0;N<R.count;N++){const U=N*C;!0===v&&(a.fromBufferAttribute(R,N),M[D+U+0]=a.x,M[D+U+1]=a.y,M[D+U+2]=a.z,M[D+U+3]=0),!0===_&&(a.fromBufferAttribute(O,N),M[D+U+4]=a.x,M[D+U+5]=a.y,M[D+U+6]=a.z,M[D+U+7]=0),!0===y&&(a.fromBufferAttribute(I,N),M[D+U+8]=a.x,M[D+U+9]=a.y,M[D+U+10]=a.z,M[D+U+11]=4===I.itemSize?a.w:1)}}function L(){A.dispose(),s.delete(c),c.removeEventListener("dispose",L)}f={count:p,texture:A,size:new Bc(S,T)},s.set(c,f),c.addEventListener("dispose",L)}let m=0;for(let F=0;F<d.length;F++)m+=d[F];const g=c.morphTargetsRelative?1:1-m;h.getUniforms().setValue(e,"morphTargetBaseInfluence",g),h.getUniforms().setValue(e,"morphTargetInfluences",d),h.getUniforms().setValue(e,"morphTargetsTexture",f.texture,i),h.getUniforms().setValue(e,"morphTargetsTextureSize",f.size)}else{const z=void 0===d?0:d.length;let k=n[c.id];if(void 0===k||k.length!==z){k=[];for(let G=0;G<z;G++)k[G]=[G,0];n[c.id]=k}for(let W=0;W<z;W++){const X=k[W];X[0]=W,X[1]=d[W]}k.sort(yp);for(let q=0;q<8;q++)q<z&&k[q][1]?(o[q][0]=k[q][0],o[q][1]=k[q][1]):(o[q][0]=Number.MAX_SAFE_INTEGER,o[q][1]=0);o.sort(_p);const H=c.morphAttributes.position,B=c.morphAttributes.normal;let V=0;for(let Y=0;Y<8;Y++){const $=o[Y],Z=$[0],K=$[1];Z!==Number.MAX_SAFE_INTEGER&&K?(H&&c.getAttribute("morphTarget"+Y)!==H[Z]&&c.setAttribute("morphTarget"+Y,H[Z]),B&&c.getAttribute("morphNormal"+Y)!==B[Z]&&c.setAttribute("morphNormal"+Y,B[Z]),r[Y]=K,V+=K):(H&&!0===c.hasAttribute("morphTarget"+Y)&&c.deleteAttribute("morphTarget"+Y),B&&!0===c.hasAttribute("morphNormal"+Y)&&c.deleteAttribute("morphNormal"+Y),r[Y]=0)}const j=c.morphTargetsRelative?1:1-V;h.getUniforms().setValue(e,"morphTargetBaseInfluence",j),h.getUniforms().setValue(e,"morphTargetInfluences",r)}}}}function xp(e,t,i,n){let r=new WeakMap;function s(e){const t=e.target;t.removeEventListener("dispose",s),i.remove(t.instanceMatrix),null!==t.instanceColor&&i.remove(t.instanceColor)}return{update:function(a){const o=n.render.frame,l=a.geometry,c=t.get(a,l);if(r.get(c)!==o&&(t.update(c),r.set(c,o)),a.isInstancedMesh&&(!1===a.hasEventListener("dispose",s)&&a.addEventListener("dispose",s),r.get(a)!==o&&(i.update(a.instanceMatrix,e.ARRAY_BUFFER),null!==a.instanceColor&&i.update(a.instanceColor,e.ARRAY_BUFFER),r.set(a,o))),a.isSkinnedMesh){const e=a.skeleton;r.get(e)!==o&&(e.update(),r.set(e,o))}return c},dispose:function(){r=new WeakMap}}}class wp extends lh{constructor(e,t,i,n,r,s,a,o,l,c){if((c=void 0!==c?c:Ql)!==Ql&&c!==ec)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&c===Ql&&(i=Xl),void 0===i&&c===ec&&(i=Kl),super(null,n,r,s,a,o,c,i,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:kl,this.minFilter=void 0!==o?o:kl,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}const Ep=new lh,Sp=new wp(1,1);Sp.compareFunction=515;const Tp=new uh,Mp=new ph,Ap=new Lu,Cp=[],Lp=[],Pp=new Float32Array(16),Rp=new Float32Array(9),Op=new Float32Array(4);function Ip(e,t,i){const n=e[0];if(n<=0||n>0)return e;const r=t*i;let s=Cp[r];if(void 0===s&&(s=new Float32Array(r),Cp[r]=s),0!==t){n.toArray(s,0);for(let n=1,r=0;n!==t;++n)r+=i,e[n].toArray(s,r)}return s}function Dp(e,t){if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(e[i]!==t[i])return!1;return!0}function Np(e,t){for(let i=0,n=t.length;i<n;i++)e[i]=t[i]}function Up(e,t){let i=Lp[t];void 0===i&&(i=new Int32Array(t),Lp[t]=i);for(let n=0;n!==t;++n)i[n]=e.allocateTextureUnit();return i}function Fp(e,t){const i=this.cache;i[0]!==t&&(e.uniform1f(this.addr,t),i[0]=t)}function zp(e,t){const i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(Dp(i,t))return;e.uniform2fv(this.addr,t),Np(i,t)}}function kp(e,t){const i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y&&i[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(void 0!==t.r)i[0]===t.r&&i[1]===t.g&&i[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(Dp(i,t))return;e.uniform3fv(this.addr,t),Np(i,t)}}function Hp(e,t){const i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y&&i[2]===t.z&&i[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(Dp(i,t))return;e.uniform4fv(this.addr,t),Np(i,t)}}function Bp(e,t){const i=this.cache,n=t.elements;if(void 0===n){if(Dp(i,t))return;e.uniformMatrix2fv(this.addr,!1,t),Np(i,t)}else{if(Dp(i,n))return;Op.set(n),e.uniformMatrix2fv(this.addr,!1,Op),Np(i,n)}}function Vp(e,t){const i=this.cache,n=t.elements;if(void 0===n){if(Dp(i,t))return;e.uniformMatrix3fv(this.addr,!1,t),Np(i,t)}else{if(Dp(i,n))return;Rp.set(n),e.uniformMatrix3fv(this.addr,!1,Rp),Np(i,n)}}function jp(e,t){const i=this.cache,n=t.elements;if(void 0===n){if(Dp(i,t))return;e.uniformMatrix4fv(this.addr,!1,t),Np(i,t)}else{if(Dp(i,n))return;Pp.set(n),e.uniformMatrix4fv(this.addr,!1,Pp),Np(i,n)}}function Gp(e,t){const i=this.cache;i[0]!==t&&(e.uniform1i(this.addr,t),i[0]=t)}function Wp(e,t){const i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(Dp(i,t))return;e.uniform2iv(this.addr,t),Np(i,t)}}function Xp(e,t){const i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y&&i[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(Dp(i,t))return;e.uniform3iv(this.addr,t),Np(i,t)}}function qp(e,t){const i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y&&i[2]===t.z&&i[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(Dp(i,t))return;e.uniform4iv(this.addr,t),Np(i,t)}}function Yp(e,t){const i=this.cache;i[0]!==t&&(e.uniform1ui(this.addr,t),i[0]=t)}function $p(e,t){const i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(Dp(i,t))return;e.uniform2uiv(this.addr,t),Np(i,t)}}function Zp(e,t){const i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y&&i[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(Dp(i,t))return;e.uniform3uiv(this.addr,t),Np(i,t)}}function Kp(e,t){const i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y&&i[2]===t.z&&i[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(Dp(i,t))return;e.uniform4uiv(this.addr,t),Np(i,t)}}function Jp(e,t,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r);const s=this.type===e.SAMPLER_2D_SHADOW?Sp:Ep;i.setTexture2D(t||s,r)}function Qp(e,t,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(t||Mp,r)}function ef(e,t,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTextureCube(t||Ap,r)}function tf(e,t,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(t||Tp,r)}function nf(e,t){e.uniform1fv(this.addr,t)}function rf(e,t){const i=Ip(t,this.size,2);e.uniform2fv(this.addr,i)}function sf(e,t){const i=Ip(t,this.size,3);e.uniform3fv(this.addr,i)}function af(e,t){const i=Ip(t,this.size,4);e.uniform4fv(this.addr,i)}function of(e,t){const i=Ip(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,i)}function lf(e,t){const i=Ip(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,i)}function cf(e,t){const i=Ip(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,i)}function hf(e,t){e.uniform1iv(this.addr,t)}function df(e,t){e.uniform2iv(this.addr,t)}function uf(e,t){e.uniform3iv(this.addr,t)}function pf(e,t){e.uniform4iv(this.addr,t)}function ff(e,t){e.uniform1uiv(this.addr,t)}function mf(e,t){e.uniform2uiv(this.addr,t)}function gf(e,t){e.uniform3uiv(this.addr,t)}function vf(e,t){e.uniform4uiv(this.addr,t)}function _f(e,t,i){const n=this.cache,r=t.length,s=Up(i,r);Dp(n,s)||(e.uniform1iv(this.addr,s),Np(n,s));for(let e=0;e!==r;++e)i.setTexture2D(t[e]||Ep,s[e])}function yf(e,t,i){const n=this.cache,r=t.length,s=Up(i,r);Dp(n,s)||(e.uniform1iv(this.addr,s),Np(n,s));for(let e=0;e!==r;++e)i.setTexture3D(t[e]||Mp,s[e])}function bf(e,t,i){const n=this.cache,r=t.length,s=Up(i,r);Dp(n,s)||(e.uniform1iv(this.addr,s),Np(n,s));for(let e=0;e!==r;++e)i.setTextureCube(t[e]||Ap,s[e])}function xf(e,t,i){const n=this.cache,r=t.length,s=Up(i,r);Dp(n,s)||(e.uniform1iv(this.addr,s),Np(n,s));for(let e=0;e!==r;++e)i.setTexture2DArray(t[e]||Tp,s[e])}class wf{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return Fp;case 35664:return zp;case 35665:return kp;case 35666:return Hp;case 35674:return Bp;case 35675:return Vp;case 35676:return jp;case 5124:case 35670:return Gp;case 35667:case 35671:return Wp;case 35668:case 35672:return Xp;case 35669:case 35673:return qp;case 5125:return Yp;case 36294:return $p;case 36295:return Zp;case 36296:return Kp;case 35678:case 36198:case 36298:case 36306:case 35682:return Jp;case 35679:case 36299:case 36307:return Qp;case 35680:case 36300:case 36308:case 36293:return ef;case 36289:case 36303:case 36311:case 36292:return tf}}(t.type)}}class Ef{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return nf;case 35664:return rf;case 35665:return sf;case 35666:return af;case 35674:return of;case 35675:return lf;case 35676:return cf;case 5124:case 35670:return hf;case 35667:case 35671:return df;case 35668:case 35672:return uf;case 35669:case 35673:return pf;case 5125:return ff;case 36294:return mf;case 36295:return gf;case 36296:return vf;case 35678:case 36198:case 36298:case 36306:case 35682:return _f;case 35679:case 36299:case 36307:return yf;case 35680:case 36300:case 36308:case 36293:return bf;case 36289:case 36303:case 36311:case 36292:return xf}}(t.type)}}class Sf{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const n=this.seq;for(let r=0,s=n.length;r!==s;++r){const s=n[r];s.setValue(e,t[s.id],i)}}}const Tf=/(\w+)(\])?(\[|\.)?/g;function Mf(e,t){e.seq.push(t),e.map[t.id]=t}function Af(e,t,i){const n=e.name,r=n.length;for(Tf.lastIndex=0;;){const s=Tf.exec(n),a=Tf.lastIndex;let o=s[1];const l="]"===s[2],c=s[3];if(l&&(o|=0),void 0===c||"["===c&&a+2===r){Mf(i,void 0===c?new wf(o,e,t):new Ef(o,e,t));break}{let e=i.map[o];void 0===e&&(e=new Sf(o),Mf(i,e)),i=e}}}class Cf{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let n=0;n<i;++n){const i=e.getActiveUniform(t,n);Af(i,e.getUniformLocation(t,i.name),this)}}setValue(e,t,i,n){const r=this.map[t];void 0!==r&&r.setValue(e,i,n)}setOptional(e,t,i){const n=t[i];void 0!==n&&this.setValue(e,i,n)}static upload(e,t,i,n){for(let r=0,s=t.length;r!==s;++r){const s=t[r],a=i[s.id];!1!==a.needsUpdate&&s.setValue(e,a.value,n)}}static seqWithValue(e,t){const i=[];for(let n=0,r=e.length;n!==r;++n){const r=e[n];r.id in t&&i.push(r)}return i}}function Lf(e,t,i){const n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),n}const Pf=37297;let Rf=0;function Of(e,t,i){const n=e.getShaderParameter(t,e.COMPILE_STATUS),r=e.getShaderInfoLog(t).trim();if(n&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const n=parseInt(s[1]);return i.toUpperCase()+"\n\n"+r+"\n\n"+function(e,t){const i=e.split("\n"),n=[],r=Math.max(t-6,0),s=Math.min(t+6,i.length);for(let e=r;e<s;e++){const r=e+1;n.push(`${r===t?">":" "} ${r}: ${i[e]}`)}return n.join("\n")}(e.getShaderSource(t),n)}return r}function If(e,t){const i=function(e){const t=Qc.getPrimaries(Qc.workingColorSpace),i=Qc.getPrimaries(e);let n;switch(t===i?n="":t===xc&&i===bc?n="LinearDisplayP3ToLinearSRGB":t===bc&&i===xc&&(n="LinearSRGBToLinearDisplayP3"),e){case mc:case vc:return[n,"LinearTransferOETF"];case fc:case gc:return[n,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",e),[n,"LinearTransferOETF"]}}(t);return`vec4 ${e}( vec4 value ) { return ${i[0]}( ${i[1]}( value ) ); }`}function Df(e,t){let i;switch(t){case Al:i="Linear";break;case Cl:i="Reinhard";break;case Ll:i="OptimizedCineon";break;case Pl:i="ACESFilmic";break;case Ol:i="AgX";break;case Rl:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),i="Linear"}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function Nf(e){return""!==e}function Uf(e,t){const i=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Ff(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const zf=/^[ \t]*#include +<([\w\d./]+)>/gm;function kf(e){return e.replace(zf,Bf)}const Hf=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Bf(e,t){let i=Bu[t];if(void 0===i){const e=Hf.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");i=Bu[e],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return kf(i)}const Vf=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function jf(e){return e.replace(Vf,Gf)}function Gf(e,t,i,n){let r="";for(let e=parseInt(t);e<parseInt(i);e++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return r}function Wf(e){let t=`precision ${e.precision} float;\n\tprecision ${e.precision} int;\n\tprecision ${e.precision} sampler2D;\n\tprecision ${e.precision} samplerCube;\n\t`;return e.isWebGL2&&(t+=`precision ${e.precision} sampler3D;\n\t\tprecision ${e.precision} sampler2DArray;\n\t\tprecision ${e.precision} sampler2DShadow;\n\t\tprecision ${e.precision} samplerCubeShadow;\n\t\tprecision ${e.precision} sampler2DArrayShadow;\n\t\tprecision ${e.precision} isampler2D;\n\t\tprecision ${e.precision} isampler3D;\n\t\tprecision ${e.precision} isamplerCube;\n\t\tprecision ${e.precision} isampler2DArray;\n\t\tprecision ${e.precision} usampler2D;\n\t\tprecision ${e.precision} usampler3D;\n\t\tprecision ${e.precision} usamplerCube;\n\t\tprecision ${e.precision} usampler2DArray;\n\t\t`),"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Xf(e,t,i,n){const r=e.getContext(),s=i.defines;let a=i.vertexShader,o=i.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===ml?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===gl?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===vl&&(t="SHADOWMAP_TYPE_VSM"),t}(i),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Il:case Dl:t="ENVMAP_TYPE_CUBE";break;case Nl:t="ENVMAP_TYPE_CUBE_UV"}return t}(i),h=function(e){let t="ENVMAP_MODE_REFLECTION";return e.envMap&&e.envMapMode===Dl&&(t="ENVMAP_MODE_REFRACTION"),t}(i),d=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case El:t="ENVMAP_BLENDING_MULTIPLY";break;case Sl:t="ENVMAP_BLENDING_MIX";break;case Tl:t="ENVMAP_BLENDING_ADD"}return t}(i),u=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const i=Math.log2(t)-2,n=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,i),112)),texelHeight:n,maxMip:i}}(i),p=i.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.normalMapTangentSpace||e.clearcoatNormalMap||e.flatShading||e.alphaToCoverage||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Nf).join("\n")}(i),f=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Nf).join("\n")}(i),m=function(e){const t=[];for(const i in e){const n=e[i];!1!==n&&t.push("#define "+i+" "+n)}return t.join("\n")}(s),g=r.createProgram();let v,_,y=i.glslVersion?"#version "+i.glslVersion+"\n":"";i.isRawShaderMaterial?(v=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m].filter(Nf).join("\n"),v.length>0&&(v+="\n"),_=[p,"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m].filter(Nf).join("\n"),_.length>0&&(_+="\n")):(v=[Wf(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m,i.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",i.batching?"#define USE_BATCHING":"",i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.displacementMap?"#define USE_DISPLACEMENTMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.mapUv?"#define MAP_UV "+i.mapUv:"",i.alphaMapUv?"#define ALPHAMAP_UV "+i.alphaMapUv:"",i.lightMapUv?"#define LIGHTMAP_UV "+i.lightMapUv:"",i.aoMapUv?"#define AOMAP_UV "+i.aoMapUv:"",i.emissiveMapUv?"#define EMISSIVEMAP_UV "+i.emissiveMapUv:"",i.bumpMapUv?"#define BUMPMAP_UV "+i.bumpMapUv:"",i.normalMapUv?"#define NORMALMAP_UV "+i.normalMapUv:"",i.displacementMapUv?"#define DISPLACEMENTMAP_UV "+i.displacementMapUv:"",i.metalnessMapUv?"#define METALNESSMAP_UV "+i.metalnessMapUv:"",i.roughnessMapUv?"#define ROUGHNESSMAP_UV "+i.roughnessMapUv:"",i.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+i.anisotropyMapUv:"",i.clearcoatMapUv?"#define CLEARCOATMAP_UV "+i.clearcoatMapUv:"",i.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+i.clearcoatNormalMapUv:"",i.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+i.clearcoatRoughnessMapUv:"",i.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+i.iridescenceMapUv:"",i.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+i.iridescenceThicknessMapUv:"",i.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+i.sheenColorMapUv:"",i.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+i.sheenRoughnessMapUv:"",i.specularMapUv?"#define SPECULARMAP_UV "+i.specularMapUv:"",i.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+i.specularColorMapUv:"",i.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+i.specularIntensityMapUv:"",i.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+i.transmissionMapUv:"",i.thicknessMapUv?"#define THICKNESSMAP_UV "+i.thicknessMapUv:"",i.vertexTangents&&!1===i.flatShading?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&!1===i.flatShading?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Nf).join("\n"),_=[p,Wf(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.envMap?"#define "+h:"",i.envMap?"#define "+d:"",u?"#define CUBEUV_TEXEL_WIDTH "+u.texelWidth:"",u?"#define CUBEUV_TEXEL_HEIGHT "+u.texelHeight:"",u?"#define CUBEUV_MAX_MIP "+u.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents&&!1===i.flatShading?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==Ml?"#define TONE_MAPPING":"",i.toneMapping!==Ml?Bu.tonemapping_pars_fragment:"",i.toneMapping!==Ml?Df("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",Bu.colorspace_pars_fragment,If("linearToOutputTexel",i.outputColorSpace),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(Nf).join("\n")),a=kf(a),a=Uf(a,i),a=Ff(a,i),o=kf(o),o=Uf(o,i),o=Ff(o,i),a=jf(a),o=jf(o),i.isWebGL2&&!0!==i.isRawShaderMaterial&&(y="#version 300 es\n",v=[f,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+v,_=["precision mediump sampler2DArray;","#define varying in",i.glslVersion===Ec?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===Ec?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_);const b=y+v+a,x=y+_+o,w=Lf(r,r.VERTEX_SHADER,b),E=Lf(r,r.FRAGMENT_SHADER,x);function S(t){if(e.debug.checkShaderErrors){const i=r.getProgramInfoLog(g).trim(),n=r.getShaderInfoLog(w).trim(),s=r.getShaderInfoLog(E).trim();let a=!0,o=!0;if(!1===r.getProgramParameter(g,r.LINK_STATUS))if(a=!1,"function"==typeof e.debug.onShaderError)e.debug.onShaderError(r,g,w,E);else{const e=Of(r,w,"vertex"),n=Of(r,E,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(g,r.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+i+"\n"+e+"\n"+n)}else""!==i?console.warn("THREE.WebGLProgram: Program Info Log:",i):""!==n&&""!==s||(o=!1);o&&(t.diagnostics={runnable:a,programLog:i,vertexShader:{log:n,prefix:v},fragmentShader:{log:s,prefix:_}})}r.deleteShader(w),r.deleteShader(E),T=new Cf(r,g),M=function(e,t){const i={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const n=e.getActiveAttrib(t,r),s=n.name;let a=1;n.type===e.FLOAT_MAT2&&(a=2),n.type===e.FLOAT_MAT3&&(a=3),n.type===e.FLOAT_MAT4&&(a=4),i[s]={type:n.type,location:e.getAttribLocation(t,s),locationSize:a}}return i}(r,g)}let T,M;r.attachShader(g,w),r.attachShader(g,E),void 0!==i.index0AttributeName?r.bindAttribLocation(g,0,i.index0AttributeName):!0===i.morphTargets&&r.bindAttribLocation(g,0,"position"),r.linkProgram(g),this.getUniforms=function(){return void 0===T&&S(this),T},this.getAttributes=function(){return void 0===M&&S(this),M};let A=!1===i.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===A&&(A=r.getProgramParameter(g,Pf)),A},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(g),this.program=void 0},this.type=i.shaderType,this.name=i.shaderName,this.id=Rf++,this.cacheKey=t,this.usedTimes=1,this.program=g,this.vertexShader=w,this.fragmentShader=E,this}let qf=0;class Yf{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,n=this._getShaderStage(t),r=this._getShaderStage(i),s=this._getShaderCacheForMaterial(e);return!1===s.has(n)&&(s.add(n),n.usedTimes++),!1===s.has(r)&&(s.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const e of t)e.usedTimes--,0===e.usedTimes&&this.shaderCache.delete(e.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new $f(e),t.set(e,i)),i}}class $f{constructor(e){this.id=qf++,this.code=e,this.usedTimes=0}}function Zf(e,t,i,n,r,s,a){const o=new id,l=new Yf,c=new Set,h=[],d=r.isWebGL2,u=r.logarithmicDepthBuffer,p=r.vertexTextures;let f=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(e){return c.add(e),0===e?"uv":`uv${e}`}return{getParameters:function(s,o,h,v,_){const y=v.fog,b=_.geometry,x=s.isMeshStandardMaterial?v.environment:null,w=(s.isMeshStandardMaterial?i:t).get(s.envMap||x),E=w&&w.mapping===Nl?w.image.height:null,S=m[s.type];null!==s.precision&&(f=r.getMaxPrecision(s.precision),f!==s.precision&&console.warn("THREE.WebGLProgram.getParameters:",s.precision,"not supported, using",f,"instead."));const T=b.morphAttributes.position||b.morphAttributes.normal||b.morphAttributes.color,M=void 0!==T?T.length:0;let A,C,L,P,R=0;if(void 0!==b.morphAttributes.position&&(R=1),void 0!==b.morphAttributes.normal&&(R=2),void 0!==b.morphAttributes.color&&(R=3),S){const e=ju[S];A=e.vertexShader,C=e.fragmentShader}else A=s.vertexShader,C=s.fragmentShader,l.update(s),L=l.getVertexShaderID(s),P=l.getFragmentShaderID(s);const O=e.getRenderTarget(),I=!0===_.isInstancedMesh,D=!0===_.isBatchedMesh,N=!!s.map,U=!!s.matcap,F=!!w,z=!!s.aoMap,k=!!s.lightMap,H=!!s.bumpMap,B=!!s.normalMap,V=!!s.displacementMap,j=!!s.emissiveMap,G=!!s.metalnessMap,W=!!s.roughnessMap,X=s.anisotropy>0,q=s.clearcoat>0,Y=s.iridescence>0,$=s.sheen>0,Z=s.transmission>0,K=X&&!!s.anisotropyMap,J=q&&!!s.clearcoatMap,Q=q&&!!s.clearcoatNormalMap,ee=q&&!!s.clearcoatRoughnessMap,te=Y&&!!s.iridescenceMap,ie=Y&&!!s.iridescenceThicknessMap,ne=$&&!!s.sheenColorMap,re=$&&!!s.sheenRoughnessMap,se=!!s.specularMap,ae=!!s.specularColorMap,oe=!!s.specularIntensityMap,le=Z&&!!s.transmissionMap,ce=Z&&!!s.thicknessMap,he=!!s.gradientMap,de=!!s.alphaMap,ue=s.alphaTest>0,pe=!!s.alphaHash,fe=!!s.extensions;let me=Ml;s.toneMapped&&(null!==O&&!0!==O.isXRRenderTarget||(me=e.toneMapping));const ge={isWebGL2:d,shaderID:S,shaderType:s.type,shaderName:s.name,vertexShader:A,fragmentShader:C,defines:s.defines,customVertexShaderID:L,customFragmentShaderID:P,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:f,batching:D,instancing:I,instancingColor:I&&null!==_.instanceColor,supportsVertexTextures:p,outputColorSpace:null===O?e.outputColorSpace:!0===O.isXRRenderTarget?O.texture.colorSpace:mc,alphaToCoverage:!!s.alphaToCoverage,map:N,matcap:U,envMap:F,envMapMode:F&&w.mapping,envMapCubeUVHeight:E,aoMap:z,lightMap:k,bumpMap:H,normalMap:B,displacementMap:p&&V,emissiveMap:j,normalMapObjectSpace:B&&1===s.normalMapType,normalMapTangentSpace:B&&0===s.normalMapType,metalnessMap:G,roughnessMap:W,anisotropy:X,anisotropyMap:K,clearcoat:q,clearcoatMap:J,clearcoatNormalMap:Q,clearcoatRoughnessMap:ee,iridescence:Y,iridescenceMap:te,iridescenceThicknessMap:ie,sheen:$,sheenColorMap:ne,sheenRoughnessMap:re,specularMap:se,specularColorMap:ae,specularIntensityMap:oe,transmission:Z,transmissionMap:le,thicknessMap:ce,gradientMap:he,opaque:!1===s.transparent&&1===s.blending&&!1===s.alphaToCoverage,alphaMap:de,alphaTest:ue,alphaHash:pe,combine:s.combine,mapUv:N&&g(s.map.channel),aoMapUv:z&&g(s.aoMap.channel),lightMapUv:k&&g(s.lightMap.channel),bumpMapUv:H&&g(s.bumpMap.channel),normalMapUv:B&&g(s.normalMap.channel),displacementMapUv:V&&g(s.displacementMap.channel),emissiveMapUv:j&&g(s.emissiveMap.channel),metalnessMapUv:G&&g(s.metalnessMap.channel),roughnessMapUv:W&&g(s.roughnessMap.channel),anisotropyMapUv:K&&g(s.anisotropyMap.channel),clearcoatMapUv:J&&g(s.clearcoatMap.channel),clearcoatNormalMapUv:Q&&g(s.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ee&&g(s.clearcoatRoughnessMap.channel),iridescenceMapUv:te&&g(s.iridescenceMap.channel),iridescenceThicknessMapUv:ie&&g(s.iridescenceThicknessMap.channel),sheenColorMapUv:ne&&g(s.sheenColorMap.channel),sheenRoughnessMapUv:re&&g(s.sheenRoughnessMap.channel),specularMapUv:se&&g(s.specularMap.channel),specularColorMapUv:ae&&g(s.specularColorMap.channel),specularIntensityMapUv:oe&&g(s.specularIntensityMap.channel),transmissionMapUv:le&&g(s.transmissionMap.channel),thicknessMapUv:ce&&g(s.thicknessMap.channel),alphaMapUv:de&&g(s.alphaMap.channel),vertexTangents:!!b.attributes.tangent&&(B||X),vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!b.attributes.color&&4===b.attributes.color.itemSize,pointsUvs:!0===_.isPoints&&!!b.attributes.uv&&(N||de),fog:!!y,useFog:!0===s.fog,fogExp2:!!y&&y.isFogExp2,flatShading:!0===s.flatShading,sizeAttenuation:!0===s.sizeAttenuation,logarithmicDepthBuffer:u,skinning:!0===_.isSkinnedMesh,morphTargets:void 0!==b.morphAttributes.position,morphNormals:void 0!==b.morphAttributes.normal,morphColors:void 0!==b.morphAttributes.color,morphTargetsCount:M,morphTextureStride:R,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numLightProbes:o.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:s.dithering,shadowMapEnabled:e.shadowMap.enabled&&h.length>0,shadowMapType:e.shadowMap.type,toneMapping:me,useLegacyLights:e._useLegacyLights,decodeVideoTexture:N&&!0===s.map.isVideoTexture&&Qc.getTransfer(s.map.colorSpace)===yc,premultipliedAlpha:s.premultipliedAlpha,doubleSided:s.side===bl,flipSided:s.side===yl,useDepthPacking:s.depthPacking>=0,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionDerivatives:fe&&!0===s.extensions.derivatives,extensionFragDepth:fe&&!0===s.extensions.fragDepth,extensionDrawBuffers:fe&&!0===s.extensions.drawBuffers,extensionShaderTextureLOD:fe&&!0===s.extensions.shaderTextureLOD,extensionClipCullDistance:fe&&!0===s.extensions.clipCullDistance&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:fe&&!0===s.extensions.multiDraw&&n.has("WEBGL_multi_draw"),rendererExtensionFragDepth:d||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||n.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:s.customProgramCacheKey()};return ge.vertexUv1s=c.has(1),ge.vertexUv2s=c.has(2),ge.vertexUv3s=c.has(3),c.clear(),ge},getProgramCacheKey:function(t){const i=[];if(t.shaderID?i.push(t.shaderID):(i.push(t.customVertexShaderID),i.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)i.push(e),i.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(i,t),function(e,t){o.disableAll(),t.isWebGL2&&o.enable(0),t.supportsVertexTextures&&o.enable(1),t.instancing&&o.enable(2),t.instancingColor&&o.enable(3),t.matcap&&o.enable(4),t.envMap&&o.enable(5),t.normalMapObjectSpace&&o.enable(6),t.normalMapTangentSpace&&o.enable(7),t.clearcoat&&o.enable(8),t.iridescence&&o.enable(9),t.alphaTest&&o.enable(10),t.vertexColors&&o.enable(11),t.vertexAlphas&&o.enable(12),t.vertexUv1s&&o.enable(13),t.vertexUv2s&&o.enable(14),t.vertexUv3s&&o.enable(15),t.vertexTangents&&o.enable(16),t.anisotropy&&o.enable(17),t.alphaHash&&o.enable(18),t.batching&&o.enable(19),e.push(o.mask),o.disableAll(),t.fog&&o.enable(0),t.useFog&&o.enable(1),t.flatShading&&o.enable(2),t.logarithmicDepthBuffer&&o.enable(3),t.skinning&&o.enable(4),t.morphTargets&&o.enable(5),t.morphNormals&&o.enable(6),t.morphColors&&o.enable(7),t.premultipliedAlpha&&o.enable(8),t.shadowMapEnabled&&o.enable(9),t.useLegacyLights&&o.enable(10),t.doubleSided&&o.enable(11),t.flipSided&&o.enable(12),t.useDepthPacking&&o.enable(13),t.dithering&&o.enable(14),t.transmission&&o.enable(15),t.sheen&&o.enable(16),t.opaque&&o.enable(17),t.pointsUvs&&o.enable(18),t.decodeVideoTexture&&o.enable(19),t.alphaToCoverage&&o.enable(20),e.push(o.mask)}(i,t),i.push(e.outputColorSpace)),i.push(t.customProgramCacheKey),i.join()},getUniforms:function(e){const t=m[e.type];let i;if(t){const e=ju[t];i=bu.clone(e.uniforms)}else i=e.uniforms;return i},acquireProgram:function(t,i){let n;for(let e=0,t=h.length;e<t;e++){const t=h[e];if(t.cacheKey===i){n=t,++n.usedTimes;break}}return void 0===n&&(n=new Xf(e,i,t,s),h.push(n)),n},releaseProgram:function(e){if(0==--e.usedTimes){const t=h.indexOf(e);h[t]=h[h.length-1],h.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:h,dispose:function(){l.dispose()}}}function Kf(){let e=new WeakMap;return{get:function(t){let i=e.get(t);return void 0===i&&(i={},e.set(t,i)),i},remove:function(t){e.delete(t)},update:function(t,i,n){e.get(t)[i]=n},dispose:function(){e=new WeakMap}}}function Jf(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Qf(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function em(){const e=[];let t=0;const i=[],n=[],r=[];function s(i,n,r,s,a,o){let l=e[t];return void 0===l?(l={id:i.id,object:i,geometry:n,material:r,groupOrder:s,renderOrder:i.renderOrder,z:a,group:o},e[t]=l):(l.id=i.id,l.object=i,l.geometry=n,l.material=r,l.groupOrder=s,l.renderOrder=i.renderOrder,l.z=a,l.group=o),t++,l}return{opaque:i,transmissive:n,transparent:r,init:function(){t=0,i.length=0,n.length=0,r.length=0},push:function(e,t,a,o,l,c){const h=s(e,t,a,o,l,c);a.transmission>0?n.push(h):!0===a.transparent?r.push(h):i.push(h)},unshift:function(e,t,a,o,l,c){const h=s(e,t,a,o,l,c);a.transmission>0?n.unshift(h):!0===a.transparent?r.unshift(h):i.unshift(h)},finish:function(){for(let i=t,n=e.length;i<n;i++){const t=e[i];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){i.length>1&&i.sort(e||Jf),n.length>1&&n.sort(t||Qf),r.length>1&&r.sort(t||Qf)}}}function tm(){let e=new WeakMap;return{get:function(t,i){const n=e.get(t);let r;return void 0===n?(r=new em,e.set(t,[r])):i>=n.length?(r=new em,n.push(r)):r=n[i],r},dispose:function(){e=new WeakMap}}}function im(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let i;switch(t.type){case"DirectionalLight":i={direction:new mh,color:new Od};break;case"SpotLight":i={position:new mh,direction:new mh,color:new Od,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new mh,color:new Od,distance:0,decay:0};break;case"HemisphereLight":i={direction:new mh,skyColor:new Od,groundColor:new Od};break;case"RectAreaLight":i={color:new Od,position:new mh,halfWidth:new mh,halfHeight:new mh}}return e[t.id]=i,i}}}let nm=0;function rm(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function sm(e,t){const i=new im,n=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let i;switch(t.type){case"DirectionalLight":case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Bc};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Bc,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=i,i}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let e=0;e<9;e++)r.probe.push(new mh);const s=new mh,a=new Wh,o=new Wh;return{setup:function(s,a){let o=0,l=0,c=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let h=0,d=0,u=0,p=0,f=0,m=0,g=0,v=0,_=0,y=0,b=0;s.sort(rm);const x=!0===a?Math.PI:1;for(let e=0,t=s.length;e<t;e++){const t=s[e],a=t.color,w=t.intensity,E=t.distance,S=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)o+=a.r*w*x,l+=a.g*w*x,c+=a.b*w*x;else if(t.isLightProbe){for(let e=0;e<9;e++)r.probe[e].addScaledVector(t.sh.coefficients[e],w);b++}else if(t.isDirectionalLight){const e=i.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*x),t.castShadow){const e=t.shadow,i=n.get(t);i.shadowBias=e.bias,i.shadowNormalBias=e.normalBias,i.shadowRadius=e.radius,i.shadowMapSize=e.mapSize,r.directionalShadow[h]=i,r.directionalShadowMap[h]=S,r.directionalShadowMatrix[h]=t.shadow.matrix,m++}r.directional[h]=e,h++}else if(t.isSpotLight){const e=i.get(t);e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(a).multiplyScalar(w*x),e.distance=E,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,r.spot[u]=e;const s=t.shadow;if(t.map&&(r.spotLightMap[_]=t.map,_++,s.updateMatrices(t),t.castShadow&&y++),r.spotLightMatrix[u]=s.matrix,t.castShadow){const e=n.get(t);e.shadowBias=s.bias,e.shadowNormalBias=s.normalBias,e.shadowRadius=s.radius,e.shadowMapSize=s.mapSize,r.spotShadow[u]=e,r.spotShadowMap[u]=S,v++}u++}else if(t.isRectAreaLight){const e=i.get(t);e.color.copy(a).multiplyScalar(w),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),r.rectArea[p]=e,p++}else if(t.isPointLight){const e=i.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*x),e.distance=t.distance,e.decay=t.decay,t.castShadow){const e=t.shadow,i=n.get(t);i.shadowBias=e.bias,i.shadowNormalBias=e.normalBias,i.shadowRadius=e.radius,i.shadowMapSize=e.mapSize,i.shadowCameraNear=e.camera.near,i.shadowCameraFar=e.camera.far,r.pointShadow[d]=i,r.pointShadowMap[d]=S,r.pointShadowMatrix[d]=t.shadow.matrix,g++}r.point[d]=e,d++}else if(t.isHemisphereLight){const e=i.get(t);e.skyColor.copy(t.color).multiplyScalar(w*x),e.groundColor.copy(t.groundColor).multiplyScalar(w*x),r.hemi[f]=e,f++}}p>0&&(t.isWebGL2?!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=Vu.LTC_FLOAT_1,r.rectAreaLTC2=Vu.LTC_FLOAT_2):(r.rectAreaLTC1=Vu.LTC_HALF_1,r.rectAreaLTC2=Vu.LTC_HALF_2):!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=Vu.LTC_FLOAT_1,r.rectAreaLTC2=Vu.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Vu.LTC_HALF_1,r.rectAreaLTC2=Vu.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=o,r.ambient[1]=l,r.ambient[2]=c;const w=r.hash;w.directionalLength===h&&w.pointLength===d&&w.spotLength===u&&w.rectAreaLength===p&&w.hemiLength===f&&w.numDirectionalShadows===m&&w.numPointShadows===g&&w.numSpotShadows===v&&w.numSpotMaps===_&&w.numLightProbes===b||(r.directional.length=h,r.spot.length=u,r.rectArea.length=p,r.point.length=d,r.hemi.length=f,r.directionalShadow.length=m,r.directionalShadowMap.length=m,r.pointShadow.length=g,r.pointShadowMap.length=g,r.spotShadow.length=v,r.spotShadowMap.length=v,r.directionalShadowMatrix.length=m,r.pointShadowMatrix.length=g,r.spotLightMatrix.length=v+_-y,r.spotLightMap.length=_,r.numSpotLightShadowsWithMaps=y,r.numLightProbes=b,w.directionalLength=h,w.pointLength=d,w.spotLength=u,w.rectAreaLength=p,w.hemiLength=f,w.numDirectionalShadows=m,w.numPointShadows=g,w.numSpotShadows=v,w.numSpotMaps=_,w.numLightProbes=b,r.version=nm++)},setupView:function(e,t){let i=0,n=0,l=0,c=0,h=0;const d=t.matrixWorldInverse;for(let t=0,u=e.length;t<u;t++){const u=e[t];if(u.isDirectionalLight){const e=r.directional[i];e.direction.setFromMatrixPosition(u.matrixWorld),s.setFromMatrixPosition(u.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(d),i++}else if(u.isSpotLight){const e=r.spot[l];e.position.setFromMatrixPosition(u.matrixWorld),e.position.applyMatrix4(d),e.direction.setFromMatrixPosition(u.matrixWorld),s.setFromMatrixPosition(u.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(d),l++}else if(u.isRectAreaLight){const e=r.rectArea[c];e.position.setFromMatrixPosition(u.matrixWorld),e.position.applyMatrix4(d),o.identity(),a.copy(u.matrixWorld),a.premultiply(d),o.extractRotation(a),e.halfWidth.set(.5*u.width,0,0),e.halfHeight.set(0,.5*u.height,0),e.halfWidth.applyMatrix4(o),e.halfHeight.applyMatrix4(o),c++}else if(u.isPointLight){const e=r.point[n];e.position.setFromMatrixPosition(u.matrixWorld),e.position.applyMatrix4(d),n++}else if(u.isHemisphereLight){const e=r.hemi[h];e.direction.setFromMatrixPosition(u.matrixWorld),e.direction.transformDirection(d),h++}}},state:r}}function am(e,t){const i=new sm(e,t),n=[],r=[];return{init:function(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:i},setupLights:function(e){i.setup(n,e)},setupLightsView:function(e){i.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){r.push(e)}}}function om(e,t){let i=new WeakMap;return{get:function(n,r=0){const s=i.get(n);let a;return void 0===s?(a=new am(e,t),i.set(n,[a])):r>=s.length?(a=new am(e,t),s.push(a)):a=s[r],a},dispose:function(){i=new WeakMap}}}class lm extends Nd{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class cm extends Nd{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function hm(e,t,i){let n=new Fu;const r=new Bc,s=new Bc,a=new ch,o=new lm({depthPacking:3201}),l=new cm,c={},h=i.maxTextureSize,d={[_l]:yl,[yl]:_l,[bl]:bl},u=new xu({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Bc},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=u.clone();p.defines.HORIZONTAL_PASS=1;const f=new Zd;f.setAttribute("position",new kd(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new fu(f,u),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ml;let v=this.type;function _(i,n){const s=t.update(m);u.defines.VSM_SAMPLES!==i.blurSamples&&(u.defines.VSM_SAMPLES=i.blurSamples,p.defines.VSM_SAMPLES=i.blurSamples,u.needsUpdate=!0,p.needsUpdate=!0),null===i.mapPass&&(i.mapPass=new dh(r.x,r.y)),u.uniforms.shadow_pass.value=i.map.texture,u.uniforms.resolution.value=i.mapSize,u.uniforms.radius.value=i.radius,e.setRenderTarget(i.mapPass),e.clear(),e.renderBufferDirect(n,null,s,u,m,null),p.uniforms.shadow_pass.value=i.mapPass.texture,p.uniforms.resolution.value=i.mapSize,p.uniforms.radius.value=i.radius,e.setRenderTarget(i.map),e.clear(),e.renderBufferDirect(n,null,s,p,m,null)}function y(t,i,n,r){let s=null;const a=!0===n.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==a)s=a;else if(s=!0===n.isPointLight?l:o,e.localClippingEnabled&&!0===i.clipShadows&&Array.isArray(i.clippingPlanes)&&0!==i.clippingPlanes.length||i.displacementMap&&0!==i.displacementScale||i.alphaMap&&i.alphaTest>0||i.map&&i.alphaTest>0){const e=s.uuid,t=i.uuid;let n=c[e];void 0===n&&(n={},c[e]=n);let r=n[t];void 0===r&&(r=s.clone(),n[t]=r,i.addEventListener("dispose",x)),s=r}return s.visible=i.visible,s.wireframe=i.wireframe,s.side=r===vl?null!==i.shadowSide?i.shadowSide:i.side:null!==i.shadowSide?i.shadowSide:d[i.side],s.alphaMap=i.alphaMap,s.alphaTest=i.alphaTest,s.map=i.map,s.clipShadows=i.clipShadows,s.clippingPlanes=i.clippingPlanes,s.clipIntersection=i.clipIntersection,s.displacementMap=i.displacementMap,s.displacementScale=i.displacementScale,s.displacementBias=i.displacementBias,s.wireframeLinewidth=i.wireframeLinewidth,s.linewidth=i.linewidth,!0===n.isPointLight&&!0===s.isMeshDistanceMaterial&&(e.properties.get(s).light=n),s}function b(i,r,s,a,o){if(!1===i.visible)return;if(i.layers.test(r.layers)&&(i.isMesh||i.isLine||i.isPoints)&&(i.castShadow||i.receiveShadow&&o===vl)&&(!i.frustumCulled||n.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,i.matrixWorld);const n=t.update(i),l=i.material;if(Array.isArray(l)){const t=n.groups;for(let c=0,h=t.length;c<h;c++){const h=t[c],d=l[h.materialIndex];if(d&&d.visible){const t=y(i,d,a,o);i.onBeforeShadow(e,i,r,s,n,t,h),e.renderBufferDirect(s,null,n,t,i,h),i.onAfterShadow(e,i,r,s,n,t,h)}}}else if(l.visible){const t=y(i,l,a,o);i.onBeforeShadow(e,i,r,s,n,t,null),e.renderBufferDirect(s,null,n,t,i,null),i.onAfterShadow(e,i,r,s,n,t,null)}}const l=i.children;for(let e=0,t=l.length;e<t;e++)b(l[e],r,s,a,o)}function x(e){e.target.removeEventListener("dispose",x);for(const t in c){const i=c[t],n=e.target.uuid;n in i&&(i[n].dispose(),delete i[n])}}this.render=function(t,i,o){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),u=e.state;u.setBlending(xl),u.buffers.color.setClear(1,1,1,1),u.buffers.depth.setTest(!0),u.setScissorTest(!1);const p=v!==vl&&this.type===vl,f=v===vl&&this.type!==vl;for(let l=0,c=t.length;l<c;l++){const c=t[l],d=c.shadow;if(void 0===d){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}if(!1===d.autoUpdate&&!1===d.needsUpdate)continue;r.copy(d.mapSize);const m=d.getFrameExtents();if(r.multiply(m),s.copy(d.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/m.x),r.x=s.x*m.x,d.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/m.y),r.y=s.y*m.y,d.mapSize.y=s.y)),null===d.map||!0===p||!0===f){const e=this.type!==vl?{minFilter:kl,magFilter:kl}:{};null!==d.map&&d.map.dispose(),d.map=new dh(r.x,r.y,e),d.map.texture.name=c.name+".shadowMap",d.camera.updateProjectionMatrix()}e.setRenderTarget(d.map),e.clear();const g=d.getViewportCount();for(let e=0;e<g;e++){const t=d.getViewport(e);a.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),u.viewport(a),d.updateMatrices(c,e),n=d.getFrustum(),b(i,o,d.camera,c,this.type)}!0!==d.isPointLightShadow&&this.type===vl&&_(d,o),d.needsUpdate=!1}v=this.type,g.needsUpdate=!1,e.setRenderTarget(l,c,d)}}function dm(e,t,i){const n=i.isWebGL2,r=new function(){let t=!1;const i=new ch;let n=null;const r=new ch(0,0,0,0);return{setMask:function(i){n===i||t||(e.colorMask(i,i,i,i),n=i)},setLocked:function(e){t=e},setClear:function(t,n,s,a,o){!0===o&&(t*=a,n*=a,s*=a),i.set(t,n,s,a),!1===r.equals(i)&&(e.clearColor(t,n,s,a),r.copy(i))},reset:function(){t=!1,n=null,r.set(-1,0,0,0)}}},s=new function(){let t=!1,i=null,n=null,r=null;return{setTest:function(t){t?V(e.DEPTH_TEST):j(e.DEPTH_TEST)},setMask:function(n){i===n||t||(e.depthMask(n),i=n)},setFunc:function(t){if(n!==t){switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:default:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL)}n=t}},setLocked:function(e){t=e},setClear:function(t){r!==t&&(e.clearDepth(t),r=t)},reset:function(){t=!1,i=null,n=null,r=null}}},a=new function(){let t=!1,i=null,n=null,r=null,s=null,a=null,o=null,l=null,c=null;return{setTest:function(i){t||(i?V(e.STENCIL_TEST):j(e.STENCIL_TEST))},setMask:function(n){i===n||t||(e.stencilMask(n),i=n)},setFunc:function(t,i,a){n===t&&r===i&&s===a||(e.stencilFunc(t,i,a),n=t,r=i,s=a)},setOp:function(t,i,n){a===t&&o===i&&l===n||(e.stencilOp(t,i,n),a=t,o=i,l=n)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,i=null,n=null,r=null,s=null,a=null,o=null,l=null,c=null}}},o=new WeakMap,l=new WeakMap;let c={},h={},d=new WeakMap,u=[],p=null,f=!1,m=null,g=null,v=null,_=null,y=null,b=null,x=null,w=new Od(0,0,0),E=0,S=!1,T=null,M=null,A=null,C=null,L=null;const P=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let R=!1,O=0;const I=e.getParameter(e.VERSION);-1!==I.indexOf("WebGL")?(O=parseFloat(/^WebGL (\d)/.exec(I)[1]),R=O>=1):-1!==I.indexOf("OpenGL ES")&&(O=parseFloat(/^OpenGL ES (\d)/.exec(I)[1]),R=O>=2);let D=null,N={};const U=e.getParameter(e.SCISSOR_BOX),F=e.getParameter(e.VIEWPORT),z=(new ch).fromArray(U),k=(new ch).fromArray(F);function H(t,i,r,s){const a=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let o=0;o<r;o++)!n||t!==e.TEXTURE_3D&&t!==e.TEXTURE_2D_ARRAY?e.texImage2D(i+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,a):e.texImage3D(i,0,e.RGBA,1,1,s,0,e.RGBA,e.UNSIGNED_BYTE,a);return o}const B={};function V(t){!0!==c[t]&&(e.enable(t),c[t]=!0)}function j(t){!1!==c[t]&&(e.disable(t),c[t]=!1)}B[e.TEXTURE_2D]=H(e.TEXTURE_2D,e.TEXTURE_2D,1),B[e.TEXTURE_CUBE_MAP]=H(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),n&&(B[e.TEXTURE_2D_ARRAY]=H(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),B[e.TEXTURE_3D]=H(e.TEXTURE_3D,e.TEXTURE_3D,1,1)),r.setClear(0,0,0,1),s.setClear(1),a.setClear(0),V(e.DEPTH_TEST),s.setFunc(3),q(!1),Y(1),V(e.CULL_FACE),X(xl);const G={[wl]:e.FUNC_ADD,101:e.FUNC_SUBTRACT,102:e.FUNC_REVERSE_SUBTRACT};if(n)G[103]=e.MIN,G[104]=e.MAX;else{const e=t.get("EXT_blend_minmax");null!==e&&(G[103]=e.MIN_EXT,G[104]=e.MAX_EXT)}const W={200:e.ZERO,201:e.ONE,202:e.SRC_COLOR,204:e.SRC_ALPHA,210:e.SRC_ALPHA_SATURATE,208:e.DST_COLOR,206:e.DST_ALPHA,203:e.ONE_MINUS_SRC_COLOR,205:e.ONE_MINUS_SRC_ALPHA,209:e.ONE_MINUS_DST_COLOR,207:e.ONE_MINUS_DST_ALPHA,211:e.CONSTANT_COLOR,212:e.ONE_MINUS_CONSTANT_COLOR,213:e.CONSTANT_ALPHA,214:e.ONE_MINUS_CONSTANT_ALPHA};function X(t,i,n,r,s,a,o,l,c,h){if(t!==xl){if(!1===f&&(V(e.BLEND),f=!0),5===t)s=s||i,a=a||n,o=o||r,i===g&&s===y||(e.blendEquationSeparate(G[i],G[s]),g=i,y=s),n===v&&r===_&&a===b&&o===x||(e.blendFuncSeparate(W[n],W[r],W[a],W[o]),v=n,_=r,b=a,x=o),!1!==l.equals(w)&&c===E||(e.blendColor(l.r,l.g,l.b,c),w.copy(l),E=c),m=t,S=!1;else if(t!==m||h!==S){if(g===wl&&y===wl||(e.blendEquation(e.FUNC_ADD),g=wl,y=wl),h)switch(t){case 1:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}v=null,_=null,b=null,x=null,w.set(0,0,0),E=0,m=t,S=h}}else!0===f&&(j(e.BLEND),f=!1)}function q(t){T!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),T=t)}function Y(t){0!==t?(V(e.CULL_FACE),t!==M&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):j(e.CULL_FACE),M=t}function $(t,i,n){t?(V(e.POLYGON_OFFSET_FILL),C===i&&L===n||(e.polygonOffset(i,n),C=i,L=n)):j(e.POLYGON_OFFSET_FILL)}return{buffers:{color:r,depth:s,stencil:a},enable:V,disable:j,bindFramebuffer:function(t,i){return h[t]!==i&&(e.bindFramebuffer(t,i),h[t]=i,n&&(t===e.DRAW_FRAMEBUFFER&&(h[e.FRAMEBUFFER]=i),t===e.FRAMEBUFFER&&(h[e.DRAW_FRAMEBUFFER]=i)),!0)},drawBuffers:function(n,r){let s=u,a=!1;if(n)if(s=d.get(r),void 0===s&&(s=[],d.set(r,s)),n.isWebGLMultipleRenderTargets){const t=n.texture;if(s.length!==t.length||s[0]!==e.COLOR_ATTACHMENT0){for(let i=0,n=t.length;i<n;i++)s[i]=e.COLOR_ATTACHMENT0+i;s.length=t.length,a=!0}}else s[0]!==e.COLOR_ATTACHMENT0&&(s[0]=e.COLOR_ATTACHMENT0,a=!0);else s[0]!==e.BACK&&(s[0]=e.BACK,a=!0);a&&(i.isWebGL2?e.drawBuffers(s):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(s))},useProgram:function(t){return p!==t&&(e.useProgram(t),p=t,!0)},setBlending:X,setMaterial:function(t,i){t.side===bl?j(e.CULL_FACE):V(e.CULL_FACE);let n=t.side===yl;i&&(n=!n),q(n),1===t.blending&&!1===t.transparent?X(xl):X(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),s.setFunc(t.depthFunc),s.setTest(t.depthTest),s.setMask(t.depthWrite),r.setMask(t.colorWrite);const o=t.stencilWrite;a.setTest(o),o&&(a.setMask(t.stencilWriteMask),a.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),a.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),$(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?V(e.SAMPLE_ALPHA_TO_COVERAGE):j(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:q,setCullFace:Y,setLineWidth:function(t){t!==A&&(R&&e.lineWidth(t),A=t)},setPolygonOffset:$,setScissorTest:function(t){t?V(e.SCISSOR_TEST):j(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+P-1),D!==t&&(e.activeTexture(t),D=t)},bindTexture:function(t,i,n){void 0===n&&(n=null===D?e.TEXTURE0+P-1:D);let r=N[n];void 0===r&&(r={type:void 0,texture:void 0},N[n]=r),r.type===t&&r.texture===i||(D!==n&&(e.activeTexture(n),D=n),e.bindTexture(t,i||B[t]),r.type=t,r.texture=i)},unbindTexture:function(){const t=N[D];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},updateUBOMapping:function(t,i){let n=l.get(i);void 0===n&&(n=new WeakMap,l.set(i,n));let r=n.get(t);void 0===r&&(r=e.getUniformBlockIndex(i,t.name),n.set(t,r))},uniformBlockBinding:function(t,i){const n=l.get(i).get(t);o.get(i)!==n&&(e.uniformBlockBinding(i,n,t.__bindingPointIndex),o.set(i,n))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===z.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),z.copy(t))},viewport:function(t){!1===k.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),k.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),!0===n&&(e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),c={},D=null,N={},h={},d=new WeakMap,u=[],p=null,f=!1,m=null,g=null,v=null,_=null,y=null,b=null,x=null,w=new Od(0,0,0),E=0,S=!1,T=null,M=null,A=null,C=null,L=null,z.set(0,0,e.canvas.width,e.canvas.height),k.set(0,0,e.canvas.width,e.canvas.height),r.reset(),s.reset(),a.reset()}}}function um(e,t,i,n,r,s,a){const o=r.isWebGL2,l=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,c="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),h=new WeakMap;let d;const u=new WeakMap;let p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function f(e,t){return p?new OffscreenCanvas(e,t):Wc("canvas")}function m(e,t,i,n){let r=1;if((e.width>n||e.height>n)&&(r=n/Math.max(e.width,e.height)),r<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const n=t?Fc:Math.floor,s=n(r*e.width),a=n(r*e.height);void 0===d&&(d=f(s,a));const o=i?f(s,a):d;return o.width=s,o.height=a,o.getContext("2d").drawImage(e,0,0,s,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+s+"x"+a+")."),o}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function g(e){return Uc(e.width)&&Uc(e.height)}function v(e,t){return e.generateMipmaps&&t&&e.minFilter!==kl&&e.minFilter!==Bl}function _(t){e.generateMipmap(t)}function y(i,n,r,s,a=!1){if(!1===o)return n;if(null!==i){if(void 0!==e[i])return e[i];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+i+"'")}let l=n;if(n===e.RED&&(r===e.FLOAT&&(l=e.R32F),r===e.HALF_FLOAT&&(l=e.R16F),r===e.UNSIGNED_BYTE&&(l=e.R8)),n===e.RED_INTEGER&&(r===e.UNSIGNED_BYTE&&(l=e.R8UI),r===e.UNSIGNED_SHORT&&(l=e.R16UI),r===e.UNSIGNED_INT&&(l=e.R32UI),r===e.BYTE&&(l=e.R8I),r===e.SHORT&&(l=e.R16I),r===e.INT&&(l=e.R32I)),n===e.RG&&(r===e.FLOAT&&(l=e.RG32F),r===e.HALF_FLOAT&&(l=e.RG16F),r===e.UNSIGNED_BYTE&&(l=e.RG8)),n===e.RGBA){const t=a?_c:Qc.getTransfer(s);r===e.FLOAT&&(l=e.RGBA32F),r===e.HALF_FLOAT&&(l=e.RGBA16F),r===e.UNSIGNED_BYTE&&(l=t===yc?e.SRGB8_ALPHA8:e.RGBA8),r===e.UNSIGNED_SHORT_4_4_4_4&&(l=e.RGBA4),r===e.UNSIGNED_SHORT_5_5_5_1&&(l=e.RGB5_A1)}return l!==e.R16F&&l!==e.R32F&&l!==e.RG16F&&l!==e.RG32F&&l!==e.RGBA16F&&l!==e.RGBA32F||t.get("EXT_color_buffer_float"),l}function b(e,t,i){return!0===v(e,i)||e.isFramebufferTexture&&e.minFilter!==kl&&e.minFilter!==Bl?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function x(t){return t===kl||1004===t||t===Hl?e.NEAREST:e.LINEAR}function w(e){const t=e.target;t.removeEventListener("dispose",w),function(e){const t=n.get(e);if(void 0===t.__webglInit)return;const i=e.source,r=u.get(i);if(r){const n=r[t.__cacheKey];n.usedTimes--,0===n.usedTimes&&S(e),0===Object.keys(r).length&&u.delete(i)}n.remove(e)}(t),t.isVideoTexture&&h.delete(t)}function E(t){const i=t.target;i.removeEventListener("dispose",E),function(t){const i=t.texture,r=n.get(t),s=n.get(i);if(void 0!==s.__webglTexture&&(e.deleteTexture(s.__webglTexture),a.memory.textures--),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++){if(Array.isArray(r.__webglFramebuffer[t]))for(let i=0;i<r.__webglFramebuffer[t].length;i++)e.deleteFramebuffer(r.__webglFramebuffer[t][i]);else e.deleteFramebuffer(r.__webglFramebuffer[t]);r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[t])}else{if(Array.isArray(r.__webglFramebuffer))for(let t=0;t<r.__webglFramebuffer.length;t++)e.deleteFramebuffer(r.__webglFramebuffer[t]);else e.deleteFramebuffer(r.__webglFramebuffer);if(r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&e.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer)for(let t=0;t<r.__webglColorRenderbuffer.length;t++)r.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(r.__webglColorRenderbuffer[t]);r.__webglDepthRenderbuffer&&e.deleteRenderbuffer(r.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(let t=0,r=i.length;t<r;t++){const r=n.get(i[t]);r.__webglTexture&&(e.deleteTexture(r.__webglTexture),a.memory.textures--),n.remove(i[t])}n.remove(i),n.remove(t)}(i)}function S(t){const i=n.get(t);e.deleteTexture(i.__webglTexture);const r=t.source;delete u.get(r)[i.__cacheKey],a.memory.textures--}let T=0;function M(t,r){const s=n.get(t);if(t.isVideoTexture&&function(e){const t=a.render.frame;h.get(e)!==t&&(h.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&s.__version!==t.version){const e=t.image;if(null===e)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void O(s,t,r);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}i.bindTexture(e.TEXTURE_2D,s.__webglTexture,e.TEXTURE0+r)}const A={[Ul]:e.REPEAT,[Fl]:e.CLAMP_TO_EDGE,[zl]:e.MIRRORED_REPEAT},C={[kl]:e.NEAREST,1004:e.NEAREST_MIPMAP_NEAREST,[Hl]:e.NEAREST_MIPMAP_LINEAR,[Bl]:e.LINEAR,[Vl]:e.LINEAR_MIPMAP_NEAREST,[jl]:e.LINEAR_MIPMAP_LINEAR},L={512:e.NEVER,519:e.ALWAYS,513:e.LESS,515:e.LEQUAL,514:e.EQUAL,518:e.GEQUAL,516:e.GREATER,517:e.NOTEQUAL};function P(i,s,a){if(s.type!==ql||!1!==t.has("OES_texture_float_linear")||s.magFilter!==Bl&&s.magFilter!==Vl&&s.magFilter!==Hl&&s.magFilter!==jl&&s.minFilter!==Bl&&s.minFilter!==Vl&&s.minFilter!==Hl&&s.minFilter!==jl||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),a?(e.texParameteri(i,e.TEXTURE_WRAP_S,A[s.wrapS]),e.texParameteri(i,e.TEXTURE_WRAP_T,A[s.wrapT]),i!==e.TEXTURE_3D&&i!==e.TEXTURE_2D_ARRAY||e.texParameteri(i,e.TEXTURE_WRAP_R,A[s.wrapR]),e.texParameteri(i,e.TEXTURE_MAG_FILTER,C[s.magFilter]),e.texParameteri(i,e.TEXTURE_MIN_FILTER,C[s.minFilter])):(e.texParameteri(i,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(i,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),i!==e.TEXTURE_3D&&i!==e.TEXTURE_2D_ARRAY||e.texParameteri(i,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),s.wrapS===Fl&&s.wrapT===Fl||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(i,e.TEXTURE_MAG_FILTER,x(s.magFilter)),e.texParameteri(i,e.TEXTURE_MIN_FILTER,x(s.minFilter)),s.minFilter!==kl&&s.minFilter!==Bl&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),s.compareFunction&&(e.texParameteri(i,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(i,e.TEXTURE_COMPARE_FUNC,L[s.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){const a=t.get("EXT_texture_filter_anisotropic");if(s.magFilter===kl)return;if(s.minFilter!==Hl&&s.minFilter!==jl)return;if(s.type===ql&&!1===t.has("OES_texture_float_linear"))return;if(!1===o&&s.type===Yl&&!1===t.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||n.get(s).__currentAnisotropy)&&(e.texParameterf(i,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),n.get(s).__currentAnisotropy=s.anisotropy)}}function R(t,i){let n=!1;void 0===t.__webglInit&&(t.__webglInit=!0,i.addEventListener("dispose",w));const r=i.source;let s=u.get(r);void 0===s&&(s={},u.set(r,s));const o=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(i);if(o!==t.__cacheKey){void 0===s[o]&&(s[o]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,n=!0),s[o].usedTimes++;const r=s[t.__cacheKey];void 0!==r&&(s[t.__cacheKey].usedTimes--,0===r.usedTimes&&S(i)),t.__cacheKey=o,t.__webglTexture=s[o].texture}return n}function O(t,a,l){let c=e.TEXTURE_2D;(a.isDataArrayTexture||a.isCompressedArrayTexture)&&(c=e.TEXTURE_2D_ARRAY),a.isData3DTexture&&(c=e.TEXTURE_3D);const h=R(t,a),d=a.source;i.bindTexture(c,t.__webglTexture,e.TEXTURE0+l);const u=n.get(d);if(d.version!==u.__version||!0===h){i.activeTexture(e.TEXTURE0+l);const t=Qc.getPrimaries(Qc.workingColorSpace),n=a.colorSpace===pc?null:Qc.getPrimaries(a.colorSpace),p=a.colorSpace===pc||t===n?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,a.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,a.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,p);const f=function(e){return!o&&(e.wrapS!==Fl||e.wrapT!==Fl||e.minFilter!==kl&&e.minFilter!==Bl)}(a)&&!1===g(a.image);let x=m(a.image,f,!1,r.maxTextureSize);x=z(a,x);const w=g(x)||o,E=s.convert(a.format,a.colorSpace);let S,T=s.convert(a.type),M=y(a.internalFormat,E,T,a.colorSpace,a.isVideoTexture);P(c,a,w);const A=a.mipmaps,C=o&&!0!==a.isVideoTexture&&36196!==M,L=void 0===u.__version||!0===h,R=d.dataReady,O=b(a,x,w);if(a.isDepthTexture)M=e.DEPTH_COMPONENT,o?M=a.type===ql?e.DEPTH_COMPONENT32F:a.type===Xl?e.DEPTH_COMPONENT24:a.type===Kl?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT16:a.type===ql&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),a.format===Ql&&M===e.DEPTH_COMPONENT&&a.type!==Wl&&a.type!==Xl&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),a.type=Xl,T=s.convert(a.type)),a.format===ec&&M===e.DEPTH_COMPONENT&&(M=e.DEPTH_STENCIL,a.type!==Kl&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),a.type=Kl,T=s.convert(a.type))),L&&(C?i.texStorage2D(e.TEXTURE_2D,1,M,x.width,x.height):i.texImage2D(e.TEXTURE_2D,0,M,x.width,x.height,0,E,T,null));else if(a.isDataTexture)if(A.length>0&&w){C&&L&&i.texStorage2D(e.TEXTURE_2D,O,M,A[0].width,A[0].height);for(let t=0,n=A.length;t<n;t++)S=A[t],C?R&&i.texSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,E,T,S.data):i.texImage2D(e.TEXTURE_2D,t,M,S.width,S.height,0,E,T,S.data);a.generateMipmaps=!1}else C?(L&&i.texStorage2D(e.TEXTURE_2D,O,M,x.width,x.height),R&&i.texSubImage2D(e.TEXTURE_2D,0,0,0,x.width,x.height,E,T,x.data)):i.texImage2D(e.TEXTURE_2D,0,M,x.width,x.height,0,E,T,x.data);else if(a.isCompressedTexture)if(a.isCompressedArrayTexture){C&&L&&i.texStorage3D(e.TEXTURE_2D_ARRAY,O,M,A[0].width,A[0].height,x.depth);for(let t=0,n=A.length;t<n;t++)S=A[t],a.format!==Jl?null!==E?C?R&&i.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,S.width,S.height,x.depth,E,S.data,0,0):i.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,M,S.width,S.height,x.depth,0,S.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):C?R&&i.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,S.width,S.height,x.depth,E,T,S.data):i.texImage3D(e.TEXTURE_2D_ARRAY,t,M,S.width,S.height,x.depth,0,E,T,S.data)}else{C&&L&&i.texStorage2D(e.TEXTURE_2D,O,M,A[0].width,A[0].height);for(let t=0,n=A.length;t<n;t++)S=A[t],a.format!==Jl?null!==E?C?R&&i.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,E,S.data):i.compressedTexImage2D(e.TEXTURE_2D,t,M,S.width,S.height,0,S.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):C?R&&i.texSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,E,T,S.data):i.texImage2D(e.TEXTURE_2D,t,M,S.width,S.height,0,E,T,S.data)}else if(a.isDataArrayTexture)C?(L&&i.texStorage3D(e.TEXTURE_2D_ARRAY,O,M,x.width,x.height,x.depth),R&&i.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,x.width,x.height,x.depth,E,T,x.data)):i.texImage3D(e.TEXTURE_2D_ARRAY,0,M,x.width,x.height,x.depth,0,E,T,x.data);else if(a.isData3DTexture)C?(L&&i.texStorage3D(e.TEXTURE_3D,O,M,x.width,x.height,x.depth),R&&i.texSubImage3D(e.TEXTURE_3D,0,0,0,0,x.width,x.height,x.depth,E,T,x.data)):i.texImage3D(e.TEXTURE_3D,0,M,x.width,x.height,x.depth,0,E,T,x.data);else if(a.isFramebufferTexture){if(L)if(C)i.texStorage2D(e.TEXTURE_2D,O,M,x.width,x.height);else{let t=x.width,n=x.height;for(let r=0;r<O;r++)i.texImage2D(e.TEXTURE_2D,r,M,t,n,0,E,T,null),t>>=1,n>>=1}}else if(A.length>0&&w){C&&L&&i.texStorage2D(e.TEXTURE_2D,O,M,A[0].width,A[0].height);for(let t=0,n=A.length;t<n;t++)S=A[t],C?R&&i.texSubImage2D(e.TEXTURE_2D,t,0,0,E,T,S):i.texImage2D(e.TEXTURE_2D,t,M,E,T,S);a.generateMipmaps=!1}else C?(L&&i.texStorage2D(e.TEXTURE_2D,O,M,x.width,x.height),R&&i.texSubImage2D(e.TEXTURE_2D,0,0,0,E,T,x)):i.texImage2D(e.TEXTURE_2D,0,M,E,T,x);v(a,w)&&_(c),u.__version=d.version,a.onUpdate&&a.onUpdate(a)}t.__version=a.version}function I(t,r,a,o,c,h){const d=s.convert(a.format,a.colorSpace),u=s.convert(a.type),p=y(a.internalFormat,d,u,a.colorSpace);if(!n.get(r).__hasExternalTextures){const t=Math.max(1,r.width>>h),n=Math.max(1,r.height>>h);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?i.texImage3D(c,h,p,t,n,r.depth,0,d,u,null):i.texImage2D(c,h,p,t,n,0,d,u,null)}i.bindFramebuffer(e.FRAMEBUFFER,t),F(r)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,o,c,n.get(a).__webglTexture,0,U(r)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,o,c,n.get(a).__webglTexture,h),i.bindFramebuffer(e.FRAMEBUFFER,null)}function D(t,i,n){if(e.bindRenderbuffer(e.RENDERBUFFER,t),i.depthBuffer&&!i.stencilBuffer){let r=!0===o?e.DEPTH_COMPONENT24:e.DEPTH_COMPONENT16;if(n||F(i)){const t=i.depthTexture;t&&t.isDepthTexture&&(t.type===ql?r=e.DEPTH_COMPONENT32F:t.type===Xl&&(r=e.DEPTH_COMPONENT24));const n=U(i);F(i)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,n,r,i.width,i.height):e.renderbufferStorageMultisample(e.RENDERBUFFER,n,r,i.width,i.height)}else e.renderbufferStorage(e.RENDERBUFFER,r,i.width,i.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)}else if(i.depthBuffer&&i.stencilBuffer){const r=U(i);n&&!1===F(i)?e.renderbufferStorageMultisample(e.RENDERBUFFER,r,e.DEPTH24_STENCIL8,i.width,i.height):F(i)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,r,e.DEPTH24_STENCIL8,i.width,i.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,i.width,i.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)}else{const t=!0===i.isWebGLMultipleRenderTargets?i.texture:[i.texture];for(let r=0;r<t.length;r++){const a=t[r],o=s.convert(a.format,a.colorSpace),c=s.convert(a.type),h=y(a.internalFormat,o,c,a.colorSpace),d=U(i);n&&!1===F(i)?e.renderbufferStorageMultisample(e.RENDERBUFFER,d,h,i.width,i.height):F(i)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,d,h,i.width,i.height):e.renderbufferStorage(e.RENDERBUFFER,h,i.width,i.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function N(t){const r=n.get(t),s=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!r.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(e.FRAMEBUFFER,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),M(r.depthTexture,0);const s=n.get(r.depthTexture).__webglTexture,a=U(r);if(r.depthTexture.format===Ql)F(r)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0,a):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0);else{if(r.depthTexture.format!==ec)throw new Error("Unknown depthTexture format");F(r)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0,a):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0)}}(r.__webglFramebuffer,t)}else if(s){r.__webglDepthbuffer=[];for(let n=0;n<6;n++)i.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[n]),r.__webglDepthbuffer[n]=e.createRenderbuffer(),D(r.__webglDepthbuffer[n],t,!1)}else i.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),D(r.__webglDepthbuffer,t,!1);i.bindFramebuffer(e.FRAMEBUFFER,null)}function U(e){return Math.min(r.maxSamples,e.samples)}function F(e){const i=n.get(e);return o&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==i.__useRenderToTexture}function z(e,i){const n=e.colorSpace,r=e.format,s=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===Sc||n!==mc&&n!==pc&&(Qc.getTransfer(n)===yc?!1===o?!0===t.has("EXT_sRGB")&&r===Jl?(e.format=Sc,e.minFilter=Bl,e.generateMipmaps=!1):i=nh.sRGBToLinear(i):r===Jl&&s===Gl||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",n)),i}this.allocateTextureUnit=function(){const e=T;return e>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+r.maxTextures),T+=1,e},this.resetTextureUnits=function(){T=0},this.setTexture2D=M,this.setTexture2DArray=function(t,r){const s=n.get(t);t.version>0&&s.__version!==t.version?O(s,t,r):i.bindTexture(e.TEXTURE_2D_ARRAY,s.__webglTexture,e.TEXTURE0+r)},this.setTexture3D=function(t,r){const s=n.get(t);t.version>0&&s.__version!==t.version?O(s,t,r):i.bindTexture(e.TEXTURE_3D,s.__webglTexture,e.TEXTURE0+r)},this.setTextureCube=function(t,a){const l=n.get(t);t.version>0&&l.__version!==t.version?function(t,a,l){if(6!==a.image.length)return;const c=R(t,a),h=a.source;i.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+l);const d=n.get(h);if(h.version!==d.__version||!0===c){i.activeTexture(e.TEXTURE0+l);const t=Qc.getPrimaries(Qc.workingColorSpace),n=a.colorSpace===pc?null:Qc.getPrimaries(a.colorSpace),u=a.colorSpace===pc||t===n?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,a.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,a.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,u);const p=a.isCompressedTexture||a.image[0].isCompressedTexture,f=a.image[0]&&a.image[0].isDataTexture,x=[];for(let e=0;e<6;e++)x[e]=p||f?f?a.image[e].image:a.image[e]:m(a.image[e],!1,!0,r.maxCubemapSize),x[e]=z(a,x[e]);const w=x[0],E=g(w)||o,S=s.convert(a.format,a.colorSpace),T=s.convert(a.type),M=y(a.internalFormat,S,T,a.colorSpace),A=o&&!0!==a.isVideoTexture,C=void 0===d.__version||!0===c,L=h.dataReady;let R,O=b(a,w,E);if(P(e.TEXTURE_CUBE_MAP,a,E),p){A&&C&&i.texStorage2D(e.TEXTURE_CUBE_MAP,O,M,w.width,w.height);for(let t=0;t<6;t++){R=x[t].mipmaps;for(let n=0;n<R.length;n++){const r=R[n];a.format!==Jl?null!==S?A?L&&i.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n,0,0,r.width,r.height,S,r.data):i.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n,M,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):A?L&&i.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n,0,0,r.width,r.height,S,T,r.data):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n,M,r.width,r.height,0,S,T,r.data)}}}else{R=a.mipmaps,A&&C&&(R.length>0&&O++,i.texStorage2D(e.TEXTURE_CUBE_MAP,O,M,x[0].width,x[0].height));for(let t=0;t<6;t++)if(f){A?L&&i.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,x[t].width,x[t].height,S,T,x[t].data):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,M,x[t].width,x[t].height,0,S,T,x[t].data);for(let n=0;n<R.length;n++){const r=R[n].image[t].image;A?L&&i.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,0,0,r.width,r.height,S,T,r.data):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,M,r.width,r.height,0,S,T,r.data)}}else{A?L&&i.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,S,T,x[t]):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,M,S,T,x[t]);for(let n=0;n<R.length;n++){const r=R[n];A?L&&i.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,0,0,S,T,r.image[t]):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,M,S,T,r.image[t])}}}v(a,E)&&_(e.TEXTURE_CUBE_MAP),d.__version=h.version,a.onUpdate&&a.onUpdate(a)}t.__version=a.version}(l,t,a):i.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture,e.TEXTURE0+a)},this.rebindTextures=function(t,i,r){const s=n.get(t);void 0!==i&&I(s.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==r&&N(t)},this.setupRenderTarget=function(t){const l=t.texture,c=n.get(t),h=n.get(l);t.addEventListener("dispose",E),!0!==t.isWebGLMultipleRenderTargets&&(void 0===h.__webglTexture&&(h.__webglTexture=e.createTexture()),h.__version=l.version,a.memory.textures++);const d=!0===t.isWebGLCubeRenderTarget,u=!0===t.isWebGLMultipleRenderTargets,p=g(t)||o;if(d){c.__webglFramebuffer=[];for(let t=0;t<6;t++)if(o&&l.mipmaps&&l.mipmaps.length>0){c.__webglFramebuffer[t]=[];for(let i=0;i<l.mipmaps.length;i++)c.__webglFramebuffer[t][i]=e.createFramebuffer()}else c.__webglFramebuffer[t]=e.createFramebuffer()}else{if(o&&l.mipmaps&&l.mipmaps.length>0){c.__webglFramebuffer=[];for(let t=0;t<l.mipmaps.length;t++)c.__webglFramebuffer[t]=e.createFramebuffer()}else c.__webglFramebuffer=e.createFramebuffer();if(u)if(r.drawBuffers){const i=t.texture;for(let t=0,r=i.length;t<r;t++){const r=n.get(i[t]);void 0===r.__webglTexture&&(r.__webglTexture=e.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&t.samples>0&&!1===F(t)){const n=u?l:[l];c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=[],i.bindFramebuffer(e.FRAMEBUFFER,c.__webglMultisampledFramebuffer);for(let i=0;i<n.length;i++){const r=n[i];c.__webglColorRenderbuffer[i]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,c.__webglColorRenderbuffer[i]);const a=s.convert(r.format,r.colorSpace),o=s.convert(r.type),l=y(r.internalFormat,a,o,r.colorSpace,!0===t.isXRRenderTarget),h=U(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,h,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+i,e.RENDERBUFFER,c.__webglColorRenderbuffer[i])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),D(c.__webglDepthRenderbuffer,t,!0)),i.bindFramebuffer(e.FRAMEBUFFER,null)}}if(d){i.bindTexture(e.TEXTURE_CUBE_MAP,h.__webglTexture),P(e.TEXTURE_CUBE_MAP,l,p);for(let i=0;i<6;i++)if(o&&l.mipmaps&&l.mipmaps.length>0)for(let n=0;n<l.mipmaps.length;n++)I(c.__webglFramebuffer[i][n],t,l,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+i,n);else I(c.__webglFramebuffer[i],t,l,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0);v(l,p)&&_(e.TEXTURE_CUBE_MAP),i.unbindTexture()}else if(u){const r=t.texture;for(let s=0,a=r.length;s<a;s++){const a=r[s],o=n.get(a);i.bindTexture(e.TEXTURE_2D,o.__webglTexture),P(e.TEXTURE_2D,a,p),I(c.__webglFramebuffer,t,a,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,0),v(a,p)&&_(e.TEXTURE_2D)}i.unbindTexture()}else{let n=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(o?n=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(n,h.__webglTexture),P(n,l,p),o&&l.mipmaps&&l.mipmaps.length>0)for(let i=0;i<l.mipmaps.length;i++)I(c.__webglFramebuffer[i],t,l,e.COLOR_ATTACHMENT0,n,i);else I(c.__webglFramebuffer,t,l,e.COLOR_ATTACHMENT0,n,0);v(l,p)&&_(n),i.unbindTexture()}t.depthBuffer&&N(t)},this.updateRenderTargetMipmap=function(t){const r=g(t)||o,s=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let a=0,o=s.length;a<o;a++){const o=s[a];if(v(o,r)){const r=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,s=n.get(o).__webglTexture;i.bindTexture(r,s),_(r),i.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(o&&t.samples>0&&!1===F(t)){const r=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],s=t.width,a=t.height;let o=e.COLOR_BUFFER_BIT;const l=[],h=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,d=n.get(t),u=!0===t.isWebGLMultipleRenderTargets;if(u)for(let t=0;t<r.length;t++)i.bindFramebuffer(e.FRAMEBUFFER,d.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),i.bindFramebuffer(e.FRAMEBUFFER,d.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);i.bindFramebuffer(e.READ_FRAMEBUFFER,d.__webglMultisampledFramebuffer),i.bindFramebuffer(e.DRAW_FRAMEBUFFER,d.__webglFramebuffer);for(let i=0;i<r.length;i++){l.push(e.COLOR_ATTACHMENT0+i),t.depthBuffer&&l.push(h);const p=void 0!==d.__ignoreDepthValues&&d.__ignoreDepthValues;if(!1===p&&(t.depthBuffer&&(o|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&(o|=e.STENCIL_BUFFER_BIT)),u&&e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,d.__webglColorRenderbuffer[i]),!0===p&&(e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[h]),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[h])),u){const t=n.get(r[i]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,s,a,0,0,s,a,o,e.NEAREST),c&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,l)}if(i.bindFramebuffer(e.READ_FRAMEBUFFER,null),i.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),u)for(let t=0;t<r.length;t++){i.bindFramebuffer(e.FRAMEBUFFER,d.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,d.__webglColorRenderbuffer[t]);const s=n.get(r[t]).__webglTexture;i.bindFramebuffer(e.FRAMEBUFFER,d.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,s,0)}i.bindFramebuffer(e.DRAW_FRAMEBUFFER,d.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=N,this.setupFrameBufferTexture=I,this.useMultisampledRTT=F}function pm(e,t,i){const n=i.isWebGL2;return{convert:function(i,r=""){let s;const a=Qc.getTransfer(r);if(i===Gl)return e.UNSIGNED_BYTE;if(i===$l)return e.UNSIGNED_SHORT_4_4_4_4;if(i===Zl)return e.UNSIGNED_SHORT_5_5_5_1;if(1010===i)return e.BYTE;if(1011===i)return e.SHORT;if(i===Wl)return e.UNSIGNED_SHORT;if(1013===i)return e.INT;if(i===Xl)return e.UNSIGNED_INT;if(i===ql)return e.FLOAT;if(i===Yl)return n?e.HALF_FLOAT:(s=t.get("OES_texture_half_float"),null!==s?s.HALF_FLOAT_OES:null);if(1021===i)return e.ALPHA;if(i===Jl)return e.RGBA;if(1024===i)return e.LUMINANCE;if(1025===i)return e.LUMINANCE_ALPHA;if(i===Ql)return e.DEPTH_COMPONENT;if(i===ec)return e.DEPTH_STENCIL;if(i===Sc)return s=t.get("EXT_sRGB"),null!==s?s.SRGB_ALPHA_EXT:null;if(1028===i)return e.RED;if(i===tc)return e.RED_INTEGER;if(1030===i)return e.RG;if(i===ic)return e.RG_INTEGER;if(i===nc)return e.RGBA_INTEGER;if(i===rc||i===sc||i===ac||i===oc)if(a===yc){if(s=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===s)return null;if(i===rc)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===sc)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===ac)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===oc)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(s=t.get("WEBGL_compressed_texture_s3tc"),null===s)return null;if(i===rc)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===sc)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===ac)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===oc)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===i||35841===i||35842===i||35843===i){if(s=t.get("WEBGL_compressed_texture_pvrtc"),null===s)return null;if(35840===i)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===i)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===i)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===i)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===i)return s=t.get("WEBGL_compressed_texture_etc1"),null!==s?s.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===i||37496===i){if(s=t.get("WEBGL_compressed_texture_etc"),null===s)return null;if(37492===i)return a===yc?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(37496===i)return a===yc?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}if(37808===i||37809===i||37810===i||37811===i||37812===i||37813===i||37814===i||37815===i||37816===i||37817===i||37818===i||37819===i||37820===i||37821===i){if(s=t.get("WEBGL_compressed_texture_astc"),null===s)return null;if(37808===i)return a===yc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===i)return a===yc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===i)return a===yc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===i)return a===yc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===i)return a===yc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===i)return a===yc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===i)return a===yc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===i)return a===yc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===i)return a===yc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===i)return a===yc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===i)return a===yc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===i)return a===yc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===i)return a===yc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===i)return a===yc?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}if(i===lc||36494===i||36495===i){if(s=t.get("EXT_texture_compression_bptc"),null===s)return null;if(i===lc)return a===yc?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===i)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===i)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===i||36284===i||36285===i||36286===i){if(s=t.get("EXT_texture_compression_rgtc"),null===s)return null;if(i===lc)return s.COMPRESSED_RED_RGTC1_EXT;if(36284===i)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===i)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===i)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return i===Kl?n?e.UNSIGNED_INT_24_8:(s=t.get("WEBGL_depth_texture"),null!==s?s.UNSIGNED_INT_24_8_WEBGL:null):void 0!==e[i]?e[i]:null}}}class fm extends Mu{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class mm extends gd{constructor(){super(),this.isGroup=!0,this.type="Group"}}const gm={type:"move"};class vm{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new mm,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new mm,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new mh,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new mh),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new mm,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new mh,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new mh),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let n=null,r=null,s=null;const a=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){s=!0;for(const n of e.hand.values()){const e=t.getJointPose(n,i),r=this._getHandJoint(l,n);null!==e&&(r.matrix.fromArray(e.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.matrixWorldNeedsUpdate=!0,r.jointRadius=e.radius),r.visible=null!==e}const n=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],a=n.position.distanceTo(r.position),o=.02,c=.005;l.inputState.pinching&&a>o+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&a<=o-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&e.gripSpace&&(r=t.getPose(e.gripSpace,i),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1));null!==a&&(n=t.getPose(e.targetRaySpace,i),null===n&&null!==r&&(n=r),null!==n&&(a.matrix.fromArray(n.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,n.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(n.linearVelocity)):a.hasLinearVelocity=!1,n.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(n.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(gm)))}return null!==a&&(a.visible=null!==n),null!==o&&(o.visible=null!==r),null!==l&&(l.visible=null!==s),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new mm;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class _m{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,i){if(null===this.texture){const n=new lh;e.properties.get(n).__webglTexture=t.texture,t.depthNear==i.depthNear&&t.depthFar==i.depthFar||(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=n}}render(e,t){if(null!==this.texture){if(null===this.mesh){const e=t.cameras[0].viewport,i=new xu({extensions:{fragDepth:!0},vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:e.z},depthHeight:{value:e.w}}});this.mesh=new fu(new Hu(20,20),i)}e.render(this.mesh,t)}}reset(){this.texture=null,this.mesh=null}}class ym extends Ac{constructor(e,t){super();const i=this;let n=null,r=1,s=null,a="local-floor",o=1,l=null,c=null,h=null,d=null,u=null,p=null;const f=new _m,m=t.getContextAttributes();let g=null,v=null;const _=[],y=[],b=new Bc;let x=null;const w=new Mu;w.layers.enable(1),w.viewport=new ch;const E=new Mu;E.layers.enable(2),E.viewport=new ch;const S=[w,E],T=new fm;T.layers.enable(1),T.layers.enable(2);let M=null,A=null;function C(e){const t=y.indexOf(e.inputSource);if(-1===t)return;const i=_[t];void 0!==i&&(i.update(e.inputSource,e.frame,l||s),i.dispatchEvent({type:e.type,data:e.inputSource}))}function L(){n.removeEventListener("select",C),n.removeEventListener("selectstart",C),n.removeEventListener("selectend",C),n.removeEventListener("squeeze",C),n.removeEventListener("squeezestart",C),n.removeEventListener("squeezeend",C),n.removeEventListener("end",L),n.removeEventListener("inputsourceschange",P);for(let e=0;e<_.length;e++){const t=y[e];null!==t&&(y[e]=null,_[e].disconnect(t))}M=null,A=null,f.reset(),e.setRenderTarget(g),u=null,d=null,h=null,n=null,v=null,N.stop(),i.isPresenting=!1,e.setPixelRatio(x),e.setSize(b.width,b.height,!1),i.dispatchEvent({type:"sessionend"})}function P(e){for(let t=0;t<e.removed.length;t++){const i=e.removed[t],n=y.indexOf(i);n>=0&&(y[n]=null,_[n].disconnect(i))}for(let t=0;t<e.added.length;t++){const i=e.added[t];let n=y.indexOf(i);if(-1===n){for(let e=0;e<_.length;e++){if(e>=y.length){y.push(i),n=e;break}if(null===y[e]){y[e]=i,n=e;break}}if(-1===n)break}const r=_[n];r&&r.connect(i)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=_[e];return void 0===t&&(t=new vm,_[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=_[e];return void 0===t&&(t=new vm,_[e]=t),t.getGripSpace()},this.getHand=function(e){let t=_[e];return void 0===t&&(t=new vm,_[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){r=e,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){a=e,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==d?d:u},this.getBinding=function(){return h},this.getFrame=function(){return p},this.getSession=function(){return n},this.setSession=async function(c){if(n=c,null!==n){if(g=e.getRenderTarget(),n.addEventListener("select",C),n.addEventListener("selectstart",C),n.addEventListener("selectend",C),n.addEventListener("squeeze",C),n.addEventListener("squeezestart",C),n.addEventListener("squeezeend",C),n.addEventListener("end",L),n.addEventListener("inputsourceschange",P),!0!==m.xrCompatible&&await t.makeXRCompatible(),x=e.getPixelRatio(),e.getSize(b),void 0===n.renderState.layers||!1===e.capabilities.isWebGL2){const i={antialias:void 0!==n.renderState.layers||m.antialias,alpha:!0,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:r};u=new XRWebGLLayer(n,t,i),n.updateRenderState({baseLayer:u}),e.setPixelRatio(1),e.setSize(u.framebufferWidth,u.framebufferHeight,!1),v=new dh(u.framebufferWidth,u.framebufferHeight,{format:Jl,type:Gl,colorSpace:e.outputColorSpace,stencilBuffer:m.stencil})}else{let i=null,s=null,a=null;m.depth&&(a=m.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,i=m.stencil?ec:Ql,s=m.stencil?Kl:Xl);const o={colorFormat:t.RGBA8,depthFormat:a,scaleFactor:r};h=new XRWebGLBinding(n,t),d=h.createProjectionLayer(o),n.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),v=new dh(d.textureWidth,d.textureHeight,{format:Jl,type:Gl,depthTexture:new wp(d.textureWidth,d.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,i),stencilBuffer:m.stencil,colorSpace:e.outputColorSpace,samples:m.antialias?4:0}),e.properties.get(v).__ignoreDepthValues=d.ignoreDepthValues}v.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await n.requestReferenceSpace(a),N.setContext(n),N.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==n)return n.environmentBlendMode};const R=new mh,O=new mh;function I(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===n)return;null!==f.texture&&(e.near=f.depthNear,e.far=f.depthFar),T.near=E.near=w.near=e.near,T.far=E.far=w.far=e.far,M===T.near&&A===T.far||(n.updateRenderState({depthNear:T.near,depthFar:T.far}),M=T.near,A=T.far,w.near=M,w.far=A,E.near=M,E.far=A,w.updateProjectionMatrix(),E.updateProjectionMatrix(),e.updateProjectionMatrix());const t=e.parent,i=T.cameras;I(T,t);for(let e=0;e<i.length;e++)I(i[e],t);2===i.length?function(e,t,i){R.setFromMatrixPosition(t.matrixWorld),O.setFromMatrixPosition(i.matrixWorld);const n=R.distanceTo(O),r=t.projectionMatrix.elements,s=i.projectionMatrix.elements,a=r[14]/(r[10]-1),o=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],h=(r[8]-1)/r[0],d=(s[8]+1)/s[0],u=a*h,p=a*d,f=n/(-h+d),m=f*-h;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();const g=a+f,v=o+f,_=u-m,y=p+(n-m),b=l*o/v*g,x=c*o/v*g;e.projectionMatrix.makePerspective(_,y,b,x,g,v),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}(T,w,E):T.projectionMatrix.copy(w.projectionMatrix),function(e,t,i){null===i?e.matrix.copy(t.matrixWorld):(e.matrix.copy(i.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld)),e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*Rc*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,T,t)},this.getCamera=function(){return T},this.getFoveation=function(){if(null!==d||null!==u)return o},this.setFoveation=function(e){o=e,null!==d&&(d.fixedFoveation=e),null!==u&&void 0!==u.fixedFoveation&&(u.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==f.texture};let D=null;const N=new zu;N.setAnimationLoop((function(t,r){if(c=r.getViewerPose(l||s),p=r,null!==c){const t=c.views;null!==u&&(e.setRenderTargetFramebuffer(v,u.framebuffer),e.setRenderTarget(v));let i=!1;t.length!==T.cameras.length&&(T.cameras.length=0,i=!0);for(let n=0;n<t.length;n++){const r=t[n];let s=null;if(null!==u)s=u.getViewport(r);else{const t=h.getViewSubImage(d,r);s=t.viewport,0===n&&(e.setRenderTargetTextures(v,t.colorTexture,d.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(v))}let a=S[n];void 0===a&&(a=new Mu,a.layers.enable(n),a.viewport=new ch,S[n]=a),a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),a.projectionMatrix.fromArray(r.projectionMatrix),a.projectionMatrixInverse.copy(a.projectionMatrix).invert(),a.viewport.set(s.x,s.y,s.width,s.height),0===n&&(T.matrix.copy(a.matrix),T.matrix.decompose(T.position,T.quaternion,T.scale)),!0===i&&T.cameras.push(a)}const r=n.enabledFeatures;if(r&&r.includes("depth-sensing")){const i=h.getDepthInformation(t[0]);i&&i.isValid&&i.texture&&f.init(e,i,n.renderState)}}for(let e=0;e<_.length;e++){const t=y[e],i=_[e];null!==t&&void 0!==i&&i.update(t,r,l||s)}f.render(e,T),D&&D(t,r),r.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:r}),p=null})),this.setAnimationLoop=function(e){D=e},this.dispose=function(){}}}function bm(e,t){function i(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function n(n,r){n.opacity.value=r.opacity,r.color&&n.diffuse.value.copy(r.color),r.emissive&&n.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(n.map.value=r.map,i(r.map,n.mapTransform)),r.alphaMap&&(n.alphaMap.value=r.alphaMap,i(r.alphaMap,n.alphaMapTransform)),r.bumpMap&&(n.bumpMap.value=r.bumpMap,i(r.bumpMap,n.bumpMapTransform),n.bumpScale.value=r.bumpScale,r.side===yl&&(n.bumpScale.value*=-1)),r.normalMap&&(n.normalMap.value=r.normalMap,i(r.normalMap,n.normalMapTransform),n.normalScale.value.copy(r.normalScale),r.side===yl&&n.normalScale.value.negate()),r.displacementMap&&(n.displacementMap.value=r.displacementMap,i(r.displacementMap,n.displacementMapTransform),n.displacementScale.value=r.displacementScale,n.displacementBias.value=r.displacementBias),r.emissiveMap&&(n.emissiveMap.value=r.emissiveMap,i(r.emissiveMap,n.emissiveMapTransform)),r.specularMap&&(n.specularMap.value=r.specularMap,i(r.specularMap,n.specularMapTransform)),r.alphaTest>0&&(n.alphaTest.value=r.alphaTest);const s=t.get(r).envMap;if(s&&(n.envMap.value=s,n.flipEnvMap.value=s.isCubeTexture&&!1===s.isRenderTargetTexture?-1:1,n.reflectivity.value=r.reflectivity,n.ior.value=r.ior,n.refractionRatio.value=r.refractionRatio),r.lightMap){n.lightMap.value=r.lightMap;const t=!0===e._useLegacyLights?Math.PI:1;n.lightMapIntensity.value=r.lightMapIntensity*t,i(r.lightMap,n.lightMapTransform)}r.aoMap&&(n.aoMap.value=r.aoMap,n.aoMapIntensity.value=r.aoMapIntensity,i(r.aoMap,n.aoMapTransform))}return{refreshFogUniforms:function(t,i){i.color.getRGB(t.fogColor.value,yu(e)),i.isFog?(t.fogNear.value=i.near,t.fogFar.value=i.far):i.isFogExp2&&(t.fogDensity.value=i.density)},refreshMaterialUniforms:function(e,r,s,a,o){r.isMeshBasicMaterial||r.isMeshLambertMaterial?n(e,r):r.isMeshToonMaterial?(n(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,r)):r.isMeshPhongMaterial?(n(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,r)):r.isMeshStandardMaterial?(n(e,r),function(e,n){e.metalness.value=n.metalness,n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap,i(n.metalnessMap,e.metalnessMapTransform)),e.roughness.value=n.roughness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap,i(n.roughnessMap,e.roughnessMapTransform));t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}(e,r),r.isMeshPhysicalMaterial&&function(e,t,n){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,i(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,i(t.sheenRoughnessMap,e.sheenRoughnessMapTransform))),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,i(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,i(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,i(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),t.side===yl&&e.clearcoatNormalScale.value.negate())),t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,i(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,i(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform))),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=n.texture,e.transmissionSamplerSize.value.set(n.width,n.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,i(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,i(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)),t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,i(t.anisotropyMap,e.anisotropyMapTransform))),e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,i(t.specularColorMap,e.specularColorMapTransform)),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,i(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,r,o)):r.isMeshMatcapMaterial?(n(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,r)):r.isMeshDepthMaterial?n(e,r):r.isMeshDistanceMaterial?(n(e,r),function(e,i){const n=t.get(i).light;e.referencePosition.value.setFromMatrixPosition(n.matrixWorld),e.nearDistance.value=n.shadow.camera.near,e.farDistance.value=n.shadow.camera.far}(e,r)):r.isMeshNormalMaterial?n(e,r):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,i(t.map,e.mapTransform))}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map,i(t.map,e.uvTransform)),t.alphaMap&&(e.alphaMap.value=t.alphaMap,i(t.alphaMap,e.alphaMapTransform)),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,r,s,a):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,i(t.map,e.mapTransform)),t.alphaMap&&(e.alphaMap.value=t.alphaMap,i(t.alphaMap,e.alphaMapTransform)),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function xm(e,t,i,n){let r={},s={},a=[];const o=i.isWebGL2?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(e,t,i,n){const r=e.value,s=t+"_"+i;if(void 0===n[s])return n[s]="number"==typeof r||"boolean"==typeof r?r:r.clone(),!0;{const e=n[s];if("number"==typeof r||"boolean"==typeof r){if(e!==r)return n[s]=r,!0}else if(!1===e.equals(r))return e.copy(r),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"==typeof e||"boolean"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function h(t){const i=t.target;i.removeEventListener("dispose",h);const n=a.indexOf(i.__bindingPointIndex);a.splice(n,1),e.deleteBuffer(r[i.id]),delete r[i.id],delete s[i.id]}return{bind:function(e,t){const i=t.program;n.uniformBlockBinding(e,i)},update:function(i,d){let u=r[i.id];void 0===u&&(function(e){const t=e.uniforms;let i=0;for(let e=0,n=t.length;e<n;e++){const n=Array.isArray(t[e])?t[e]:[t[e]];for(let e=0,t=n.length;e<t;e++){const t=n[e],r=Array.isArray(t.value)?t.value:[t.value];for(let e=0,n=r.length;e<n;e++){const n=c(r[e]),s=i%16;0!==s&&16-s<n.boundary&&(i+=16-s),t.__data=new Float32Array(n.storage/Float32Array.BYTES_PER_ELEMENT),t.__offset=i,i+=n.storage}}}const n=i%16;n>0&&(i+=16-n),e.__size=i,e.__cache={}}(i),u=function(t){const i=function(){for(let e=0;e<o;e++)if(-1===a.indexOf(e))return a.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=i;const n=e.createBuffer(),r=t.__size,s=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,n),e.bufferData(e.UNIFORM_BUFFER,r,s),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,i,n),n}(i),r[i.id]=u,i.addEventListener("dispose",h));const p=d.program;n.updateUBOMapping(i,p);const f=t.render.frame;s[i.id]!==f&&(function(t){const i=r[t.id],n=t.uniforms,s=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,i);for(let t=0,i=n.length;t<i;t++){const i=Array.isArray(n[t])?n[t]:[n[t]];for(let n=0,r=i.length;n<r;n++){const r=i[n];if(!0===l(r,t,n,s)){const t=r.__offset,i=Array.isArray(r.value)?r.value:[r.value];let n=0;for(let s=0;s<i.length;s++){const a=i[s],o=c(a);"number"==typeof a||"boolean"==typeof a?(r.__data[0]=a,e.bufferSubData(e.UNIFORM_BUFFER,t+n,r.__data)):a.isMatrix3?(r.__data[0]=a.elements[0],r.__data[1]=a.elements[1],r.__data[2]=a.elements[2],r.__data[3]=0,r.__data[4]=a.elements[3],r.__data[5]=a.elements[4],r.__data[6]=a.elements[5],r.__data[7]=0,r.__data[8]=a.elements[6],r.__data[9]=a.elements[7],r.__data[10]=a.elements[8],r.__data[11]=0):(a.toArray(r.__data,n),n+=o.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,r.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(i),s[i.id]=f)},dispose:function(){for(const t in r)e.deleteBuffer(r[t]);a=[],r={},s={}}}}class wm{constructor(e={}){const{canvas:t=Xc(),context:i=null,depth:n=!0,stencil:r=!0,alpha:s=!1,antialias:a=!1,premultipliedAlpha:o=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:h=!1}=e;let d;this.isWebGLRenderer=!0,d=null!==i?i.getContextAttributes().alpha:s;const u=new Uint32Array(4),p=new Int32Array(4);let f=null,m=null;const g=[],v=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=fc,this._useLegacyLights=!1,this.toneMapping=Ml,this.toneMappingExposure=1;const _=this;let y=!1,b=0,x=0,w=null,E=-1,S=null;const T=new ch,M=new ch;let A=null;const C=new Od(0);let L=0,P=t.width,R=t.height,O=1,I=null,D=null;const N=new ch(0,0,P,R),U=new ch(0,0,P,R);let F=!1;const z=new Fu;let k=!1,H=!1,B=null;const V=new Wh,j=new Bc,G=new mh,W={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function X(){return null===w?O:1}let q,Y,$,Z,K,J,Q,ee,te,ie,ne,re,se,ae,oe,le,ce,he,de,ue,pe,fe,me,ge,ve=i;function _e(e,i){for(let n=0;n<e.length;n++){const r=e[n],s=t.getContext(r,i);if(null!==s)return s}return null}try{const e={alpha:!0,depth:n,stencil:r,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${fl}`),t.addEventListener("webglcontextlost",xe,!1),t.addEventListener("webglcontextrestored",we,!1),t.addEventListener("webglcontextcreationerror",Ee,!1),null===ve){const t=["webgl2","webgl","experimental-webgl"];if(!0===_.isWebGL1Renderer&&t.shift(),ve=_e(t,e),null===ve)throw _e(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}"undefined"!=typeof WebGLRenderingContext&&ve instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===ve.getShaderPrecisionFormat&&(ve.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function ye(){q=new fp(ve),Y=new Yu(ve,q,e),q.init(Y),fe=new pm(ve,q,Y),$=new dm(ve,q,Y),Z=new vp(ve),K=new Kf,J=new um(ve,q,$,K,Y,fe,Z),Q=new Zu(_),ee=new pp(_),te=new ku(ve,Y),me=new Xu(ve,q,te,Y),ie=new mp(ve,te,Z,me),ne=new xp(ve,ie,te,Z),de=new bp(ve,Y,J),le=new $u(K),re=new Zf(_,Q,ee,q,Y,me,le),se=new bm(_,K),ae=new tm,oe=new om(q,Y),he=new Wu(_,Q,ee,$,ne,d,o),ce=new hm(_,ne,Y),ge=new xm(ve,Z,Y,$),ue=new qu(ve,q,Z,Y),pe=new gp(ve,q,Z,Y),Z.programs=re.programs,_.capabilities=Y,_.extensions=q,_.properties=K,_.renderLists=ae,_.shadowMap=ce,_.state=$,_.info=Z}ye();const be=new ym(_,ve);function xe(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),y=!0}function we(){console.log("THREE.WebGLRenderer: Context Restored."),y=!1;const e=Z.autoReset,t=ce.enabled,i=ce.autoUpdate,n=ce.needsUpdate,r=ce.type;ye(),Z.autoReset=e,ce.enabled=t,ce.autoUpdate=i,ce.needsUpdate=n,ce.type=r}function Ee(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Se(e){const t=e.target;t.removeEventListener("dispose",Se),function(e){(function(e){const t=K.get(e).programs;void 0!==t&&(t.forEach((function(e){re.releaseProgram(e)})),e.isShaderMaterial&&re.releaseShaderCache(e))})(e),K.remove(e)}(t)}function Te(e,t,i){!0===e.transparent&&e.side===bl&&!1===e.forceSinglePass?(e.side=yl,e.needsUpdate=!0,De(e,t,i),e.side=_l,e.needsUpdate=!0,De(e,t,i),e.side=bl):De(e,t,i)}this.xr=be,this.getContext=function(){return ve},this.getContextAttributes=function(){return ve.getContextAttributes()},this.forceContextLoss=function(){const e=q.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=q.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return O},this.setPixelRatio=function(e){void 0!==e&&(O=e,this.setSize(P,R,!1))},this.getSize=function(e){return e.set(P,R)},this.setSize=function(e,i,n=!0){be.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(P=e,R=i,t.width=Math.floor(e*O),t.height=Math.floor(i*O),!0===n&&(t.style.width=e+"px",t.style.height=i+"px"),this.setViewport(0,0,e,i))},this.getDrawingBufferSize=function(e){return e.set(P*O,R*O).floor()},this.setDrawingBufferSize=function(e,i,n){P=e,R=i,O=n,t.width=Math.floor(e*n),t.height=Math.floor(i*n),this.setViewport(0,0,e,i)},this.getCurrentViewport=function(e){return e.copy(T)},this.getViewport=function(e){return e.copy(N)},this.setViewport=function(e,t,i,n){e.isVector4?N.set(e.x,e.y,e.z,e.w):N.set(e,t,i,n),$.viewport(T.copy(N).multiplyScalar(O).floor())},this.getScissor=function(e){return e.copy(U)},this.setScissor=function(e,t,i,n){e.isVector4?U.set(e.x,e.y,e.z,e.w):U.set(e,t,i,n),$.scissor(M.copy(U).multiplyScalar(O).floor())},this.getScissorTest=function(){return F},this.setScissorTest=function(e){$.setScissorTest(F=e)},this.setOpaqueSort=function(e){I=e},this.setTransparentSort=function(e){D=e},this.getClearColor=function(e){return e.copy(he.getClearColor())},this.setClearColor=function(){he.setClearColor.apply(he,arguments)},this.getClearAlpha=function(){return he.getClearAlpha()},this.setClearAlpha=function(){he.setClearAlpha.apply(he,arguments)},this.clear=function(e=!0,t=!0,i=!0){let n=0;if(e){let e=!1;if(null!==w){const t=w.texture.format;e=t===nc||t===ic||t===tc}if(e){const e=w.texture.type,t=e===Gl||e===Xl||e===Wl||e===Kl||e===$l||e===Zl,i=he.getClearColor(),n=he.getClearAlpha(),r=i.r,s=i.g,a=i.b;t?(u[0]=r,u[1]=s,u[2]=a,u[3]=n,ve.clearBufferuiv(ve.COLOR,0,u)):(p[0]=r,p[1]=s,p[2]=a,p[3]=n,ve.clearBufferiv(ve.COLOR,0,p))}else n|=ve.COLOR_BUFFER_BIT}t&&(n|=ve.DEPTH_BUFFER_BIT),i&&(n|=ve.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ve.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",xe,!1),t.removeEventListener("webglcontextrestored",we,!1),t.removeEventListener("webglcontextcreationerror",Ee,!1),ae.dispose(),oe.dispose(),K.dispose(),Q.dispose(),ee.dispose(),ne.dispose(),me.dispose(),ge.dispose(),re.dispose(),be.dispose(),be.removeEventListener("sessionstart",Ae),be.removeEventListener("sessionend",Ce),B&&(B.dispose(),B=null),Le.stop()},this.renderBufferDirect=function(e,t,i,n,r,s){null===t&&(t=W);const a=r.isMesh&&r.matrixWorld.determinant()<0,o=function(e,t,i,n,r){!0!==t.isScene&&(t=W),J.resetTextureUnits();const s=t.fog,a=n.isMeshStandardMaterial?t.environment:null,o=null===w?_.outputColorSpace:!0===w.isXRRenderTarget?w.texture.colorSpace:mc,l=(n.isMeshStandardMaterial?ee:Q).get(n.envMap||a),c=!0===n.vertexColors&&!!i.attributes.color&&4===i.attributes.color.itemSize,h=!!i.attributes.tangent&&(!!n.normalMap||n.anisotropy>0),d=!!i.morphAttributes.position,u=!!i.morphAttributes.normal,p=!!i.morphAttributes.color;let f=Ml;n.toneMapped&&(null!==w&&!0!==w.isXRRenderTarget||(f=_.toneMapping));const g=i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color,v=void 0!==g?g.length:0,y=K.get(n),b=m.state.lights;if(!0===k&&(!0===H||e!==S)){const t=e===S&&n.id===E;le.setState(n,e,t)}let x=!1;n.version===y.__version?y.needsLights&&y.lightsStateVersion!==b.state.version||y.outputColorSpace!==o||r.isBatchedMesh&&!1===y.batching?x=!0:r.isBatchedMesh||!0!==y.batching?r.isInstancedMesh&&!1===y.instancing?x=!0:r.isInstancedMesh||!0!==y.instancing?r.isSkinnedMesh&&!1===y.skinning?x=!0:r.isSkinnedMesh||!0!==y.skinning?r.isInstancedMesh&&!0===y.instancingColor&&null===r.instanceColor||r.isInstancedMesh&&!1===y.instancingColor&&null!==r.instanceColor||y.envMap!==l||!0===n.fog&&y.fog!==s?x=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===le.numPlanes&&y.numIntersection===le.numIntersection?(y.vertexAlphas!==c||y.vertexTangents!==h||y.morphTargets!==d||y.morphNormals!==u||y.morphColors!==p||y.toneMapping!==f||!0===Y.isWebGL2&&y.morphTargetsCount!==v)&&(x=!0):x=!0:x=!0:x=!0:x=!0:(x=!0,y.__version=n.version);let T=y.currentProgram;!0===x&&(T=De(n,t,r));let M=!1,A=!1,C=!1;const L=T.getUniforms(),P=y.uniforms;if($.useProgram(T.program)&&(M=!0,A=!0,C=!0),n.id!==E&&(E=n.id,A=!0),M||S!==e){L.setValue(ve,"projectionMatrix",e.projectionMatrix),L.setValue(ve,"viewMatrix",e.matrixWorldInverse);const t=L.map.cameraPosition;void 0!==t&&t.setValue(ve,G.setFromMatrixPosition(e.matrixWorld)),Y.logarithmicDepthBuffer&&L.setValue(ve,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&L.setValue(ve,"isOrthographic",!0===e.isOrthographicCamera),S!==e&&(S=e,A=!0,C=!0)}if(r.isSkinnedMesh){L.setOptional(ve,r,"bindMatrix"),L.setOptional(ve,r,"bindMatrixInverse");const e=r.skeleton;e&&(Y.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),L.setValue(ve,"boneTexture",e.boneTexture,J)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}r.isBatchedMesh&&(L.setOptional(ve,r,"batchingTexture"),L.setValue(ve,"batchingTexture",r._matricesTexture,J));const I=i.morphAttributes;var D,N;if((void 0!==I.position||void 0!==I.normal||void 0!==I.color&&!0===Y.isWebGL2)&&de.update(r,i,T),(A||y.receiveShadow!==r.receiveShadow)&&(y.receiveShadow=r.receiveShadow,L.setValue(ve,"receiveShadow",r.receiveShadow)),n.isMeshGouraudMaterial&&null!==n.envMap&&(P.envMap.value=l,P.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1),A&&(L.setValue(ve,"toneMappingExposure",_.toneMappingExposure),y.needsLights&&(N=C,(D=P).ambientLightColor.needsUpdate=N,D.lightProbe.needsUpdate=N,D.directionalLights.needsUpdate=N,D.directionalLightShadows.needsUpdate=N,D.pointLights.needsUpdate=N,D.pointLightShadows.needsUpdate=N,D.spotLights.needsUpdate=N,D.spotLightShadows.needsUpdate=N,D.rectAreaLights.needsUpdate=N,D.hemisphereLights.needsUpdate=N),s&&!0===n.fog&&se.refreshFogUniforms(P,s),se.refreshMaterialUniforms(P,n,O,R,B),Cf.upload(ve,Ne(y),P,J)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Cf.upload(ve,Ne(y),P,J),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&L.setValue(ve,"center",r.center),L.setValue(ve,"modelViewMatrix",r.modelViewMatrix),L.setValue(ve,"normalMatrix",r.normalMatrix),L.setValue(ve,"modelMatrix",r.matrixWorld),n.isShaderMaterial||n.isRawShaderMaterial){const e=n.uniformsGroups;for(let t=0,i=e.length;t<i;t++)if(Y.isWebGL2){const i=e[t];ge.update(i,T),ge.bind(i,T)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return T}(e,t,i,n,r);$.setMaterial(n,a);let l=i.index,c=1;if(!0===n.wireframe){if(l=ie.getWireframeAttribute(i),void 0===l)return;c=2}const h=i.drawRange,d=i.attributes.position;let u=h.start*c,p=(h.start+h.count)*c;null!==s&&(u=Math.max(u,s.start*c),p=Math.min(p,(s.start+s.count)*c)),null!==l?(u=Math.max(u,0),p=Math.min(p,l.count)):null!=d&&(u=Math.max(u,0),p=Math.min(p,d.count));const f=p-u;if(f<0||f===1/0)return;let g;me.setup(r,n,o,i,l);let v=ue;if(null!==l&&(g=te.get(l),v=pe,v.setIndex(g)),r.isMesh)!0===n.wireframe?($.setLineWidth(n.wireframeLinewidth*X()),v.setMode(ve.LINES)):v.setMode(ve.TRIANGLES);else if(r.isLine){let e=n.linewidth;void 0===e&&(e=1),$.setLineWidth(e*X()),r.isLineSegments?v.setMode(ve.LINES):r.isLineLoop?v.setMode(ve.LINE_LOOP):v.setMode(ve.LINE_STRIP)}else r.isPoints?v.setMode(ve.POINTS):r.isSprite&&v.setMode(ve.TRIANGLES);if(r.isBatchedMesh)v.renderMultiDraw(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount);else if(r.isInstancedMesh)v.renderInstances(u,f,r.count);else if(i.isInstancedBufferGeometry){const e=void 0!==i._maxInstanceCount?i._maxInstanceCount:1/0,t=Math.min(i.instanceCount,e);v.renderInstances(u,f,t)}else v.render(u,f)},this.compile=function(e,t,i=null){null===i&&(i=e),m=oe.get(i),m.init(),v.push(m),i.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(m.pushLight(e),e.castShadow&&m.pushShadow(e))})),e!==i&&e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(m.pushLight(e),e.castShadow&&m.pushShadow(e))})),m.setupLights(_._useLegacyLights);const n=new Set;return e.traverse((function(e){const t=e.material;if(t)if(Array.isArray(t))for(let r=0;r<t.length;r++){const s=t[r];Te(s,i,e),n.add(s)}else Te(t,i,e),n.add(t)})),v.pop(),m=null,n},this.compileAsync=function(e,t,i=null){const n=this.compile(e,t,i);return new Promise((t=>{function i(){n.forEach((function(e){K.get(e).currentProgram.isReady()&&n.delete(e)})),0!==n.size?setTimeout(i,10):t(e)}null!==q.get("KHR_parallel_shader_compile")?i():setTimeout(i,10)}))};let Me=null;function Ae(){Le.stop()}function Ce(){Le.start()}const Le=new zu;function Pe(e,t,i,n){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)i=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)m.pushLight(e),e.castShadow&&m.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||z.intersectsSprite(e)){n&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(V);const t=ne.update(e),r=e.material;r.visible&&f.push(e,t,r,i,G.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||z.intersectsObject(e))){const t=ne.update(e),r=e.material;if(n&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),G.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),G.copy(t.boundingSphere.center)),G.applyMatrix4(e.matrixWorld).applyMatrix4(V)),Array.isArray(r)){const n=t.groups;for(let s=0,a=n.length;s<a;s++){const a=n[s],o=r[a.materialIndex];o&&o.visible&&f.push(e,t,o,i,G.z,a)}}else r.visible&&f.push(e,t,r,i,G.z,null)}const r=e.children;for(let e=0,s=r.length;e<s;e++)Pe(r[e],t,i,n)}function Re(e,t,i,n){const r=e.opaque,s=e.transmissive,a=e.transparent;m.setupLightsView(i),!0===k&&le.setGlobalState(_.clippingPlanes,i),s.length>0&&function(e,t,i,n){if(null!==(!0===i.isScene?i.overrideMaterial:null))return;const r=Y.isWebGL2;null===B&&(B=new dh(1,1,{generateMipmaps:!0,type:q.has("EXT_color_buffer_half_float")?Yl:Gl,minFilter:jl,samples:r?4:0})),_.getDrawingBufferSize(j),r?B.setSize(j.x,j.y):B.setSize(Fc(j.x),Fc(j.y));const s=_.getRenderTarget();_.setRenderTarget(B),_.getClearColor(C),L=_.getClearAlpha(),L<1&&_.setClearColor(16777215,.5),_.clear();const a=_.toneMapping;_.toneMapping=Ml,Oe(e,i,n),J.updateMultisampleRenderTarget(B),J.updateRenderTargetMipmap(B);let o=!1;for(let e=0,r=t.length;e<r;e++){const r=t[e],s=r.object,a=r.geometry,l=r.material,c=r.group;if(l.side===bl&&s.layers.test(n.layers)){const e=l.side;l.side=yl,l.needsUpdate=!0,Ie(s,i,n,a,l,c),l.side=e,l.needsUpdate=!0,o=!0}}!0===o&&(J.updateMultisampleRenderTarget(B),J.updateRenderTargetMipmap(B)),_.setRenderTarget(s),_.setClearColor(C,L),_.toneMapping=a}(r,s,t,i),n&&$.viewport(T.copy(n)),r.length>0&&Oe(r,t,i),s.length>0&&Oe(s,t,i),a.length>0&&Oe(a,t,i),$.buffers.depth.setTest(!0),$.buffers.depth.setMask(!0),$.buffers.color.setMask(!0),$.setPolygonOffset(!1)}function Oe(e,t,i){const n=!0===t.isScene?t.overrideMaterial:null;for(let r=0,s=e.length;r<s;r++){const s=e[r],a=s.object,o=s.geometry,l=null===n?s.material:n,c=s.group;a.layers.test(i.layers)&&Ie(a,t,i,o,l,c)}}function Ie(e,t,i,n,r,s){e.onBeforeRender(_,t,i,n,r,s),e.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),r.onBeforeRender(_,t,i,n,e,s),!0===r.transparent&&r.side===bl&&!1===r.forceSinglePass?(r.side=yl,r.needsUpdate=!0,_.renderBufferDirect(i,t,n,r,e,s),r.side=_l,r.needsUpdate=!0,_.renderBufferDirect(i,t,n,r,e,s),r.side=bl):_.renderBufferDirect(i,t,n,r,e,s),e.onAfterRender(_,t,i,n,r,s)}function De(e,t,i){!0!==t.isScene&&(t=W);const n=K.get(e),r=m.state.lights,s=m.state.shadowsArray,a=r.state.version,o=re.getParameters(e,r.state,s,t,i),l=re.getProgramCacheKey(o);let c=n.programs;n.environment=e.isMeshStandardMaterial?t.environment:null,n.fog=t.fog,n.envMap=(e.isMeshStandardMaterial?ee:Q).get(e.envMap||n.environment),void 0===c&&(e.addEventListener("dispose",Se),c=new Map,n.programs=c);let h=c.get(l);if(void 0!==h){if(n.currentProgram===h&&n.lightsStateVersion===a)return Ue(e,o),h}else o.uniforms=re.getUniforms(e),e.onBuild(i,o,_),e.onBeforeCompile(o,_),h=re.acquireProgram(o,l),c.set(l,h),n.uniforms=o.uniforms;const d=n.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(d.clippingPlanes=le.uniform),Ue(e,o),n.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),n.lightsStateVersion=a,n.needsLights&&(d.ambientLightColor.value=r.state.ambient,d.lightProbe.value=r.state.probe,d.directionalLights.value=r.state.directional,d.directionalLightShadows.value=r.state.directionalShadow,d.spotLights.value=r.state.spot,d.spotLightShadows.value=r.state.spotShadow,d.rectAreaLights.value=r.state.rectArea,d.ltc_1.value=r.state.rectAreaLTC1,d.ltc_2.value=r.state.rectAreaLTC2,d.pointLights.value=r.state.point,d.pointLightShadows.value=r.state.pointShadow,d.hemisphereLights.value=r.state.hemi,d.directionalShadowMap.value=r.state.directionalShadowMap,d.directionalShadowMatrix.value=r.state.directionalShadowMatrix,d.spotShadowMap.value=r.state.spotShadowMap,d.spotLightMatrix.value=r.state.spotLightMatrix,d.spotLightMap.value=r.state.spotLightMap,d.pointShadowMap.value=r.state.pointShadowMap,d.pointShadowMatrix.value=r.state.pointShadowMatrix),n.currentProgram=h,n.uniformsList=null,h}function Ne(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=Cf.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function Ue(e,t){const i=K.get(e);i.outputColorSpace=t.outputColorSpace,i.batching=t.batching,i.instancing=t.instancing,i.instancingColor=t.instancingColor,i.skinning=t.skinning,i.morphTargets=t.morphTargets,i.morphNormals=t.morphNormals,i.morphColors=t.morphColors,i.morphTargetsCount=t.morphTargetsCount,i.numClippingPlanes=t.numClippingPlanes,i.numIntersection=t.numClipIntersection,i.vertexAlphas=t.vertexAlphas,i.vertexTangents=t.vertexTangents,i.toneMapping=t.toneMapping}Le.setAnimationLoop((function(e){Me&&Me(e)})),"undefined"!=typeof self&&Le.setContext(self),this.setAnimationLoop=function(e){Me=e,be.setAnimationLoop(e),null===e?Le.stop():Le.start()},be.addEventListener("sessionstart",Ae),be.addEventListener("sessionend",Ce),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===y)return;!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===be.enabled&&!0===be.isPresenting&&(!0===be.cameraAutoUpdate&&be.updateCamera(t),t=be.getCamera()),!0===e.isScene&&e.onBeforeRender(_,e,t,w),m=oe.get(e,v.length),m.init(),v.push(m),V.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),z.setFromProjectionMatrix(V),H=this.localClippingEnabled,k=le.init(this.clippingPlanes,H),f=ae.get(e,g.length),f.init(),g.push(f),Pe(e,t,0,_.sortObjects),f.finish(),!0===_.sortObjects&&f.sort(I,D),this.info.render.frame++,!0===k&&le.beginShadows();const i=m.state.shadowsArray;if(ce.render(i,e,t),!0===k&&le.endShadows(),!0===this.info.autoReset&&this.info.reset(),!1!==be.enabled&&!1!==be.isPresenting&&!1!==be.hasDepthSensing()||he.render(f,e),m.setupLights(_._useLegacyLights),t.isArrayCamera){const i=t.cameras;for(let t=0,n=i.length;t<n;t++){const n=i[t];Re(f,e,n,n.viewport)}}else Re(f,e,t);null!==w&&(J.updateMultisampleRenderTarget(w),J.updateRenderTargetMipmap(w)),!0===e.isScene&&e.onAfterRender(_,e,t),me.resetDefaultState(),E=-1,S=null,v.pop(),m=v.length>0?v[v.length-1]:null,g.pop(),f=g.length>0?g[g.length-1]:null},this.getActiveCubeFace=function(){return b},this.getActiveMipmapLevel=function(){return x},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(e,t,i){K.get(e.texture).__webglTexture=t,K.get(e.depthTexture).__webglTexture=i;const n=K.get(e);n.__hasExternalTextures=!0,n.__hasExternalTextures&&(n.__autoAllocateDepthBuffer=void 0===i,n.__autoAllocateDepthBuffer||!0===q.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),n.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){const i=K.get(e);i.__webglFramebuffer=t,i.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e,t=0,i=0){w=e,b=t,x=i;let n=!0,r=null,s=!1,a=!1;if(e){const o=K.get(e);void 0!==o.__useDefaultFramebuffer?($.bindFramebuffer(ve.FRAMEBUFFER,null),n=!1):void 0===o.__webglFramebuffer?J.setupRenderTarget(e):o.__hasExternalTextures&&J.rebindTextures(e,K.get(e.texture).__webglTexture,K.get(e.depthTexture).__webglTexture);const l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(a=!0);const c=K.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=Array.isArray(c[t])?c[t][i]:c[t],s=!0):r=Y.isWebGL2&&e.samples>0&&!1===J.useMultisampledRTT(e)?K.get(e).__webglMultisampledFramebuffer:Array.isArray(c)?c[i]:c,T.copy(e.viewport),M.copy(e.scissor),A=e.scissorTest}else T.copy(N).multiplyScalar(O).floor(),M.copy(U).multiplyScalar(O).floor(),A=F;if($.bindFramebuffer(ve.FRAMEBUFFER,r)&&Y.drawBuffers&&n&&$.drawBuffers(e,r),$.viewport(T),$.scissor(M),$.setScissorTest(A),s){const n=K.get(e.texture);ve.framebufferTexture2D(ve.FRAMEBUFFER,ve.COLOR_ATTACHMENT0,ve.TEXTURE_CUBE_MAP_POSITIVE_X+t,n.__webglTexture,i)}else if(a){const n=K.get(e.texture),r=t||0;ve.framebufferTextureLayer(ve.FRAMEBUFFER,ve.COLOR_ATTACHMENT0,n.__webglTexture,i||0,r)}E=-1},this.readRenderTargetPixels=function(e,t,i,n,r,s,a){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let o=K.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(o=o[a]),o){$.bindFramebuffer(ve.FRAMEBUFFER,o);try{const a=e.texture,o=a.format,l=a.type;if(o!==Jl&&fe.convert(o)!==ve.getParameter(ve.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===Yl&&(q.has("EXT_color_buffer_half_float")||Y.isWebGL2&&q.has("EXT_color_buffer_float"));if(!(l===Gl||fe.convert(l)===ve.getParameter(ve.IMPLEMENTATION_COLOR_READ_TYPE)||l===ql&&(Y.isWebGL2||q.has("OES_texture_float")||q.has("WEBGL_color_buffer_float"))||c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-n&&i>=0&&i<=e.height-r&&ve.readPixels(t,i,n,r,fe.convert(o),fe.convert(l),s)}finally{const e=null!==w?K.get(w).__webglFramebuffer:null;$.bindFramebuffer(ve.FRAMEBUFFER,e)}}},this.copyFramebufferToTexture=function(e,t,i=0){const n=Math.pow(2,-i),r=Math.floor(t.image.width*n),s=Math.floor(t.image.height*n);J.setTexture2D(t,0),ve.copyTexSubImage2D(ve.TEXTURE_2D,i,0,0,e.x,e.y,r,s),$.unbindTexture()},this.copyTextureToTexture=function(e,t,i,n=0){const r=t.image.width,s=t.image.height,a=fe.convert(i.format),o=fe.convert(i.type);J.setTexture2D(i,0),ve.pixelStorei(ve.UNPACK_FLIP_Y_WEBGL,i.flipY),ve.pixelStorei(ve.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),ve.pixelStorei(ve.UNPACK_ALIGNMENT,i.unpackAlignment),t.isDataTexture?ve.texSubImage2D(ve.TEXTURE_2D,n,e.x,e.y,r,s,a,o,t.image.data):t.isCompressedTexture?ve.compressedTexSubImage2D(ve.TEXTURE_2D,n,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,a,t.mipmaps[0].data):ve.texSubImage2D(ve.TEXTURE_2D,n,e.x,e.y,a,o,t.image),0===n&&i.generateMipmaps&&ve.generateMipmap(ve.TEXTURE_2D),$.unbindTexture()},this.copyTextureToTexture3D=function(e,t,i,n,r=0){if(_.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const s=e.max.x-e.min.x+1,a=e.max.y-e.min.y+1,o=e.max.z-e.min.z+1,l=fe.convert(n.format),c=fe.convert(n.type);let h;if(n.isData3DTexture)J.setTexture3D(n,0),h=ve.TEXTURE_3D;else{if(!n.isDataArrayTexture&&!n.isCompressedArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");J.setTexture2DArray(n,0),h=ve.TEXTURE_2D_ARRAY}ve.pixelStorei(ve.UNPACK_FLIP_Y_WEBGL,n.flipY),ve.pixelStorei(ve.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),ve.pixelStorei(ve.UNPACK_ALIGNMENT,n.unpackAlignment);const d=ve.getParameter(ve.UNPACK_ROW_LENGTH),u=ve.getParameter(ve.UNPACK_IMAGE_HEIGHT),p=ve.getParameter(ve.UNPACK_SKIP_PIXELS),f=ve.getParameter(ve.UNPACK_SKIP_ROWS),m=ve.getParameter(ve.UNPACK_SKIP_IMAGES),g=i.isCompressedTexture?i.mipmaps[r]:i.image;ve.pixelStorei(ve.UNPACK_ROW_LENGTH,g.width),ve.pixelStorei(ve.UNPACK_IMAGE_HEIGHT,g.height),ve.pixelStorei(ve.UNPACK_SKIP_PIXELS,e.min.x),ve.pixelStorei(ve.UNPACK_SKIP_ROWS,e.min.y),ve.pixelStorei(ve.UNPACK_SKIP_IMAGES,e.min.z),i.isDataTexture||i.isData3DTexture?ve.texSubImage3D(h,r,t.x,t.y,t.z,s,a,o,l,c,g.data):i.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ve.compressedTexSubImage3D(h,r,t.x,t.y,t.z,s,a,o,l,g.data)):ve.texSubImage3D(h,r,t.x,t.y,t.z,s,a,o,l,c,g),ve.pixelStorei(ve.UNPACK_ROW_LENGTH,d),ve.pixelStorei(ve.UNPACK_IMAGE_HEIGHT,u),ve.pixelStorei(ve.UNPACK_SKIP_PIXELS,p),ve.pixelStorei(ve.UNPACK_SKIP_ROWS,f),ve.pixelStorei(ve.UNPACK_SKIP_IMAGES,m),0===r&&n.generateMipmaps&&ve.generateMipmap(h),$.unbindTexture()},this.initTexture=function(e){e.isCubeTexture?J.setTextureCube(e,0):e.isData3DTexture?J.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?J.setTexture2DArray(e,0):J.setTexture2D(e,0),$.unbindTexture()},this.resetState=function(){b=0,x=0,w=null,$.reset(),me.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Tc}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===gc?"display-p3":"srgb",t.unpackColorSpace=Qc.workingColorSpace===vc?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===fc?uc:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===uc?fc:mc}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class extends wm{}).prototype.isWebGL1Renderer=!0;class Em extends gd{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class Sm{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,n=this.getPoint(0),r=0;t.push(0);for(let s=1;s<=e;s++)i=this.getPoint(s/e),r+=i.distanceTo(n),t.push(r),n=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let n=0;const r=i.length;let s;s=t||e*i[r-1];let a,o=0,l=r-1;for(;o<=l;)if(n=Math.floor(o+(l-o)/2),a=i[n]-s,a<0)o=n+1;else{if(!(a>0)){l=n;break}l=n-1}if(n=l,i[n]===s)return n/(r-1);const c=i[n];return(n+(s-c)/(i[n+1]-c))/(r-1)}getTangent(e,t){const i=1e-4;let n=e-i,r=e+i;n<0&&(n=0),r>1&&(r=1);const s=this.getPoint(n),a=this.getPoint(r),o=t||(s.isVector2?new Bc:new mh);return o.copy(a).sub(s).normalize(),o}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new mh,n=[],r=[],s=[],a=new mh,o=new Wh;for(let t=0;t<=e;t++){const i=t/e;n[t]=this.getTangentAt(i,new mh)}r[0]=new mh,s[0]=new mh;let l=Number.MAX_VALUE;const c=Math.abs(n[0].x),h=Math.abs(n[0].y),d=Math.abs(n[0].z);c<=l&&(l=c,i.set(1,0,0)),h<=l&&(l=h,i.set(0,1,0)),d<=l&&i.set(0,0,1),a.crossVectors(n[0],i).normalize(),r[0].crossVectors(n[0],a),s[0].crossVectors(n[0],r[0]);for(let t=1;t<=e;t++){if(r[t]=r[t-1].clone(),s[t]=s[t-1].clone(),a.crossVectors(n[t-1],n[t]),a.length()>Number.EPSILON){a.normalize();const e=Math.acos(Ic(n[t-1].dot(n[t]),-1,1));r[t].applyMatrix4(o.makeRotationAxis(a,e))}s[t].crossVectors(n[t],r[t])}if(!0===t){let t=Math.acos(Ic(r[0].dot(r[e]),-1,1));t/=e,n[0].dot(a.crossVectors(r[0],r[e]))>0&&(t=-t);for(let i=1;i<=e;i++)r[i].applyMatrix4(o.makeRotationAxis(n[i],t*i)),s[i].crossVectors(n[i],r[i])}return{tangents:n,normals:r,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}function Tm(e,t,i,n,r){const s=.5*(n-t),a=.5*(r-i),o=e*e;return(2*i-2*n+s+a)*(e*o)+(-3*i+3*n-2*s-a)*o+s*e+i}class Mm extends Sm{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Bc){const i=t,n=this.points,r=(n.length-1)*e,s=Math.floor(r),a=r-s,o=n[0===s?s:s-1],l=n[s],c=n[s>n.length-2?n.length-1:s+1],h=n[s>n.length-3?n.length-1:s+2];return i.set(Tm(a,o.x,l.x,c.x,h.x),Tm(a,o.y,l.y,c.y,h.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const i=e.points[t];this.points.push((new Bc).fromArray(i))}return this}}class Am extends Zd{constructor(e=1,t=32,i=16,n=0,r=2*Math.PI,s=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const o=Math.min(s+a,Math.PI);let l=0;const c=[],h=new mh,d=new mh,u=[],p=[],f=[],m=[];for(let u=0;u<=i;u++){const g=[],v=u/i;let _=0;0===u&&0===s?_=.5/t:u===i&&o===Math.PI&&(_=-.5/t);for(let i=0;i<=t;i++){const o=i/t;h.x=-e*Math.cos(n+o*r)*Math.sin(s+v*a),h.y=e*Math.cos(s+v*a),h.z=e*Math.sin(n+o*r)*Math.sin(s+v*a),p.push(h.x,h.y,h.z),d.copy(h).normalize(),f.push(d.x,d.y,d.z),m.push(o+_,1-v),g.push(l++)}c.push(g)}for(let e=0;e<i;e++)for(let n=0;n<t;n++){const t=c[e][n+1],r=c[e][n],a=c[e+1][n],l=c[e+1][n+1];(0!==e||s>0)&&u.push(t,r,l),(e!==i-1||o<Math.PI)&&u.push(r,a,l)}this.setIndex(u),this.setAttribute("position",new Vd(p,3)),this.setAttribute("normal",new Vd(f,3)),this.setAttribute("uv",new Vd(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Am(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}function Cm(e,t,i){return!e||!i&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}class Lm{constructor(e,t,i,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,n=t[i],r=t[i-1];e:{t:{let s;i:{n:if(!(e<n)){for(let s=i+2;;){if(void 0===n){if(e<r)break n;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===s)break;if(r=n,n=t[++i],e<n)break t}s=t.length;break i}if(e>=r)break e;{const a=t[1];e<a&&(i=2,r=a);for(let s=i-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(i===s)break;if(n=r,r=t[--i-1],e>=r)break t}s=i,i=0}}for(;i<s;){const n=i+s>>>1;e<t[n]?s=n:i=n+1}if(n=t[i],r=t[i-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===n)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=e*n;for(let e=0;e!==n;++e)t[e]=i[r+e];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Pm extends Lm{constructor(e,t,i,n){super(e,t,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const n=this.parameterPositions;let r=e-2,s=e+1,a=n[r],o=n[s];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:r=e,a=2*t-i;break;case 2402:r=n.length-2,a=t+n[r]-n[r+1];break;default:r=e,a=i}if(void 0===o)switch(this.getSettings_().endingEnd){case 2401:s=e,o=2*i-t;break;case 2402:s=1,o=i+n[1]-n[0];break;default:s=e-1,o=t}const l=.5*(i-t),c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-i),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(e,t,i,n){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,u=this._weightNext,p=(i-t)/(n-t),f=p*p,m=f*p,g=-d*m+2*d*f-d*p,v=(1+d)*m+(-1.5-2*d)*f+(-.5+d)*p+1,_=(-1-u)*m+(1.5+u)*f+.5*p,y=u*m-u*f;for(let e=0;e!==a;++e)r[e]=g*s[c+e]+v*s[l+e]+_*s[o+e]+y*s[h+e];return r}}class Rm extends Lm{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e,t,i,n){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=(i-t)/(n-t),h=1-c;for(let e=0;e!==a;++e)r[e]=s[l+e]*h+s[o+e]*c;return r}}class Om extends Lm{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e){return this.copySampleValue_(e-1)}}class Im{constructor(e,t,i,n){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Cm(t,this.TimeBufferType),this.values=Cm(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Cm(e.times,Array),values:Cm(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(i.interpolation=t)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new Om(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Rm(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Pm(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case cc:t=this.InterpolantFactoryMethodDiscrete;break;case hc:t=this.InterpolantFactoryMethodLinear;break;case dc:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return cc;case this.InterpolantFactoryMethodLinear:return hc;case this.InterpolantFactoryMethodSmooth:return dc}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,n=t.length;i!==n;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,n=t.length;i!==n;++i)t[i]*=e}return this}trim(e,t){const i=this.times,n=i.length;let r=0,s=n-1;for(;r!==n&&i[r]<e;)++r;for(;-1!==s&&i[s]>t;)--s;if(++s,0!==r||s!==n){r>=s&&(s=Math.max(s,1),r=s-1);const e=this.getValueSize();this.times=i.slice(r,s),this.values=this.values.slice(r*e,s*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,n=this.values,r=i.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let t=0;t!==r;t++){const n=i[t];if("number"==typeof n&&isNaN(n)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,n),e=!1;break}if(null!==s&&s>n){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,n,s),e=!1;break}s=n}if(void 0!==n&&(a=n,ArrayBuffer.isView(a)&&!(a instanceof DataView)))for(let t=0,i=n.length;t!==i;++t){const i=n[t];if(isNaN(i)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,i),e=!1;break}}var a;return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),n=this.getInterpolation()===dc,r=e.length-1;let s=1;for(let a=1;a<r;++a){let r=!1;const o=e[a];if(o!==e[a+1]&&(1!==a||o!==e[0]))if(n)r=!0;else{const e=a*i,n=e-i,s=e+i;for(let a=0;a!==i;++a){const i=t[e+a];if(i!==t[n+a]||i!==t[s+a]){r=!0;break}}}if(r){if(a!==s){e[s]=e[a];const n=a*i,r=s*i;for(let e=0;e!==i;++e)t[r+e]=t[n+e]}++s}}if(r>0){e[s]=e[r];for(let e=r*i,n=s*i,a=0;a!==i;++a)t[n+a]=t[e+a];++s}return s!==e.length?(this.times=e.slice(0,s),this.values=t.slice(0,s*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),i=new(0,this.constructor)(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}Im.prototype.TimeBufferType=Float32Array,Im.prototype.ValueBufferType=Float32Array,Im.prototype.DefaultInterpolation=hc;class Dm extends Im{}Dm.prototype.ValueTypeName="bool",Dm.prototype.ValueBufferType=Array,Dm.prototype.DefaultInterpolation=cc,Dm.prototype.InterpolantFactoryMethodLinear=void 0,Dm.prototype.InterpolantFactoryMethodSmooth=void 0;(class extends Im{}).prototype.ValueTypeName="color";(class extends Im{}).prototype.ValueTypeName="number";class Nm extends Lm{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e,t,i,n){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(i-t)/(n-t);let l=e*a;for(let e=l+a;l!==e;l+=4)fh.slerpFlat(r,0,s,l-a,s,l,o);return r}}class Um extends Im{InterpolantFactoryMethodLinear(e){return new Nm(this.times,this.values,this.getValueSize(),e)}}Um.prototype.ValueTypeName="quaternion",Um.prototype.DefaultInterpolation=hc,Um.prototype.InterpolantFactoryMethodSmooth=void 0;class Fm extends Im{}Fm.prototype.ValueTypeName="string",Fm.prototype.ValueBufferType=Array,Fm.prototype.DefaultInterpolation=cc,Fm.prototype.InterpolantFactoryMethodLinear=void 0,Fm.prototype.InterpolantFactoryMethodSmooth=void 0;(class extends Im{}).prototype.ValueTypeName="vector";const zm={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class km{constructor(e,t,i){const n=this;let r,s=!1,a=0,o=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(e){o++,!1===s&&void 0!==n.onStart&&n.onStart(e,a,o),s=!0},this.itemEnd=function(e){a++,void 0!==n.onProgress&&n.onProgress(e,a,o),a===o&&(s=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)},this.resolveURL=function(e){return r?r(e):e},this.setURLModifier=function(e){return r=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,i=l.length;t<i;t+=2){const i=l[t],n=l[t+1];if(i.global&&(i.lastIndex=0),i.test(e))return n}return null}}}const Hm=new km;class Bm{constructor(e){this.manager=void 0!==e?e:Hm,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise((function(n,r){i.load(e,n,t,r)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Bm.DEFAULT_MATERIAL_NAME="__DEFAULT";class Vm extends Error{constructor(e,t){super(e),this.response=t}}const jm="\\[\\]\\.:\\/",Gm=new RegExp("["+jm+"]","g"),Wm="[^"+jm+"]",Xm="[^"+jm.replace("\\.","")+"]",qm=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Wm)+/(WCOD+)?/.source.replace("WCOD",Xm)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Wm)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Wm)+"$"),Ym=["material","materials","bones","map"];class $m{constructor(e,t,i){this.path=t,this.parsedPath=i||$m.parseTrackName(t),this.node=$m.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new $m.Composite(e,t,i):new $m(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Gm,"")}static parseTrackName(e){const t=qm.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){const e=i.nodeName.substring(n+1);-1!==Ym.indexOf(e)&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=e)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(void 0!==i)return i}if(e.children){const i=function(e){for(let n=0;n<e.length;n++){const r=e[n];if(r.name===t||r.uuid===t)return r;const s=i(r.children);if(s)return s}return null},n=i(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)e[t++]=i[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,n=t.propertyName;let r=t.propertyIndex;if(e||(e=$m.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(i){let n=t.objectIndex;switch(i){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===n){n=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[i]}if(void 0!==n){if(void 0===e[n])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[n]}}const s=e[n];if(void 0===s){const i=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i+"."+n+" but it wasn't found.",e)}let a=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}$m.Composite=class{constructor(e,t,i){const n=i||$m.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}},$m.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},$m.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},$m.prototype.GetterByBindingType=[$m.prototype._getValue_direct,$m.prototype._getValue_array,$m.prototype._getValue_arrayElement,$m.prototype._getValue_toArray],$m.prototype.SetterByBindingTypeAndVersioning=[[$m.prototype._setValue_direct,$m.prototype._setValue_direct_setNeedsUpdate,$m.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[$m.prototype._setValue_array,$m.prototype._setValue_array_setNeedsUpdate,$m.prototype._setValue_array_setMatrixWorldNeedsUpdate],[$m.prototype._setValue_arrayElement,$m.prototype._setValue_arrayElement_setNeedsUpdate,$m.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[$m.prototype._setValue_fromArray,$m.prototype._setValue_fromArray_setNeedsUpdate,$m.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class Zm{constructor(e,t,i=0,n=1/0){this.ray=new Gh(e,t),this.near=i,this.far=n,this.camera=null,this.layers=new id,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return Jm(e,this,i,t),i.sort(Km),i}intersectObjects(e,t=!0,i=[]){for(let n=0,r=e.length;n<r;n++)Jm(e[n],this,i,t);return i.sort(Km),i}}function Km(e,t){return e.distance-t.distance}function Jm(e,t,i,n){if(e.layers.test(t.layers)&&e.raycast(t,i),!0===n){const n=e.children;for(let e=0,r=n.length;e<r;e++)Jm(n[e],t,i,!0)}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:fl}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=fl);var Qm=Object.defineProperty,eg=(e,t)=>{for(var i in t)Qm(e,i,{get:t[i],enumerable:!0})};eg({},{ACTIONS:()=>pg,ANIMATION_MIN_DURATION:()=>ng,CAPTURE_EVENTS_CLASS:()=>ug,CTRLZOOM_TIMEOUT:()=>lg,DBLCLICK_DELAY:()=>sg,DEFAULT_TRANSITION:()=>ig,EASINGS:()=>vg,ICONS:()=>gg,IDS:()=>fg,INERTIA_WINDOW:()=>cg,KEY_CODES:()=>mg,LONGTOUCH_DELAY:()=>ag,MOVE_THRESHOLD:()=>rg,SPHERE_RADIUS:()=>hg,TWOFINGERSOVERLAY_DELAY:()=>og,VIEWER_DATA:()=>dg});var tg,ig=1500,ng=500,rg=4,sg=300,ag=500,og=100,lg=2e3,cg=300,hg=10,dg="photoSphereViewer",ug="psv--capture-event",pg=(e=>(e.ROTATE_UP="ROTATE_UP",e.ROTATE_DOWN="ROTATE_DOWN",e.ROTATE_RIGHT="ROTATE_RIGHT",e.ROTATE_LEFT="ROTATE_LEFT",e.ZOOM_IN="ZOOM_IN",e.ZOOM_OUT="ZOOM_OUT",e))(pg||{}),fg={MENU:"menu",TWO_FINGERS:"twoFingers",CTRL_ZOOM:"ctrlZoom",ERROR:"error",DESCRIPTION:"description"},mg={Enter:"Enter",Control:"Control",Escape:"Escape",Space:" ",PageUp:"PageUp",PageDown:"PageDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Delete:"Delete",Plus:"+",Minus:"-"},gg={arrow:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="40 40 432 432"><g transform="rotate(0, 256, 256)"><path fill="currentColor" d="M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z"/></g>\x3c!-- Created by Flatart from the Noun Project --\x3e</svg>\n',close:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g fill="currentColor" transform=" translate(50, 50) rotate(45)"><rect x="-5" y="-65" width="10" height="130"/><rect x="-65" y="-5" width="130" height="10"/></g></svg>',download:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path fill="currentColor" d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/>\x3c!--Created by Michael Zenaty from the Noun Project--\x3e</svg>\n',fullscreenIn:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/>\x3c!--Created by Garrett Knoll from the Noun Project--\x3e</svg>\n',fullscreenOut:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/>\x3c!--Created by Garrett Knoll from the Noun Project--\x3e</svg>\n',info:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="currentColor" d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle fill="currentColor" cx="39.3" cy="9.2" r="8.2"/>\x3c!--Created by Arafat Uddin from the Noun Project--\x3e</svg>\n',menu:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 80 80"><g fill="currentColor"><circle r="10" cx="20" cy="20"/><circle r="10" cx="50" cy="20"/><circle r="10" cx="80" cy="20"/><circle r="10" cx="20" cy="50"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="80" cy="50"/><circle r="10" cx="20" cy="80"/><circle r="10" cx="50" cy="80"/><circle r="10" cx="80" cy="80"/></g>\x3c!-- Created by Richard Kunk from the Noun Project--\x3e</svg>\n',zoomIn:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/>\x3c!--Created by Ryan Canning from the Noun Project--\x3e</svg>\n',zoomOut:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M4.006 6.746h7.459V8.73H4.006z"/>\x3c!--Created by Ryan Canning from the Noun Project--\x3e</svg>\n'},vg={linear:e=>e,inQuad:e=>e*e,outQuad:e=>e*(2-e),inOutQuad:e=>e<.5?2*e*e:(4-2*e)*e-1,inCubic:e=>e*e*e,outCubic:e=>--e*e*e+1,inOutCubic:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,inQuart:e=>e*e*e*e,outQuart:e=>1- --e*e*e*e,inOutQuart:e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e,inQuint:e=>e*e*e*e*e,outQuint:e=>1+--e*e*e*e*e,inOutQuint:e=>e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e,inSine:e=>1-Math.cos(e*(Math.PI/2)),outSine:e=>Math.sin(e*(Math.PI/2)),inOutSine:e=>.5-.5*Math.cos(Math.PI*e),inExpo:e=>Math.pow(2,10*(e-1)),outExpo:e=>1-Math.pow(2,-10*e),inOutExpo:e=>(e=2*e-1)<0?.5*Math.pow(2,10*e):1-.5*Math.pow(2,-10*e),inCirc:e=>1-Math.sqrt(1-e*e),outCirc:e=>Math.sqrt(1-(e-1)*(e-1)),inOutCirc:e=>(e*=2)<1?.5-.5*Math.sqrt(1-e*e):.5+.5*Math.sqrt(1-(e-=2)*e)},_g={};function yg(e,t){let i=e%t;return i<0&&(i+=t),i}function bg(e){return e.reduce(((e,t)=>e+t),0)}function xg(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function wg(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}function Eg(e,t){return[0,2*Math.PI,2*-Math.PI].reduce(((i,n)=>{const r=t-e+n;return Math.abs(r)<Math.abs(i)?r:i}),1/0)}function Sg(e,t){return Math.acos(Math.cos(e.pitch)*Math.cos(t.pitch)*Math.cos(e.yaw-t.yaw)+Math.sin(e.pitch)*Math.sin(t.pitch))}function Tg([e,t],[i,n]){e-i>Math.PI?e-=2*Math.PI:e-i<-Math.PI&&(e+=2*Math.PI);const r=(i-e)*Math.cos((t+n)/2),s=n-t;return Math.sqrt(r*r+s*s)}function Mg(e){return"string"==typeof e?e.match(/^[a-z]/i)?document.getElementById(e):document.querySelector(e):e}function Ag(e,t,i){void 0===i?e.classList.toggle(t):i?e.classList.add(t):i||e.classList.remove(t)}function Cg(e,t){e.classList.add(...t.split(" "))}function Lg(e,t){e.classList.remove(...t.split(" "))}function Pg(e,t){let i=e;do{if(i===t)return!0;i=i.parentElement}while(i);return!1}function Rg(e,t){if(!e?.matches)return null;let i=e;do{if(i.matches(t))return i;i=i.parentElement}while(i);return null}function Og(e){let t=0,i=0,n=e;for(;n;)t+=n.offsetLeft-n.scrollLeft+n.clientLeft,i+=n.offsetTop-n.scrollTop+n.clientTop,n=n.offsetParent;return{x:t,y:i}}function Ig(e,t){return window.getComputedStyle(e).getPropertyValue(t)}function Dg(e){if(e.touches.length<2)return null;const t={x:e.touches[0].clientX,y:e.touches[0].clientY},i={x:e.touches[1].clientX,y:e.touches[1].clientY};return{distance:xg(t,i),angle:wg(t,i),center:{x:(t.x+i.x)/2,y:(t.y+i.y)/2}}}function Ng(e,t=!1){return t?e===tg:document.fullscreenElement===e}function Ug(e,t=!1){t?(tg=e,e.classList.add("psv-fullscreen-emulation"),document.dispatchEvent(new Event("fullscreenchange"))):e.requestFullscreen()}function Fg(e=!1){e?(tg.classList.remove("psv-fullscreen-emulation"),tg=null,document.dispatchEvent(new Event("fullscreenchange"))):document.exitFullscreen()}function zg(e){return e.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,((e,t)=>(t>0?"-":"")+e.toLowerCase()))}function kg(e,t){let i=!1;return function(...n){i||(i=!0,setTimeout((()=>{e.apply(this,n),i=!1}),t))}}function Hg(e){if("object"!=typeof e||null===e||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Bg(e,t){const i=t;return function e(t,n){return Array.isArray(n)?(t&&Array.isArray(t)?t.length=0:t=[],n.forEach(((i,n)=>{t[n]=e(null,i)}))):"object"==typeof n?(t&&!Array.isArray(t)||(t={}),Object.keys(n).forEach((r=>{"object"==typeof n[r]&&n[r]&&Hg(n[r])?n[r]!==i&&(t[r]?e(t[r],n[r]):t[r]=e(null,n[r])):t[r]=n[r]}))):t=n,t}(e,t)}function Vg(e){return Bg(null,e)}function jg(e){return!e||0===Object.keys(e).length&&e.constructor===Object}function Gg(e){return null==e}function Wg(...e){for(const t of e)if(!Gg(t))return t;return null}function Xg(e,t){if(e===t)return!0;if(qg(e)&&qg(t)){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i of Object.keys(e))if(!Xg(e[i],t[i]))return!1;return!0}return!1}function qg(e){return"object"==typeof e&&null!==e}eg(_g,{Animation:()=>yv,Dynamic:()=>bv,MultiDynamic:()=>xv,PressHandler:()=>wv,Slider:()=>Sv,SliderDirection:()=>Ev,addClasses:()=>Cg,angle:()=>wg,applyEulerInverse:()=>mv,checkStylesheet:()=>vv,checkVersion:()=>_v,cleanCssPosition:()=>lv,clone:()=>Vg,createTexture:()=>pv,cssPositionIsOrdered:()=>cv,dasherize:()=>zg,deepEqual:()=>Xg,deepmerge:()=>Bg,distance:()=>xg,exitFullscreen:()=>Fg,firstNonNull:()=>Wg,getAbortError:()=>Kg,getAngle:()=>Sg,getClosest:()=>Rg,getConfigParser:()=>gv,getElement:()=>Mg,getPosition:()=>Og,getShortestArc:()=>Eg,getStyleProperty:()=>Ig,getTouchData:()=>Dg,getXMPValue:()=>tv,greatArcDistance:()=>Tg,hasParent:()=>Pg,invertResolvableBoolean:()=>Zg,isAbortError:()=>Jg,isEmpty:()=>jg,isExtendedPosition:()=>ev,isFullscreenEnabled:()=>Ng,isNil:()=>Gg,isPlainObject:()=>Hg,logWarn:()=>Qg,parseAngle:()=>uv,parsePoint:()=>ov,parseSpeed:()=>hv,removeClasses:()=>Lg,requestFullscreen:()=>Ug,resolveBoolean:()=>$g,speedToDuration:()=>dv,sum:()=>bg,throttle:()=>kg,toggleClass:()=>Ag,wrap:()=>yg});var Yg=class e extends Error{constructor(t){super(t),this.name="PSVError",Error.captureStackTrace?.(this,e)}};function $g(e,t){Hg(e)?(t(e.initial,!0),e.promise.then((e=>t(e,!1)))):t(e,!0)}function Zg(e){return{initial:!e.initial,promise:e.promise.then((e=>!e))}}function Kg(){const e=new Error("Loading was aborted.");return e.name="AbortError",e}function Jg(e){return"AbortError"===e?.name}function Qg(e){console.warn(`PhotoSphereViewer: ${e}`)}function ev(e){return!!e&&[["textureX","textureY"],["yaw","pitch"]].some((([t,i])=>void 0!==e[t]&&void 0!==e[i]))}function tv(e,t){let i=e.match("<GPano:"+t+">(.*)</GPano:"+t+">");if(null!==i){const e=parseInt(i[1],10);return isNaN(e)?null:e}if(i=e.match("GPano:"+t+'="(.*?)"'),null!==i){const e=parseInt(i[1],10);return isNaN(e)?null:e}return null}var iv={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},nv=["left","center","right"],rv=["top","center","bottom"],sv=[...nv,...rv],av="center";function ov(e){if(!e)return{x:.5,y:.5};if("object"==typeof e)return e;let t=e.toLocaleLowerCase().split(" ").slice(0,2);1===t.length&&(t=iv[t[0]]?[t[0],av]:[t[0],t[0]]);const i="left"!==t[1]&&"right"!==t[1]&&"top"!==t[0]&&"bottom"!==t[0];t=t.map((e=>iv[e]||e)),i||t.reverse();const n=t.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return n?{x:parseFloat(n[1])/100,y:parseFloat(n[2])/100}:{x:.5,y:.5}}function lv(e,{allowCenter:t,cssOrder:i}={allowCenter:!0,cssOrder:!0}){return e?("string"==typeof e&&(e=e.split(" ")),1===e.length&&(e[0]===av?e=[av,av]:-1!==nv.indexOf(e[0])?e=[av,e[0]]:-1!==rv.indexOf(e[0])&&(e=[e[0],av])),2!==e.length||-1===sv.indexOf(e[0])||-1===sv.indexOf(e[1])?(Qg(`Unparsable position ${e}`),null):t||e[0]!==av||e[1]!==av?(i&&!cv(e)&&(e=[e[1],e[0]]),e[1]===av&&-1!==nv.indexOf(e[0])&&(e=[av,e[0]]),e[0]===av&&-1!==rv.indexOf(e[1])&&(e=[e[1],av]),e):(Qg("Invalid position center center"),null)):null}function cv(e){return-1!==rv.indexOf(e[0])&&-1!==nv.indexOf(e[1])}function hv(e){let t;if("string"==typeof e){const i=e.toString().trim();let n=parseFloat(i.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));const r=i.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(r.match(/(pm|per minute)$/)&&(n/=60),r){case"dpm":case"degrees per minute":case"dps":case"degrees per second":t=Hc.degToRad(n);break;case"rdpm":case"radians per minute":case"rdps":case"radians per second":t=n;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":t=n*Math.PI*2;break;default:throw new Yg(`Unknown speed unit "${r}"`)}}else t=e;return t}function dv(e,t){if("number"!=typeof e){const i=hv(e);return t/Math.abs(i)*1e3}return Math.abs(e)}function uv(e,t=!1,i=t){let n;if("string"==typeof e){const t=e.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!t)throw new Yg(`Unknown angle "${e}"`);const i=parseFloat(t[1]),r=t[2];if(r)switch(r){case"deg":case"degs":n=Hc.degToRad(i);break;case"rad":case"rads":n=i;break;default:throw new Yg(`Unknown angle unit "${r}"`)}else n=i}else{if("number"!=typeof e||isNaN(e))throw new Yg(`Unknown angle "${e}"`);n=e}return n=yg(t?n+Math.PI:n,2*Math.PI),t?Hc.clamp(n-Math.PI,-Math.PI/(i?2:1),Math.PI/(i?2:1)):n}function pv(e,t=!1){const i=new lh(e);return i.needsUpdate=!0,i.minFilter=t?jl:Bl,i.generateMipmaps=t,i.anisotropy=t?2:1,i}var fv=new fh;function mv(e,t){fv.setFromEuler(t).invert(),e.applyQuaternion(fv)}function gv(e,t){const i=function(i){if(!i)return Vg(e);const n=Vg({...e,...i}),r={};for(let[i,s]of Object.entries(n)){if(t&&i in t)s=t[i](s,{rawConfig:n,defValue:e[i]});else if(!(i in e)){Qg(`Unknown option ${i}`);continue}r[i]=s}return r};return i.defaults=e,i.parsers=t||{},i}function vv(e,t){"true"!==Ig(e,`--psv-${t}-loaded`)&&console.error(`PhotoSphereViewer: stylesheet "@photo-sphere-viewer/${t}/index.css" is not loaded`)}function _v(e,t,i){t&&t!==i&&console.error(`PhotoSphereViewer: @photo-sphere-viewer/${e} is in version ${t} but @photo-sphere-viewer/core is in version ${i}`)}var yv=class{constructor(e){this.easing=vg.linear,this.callbacks=[],this.resolved=!1,this.cancelled=!1,this.options=e,e?(e.easing&&(this.easing="function"==typeof e.easing?e.easing:vg[e.easing]||vg.linear),this.delayTimeout=setTimeout((()=>{this.delayTimeout=void 0,this.animationFrame=window.requestAnimationFrame((e=>this.__run(e)))}),e.delay||0)):this.resolved=!0}__run(e){if(this.cancelled)return;this.start||(this.start=e);const t=(e-this.start)/this.options.duration,i={};if(t<1){for(const[e,n]of Object.entries(this.options.properties))if(n){const r=n.start+(n.end-n.start)*this.easing(t);i[e]=r}this.options.onTick(i,t),this.animationFrame=window.requestAnimationFrame((e=>this.__run(e)))}else{for(const[e,t]of Object.entries(this.options.properties))t&&(i[e]=t.end);this.options.onTick(i,1),this.__resolve(!0),this.animationFrame=void 0}}__resolve(e){e?this.resolved=!0:this.cancelled=!0,this.callbacks.forEach((t=>t(e))),this.callbacks.length=0}then(e){return this.resolved||this.cancelled?Promise.resolve(this.resolved).then(e):new Promise((e=>{this.callbacks.push(e)})).then(e)}cancel(){this.cancelled||this.resolved||(this.__resolve(!1),this.delayTimeout&&(window.clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0))}},bv=class{constructor(e,t){if(this.fn=e,this.mode=0,this.speed=0,this.speedMult=0,this.currentSpeed=0,this.target=0,this.__current=0,this.min=t.min,this.max=t.max,this.wrap=t.wrap,this.current=t.defaultValue,this.wrap&&0!==this.min)throw new Yg("invalid config");this.fn&&this.fn(this.current)}get current(){return this.__current}set current(e){this.__current=e}setSpeed(e){this.speed=e}goto(e,t=1){this.mode=2,this.target=this.wrap?yg(e,this.max):Hc.clamp(e,this.min,this.max),this.speedMult=t}step(e,t=1){0===t?this.setValue(this.current+e):(2!==this.mode&&(this.target=this.current),this.goto(this.target+e,t))}roll(e=!1,t=1){this.mode=1,this.target=e?-1/0:1/0,this.speedMult=t}stop(){this.mode=0}setValue(e){return this.target=this.wrap?yg(e,this.max):Hc.clamp(e,this.min,this.max),this.mode=0,this.currentSpeed=0,this.target!==this.current&&(this.current=this.target,this.fn&&this.fn(this.current),!0)}update(e){if(2===this.mode){this.wrap&&Math.abs(this.target-this.current)>this.max/2&&(this.current=this.current<this.target?this.current+this.max:this.current-this.max);const e=this.currentSpeed*this.currentSpeed/(this.speed*this.speedMult*4);Math.abs(this.target-this.current)<=e&&(this.mode=0)}let t=0===this.mode?0:this.speed*this.speedMult;this.target<this.current&&(t=-t),this.currentSpeed<t?this.currentSpeed=Math.min(t,this.currentSpeed+e/1e3*this.speed*this.speedMult*2):this.currentSpeed>t&&(this.currentSpeed=Math.max(t,this.currentSpeed-e/1e3*this.speed*this.speedMult*2));let i=null;return this.current>this.target&&this.currentSpeed?i=Math.max(this.target,this.current+this.currentSpeed*e/1e3):this.current<this.target&&this.currentSpeed&&(i=Math.min(this.target,this.current+this.currentSpeed*e/1e3)),null!==i&&(i=this.wrap?yg(i,this.max):Hc.clamp(i,this.min,this.max),i!==this.current)&&(this.current=i,this.fn&&this.fn(this.current),!0)}},xv=class{constructor(e,t){this.fn=e,this.dynamics=t,this.fn&&this.fn(this.current)}get current(){return Object.entries(this.dynamics).reduce(((e,[t,i])=>(e[t]=i.current,e)),{})}setSpeed(e){for(const t of Object.values(this.dynamics))t.setSpeed(e)}goto(e,t=1){for(const[i,n]of Object.entries(e))this.dynamics[i].goto(n,t)}step(e,t=1){if(0===t)this.setValue(Object.keys(e).reduce(((t,i)=>(t[i]=e[i]+this.dynamics[i].current,t)),{}));else for(const[i,n]of Object.entries(e))this.dynamics[i].step(n,t)}roll(e,t=1){for(const[i,n]of Object.entries(e))this.dynamics[i].roll(n,t)}stop(){for(const e of Object.values(this.dynamics))e.stop()}setValue(e){let t=!1;for(const[i,n]of Object.entries(e))t=this.dynamics[i].setValue(n)||t;return t&&this.fn&&this.fn(this.current),t}update(e){let t=!1;for(const i of Object.values(this.dynamics))t=i.update(e)||t;return t&&this.fn&&this.fn(this.current),t}},wv=class{constructor(e=200){this.delay=e,this.time=0,this.delay=e}get pending(){return 0!==this.time}down(){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.time=(new Date).getTime()}up(e){this.time&&(Date.now()-this.time<this.delay?this.timeout=setTimeout((()=>{e(),this.timeout=void 0,this.time=0}),this.delay):(e(),this.time=0))}},Ev=(e=>(e.VERTICAL="VERTICAL",e.HORIZONTAL="HORIZONTAL",e))(Ev||{}),Sv=class{constructor(e,t,i){this.container=e,this.direction=t,this.listener=i,this.mousedown=!1,this.mouseover=!1,this.container.addEventListener("click",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("touchmove",this,!0),window.addEventListener("mouseup",this),window.addEventListener("touchend",this)}get isVertical(){return"VERTICAL"===this.direction}get isHorizontal(){return"HORIZONTAL"===this.direction}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this)}handleEvent(e){switch(e.type){case"click":e.stopPropagation();break;case"mousedown":this.__onMouseDown(e);break;case"mouseenter":this.__onMouseEnter(e);break;case"mouseleave":this.__onMouseLeave(e);break;case"touchstart":this.__onTouchStart(e);break;case"mousemove":this.__onMouseMove(e);break;case"touchmove":this.__onTouchMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchend":this.__onTouchEnd(e)}}__onMouseDown(e){this.mousedown=!0,this.__update(e.clientX,e.clientY,!0)}__onMouseEnter(e){this.mouseover=!0,this.__update(e.clientX,e.clientY,!0)}__onTouchStart(e){this.mouseover=!0,this.mousedown=!0;const t=e.changedTouches[0];this.__update(t.clientX,t.clientY,!0)}__onMouseMove(e){(this.mousedown||this.mouseover)&&(e.stopPropagation(),this.__update(e.clientX,e.clientY,!0))}__onTouchMove(e){if(this.mousedown||this.mouseover){e.stopPropagation();const t=e.changedTouches[0];this.__update(t.clientX,t.clientY,!0)}}__onMouseUp(e){this.mousedown&&(this.mousedown=!1,this.__update(e.clientX,e.clientY,!1))}__onMouseLeave(e){this.mouseover&&(this.mouseover=!1,this.__update(e.clientX,e.clientY,!0))}__onTouchEnd(e){if(this.mousedown){this.mouseover=!1,this.mousedown=!1;const t=e.changedTouches[0];this.__update(t.clientX,t.clientY,!1)}}__update(e,t,i){const n=this.container.getBoundingClientRect(),r=this.isVertical?t:e,s=n[this.isVertical?"bottom":"left"],a=n[this.isVertical?"height":"width"],o=Math.abs((s-r)/a);this.listener({value:o,click:!i,mousedown:this.mousedown,mouseover:this.mouseover,cursor:{clientX:e,clientY:t}})}},Tv={};eg(Tv,{BeforeAnimateEvent:()=>Pv,BeforeRenderEvent:()=>Ov,BeforeRotateEvent:()=>Dv,ClickEvent:()=>Uv,ConfigChangedEvent:()=>zv,DoubleClickEvent:()=>Hv,FullscreenEvent:()=>Vv,HideNotificationEvent:()=>Gv,HideOverlayEvent:()=>Xv,HidePanelEvent:()=>Yv,HideTooltipEvent:()=>Zv,KeypressEvent:()=>Jv,LoadProgressEvent:()=>e_,ObjectEnterEvent:()=>R_,ObjectEvent:()=>L_,ObjectHoverEvent:()=>N_,ObjectLeaveEvent:()=>I_,PanoramaErrorEvent:()=>a_,PanoramaLoadEvent:()=>i_,PanoramaLoadedEvent:()=>r_,PositionUpdatedEvent:()=>l_,ReadyEvent:()=>u_,RenderEvent:()=>f_,RollUpdatedEvent:()=>h_,ShowNotificationEvent:()=>g_,ShowOverlayEvent:()=>__,ShowPanelEvent:()=>b_,ShowTooltipEvent:()=>w_,SizeUpdatedEvent:()=>S_,StopAllEvent:()=>M_,ViewerEvent:()=>Cv,ZoomUpdatedEvent:()=>C_});var Mv=class extends Event{constructor(e,t=!1){super(e,{cancelable:t})}},Av=class extends EventTarget{dispatchEvent(e){return super.dispatchEvent(e)}addEventListener(e,t,i){super.addEventListener(e,t,i)}removeEventListener(e,t,i){super.removeEventListener(e,t,i)}},Cv=class extends Mv{},Lv=class e extends Cv{constructor(t,i){super(e.type,!0),this.position=t,this.zoomLevel=i}};Lv.type="before-animate";var Pv=Lv,Rv=class e extends Cv{constructor(t,i){super(e.type),this.timestamp=t,this.elapsed=i}};Rv.type="before-render";var Ov=Rv,Iv=class e extends Cv{constructor(t){super(e.type,!0),this.position=t}};Iv.type="before-rotate";var Dv=Iv,Nv=class e extends Cv{constructor(t){super(e.type),this.data=t}};Nv.type="click";var Uv=Nv,Fv=class e extends Cv{constructor(t){super(e.type),this.options=t}containsOptions(...e){return e.some((e=>this.options.includes(e)))}};Fv.type="config-changed";var zv=Fv,kv=class e extends Cv{constructor(t){super(e.type),this.data=t}};kv.type="dblclick";var Hv=kv,Bv=class e extends Cv{constructor(t){super(e.type),this.fullscreenEnabled=t}};Bv.type="fullscreen";var Vv=Bv,jv=class e extends Cv{constructor(t){super(e.type),this.notificationId=t}};jv.type="hide-notification";var Gv=jv,Wv=class e extends Cv{constructor(t){super(e.type),this.overlayId=t}};Wv.type="hide-overlay";var Xv=Wv,qv=class e extends Cv{constructor(t){super(e.type),this.panelId=t}};qv.type="hide-panel";var Yv=qv,$v=class e extends Cv{constructor(t){super(e.type),this.tooltipData=t}};$v.type="hide-tooltip";var Zv=$v,Kv=class e extends Cv{constructor(t){super(e.type,!0),this.key=t}};Kv.type="key-press";var Jv=Kv,Qv=class e extends Cv{constructor(t){super(e.type),this.progress=t}};Qv.type="load-progress";var e_=Qv,t_=class e extends Cv{constructor(t){super(e.type),this.panorama=t}};t_.type="panorama-load";var i_=t_,n_=class e extends Cv{constructor(t){super(e.type),this.data=t}};n_.type="panorama-loaded";var r_=n_,s_=class e extends Cv{constructor(t,i){super(e.type),this.panorama=t,this.error=i}};s_.type="panorama-error";var a_=s_,o_=class e extends Cv{constructor(t){super(e.type),this.position=t}};o_.type="position-updated";var l_=o_,c_=class e extends Cv{constructor(t){super(e.type),this.roll=t}};c_.type="roll-updated";var h_=c_,d_=class e extends Cv{constructor(){super(e.type)}};d_.type="ready";var u_=d_,p_=class e extends Cv{constructor(){super(e.type)}};p_.type="render";var f_=p_,m_=class e extends Cv{constructor(t){super(e.type),this.notificationId=t}};m_.type="show-notification";var g_=m_,v_=class e extends Cv{constructor(t){super(e.type),this.overlayId=t}};v_.type="show-overlay";var __=v_,y_=class e extends Cv{constructor(t){super(e.type),this.panelId=t}};y_.type="show-panel";var b_=y_,x_=class e extends Cv{constructor(t,i){super(e.type),this.tooltip=t,this.tooltipData=i}};x_.type="show-tooltip";var w_=x_,E_=class e extends Cv{constructor(t){super(e.type),this.size=t}};E_.type="size-updated";var S_=E_,T_=class e extends Cv{constructor(){super(e.type)}};T_.type="stop-all";var M_=T_,A_=class e extends Cv{constructor(t){super(e.type),this.zoomLevel=t}};A_.type="zoom-updated";var C_=A_,L_=class extends Cv{constructor(e,t,i,n,r){super(e),this.originalEvent=t,this.object=i,this.viewerPoint=n,this.userDataKey=r}},P_=class e extends L_{constructor(t,i,n,r){super(e.type,t,i,n,r)}};P_.type="enter-object";var R_=P_,O_=class e extends L_{constructor(t,i,n,r){super(e.type,t,i,n,r)}};O_.type="leave-object";var I_=O_,D_=class e extends L_{constructor(t,i,n,r){super(e.type,t,i,n,r)}};D_.type="hover-object";var N_=D_,U_=class{constructor(e){this.viewer=e}init(){}destroy(){}supportsTransition(e){return!1}supportsPreload(e){return!1}textureCoordsToSphericalCoords(e,t){throw new Yg("Current adapter does not support texture coordinates.")}sphericalCoordsToTextureCoords(e,t){throw new Yg("Current adapter does not support texture coordinates.")}};function F_(e){if(e)for(const[,t]of[["_",e],...Object.entries(e)])if(t.prototype instanceof U_)return _v(t.id,t.VERSION,"5.7.4"),t;return null}U_.supportsDownload=!1;var z_=`${dg}_touchSupport`,k_={loaded:!1,pixelRatio:1,isWebGLSupported:!1,maxTextureWidth:0,isTouchEnabled:null,__maxCanvasWidth:null,isIphone:!1,get maxCanvasWidth(){return null===this.__maxCanvasWidth&&(this.__maxCanvasWidth=function(e){let t=e,i=!1;for(;t>1024&&!i;){const e=document.createElement("canvas"),n=e.getContext("2d");e.width=t,e.height=t/2,n.fillStyle="white",n.fillRect(0,0,1,1);try{n.getImageData(0,0,1,1).data[0]>0&&(i=!0)}catch(e){}e.width=0,e.height=0,i||(t/=2)}if(i)return t;throw new Yg("Unable to detect system capabilities")}(this.maxTextureWidth)),this.__maxCanvasWidth},load(){if(!this.loaded){const e=function(){const e=document.createElement("canvas");let t=null;return e.getContext&&["webgl2","webgl","experimental-webgl"].some((i=>{try{return t=e.getContext(i),null!==t}catch(e){return!1}}))?t:null}();this.pixelRatio=window.devicePixelRatio||1,this.isWebGLSupported=null!==e,this.maxTextureWidth=e?e.getParameter(e.MAX_TEXTURE_SIZE):0,this.isTouchEnabled=function(){let e="ontouchstart"in window||navigator.maxTouchPoints>0;z_ in localStorage&&(e="true"===localStorage[z_]);const t=new Promise((t=>{const i=()=>{window.removeEventListener("mousedown",n),window.removeEventListener("touchstart",r),clearTimeout(s)},n=()=>{i(),localStorage[z_]=!1,t(!1)},r=()=>{i(),localStorage[z_]=!0,t(!0)};window.addEventListener("mousedown",n,!1),window.addEventListener("touchstart",r,!1);const s=setTimeout((()=>{i(),localStorage[z_]=e,t(e)}),1e4)}));return{initial:e,promise:t}}(),this.isIphone=/iPhone/i.test(navigator.userAgent),this.loaded=!0}if(!k_.isWebGLSupported)throw new Yg("WebGL is not supported.");if(0===k_.maxTextureWidth)throw new Yg("Unable to detect system capabilities")}},H_=URL.createObjectURL(new Blob(["(",function(){function e(e){return`rgb(${e.r}, ${e.g}, ${e.b})`}function t(e,t){return{r:Math.round(e.r/2+t.r/2),g:Math.round(e.g/2+t.g/2),b:Math.round(e.b/2+t.b/2)}}function i(t,i,n,r,s){const a=t.createLinearGradient(i,0,n,0);return a.addColorStop(0,e(r)),a.addColorStop(1,e(s)),a}function n(e,t,i,n,r,s){s=Math.round(s);let a=0,o=0,l=0,c=0;const h=e.getImageData(t,i,n,r);for(let e=0;e<r;e+=s)for(let t=0;t<n;t+=s){const i=4*(e*n+t);a+=h.data[i],o+=h.data[i+1],l+=h.data[i+2],c++}return a=Math.round(a/c),o=Math.round(o/c),l=Math.round(l/c),{r:a,g:o,b:l}}self.onmessage=r=>{const s=r.data.panoData,a=new OffscreenCanvas(s.fullWidth,s.fullHeight),o=a.getContext("2d",{willReadFrequently:!0}),l=new OffscreenCanvas(s.croppedWidth,s.croppedHeight);l.getContext("2d").putImageData(r.data.image,0,0),function(r,s,a){const o=a.fullHeight-a.croppedHeight-a.croppedY,l=a.fullWidth-a.croppedWidth-a.croppedX,c=a.croppedY+a.croppedHeight/2,h=r.width/32,d=h,u=10,p=`blur(${h}px)`,f=r.getContext("2d");if(f.drawImage(s,a.croppedX,a.croppedY,a.croppedWidth,a.croppedHeight),a.croppedY>0){if(a.croppedX>0||l>0){f.filter="none";const e=n(f,a.croppedX,a.croppedY,u,u,2),s=n(f,r.width-l-11,a.croppedY,u,u,2),o=t(e,s);a.croppedX>0&&(f.fillStyle=i(f,0,a.croppedX,o,e),f.fillRect(-d,-d,a.croppedX+2*d,c+d)),l>0&&(f.fillStyle=i(f,r.width-l,r.width,s,o),f.fillRect(r.width-l-d,-d,l+2*d,c+d))}f.filter=p,f.drawImage(s,0,0,s.width,u,a.croppedX,-d,a.croppedWidth,a.croppedY+2*d),f.fillStyle=e(n(f,0,0,r.width,u,u)),f.fillRect(-d,-d,r.width+2*d,2*d)}if(o>0){if(a.croppedX>0||l>0){f.filter="none";const e=n(f,a.croppedX,r.height-o-1-u,u,u,2),s=n(f,r.width-l-1-u,r.height-o-1-u,u,u,2),h=t(e,s);a.croppedX>0&&(f.fillStyle=i(f,0,a.croppedX,h,e),f.fillRect(-d,c,a.croppedX+2*d,r.height-c+d)),l>0&&(f.fillStyle=i(f,r.width-l,r.width,s,h),f.fillRect(r.width-l-d,c,l+2*d,r.height-c+d))}f.filter=p,f.drawImage(s,0,s.height-u,s.width,u,a.croppedX,r.height-o-d,a.croppedWidth,o+2*d),f.fillStyle=e(n(f,0,r.height-1-u,r.width,u,u)),f.fillRect(-d,r.height-d,r.width+2*d,2*d)}a.croppedX>0&&(f.filter=p,f.drawImage(s,s.width-u,0,u,s.height,-d,a.croppedY,2*d,a.croppedHeight),f.drawImage(s,0,0,u,s.height,0,a.croppedY,a.croppedX+d,a.croppedHeight)),l>0&&(f.filter=p,f.drawImage(s,0,0,u,s.height,r.width-d,a.croppedY,2*d,a.croppedHeight),f.drawImage(s,s.width-u,0,u,s.height,r.width-l-d,a.croppedY,l+d,a.croppedHeight)),f.filter="none",f.drawImage(s,a.croppedX,a.croppedY,a.croppedWidth,a.croppedHeight)}(a,l,s),postMessage(o.getImageData(0,0,a.width,a.height))}}.toString(),")()"],{type:"application/javascript"})),B_=gv({backgroundColor:"#000",interpolateBackground:!1,resolution:64,useXmpData:!0,blur:!1},{resolution:e=>{if(!e||!Hc.isPowerOfTwo(e))throw new Yg("EquirectangularAdapter resolution must be power of two");return e}}),V_=class extends U_{constructor(e,t){super(e),this.config=B_(t),this.config.interpolateBackground&&(window.Worker?this.interpolationWorker=new Worker(H_,{name:"photo-sphere-viewer-interpolation"}):(Qg("Web Worker API not available"),this.config.interpolateBackground=!1)),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2}supportsTransition(){return!0}supportsPreload(){return!0}destroy(){this.interpolationWorker?.terminate(),super.destroy()}textureCoordsToSphericalCoords(e,t){if(Gg(e.textureX)||Gg(e.textureY))throw new Yg("Texture position is missing 'textureX' or 'textureY'");const i=(e.textureX+t.croppedX)/t.fullWidth*Math.PI*2,n=(e.textureY+t.croppedY)/t.fullHeight*Math.PI;return{yaw:i>=Math.PI?i-Math.PI:i+Math.PI,pitch:Math.PI/2-n}}sphericalCoordsToTextureCoords(e,t){const i=e.yaw/Math.PI/2*t.fullWidth,n=e.pitch/Math.PI*t.fullHeight;return{textureX:Math.round(e.yaw<Math.PI?i+t.fullWidth/2:i-t.fullWidth/2)-t.croppedX,textureY:Math.round(t.fullHeight/2-n)-t.croppedY}}async loadTexture(e,t=!0,i,n=this.config.useXmpData){if("string"!=typeof e)return Promise.reject(new Yg("Invalid panorama url, are you using the right adapter?"));const r=await this.viewer.textureLoader.loadFile(e,t?e=>this.viewer.loader.setProgress(e):null,e),s=n?await this.loadXMP(r):null,a=await this.viewer.textureLoader.blobToImage(r);"function"==typeof i&&(i=i(a,s)),i||s||(i=this.__defaultPanoData(a));const o={isEquirectangular:!0,fullWidth:Wg(i?.fullWidth,s?.fullWidth,a.width),fullHeight:Wg(i?.fullHeight,s?.fullHeight,a.height),croppedWidth:Wg(i?.croppedWidth,s?.croppedWidth,a.width),croppedHeight:Wg(i?.croppedHeight,s?.croppedHeight,a.height),croppedX:Wg(i?.croppedX,s?.croppedX,0),croppedY:Wg(i?.croppedY,s?.croppedY,0),poseHeading:Wg(i?.poseHeading,s?.poseHeading,0),posePitch:Wg(i?.posePitch,s?.posePitch,0),poseRoll:Wg(i?.poseRoll,s?.poseRoll,0)};return o.croppedWidth===a.width&&o.croppedHeight===a.height||Qg(`Invalid panoData, croppedWidth/croppedHeight is not coherent with the loaded image.\n            panoData: ${o.croppedWidth}x${o.croppedHeight}, image: ${a.width}x${a.height}`),Math.abs(o.fullWidth-2*o.fullHeight)>1&&(Qg("Invalid panoData, fullWidth should be twice fullHeight"),o.fullWidth=2*o.fullHeight),o.croppedX+o.croppedWidth>o.fullWidth&&(Qg("Invalid panoData, croppedX + croppedWidth > fullWidth"),o.croppedX=o.fullWidth-o.croppedWidth),o.croppedY+o.croppedHeight>o.fullHeight&&(Qg("Invalid panoData, croppedY + croppedHeight > fullHeight"),o.croppedY=o.fullHeight-o.croppedHeight),{panorama:e,texture:this.createEquirectangularTexture(a,o),panoData:o,cacheKey:e}}async loadXMP(e){const t=await this.loadBlobAsString(e),i=t.indexOf("<x:xmpmeta"),n=t.indexOf("</x:xmpmeta>"),r=t.substring(i,n);return-1!==i&&-1!==n&&r.includes("GPano:")?{isEquirectangular:!0,fullWidth:tv(r,"FullPanoWidthPixels"),fullHeight:tv(r,"FullPanoHeightPixels"),croppedWidth:tv(r,"CroppedAreaImageWidthPixels"),croppedHeight:tv(r,"CroppedAreaImageHeightPixels"),croppedX:tv(r,"CroppedAreaLeftPixels"),croppedY:tv(r,"CroppedAreaTopPixels"),poseHeading:tv(r,"PoseHeadingDegrees"),posePitch:tv(r,"PosePitchDegrees"),poseRoll:tv(r,"PoseRollDegrees")}:null}loadBlobAsString(e){return new Promise(((t,i)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=i,n.readAsText(e)}))}createEquirectangularTexture(e,t){if(this.config.blur||t.fullWidth>k_.maxTextureWidth||t.croppedWidth!==t.fullWidth||t.croppedHeight!==t.fullHeight){const i=Math.min(1,k_.maxCanvasWidth/t.fullWidth),n={fullWidth:t.fullWidth*i,fullHeight:t.fullHeight*i,croppedWidth:t.croppedWidth*i,croppedHeight:t.croppedHeight*i,croppedX:t.croppedX*i,croppedY:t.croppedY*i},r=document.createElement("canvas");r.width=n.fullWidth,r.height=n.fullHeight;const s=r.getContext("2d");if(this.config.backgroundColor&&(s.fillStyle=this.config.backgroundColor,s.fillRect(0,0,r.width,r.height)),this.config.blur){const t=r.width/2048,a=Math.ceil(2*t);n.croppedWidth===r.width&&(s.drawImage(e,0,0,a/i,e.height,0,n.croppedY,a,n.croppedHeight),s.drawImage(e,e.width-a/i,0,a/i,e.height,r.width-a,n.croppedY,a,n.croppedHeight)),n.croppedHeight===r.height&&(s.drawImage(e,0,0,1,1,n.croppedX,0,n.croppedWidth,a),s.drawImage(e,0,e.height-1,1,1,n.croppedX,r.height-a,n.croppedWidth,a)),s.filter=`blur(${t}px)`}s.drawImage(e,n.croppedX,n.croppedY,n.croppedWidth,n.croppedHeight);const a=pv(r);return this.config.interpolateBackground&&n.fullWidth<=8096&&(t.croppedWidth!==t.fullWidth||t.croppedHeight!==t.fullHeight)&&(this.interpolationWorker.postMessage({image:s.getImageData(n.croppedX,n.croppedY,n.croppedWidth,n.croppedHeight),panoData:n}),this.interpolationWorker.onmessage=e=>{s.putImageData(e.data,0,0),a.needsUpdate=!0,this.viewer.needsUpdate()}),a}return pv(e)}createMesh(e=1){const t=new Am(hg*e,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS,-Math.PI/2).scale(-1,1,1);return new fu(t,new Ud)}setTexture(e,t){e.material.map=t.texture}setTextureOpacity(e,t){e.material.opacity=t,e.material.transparent=t<1}disposeTexture(e){e.texture?.dispose()}__defaultPanoData(e){const t=Math.max(e.width,2*e.height),i=Math.round(t/2),n=Math.round((t-e.width)/2),r=Math.round((i-e.height)/2);return{isEquirectangular:!0,fullWidth:t,fullHeight:i,croppedWidth:e.width,croppedHeight:e.height,croppedX:n,croppedY:r}}};V_.id="equirectangular",V_.VERSION="5.7.4",V_.supportsDownload=!0;var j_=class e{constructor(t,i){this.parent=t,this.children=[],this.container=document.createElement("div"),this.state={visible:!0},this.viewer=t instanceof e?t.viewer:t,this.container.className=i.className||"",this.parent.children.push(this),this.parent.container.appendChild(this.container)}destroy(){this.parent.container.removeChild(this.container);const e=this.parent.children.indexOf(this);-1!==e&&this.parent.children.splice(e,1),this.children.slice().forEach((e=>e.destroy())),this.children.length=0}toggle(e=!this.isVisible()){e?this.show():this.hide()}hide(e){this.container.style.display="none",this.state.visible=!1}show(e){this.container.style.display="",this.state.visible=!0}isVisible(){return this.state.visible}},G_=gv({id:null,className:null,title:null,hoverScale:!1,collapsable:!1,tabbable:!0,icon:null,iconActive:null}),W_=class extends j_{constructor(e,t){super(e,{className:`psv-button ${t.hoverScale?"psv-button--hover-scale":""} ${t.className||""}`}),this.state={visible:!0,enabled:!0,supported:!0,collapsed:!1,active:!1,width:0},this.config=G_(t),this.config.id=this.constructor.id,t.icon&&this.__setIcon(t.icon),this.state.width=this.container.offsetWidth,this.config.title?this.container.title=this.config.title:this.id&&this.id in this.viewer.config.lang&&(this.container.title=this.viewer.config.lang[this.id]),t.tabbable&&(this.container.tabIndex=0),this.container.addEventListener("click",(e=>{this.state.enabled&&this.onClick(),e.stopPropagation()})),this.container.addEventListener("keydown",(e=>{e.key===mg.Enter&&this.state.enabled&&(this.onClick(),e.stopPropagation())}))}get id(){return this.config.id}get title(){return this.container.title}get content(){return this.container.innerHTML}get width(){return this.state.width}get collapsable(){return this.config.collapsable}show(e=!0){this.isVisible()||(this.state.visible=!0,this.state.collapsed||(this.container.style.display=""),e&&this.viewer.navbar.autoSize())}hide(e=!0){this.isVisible()&&(this.state.visible=!1,this.container.style.display="none",e&&this.viewer.navbar.autoSize())}checkSupported(){$g(this.isSupported(),((e,t)=>{this.state&&(this.state.supported=e,t?e||this.hide():this.toggle(e))}))}autoSize(){}isSupported(){return!0}toggleActive(e=!this.state.active){e!==this.state.active&&(this.state.active=e,Ag(this.container,"psv-button--active",this.state.active),this.config.iconActive&&this.__setIcon(this.state.active?this.config.iconActive:this.config.icon))}disable(){this.container.classList.add("psv-button--disabled"),this.state.enabled=!1}enable(){this.container.classList.remove("psv-button--disabled"),this.state.enabled=!0}collapse(){this.state.collapsed=!0,this.container.style.display="none"}uncollapse(){this.state.collapsed=!1,this.state.visible&&(this.container.style.display="")}__setIcon(e){this.container.innerHTML=e,Cg(this.container.querySelector("svg"),"psv-button-svg")}},X_=class extends W_{constructor(e,t){super(e,{className:`psv-custom-button ${t.className||""}`,hoverScale:!1,collapsable:!1!==t.collapsable,tabbable:!1!==t.tabbable,title:t.title}),this.customOnClick=t.onClick,t.id?this.config.id=t.id:this.config.id="psvButton-"+Math.random().toString(36).substring(2),t.content&&("string"==typeof t.content?this.container.innerHTML=t.content:(this.container.classList.add("psv-custom-button--no-padding"),t.content.style.height="100%",t.content.attachViewer?.(this.viewer),this.container.appendChild(t.content))),this.state.width=this.container.offsetWidth,t.disabled&&this.disable(),!1===t.visible&&this.hide()}onClick(){this.customOnClick?.(this.viewer)}},q_=class extends W_{constructor(e){super(e,{className:"psv-description-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:gg.info}),this.mode=0,this.viewer.addEventListener(Gv.type,this),this.viewer.addEventListener(g_.type,this),this.viewer.addEventListener(Yv.type,this),this.viewer.addEventListener(b_.type,this),this.viewer.addEventListener(zv.type,this)}destroy(){this.viewer.removeEventListener(Gv.type,this),this.viewer.removeEventListener(g_.type,this),this.viewer.removeEventListener(Yv.type,this),this.viewer.removeEventListener(b_.type,this),this.viewer.removeEventListener(zv.type,this),super.destroy()}handleEvent(e){if(e instanceof zv)return void(e.containsOptions("description")&&this.autoSize(!0));if(!this.mode)return;let t=!1;e instanceof Gv?t=1===this.mode:e instanceof g_?t=1===this.mode&&e.notificationId!==fg.DESCRIPTION:e instanceof Yv?t=2===this.mode:e instanceof b_&&(t=2===this.mode&&e.panelId!==fg.DESCRIPTION),t&&(this.toggleActive(!1),this.mode=0)}onClick(){this.mode?this.__close():this.__open()}hide(e){super.hide(e),this.mode&&this.__close()}autoSize(e=!1){if(e){const e=this.viewer.navbar.getButton("caption",!1),t=e&&!e.isVisible(),i=!!this.viewer.config.description;t||i?this.show(!1):this.hide(!1)}}__close(){switch(this.mode){case 1:this.viewer.notification.hide(fg.DESCRIPTION);break;case 2:this.viewer.panel.hide(fg.DESCRIPTION)}}__open(){this.toggleActive(!0),this.viewer.config.description?(this.mode=2,this.viewer.panel.show({id:fg.DESCRIPTION,content:(this.viewer.config.caption?`<p>${this.viewer.config.caption}</p>`:"")+this.viewer.config.description})):(this.mode=1,this.viewer.notification.show({id:fg.DESCRIPTION,content:this.viewer.config.caption}))}};q_.id="description";var Y_=class extends W_{constructor(e){super(e,{className:"psv-download-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:gg.download}),this.viewer.addEventListener(zv.type,this)}destroy(){this.viewer.removeEventListener(zv.type,this),super.destroy()}handleEvent(e){e instanceof zv&&e.containsOptions("downloadUrl")&&this.checkSupported()}onClick(){const e=document.createElement("a");e.href=this.viewer.config.downloadUrl||this.viewer.config.panorama,e.href.startsWith("data:")&&!this.viewer.config.downloadName?e.download="panorama."+e.href.substring(0,e.href.indexOf(";")).split("/").pop():e.download=this.viewer.config.downloadName||e.href.split("/").pop(),e.target="_blank",this.viewer.container.appendChild(e),e.click(),setTimeout((()=>{this.viewer.container.removeChild(e)}),100)}checkSupported(){this.viewer.adapter.constructor.supportsDownload||this.viewer.config.downloadUrl?this.show():this.hide()}};Y_.id="download";var $_=class extends W_{constructor(e){super(e,{className:"psv-fullscreen-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:gg.fullscreenIn,iconActive:gg.fullscreenOut}),this.viewer.addEventListener(Vv.type,this)}destroy(){this.viewer.removeEventListener(Vv.type,this),super.destroy()}handleEvent(e){e instanceof Vv&&this.toggleActive(e.fullscreenEnabled)}onClick(){this.viewer.toggleFullscreen()}};$_.id="fullscreen";var Z_=class extends W_{constructor(e){super(e,{className:"psv-menu-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:gg.menu}),this.viewer.addEventListener(b_.type,this),this.viewer.addEventListener(Yv.type,this),super.hide()}destroy(){this.viewer.removeEventListener(b_.type,this),this.viewer.removeEventListener(Yv.type,this),super.destroy()}handleEvent(e){e instanceof b_?this.toggleActive(e.panelId===fg.MENU):e instanceof Yv&&this.toggleActive(!1)}onClick(){this.state.active?this.__hideMenu():this.__showMenu()}hide(e){super.hide(e),this.__hideMenu()}show(e){super.show(e),this.state.active&&this.__showMenu()}__showMenu(){var e,t;this.viewer.panel.show({id:fg.MENU,content:(e=this.viewer.navbar.collapsed,t=this.viewer.config.lang.menu,`\n<div class="psv-panel-menu psv-panel-menu--stripped">\n  <h1 class="psv-panel-menu-title">${gg.menu} ${t}</h1>\n  <ul class="psv-panel-menu-list">\n    ${e.map((e=>`\n    <li data-psv-button="${e.id}" class="psv-panel-menu-item" tabindex="0">\n      <span class="psv-panel-menu-item-icon">${e.content}</span>\n      <span class="psv-panel-menu-item-label">${e.title}</span>\n    </li>\n    `)).join("")}\n  </ul>\n</div>\n`),noMargin:!0,clickHandler:e=>{const t=e?Rg(e,"li"):void 0,i=t?t.dataset.psvButton:void 0;i&&(this.viewer.navbar.getButton(i).onClick(),this.__hideMenu())}})}__hideMenu(){this.viewer.panel.hide(fg.MENU)}};function K_(e){let t=0;switch(e){case 0:t=90;break;case 1:t=-90;break;case 3:t=180;break;default:t=0}return gg.arrow.replace("rotate(0",`rotate(${t}`)}Z_.id="menu";var J_=class extends W_{constructor(e,t){super(e,{className:"psv-move-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:K_(t)}),this.direction=t,this.handler=new wv,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(e){switch(e.type){case"mousedown":this.__onMouseDown();break;case"mouseup":case"touchend":this.__onMouseUp();break;case"keydown":e.key===mg.Enter&&this.__onMouseDown();break;case"keyup":e.key===mg.Enter&&this.__onMouseUp()}}onClick(){}isSupported(){return Zg(k_.isTouchEnabled)}__onMouseDown(){if(!this.state.enabled)return;const e={};switch(this.direction){case 0:e.pitch=!1;break;case 1:e.pitch=!0;break;case 3:e.yaw=!1;break;default:e.yaw=!0}this.viewer.stopAll(),this.viewer.dynamics.position.roll(e),this.handler.down()}__onMouseUp(){this.state.enabled&&this.handler.up((()=>{this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer()}))}};J_.groupId="move";var Q_=class extends J_{constructor(e){super(e,1)}};Q_.id="moveDown";var ey=class extends J_{constructor(e){super(e,2)}};ey.id="moveLeft";var ty=class extends J_{constructor(e){super(e,3)}};ty.id="moveRight";var iy=class extends J_{constructor(e){super(e,0)}};iy.id="moveUp";var ny=class extends W_{constructor(e,t,i){super(e,{className:"psv-zoom-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:t}),this.direction=i,this.handler=new wv,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(e){switch(e.type){case"mousedown":this.__onMouseDown();break;case"mouseup":case"touchend":this.__onMouseUp();break;case"keydown":e.key===mg.Enter&&this.__onMouseDown();break;case"keyup":e.key===mg.Enter&&this.__onMouseUp()}}onClick(){}isSupported(){return Zg(k_.isTouchEnabled)}__onMouseDown(){this.state.enabled&&(this.viewer.dynamics.zoom.roll(1===this.direction),this.handler.down())}__onMouseUp(){this.state.enabled&&this.handler.up((()=>this.viewer.dynamics.zoom.stop()))}};ny.groupId="zoom";var ry=class extends ny{constructor(e){super(e,gg.zoomIn,0)}};ry.id="zoomIn";var sy=class extends ny{constructor(e){super(e,gg.zoomOut,1)}};sy.id="zoomOut";var ay=class extends W_{constructor(e){super(e,{className:"psv-zoom-range",hoverScale:!1,collapsable:!1,tabbable:!1}),this.zoomRange=document.createElement("div"),this.zoomRange.className="psv-zoom-range-line",this.container.appendChild(this.zoomRange),this.zoomValue=document.createElement("div"),this.zoomValue.className="psv-zoom-range-handle",this.zoomRange.appendChild(this.zoomValue),this.slider=new Sv(this.container,"HORIZONTAL",(e=>this.__onSliderUpdate(e))),this.mediaMinWidth=parseInt(Ig(this.container,"max-width"),10),this.viewer.addEventListener(C_.type,this),this.viewer.state.ready?this.__moveZoomValue(this.viewer.getZoomLevel()):this.viewer.addEventListener(u_.type,this)}destroy(){this.slider.destroy(),this.viewer.removeEventListener(C_.type,this),this.viewer.removeEventListener(u_.type,this),super.destroy()}handleEvent(e){e instanceof C_?this.__moveZoomValue(e.zoomLevel):e instanceof u_&&this.__moveZoomValue(this.viewer.getZoomLevel())}onClick(){}isSupported(){return Zg(k_.isTouchEnabled)}autoSize(){this.state.supported&&(this.viewer.state.size.width<=this.mediaMinWidth&&this.state.visible?this.hide(!1):this.viewer.state.size.width>this.mediaMinWidth&&!this.state.visible&&this.show(!1))}__moveZoomValue(e){this.zoomValue.style.left=e/100*this.zoomRange.offsetWidth-this.zoomValue.offsetWidth/2+"px"}__onSliderUpdate(e){e.mousedown&&this.viewer.zoom(100*e.value)}};ay.id="zoomRange",ay.groupId="zoom";var oy=class extends Av{constructor(e){super(),this.viewer=e}init(){}destroy(){}},ly=class extends oy{constructor(e,t){super(e),this.config=this.constructor.configParser(t)}setOption(e,t){this.setOptions({[e]:t})}setOptions(e){const t={...this.config,...e},i=this.constructor,n=i.configParser,r=i.readonlyOptions,s=i.id;for(let[i,a]of Object.entries(e))i in n.defaults?r.includes(i)?Qg(`${s}: Option "${i}" cannot be updated`):(i in n.parsers&&(a=n.parsers[i](a,{rawConfig:t,defValue:n.defaults[i]})),this.config[i]=a):Qg(`${s}: Unknown option "${i}"`)}};function cy(e){if(e)for(const[,t]of[["_",e],...Object.entries(e)])if(t.prototype instanceof oy)return _v(t.id,t.VERSION,"5.7.4"),t;return null}ly.readonlyOptions=[];var hy={panorama:null,container:null,adapter:[V_,null],plugins:[],caption:null,description:null,downloadUrl:null,downloadName:null,loadingImg:null,loadingTxt:"",size:null,fisheye:0,minFov:30,maxFov:90,defaultZoomLvl:50,defaultYaw:0,defaultPitch:0,sphereCorrection:null,moveSpeed:1,zoomSpeed:1,moveInertia:!0,mousewheel:!0,mousemove:!0,mousewheelCtrlKey:!1,touchmoveTwoFingers:!1,panoData:null,requestHeaders:null,rendererParameters:{alpha:!0,antialias:!0},withCredentials:!1,navbar:["zoom","move","download","description","caption","fullscreen"],lang:{zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",moveUp:"Move up",moveDown:"Move down",moveLeft:"Move left",moveRight:"Move right",description:"Description",download:"Download",fullscreen:"Fullscreen",loading:"Loading...",menu:"Menu",close:"Close",twoFingers:"Use two fingers to navigate",ctrlZoom:"Use ctrl + scroll to zoom the image",loadError:"The panorama cannot be loaded",webglError:"Your browser does not seem to support WebGL"},keyboard:"fullscreen",keyboardActions:{[mg.ArrowUp]:"ROTATE_UP",[mg.ArrowDown]:"ROTATE_DOWN",[mg.ArrowRight]:"ROTATE_RIGHT",[mg.ArrowLeft]:"ROTATE_LEFT",[mg.PageUp]:"ZOOM_IN",[mg.PageDown]:"ZOOM_OUT",[mg.Plus]:"ZOOM_IN",[mg.Minus]:"ZOOM_OUT"}},dy={panorama:"Use setPanorama method to change the panorama",panoData:"Use setPanorama method to change the panorama",container:"Cannot change viewer container",adapter:"Cannot change adapter",plugins:"Cannot change plugins"},uy={container:e=>{if(!e)throw new Yg("No value given for container.");return e},adapter:(e,{defValue:t})=>{if(!(e=e?Array.isArray(e)?[F_(e[0]),e[1]]:[F_(e),null]:t)[0])throw new Yg("An undefined value was given for adapter.");if(!e[0].id)throw new Yg("Adapter has no id.");return e},defaultYaw:e=>uv(e),defaultPitch:e=>uv(e,!0),defaultZoomLvl:e=>Hc.clamp(e,0,100),minFov:(e,{rawConfig:t})=>(t.maxFov<e&&(Qg("maxFov cannot be lower than minFov"),e=t.maxFov),Hc.clamp(e,1,179)),maxFov:(e,{rawConfig:t})=>(e<t.minFov&&(e=t.minFov),Hc.clamp(e,1,179)),lang:e=>({...hy.lang,...e}),keyboard:e=>!!e&&("object"==typeof e?(Qg("Use keyboardActions to configure the keyboard actions, keyboard option must be either true, false, 'fullscreen' or 'always'"),"fullscreen"):"always"===e?"always":"fullscreen"),keyboardActions:(e,{rawConfig:t})=>t.keyboard&&"object"==typeof t.keyboard?t.keyboard:e,fisheye:e=>!0===e?1:!1===e?0:e,requestHeaders:e=>e&&"object"==typeof e?()=>e:"function"==typeof e?e:null,rendererParameters:(e,{defValue:t})=>({...e,...t}),plugins:e=>e.map(((e,t)=>{if(!(e=Array.isArray(e)?[cy(e[0]),e[1]]:[cy(e),null])[0])throw new Yg(`An undefined value was given for plugin ${t}.`);if(!e[0].id)throw new Yg(`Plugin ${t} has no id.`);return e})),navbar:e=>!1===e?null:!0===e?Vg(hy.navbar):"string"==typeof e?e.split(/[ ,]/):e},py=gv(hy,uy),fy=class extends W_{constructor(e){super(e,{className:"psv-caption",hoverScale:!1,collapsable:!1,tabbable:!0}),this.contentWidth=0,this.state.width=0,this.contentElt=document.createElement("div"),this.contentElt.className="psv-caption-content",this.container.appendChild(this.contentElt),this.setCaption(this.viewer.config.caption)}hide(){this.contentElt.style.display="none",this.state.visible=!1}show(){this.contentElt.style.display="",this.state.visible=!0}onClick(){}setCaption(e){this.show(),this.contentElt.innerHTML=e??"",this.contentElt.innerHTML?this.contentWidth=this.contentElt.offsetWidth:this.contentWidth=0,this.autoSize()}autoSize(){this.toggle(this.container.offsetWidth>=this.contentWidth),this.__refreshButton()}__refreshButton(){this.viewer.navbar.getButton(q_.id,!1)?.autoSize(!0)}};fy.id="caption";var my={},gy={};function vy(e,t){if(!e.id)throw new Yg("Button id is required");if(my[e.id]=e,e.groupId&&(gy[e.groupId]=gy[e.groupId]||[]).push(e),t){const i=hy.navbar;switch(t){case"start":i.unshift(e.id);break;case"end":i.push(e.id);break;default:{const[n,r]=t.split(":"),s=i.indexOf(n);if(!n||!r||-1===s)throw new Yg(`Invalid defaultPosition ${t}`);i.splice(s+("right"===r?1:0),0,e.id)}}}}[sy,ay,ry,q_,fy,Y_,$_,ey,ty,iy,Q_].forEach((e=>vy(e)));var _y=class extends j_{constructor(e){super(e,{className:`psv-navbar ${ug}`}),this.collapsed=[],this.state.visible=!1}show(){this.viewer.container.classList.add("psv--has-navbar"),this.container.classList.add("psv-navbar--open"),this.state.visible=!0}hide(){this.viewer.container.classList.remove("psv--has-navbar"),this.container.classList.remove("psv-navbar--open"),this.state.visible=!1}setButtons(e){this.children.slice().forEach((e=>e.destroy())),this.children.length=0,-1!==e.indexOf(fy.id)&&-1===e.indexOf(q_.id)&&e.splice(e.indexOf(fy.id),0,q_.id),e.forEach((e=>{"object"==typeof e?new X_(this,e):my[e]?new my[e](this):gy[e]?gy[e].forEach((e=>{new e(this)})):Qg(`Unknown button ${e}`)})),new Z_(this),this.children.forEach((e=>{e instanceof W_&&e.checkSupported()})),this.autoSize()}setCaption(e){this.children.some((t=>t instanceof fy&&(t.setCaption(e),!0)))}getButton(e,t=!0){const i=this.children.find((t=>t instanceof W_&&t.id===e));return!i&&t&&Qg(`button "${e}" not found in the navbar`),i}autoSize(){this.children.forEach((e=>{e instanceof W_&&e.autoSize()}));const e=this.container.offsetWidth;let t=0;const i=[];this.children.forEach((e=>{e.isVisible()&&e instanceof W_&&(t+=e.width,e.collapsable&&i.push(e))})),0!==t&&(e<t&&i.length>0?(i.forEach((e=>e.collapse())),this.collapsed=i,this.getButton(Z_.id).show(!1)):e>=t&&this.collapsed.length>0&&(this.collapsed.forEach((e=>e.uncollapse())),this.collapsed=[],this.getButton(Z_.id).hide(!1)),this.getButton(fy.id,!1)?.autoSize())}};zm.enabled=!1;var yy={enabled:!0,maxItems:10,ttl:600,items:{},purgeInterval:null,init(){zm.enabled&&(Qg("ThreeJS cache should be disabled"),zm.enabled=!1),!this.purgeInterval&&this.enabled&&(this.purgeInterval=setInterval((()=>this.purge()),6e4))},add(e,t,i){this.enabled&&t&&(this.items[t]=this.items[t]??{files:{},lastAccess:null},this.items[t].files[e]=i,this.items[t].lastAccess=Date.now())},get(e,t){if(this.enabled&&t&&this.items[t])return this.items[t].lastAccess=Date.now(),this.items[t].files[e]},remove(e,t){this.enabled&&t&&this.items[t]&&(delete this.items[t].files[e],0===Object.keys(this.items[t].files).length&&delete this.items[t])},purge(){Object.entries(this.items).sort((([,e],[,t])=>t.lastAccess-e.lastAccess)).forEach((([e,{lastAccess:t}],i)=>{i>0&&(Date.now()-t>=1e3*this.ttl||i>=this.maxItems)&&delete this.items[e]}))}},by=class extends j_{constructor(e){super(e,{className:"psv-loader-container"}),this.loader=document.createElement("div"),this.loader.className="psv-loader",this.container.appendChild(this.loader),this.size=this.loader.offsetWidth,this.canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.canvas.setAttribute("class","psv-loader-canvas"),this.canvas.setAttribute("viewBox",`0 0 ${this.size} ${this.size}`),this.loader.appendChild(this.canvas),this.textColor=Ig(this.loader,"color"),this.color=Ig(this.canvas,"color"),this.border=parseInt(Ig(this.loader,"--psv-loader-border"),10),this.thickness=parseInt(Ig(this.loader,"--psv-loader-tickness"),10),this.viewer.addEventListener(zv.type,this),this.__updateContent(),this.hide()}destroy(){this.viewer.removeEventListener(zv.type,this),super.destroy()}handleEvent(e){e instanceof zv&&e.containsOptions("loadingImg","loadingTxt")&&this.__updateContent()}setProgress(e){const t=Math.min(e,99.999)/100*Math.PI*2,i=this.size/2,n=i,r=this.thickness/2+this.border,s=(this.size-this.thickness)/2-this.border,a=Math.sin(t)*s+i,o=-Math.cos(t)*s+i,l=e>50?"1":"0";this.canvas.innerHTML=`\n            <circle cx="${i}" cy="${i}" r="${i}" fill="${this.color}"/>\n            <path d="M ${n} ${r} A ${s} ${s} 0 ${l} 1 ${a} ${o}" \n                  fill="none" stroke="${this.textColor}" stroke-width="${this.thickness}" stroke-linecap="round"/>\n        `,this.viewer.dispatchEvent(new e_(Math.round(e)))}__updateContent(){const e=this.loader.querySelector(".psv-loader-image, .psv-loader-text");let t;if(e&&this.loader.removeChild(e),this.viewer.config.loadingImg?(t=document.createElement("img"),t.className="psv-loader-image",t.src=this.viewer.config.loadingImg):null!==this.viewer.config.loadingTxt&&(t=document.createElement("div"),t.className="psv-loader-text",t.innerHTML=this.viewer.config.loadingTxt||this.viewer.config.lang.loading),t){const e=Math.round(Math.sqrt(2*Math.pow(this.size/2-this.thickness/2-this.border,2)));t.style.maxWidth=e+"px",t.style.maxHeight=e+"px",this.loader.appendChild(t)}}},xy=class extends j_{constructor(e){super(e,{className:"psv-notification"}),this.state={visible:!1,contentId:null,timeout:null},this.content=document.createElement("div"),this.content.className="psv-notification-content",this.container.appendChild(this.content),this.content.addEventListener("click",(()=>this.hide()))}isVisible(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}toggle(){throw new Yg("Notification cannot be toggled")}show(e){this.state.timeout&&(clearTimeout(this.state.timeout),this.state.timeout=null),"string"==typeof e&&(e={content:e}),this.state.contentId=e.id||null,this.content.innerHTML=e.content,this.container.classList.add("psv-notification--visible"),this.state.visible=!0,this.viewer.dispatchEvent(new g_(e.id)),e.timeout&&(this.state.timeout=setTimeout((()=>this.hide(this.state.contentId)),e.timeout))}hide(e){if(this.isVisible(e)){const e=this.state.contentId;this.container.classList.remove("psv-notification--visible"),this.state.visible=!1,this.state.contentId=null,this.viewer.dispatchEvent(new Gv(e))}}},wy=class extends j_{constructor(e){super(e,{className:`psv-overlay ${ug}`}),this.state={visible:!1,contentId:null,dissmisable:!0},this.image=document.createElement("div"),this.image.className="psv-overlay-image",this.container.appendChild(this.image),this.title=document.createElement("div"),this.title.className="psv-overlay-title",this.container.appendChild(this.title),this.text=document.createElement("div"),this.text.className="psv-overlay-text",this.container.appendChild(this.text),this.container.addEventListener("click",this),this.viewer.addEventListener(Jv.type,this),super.hide()}destroy(){this.viewer.removeEventListener(Jv.type,this),super.destroy()}handleEvent(e){"click"===e.type?this.isVisible()&&this.state.dissmisable&&(this.hide(),e.stopPropagation()):e instanceof Jv&&this.isVisible()&&this.state.dissmisable&&e.key===mg.Escape&&(this.hide(),e.preventDefault())}isVisible(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}toggle(){throw new Yg("Overlay cannot be toggled")}show(e){"string"==typeof e&&(e={title:e}),this.state.contentId=e.id||null,this.state.dissmisable=!1!==e.dissmisable,this.image.innerHTML=e.image||"",this.title.innerHTML=e.title||"",this.text.innerHTML=e.text||"",super.show(),this.viewer.dispatchEvent(new __(e.id))}hide(e){if(this.isVisible(e)){const e=this.state.contentId;super.hide(),this.state.contentId=null,this.viewer.dispatchEvent(new Xv(e))}}},Ey="psv-panel-content--no-interaction",Sy=class extends j_{constructor(e){super(e,{className:`psv-panel ${ug}`}),this.state={visible:!1,contentId:null,mouseX:0,mouseY:0,mousedown:!1,clickHandler:null,keyHandler:null,width:{}};const t=document.createElement("div");t.className="psv-panel-resizer",this.container.appendChild(t);const i=document.createElement("div");i.className="psv-panel-close-button",i.innerHTML=gg.close,i.title=e.config.lang.close,this.container.appendChild(i),this.content=document.createElement("div"),this.content.className="psv-panel-content",this.container.appendChild(this.content),this.container.addEventListener("wheel",(e=>e.stopPropagation())),i.addEventListener("click",(()=>this.hide())),t.addEventListener("mousedown",this),t.addEventListener("touchstart",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this),this.viewer.container.addEventListener("mousemove",this),this.viewer.container.addEventListener("touchmove",this),this.viewer.addEventListener(Jv.type,this)}destroy(){this.viewer.removeEventListener(Jv.type,this),this.viewer.container.removeEventListener("mousemove",this),this.viewer.container.removeEventListener("touchmove",this),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(e){switch(e.type){case"mousedown":this.__onMouseDown(e);break;case"touchstart":this.__onTouchStart(e);break;case"mousemove":this.__onMouseMove(e);break;case"touchmove":this.__onTouchMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchend":this.__onTouchEnd(e);break;case Jv.type:this.__onKeyPress(e)}}isVisible(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}toggle(){throw new Yg("Panel cannot be toggled")}show(e){"string"==typeof e&&(e={content:e});const t=this.isVisible(e.id);this.state.contentId=e.id||null,this.state.visible=!0,this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),e.id&&this.state.width[e.id]?this.container.style.width=this.state.width[e.id]:e.width?this.container.style.width=e.width:this.container.style.width=null,this.content.innerHTML=e.content,this.content.scrollTop=0,this.container.classList.add("psv-panel--open"),Ag(this.content,"psv-panel-content--no-margin",!0===e.noMargin),e.clickHandler&&(this.state.clickHandler=t=>{e.clickHandler(t.target)},this.state.keyHandler=t=>{t.key===mg.Enter&&e.clickHandler(t.target)},this.content.addEventListener("click",this.state.clickHandler),this.content.addEventListener("keydown",this.state.keyHandler),t||setTimeout((()=>{this.content.querySelector("a,button,[tabindex]")?.focus()}),300)),this.viewer.dispatchEvent(new b_(e.id))}hide(e){if(this.isVisible(e)){const e=this.state.contentId;this.state.visible=!1,this.state.contentId=null,this.content.innerHTML=null,this.container.classList.remove("psv-panel--open"),this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.state.clickHandler=null),this.viewer.dispatchEvent(new Yv(e))}}__onMouseDown(e){e.stopPropagation(),this.__startResize(e.clientX,e.clientY)}__onTouchStart(e){if(e.stopPropagation(),1===e.touches.length){const t=e.touches[0];this.__startResize(t.clientX,t.clientY)}}__onMouseUp(e){this.state.mousedown&&(e.stopPropagation(),this.state.mousedown=!1,this.content.classList.remove(Ey))}__onTouchEnd(e){this.state.mousedown&&(e.stopPropagation(),0===e.touches.length&&(this.state.mousedown=!1,this.content.classList.remove(Ey)))}__onMouseMove(e){this.state.mousedown&&(e.stopPropagation(),this.__resize(e.clientX,e.clientY))}__onTouchMove(e){if(this.state.mousedown){const t=e.touches[0];this.__resize(t.clientX,t.clientY)}}__onKeyPress(e){this.isVisible()&&e.key===mg.Escape&&(this.hide(),e.preventDefault())}__startResize(e,t){this.state.mouseX=e,this.state.mouseY=t,this.state.mousedown=!0,this.content.classList.add(Ey)}__resize(e,t){const i=e,n=t,r=Math.max(200,this.container.offsetWidth-(i-this.state.mouseX))+"px";this.state.contentId&&(this.state.width[this.state.contentId]=r),this.container.style.width=r,this.state.mouseX=i,this.state.mouseY=n}},Ty=class extends j_{constructor(e,t){super(e,{className:"psv-tooltip"}),this.state={visible:!0,arrow:0,border:0,state:0,width:0,height:0,pos:"",config:null,data:null},this.content=document.createElement("div"),this.content.className="psv-tooltip-content",this.container.appendChild(this.content),this.arrow=document.createElement("div"),this.arrow.className="psv-tooltip-arrow",this.container.appendChild(this.arrow),this.container.addEventListener("transitionend",this),this.container.addEventListener("touchdown",(e=>e.stopPropagation())),this.container.addEventListener("mousedown",(e=>e.stopPropagation())),this.container.style.top="-1000px",this.container.style.left="-1000px",this.show(t)}handleEvent(e){"transitionend"===e.type&&this.__onTransitionEnd(e)}destroy(){delete this.state.data,super.destroy()}toggle(){throw new Yg("Tooltip cannot be toggled")}show(e){if(0!==this.state.state)throw new Yg("Initialized tooltip cannot be re-initialized");e.className&&Cg(this.container,e.className),e.style&&Object.assign(this.container.style,e.style),this.state.state=3,this.update(e.content,e),this.state.data=e.data,this.state.state=1,this.viewer.dispatchEvent(new w_(this,this.state.data)),this.__waitImages()}update(e,t){this.content.innerHTML=e;const i=this.container.getBoundingClientRect();this.state.width=i.right-i.left,this.state.height=i.bottom-i.top,this.state.arrow=parseInt(Ig(this.arrow,"border-top-width"),10),this.state.border=parseInt(Ig(this.container,"border-top-left-radius"),10),this.move(t??this.state.config),this.__waitImages()}move(e){if(1!==this.state.state&&3!==this.state.state)throw new Yg("Uninitialized tooltip cannot be moved");e.box=e.box??this.state.config?.box??{width:0,height:0},this.state.config=e;const t=this.container,i=this.arrow,n={posClass:lv(e.position,{allowCenter:!1,cssOrder:!1})||["top","center"],width:this.state.width,height:this.state.height,top:0,left:0,arrowTop:0,arrowLeft:0};this.__computeTooltipPosition(n,e);let r=null,s=null;if(n.top<0?r="bottom":n.top+n.height>this.viewer.state.size.height&&(r="top"),n.left<0?s="right":n.left+n.width>this.viewer.state.size.width&&(s="left"),s||r){const t=cv(n.posClass);r&&(n.posClass[t?0:1]=r),s&&(n.posClass[t?1:0]=s),this.__computeTooltipPosition(n,e)}t.style.top=n.top+"px",t.style.left=n.left+"px",i.style.top=n.arrowTop+"px",i.style.left=n.arrowLeft+"px";const a=n.posClass.join("-");a!==this.state.pos&&(t.classList.remove(`psv-tooltip--${this.state.pos}`),this.state.pos=a,t.classList.add(`psv-tooltip--${this.state.pos}`))}hide(){this.container.classList.remove("psv-tooltip--visible"),this.state.state=2,this.viewer.dispatchEvent(new Zv(this.state.data))}__onTransitionEnd(e){if("transform"===e.propertyName)switch(this.state.state){case 1:this.container.classList.add("psv-tooltip--visible"),this.state.state=3;break;case 2:this.state.state=0,this.destroy()}}__computeTooltipPosition(e,t){const i=this.state.arrow,n=t.top,r=e.height,s=t.left,a=e.width,o=i+this.state.border,l=t.box.width/2+2*i,c=t.box.height/2+2*i;switch(e.posClass.join("-")){case"top-left":e.top=n-c-r,e.left=s+o-a,e.arrowTop=r,e.arrowLeft=a-o-i;break;case"top-center":e.top=n-c-r,e.left=s-a/2,e.arrowTop=r,e.arrowLeft=a/2-i;break;case"top-right":e.top=n-c-r,e.left=s-o,e.arrowTop=r,e.arrowLeft=i;break;case"bottom-left":e.top=n+c,e.left=s+o-a,e.arrowTop=2*-i,e.arrowLeft=a-o-i;break;case"bottom-center":e.top=n+c,e.left=s-a/2,e.arrowTop=2*-i,e.arrowLeft=a/2-i;break;case"bottom-right":e.top=n+c,e.left=s-o,e.arrowTop=2*-i,e.arrowLeft=i;break;case"left-top":e.top=n+o-r,e.left=s-l-a,e.arrowTop=r-o-i,e.arrowLeft=a;break;case"center-left":e.top=n-r/2,e.left=s-l-a,e.arrowTop=r/2-i,e.arrowLeft=a;break;case"left-bottom":e.top=n-o,e.left=s-l-a,e.arrowTop=i,e.arrowLeft=a;break;case"right-top":e.top=n+o-r,e.left=s+l,e.arrowTop=r-o-i,e.arrowLeft=2*-i;break;case"center-right":e.top=n-r/2,e.left=s+l,e.arrowTop=r/2-i,e.arrowLeft=2*-i;break;case"right-bottom":e.top=n-o,e.left=s+l,e.arrowTop=i,e.arrowLeft=2*-i}}__waitImages(){const e=this.content.querySelectorAll("img");if(e.length>0){const t=[];e.forEach((e=>{e.complete||t.push(new Promise((t=>{e.onload=t,e.onerror=t})))})),t.length&&Promise.all(t).then((()=>{if(1===this.state.state||3===this.state.state){const e=this.container.getBoundingClientRect();this.state.width=e.right-e.left,this.state.height=e.bottom-e.top,this.move(this.state.config)}}))}}},My=class{constructor(e){this.viewer=e,this.config=e.config,this.state=e.state}destroy(){}},Ay=new mh,Cy=new td(0,0,0,"ZXY"),Ly=class extends My{constructor(e){super(e)}fovToZoomLevel(e){const t=Math.round((e-this.config.minFov)/(this.config.maxFov-this.config.minFov)*100);return t-2*(t-50)}zoomLevelToFov(e){return this.config.maxFov+e/100*(this.config.minFov-this.config.maxFov)}vFovToHFov(e){return Hc.radToDeg(2*Math.atan(Math.tan(Hc.degToRad(e)/2)*this.state.aspect))}getAnimationProperties(e,t,i){const n=!Gg(t),r=!Gg(i),s={};let a=null;if(n){const i=this.viewer.getPosition(),n=Eg(i.yaw,t.yaw);s.yaw={start:i.yaw,end:i.yaw+n},s.pitch={start:i.pitch,end:t.pitch},a=dv(e,Sg(i,t))}if(r){const t=this.viewer.getZoomLevel(),n=Math.abs(i-t);s.zoom={start:t,end:i},null===a&&(a=dv(e,Math.PI/4*n/100))}return a=null===a?"number"==typeof e?e:ng:Math.max(ng,a),{duration:a,properties:s}}textureCoordsToSphericalCoords(e){if(!this.state.textureData?.panoData)throw new Yg("Current adapter does not support texture coordinates or no texture has been loaded");const t=this.viewer.adapter.textureCoordsToSphericalCoords(e,this.state.textureData.panoData);return Cy.equals(this.viewer.renderer.panoramaPose)&&Cy.equals(this.viewer.renderer.sphereCorrection)?t:(this.sphericalCoordsToVector3(t,Ay),Ay.applyEuler(this.viewer.renderer.panoramaPose),Ay.applyEuler(this.viewer.renderer.sphereCorrection),this.vector3ToSphericalCoords(Ay))}sphericalCoordsToTextureCoords(e){if(!this.state.textureData?.panoData)throw new Yg("Current adapter does not support texture coordinates or no texture has been loaded");return Cy.equals(this.viewer.renderer.panoramaPose)&&Cy.equals(this.viewer.renderer.sphereCorrection)||(this.sphericalCoordsToVector3(e,Ay),mv(Ay,this.viewer.renderer.sphereCorrection),mv(Ay,this.viewer.renderer.panoramaPose),e=this.vector3ToSphericalCoords(Ay)),this.viewer.adapter.sphericalCoordsToTextureCoords(e,this.state.textureData.panoData)}sphericalCoordsToVector3(e,t,i=hg){return t||(t=new mh),t.x=i*-Math.cos(e.pitch)*Math.sin(e.yaw),t.y=i*Math.sin(e.pitch),t.z=i*Math.cos(e.pitch)*Math.cos(e.yaw),t}vector3ToSphericalCoords(e){const t=Math.acos(e.y/Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)),i=Math.atan2(e.x,e.z);return{yaw:i<0?-i:2*Math.PI-i,pitch:Math.PI/2-t}}viewerCoordsToVector3(e){const t=this.viewer.renderer.getIntersections(e).filter((e=>e.object.userData[dg]));return t.length?t[0].point:null}viewerCoordsToSphericalCoords(e){const t=this.viewerCoordsToVector3(e);return t?this.vector3ToSphericalCoords(t):null}vector3ToViewerCoords(e){const t=e.clone();return t.project(this.viewer.renderer.camera),{x:Math.round((t.x+1)/2*this.state.size.width),y:Math.round((1-t.y)/2*this.state.size.height)}}sphericalCoordsToViewerCoords(e){return this.sphericalCoordsToVector3(e,Ay),this.vector3ToViewerCoords(Ay)}isPointVisible(e){let t,i;if(e instanceof mh)t=e,i=this.vector3ToViewerCoords(e);else{if(!ev(e))return!1;t=this.sphericalCoordsToVector3(e,Ay),i=this.vector3ToViewerCoords(t)}return t.dot(this.viewer.state.direction)>0&&i.x>=0&&i.x<=this.viewer.state.size.width&&i.y>=0&&i.y<=this.viewer.state.size.height}cleanPosition(e){if("yaw"in e||"pitch"in e){if(!("yaw"in e)||!("pitch"in e))throw new Yg("Position is missing 'yaw' or 'pitch'");return{yaw:uv(e.yaw),pitch:uv(e.pitch,!this.state.littlePlanet)}}return this.textureCoordsToSphericalCoords(e)}cleanSphereCorrection(e){return{pan:uv(e?.pan||0),tilt:uv(e?.tilt||0,!0),roll:uv(e?.roll||0,!0,!1)}}cleanPanoramaPose(e){return{pan:Hc.degToRad(e?.poseHeading||0),tilt:Hc.degToRad(e?.posePitch||0),roll:Hc.degToRad(e?.poseRoll||0)}}},Py=class e{constructor(){this.$=e.IDLE}is(...e){return e.some((e=>this.$&e))}set(e){this.$=e}add(e){this.$|=e}remove(e){this.$&=~e}};Py.IDLE=0,Py.CLICK=1,Py.MOVING=2,Py.INERTIA=4;var Ry=Py,Oy=class extends My{constructor(e){super(e),this.data={startMouseX:0,startMouseY:0,mouseX:0,mouseY:0,mouseHistory:[],pinchDist:0,ctrlKeyDown:!1,dblclickData:null,dblclickTimeout:null,longtouchTimeout:null,twofingersTimeout:null,ctrlZoomTimeout:null},this.step=new Ry,this.keyHandler=new wv,this.resizeObserver=new ResizeObserver(kg((()=>this.viewer.autoSize()),50)),this.moveThreshold=rg*k_.pixelRatio}init(){window.addEventListener("keydown",this,{passive:!1}),window.addEventListener("keyup",this),this.viewer.container.addEventListener("mousedown",this),window.addEventListener("mousemove",this,{passive:!1}),window.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchstart",this,{passive:!1}),window.addEventListener("touchmove",this,{passive:!1}),window.addEventListener("touchend",this,{passive:!1}),this.viewer.container.addEventListener("wheel",this,{passive:!1}),document.addEventListener("fullscreenchange",this),this.resizeObserver.observe(this.viewer.container)}destroy(){window.removeEventListener("keydown",this),window.removeEventListener("keyup",this),this.viewer.container.removeEventListener("mousedown",this),window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchstart",this),window.removeEventListener("touchmove",this),window.removeEventListener("touchend",this),this.viewer.container.removeEventListener("wheel",this),document.removeEventListener("fullscreenchange",this),this.resizeObserver.disconnect(),clearTimeout(this.data.dblclickTimeout),clearTimeout(this.data.longtouchTimeout),clearTimeout(this.data.twofingersTimeout),clearTimeout(this.data.ctrlZoomTimeout),super.destroy()}handleEvent(e){switch(e.type){case"keydown":this.__onKeyDown(e);break;case"keyup":this.__onKeyUp();break;case"mousemove":this.__onMouseMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchmove":this.__onTouchMove(e);break;case"touchend":this.__onTouchEnd(e);break;case"fullscreenchange":this.__onFullscreenChange()}if(!Rg(e.target,"."+ug))switch(e.type){case"mousedown":this.__onMouseDown(e);break;case"touchstart":this.__onTouchStart(e);break;case"wheel":this.__onMouseWheel(e)}}__onKeyDown(e){if(this.config.mousewheelCtrlKey&&(this.data.ctrlKeyDown=e.key===mg.Control,this.data.ctrlKeyDown&&(clearTimeout(this.data.ctrlZoomTimeout),this.viewer.overlay.hide(fg.CTRL_ZOOM))),!this.viewer.dispatchEvent(new Jv(e.key)))return;if(!this.state.keyboardEnabled)return;const t=this.config.keyboardActions?.[e.key];if("function"==typeof t)t(this.viewer),e.preventDefault();else if(t&&!this.keyHandler.pending){switch("ZOOM_IN"!==t&&"ZOOM_OUT"!==t&&this.viewer.stopAll(),t){case"ROTATE_UP":this.viewer.dynamics.position.roll({pitch:!1});break;case"ROTATE_DOWN":this.viewer.dynamics.position.roll({pitch:!0});break;case"ROTATE_RIGHT":this.viewer.dynamics.position.roll({yaw:!1});break;case"ROTATE_LEFT":this.viewer.dynamics.position.roll({yaw:!0});break;case"ZOOM_IN":this.viewer.dynamics.zoom.roll(!1);break;case"ZOOM_OUT":this.viewer.dynamics.zoom.roll(!0)}this.keyHandler.down(),e.preventDefault()}}__onKeyUp(){this.data.ctrlKeyDown=!1,this.state.keyboardEnabled&&this.keyHandler.up((()=>{this.viewer.dynamics.position.stop(),this.viewer.dynamics.zoom.stop(),this.viewer.resetIdleTimer()}))}__onMouseDown(e){this.step.add(Ry.CLICK),this.data.startMouseX=e.clientX,this.data.startMouseY=e.clientY}__onMouseUp(e){this.step.is(Ry.CLICK,Ry.MOVING)&&this.__stopMove(e.clientX,e.clientY,e.target,2===e.button)}__onMouseMove(e){this.config.mousemove&&this.step.is(Ry.CLICK,Ry.MOVING)&&(e.preventDefault(),this.__doMove(e.clientX,e.clientY)),this.__handleObjectsEvents(e)}__onTouchStart(e){1===e.touches.length?(this.step.add(Ry.CLICK),this.data.startMouseX=e.touches[0].clientX,this.data.startMouseY=e.touches[0].clientY,this.data.longtouchTimeout||(this.data.longtouchTimeout=setTimeout((()=>{const t=e.touches[0];this.__stopMove(t.clientX,t.clientY,t.target,!0),this.data.longtouchTimeout=null}),ag))):2===e.touches.length&&(this.step.set(Ry.IDLE),this.__cancelLongTouch(),this.config.mousemove&&(this.__cancelTwoFingersOverlay(),this.__startMoveZoom(e),e.preventDefault()))}__onTouchEnd(e){if(this.__cancelLongTouch(),this.step.is(Ry.CLICK,Ry.MOVING))if(e.preventDefault(),this.__cancelTwoFingersOverlay(),1===e.touches.length)this.__stopMove(this.data.mouseX,this.data.mouseY);else if(0===e.touches.length){const t=e.changedTouches[0];this.__stopMove(t.clientX,t.clientY,t.target)}}__onTouchMove(e){if(this.__cancelLongTouch(),this.config.mousemove)if(1===e.touches.length){if(this.config.touchmoveTwoFingers)this.step.is(Ry.CLICK)&&!this.data.twofingersTimeout&&(this.data.twofingersTimeout=setTimeout((()=>{this.viewer.overlay.show({id:fg.TWO_FINGERS,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z"/>\x3c!--Created by AomAm from the Noun Project--\x3e</svg>\n',title:this.config.lang.twoFingers})}),og));else if(this.step.is(Ry.CLICK,Ry.MOVING)){e.preventDefault();const t=e.touches[0];this.__doMove(t.clientX,t.clientY)}}else this.__doMoveZoom(e),this.__cancelTwoFingersOverlay()}__cancelLongTouch(){this.data.longtouchTimeout&&(clearTimeout(this.data.longtouchTimeout),this.data.longtouchTimeout=null)}__cancelTwoFingersOverlay(){this.config.touchmoveTwoFingers&&(this.data.twofingersTimeout&&(clearTimeout(this.data.twofingersTimeout),this.data.twofingersTimeout=null),this.viewer.overlay.hide(fg.TWO_FINGERS))}__onMouseWheel(e){if(!this.config.mousewheel||!e.deltaY)return;if(this.config.mousewheelCtrlKey&&!this.data.ctrlKeyDown)return this.viewer.overlay.show({id:fg.CTRL_ZOOM,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 17 79 79"><path fill="currentColor" d="M38.1 29.27c-.24 0-.44.2-.44.45v10.7a.45.45 0 00.9 0v-10.7c0-.25-.2-.45-.45-.45zm10.2 26.66a11.54 11.54 0 01-8.48-6.14.45.45 0 10-.8.41 12.45 12.45 0 009.22 6.62.45.45 0 00.07-.9zm24.55-13.08a23.04 23.04 0 00-22.56-23v7.07l-.01.05a2.83 2.83 0 012.39 2.78v14.03l.09-.02h8.84v-9.22a.45.45 0 11.9 0v9.22h10.35v-.9zm0 27.33V44.66H62.5c-.02 2.01-.52 4-1.47 5.76a.45.45 0 01-.61.18.45.45 0 01-.19-.61 11.54 11.54 0 001.36-5.33h-8.83l-.1-.01a2.83 2.83 0 01-2.83 2.84h-.04-.04a2.83 2.83 0 01-2.83-2.83v-14.9a2.82 2.82 0 012.47-2.8v-7.11a23.04 23.04 0 00-22.57 23v.91h14.72V29.88a8.2 8.2 0 015.02-7.57c.22-.1.5.01.59.24.1.23-.01.5-.24.6a7.3 7.3 0 00-4.47 6.73v13.88h3.9a.45.45 0 110 .9h-3.9v.15a7.32 7.32 0 0011.23 6.17.45.45 0 01.49.76 8.22 8.22 0 01-12.62-6.93v-.15H26.82v25.52a23.04 23.04 0 0023.01 23.01 23.04 23.04 0 0023.02-23.01zm1.8-27.33v27.33A24.85 24.85 0 0149.84 95a24.85 24.85 0 01-24.82-24.82V42.85a24.85 24.85 0 0124.82-24.82 24.85 24.85 0 0124.83 24.82zM57.98 29.88v9.36a.45.45 0 11-.9 0v-9.36a7.28 7.28 0 00-3.4-6.17.45.45 0 01.49-.76 8.18 8.18 0 013.8 6.93z"/>\x3c!-- Created by Icon Island from the Noun Project --\x3e</svg>\n',title:this.config.lang.ctrlZoom}),clearTimeout(this.data.ctrlZoomTimeout),void(this.data.ctrlZoomTimeout=setTimeout((()=>this.viewer.overlay.hide(fg.CTRL_ZOOM)),lg));e.preventDefault(),e.stopPropagation();const t=e.deltaY/Math.abs(e.deltaY)*5*this.config.zoomSpeed;0!==t&&this.viewer.dynamics.zoom.step(-t,5)}__onFullscreenChange(){const e=this.viewer.isFullscreenEnabled();"fullscreen"===this.config.keyboard&&(e?this.viewer.startKeyboardControl():this.viewer.stopKeyboardControl()),this.viewer.dispatchEvent(new Vv(e))}__resetMove(){this.step.set(Ry.IDLE),this.data.mouseX=0,this.data.mouseY=0,this.data.startMouseX=0,this.data.startMouseY=0,this.data.mouseHistory.length=0}__startMoveZoom(e){this.viewer.stopAll(),this.__resetMove();const t=Dg(e);this.step.set(Ry.MOVING),({distance:this.data.pinchDist,center:{x:this.data.mouseX,y:this.data.mouseY}}=t),this.__logMouseMove(this.data.mouseX,this.data.mouseY)}__stopMove(e,t,i,n=!1){this.step.is(Ry.MOVING)?this.config.moveInertia?(this.__logMouseMove(e,t),this.__stopMoveInertia(e,t)):(this.__resetMove(),this.viewer.resetIdleTimer()):(this.step.is(Ry.CLICK)&&!this.__moveThresholdReached(e,t)&&this.__doClick(e,t,i,n),this.step.remove(Ry.CLICK),this.step.is(Ry.INERTIA)||(this.__resetMove(),this.viewer.resetIdleTimer()))}__stopMoveInertia(e,t){const i=new Mm(this.data.mouseHistory.map((([,e,t])=>new Bc(e,t)))),n=i.getTangent(1),r=this.data.mouseHistory.reduce((({total:e,prev:t},i)=>({total:t?e+xg({x:t[1],y:t[2]},{x:i[1],y:i[2]})/(i[0]-t[0]):0,prev:i})),{total:0,prev:null}).total/this.data.mouseHistory.length;if(!r)return this.__resetMove(),void this.viewer.resetIdleTimer();this.step.set(Ry.INERTIA);let s=e,a=t;this.state.animation=new yv({properties:{speed:{start:r,end:0}},duration:1e3,easing:"outQuad",onTick:e=>{s+=e.speed*n.x*3*k_.pixelRatio,a+=e.speed*n.y*3*k_.pixelRatio,this.__applyMove(s,a)}}),this.state.animation.then((e=>{this.state.animation=null,e&&(this.__resetMove(),this.viewer.resetIdleTimer())}))}__doClick(e,t,i,n=!1){const r=this.viewer.container.getBoundingClientRect(),s=e-r.left,a=t-r.top,o=this.viewer.renderer.getIntersections({x:s,y:a}),l=o.find((e=>e.object.userData[dg]));if(l){const r=this.viewer.dataHelper.vector3ToSphericalCoords(l.point),c={rightclick:n,target:i,clientX:e,clientY:t,viewerX:s,viewerY:a,yaw:r.yaw,pitch:r.pitch,objects:o.map((e=>e.object)).filter((e=>!e.userData[dg]))};try{const e=this.viewer.dataHelper.sphericalCoordsToTextureCoords(c);Object.assign(c,e)}catch(e){}this.data.dblclickTimeout?(Math.abs(this.data.dblclickData.clientX-c.clientX)<this.moveThreshold&&Math.abs(this.data.dblclickData.clientY-c.clientY)<this.moveThreshold&&this.viewer.dispatchEvent(new Hv(this.data.dblclickData)),clearTimeout(this.data.dblclickTimeout),this.data.dblclickTimeout=null,this.data.dblclickData=null):(this.viewer.dispatchEvent(new Uv(c)),this.data.dblclickData=Vg(c),this.data.dblclickTimeout=setTimeout((()=>{this.data.dblclickTimeout=null,this.data.dblclickData=null}),sg))}}__handleObjectsEvents(e){if(!jg(this.state.objectsObservers)&&Pg(e.target,this.viewer.container)){const t=Og(this.viewer.container),i={x:e.clientX-t.x,y:e.clientY-t.y},n=this.viewer.renderer.getIntersections(i),r=(t,n,r)=>{this.viewer.dispatchEvent(new r(e,t,i,n))};for(const[e,t]of Object.entries(this.state.objectsObservers)){const i=n.find((t=>t.object.userData[e]));i?(t&&i.object!==t&&(r(t,e,I_),this.state.objectsObservers[e]=null),t?r(i.object,e,N_):(this.state.objectsObservers[e]=i.object,r(i.object,e,R_))):t&&(r(t,e,I_),this.state.objectsObservers[e]=null)}}}__doMove(e,t){this.step.is(Ry.CLICK)&&this.__moveThresholdReached(e,t)?(this.viewer.stopAll(),this.__resetMove(),this.step.set(Ry.MOVING),this.data.mouseX=e,this.data.mouseY=t,this.__logMouseMove(e,t)):this.step.is(Ry.MOVING)&&(this.__applyMove(e,t),this.__logMouseMove(e,t))}__moveThresholdReached(e,t){return Math.abs(e-this.data.startMouseX)>=this.moveThreshold||Math.abs(t-this.data.startMouseY)>=this.moveThreshold}__applyMove(e,t){const i=(e-this.data.mouseX)*Math.cos(this.state.roll)-(t-this.data.mouseY)*Math.sin(this.state.roll),n=(t-this.data.mouseY)*Math.cos(this.state.roll)+(e-this.data.mouseX)*Math.sin(this.state.roll),r=this.config.moveSpeed*(i/this.state.size.width)*Hc.degToRad(this.state.littlePlanet?90:this.state.hFov),s=this.config.moveSpeed*(n/this.state.size.height)*Hc.degToRad(this.state.littlePlanet?90:this.state.vFov),a=this.viewer.getPosition();this.viewer.rotate({yaw:a.yaw-r,pitch:a.pitch+s}),this.data.mouseX=e,this.data.mouseY=t}__doMoveZoom(e){if(this.step.is(Ry.MOVING)){e.preventDefault();const t=Dg(e),i=(t.distance-this.data.pinchDist)/k_.pixelRatio*this.config.zoomSpeed;this.viewer.zoom(this.viewer.getZoomLevel()+i),this.__doMove(t.center.x,t.center.y),this.data.pinchDist=t.distance}}__logMouseMove(e,t){const i=Date.now(),n=this.data.mouseHistory.length?this.data.mouseHistory[this.data.mouseHistory.length-1]:[0,-1,-1];n[1]===e&&n[2]===t?n[0]=i:i===n[0]?(n[1]=e,n[2]=t):this.data.mouseHistory.push([i,e,t]);let r=null;for(let e=0;e<this.data.mouseHistory.length;)this.data.mouseHistory[e][0]<i-cg?this.data.mouseHistory.splice(e,1):r&&this.data.mouseHistory[e][0]-r>cg/10?(this.data.mouseHistory.splice(0,e),e=0,r=this.data.mouseHistory[e][0]):(r=this.data.mouseHistory[e][0],e++)}};Qc.enabled=!1;var Iy=new Bc,Dy=new Wh,Ny=new _h,Uy=class extends My{constructor(e){super(e),this.frustumNeedsUpdate=!0,this.renderer=new wm(this.config.rendererParameters),this.renderer.setPixelRatio(k_.pixelRatio),this.renderer.outputColorSpace=mc,this.renderer.domElement.className="psv-canvas",this.scene=new Em,this.camera=new Mu(50,16/9,.1,2*hg),this.camera.matrixWorldAutoUpdate=!1,this.mesh=this.viewer.adapter.createMesh(),this.mesh.userData={[dg]:!0},this.meshContainer=new mm,this.meshContainer.add(this.mesh),this.scene.add(this.meshContainer),this.raycaster=new Zm,this.frustum=new Fu,this.container=document.createElement("div"),this.container.className="psv-canvas-container",this.container.appendChild(this.renderer.domElement),this.viewer.container.appendChild(this.container),this.viewer.addEventListener(S_.type,this),this.viewer.addEventListener(C_.type,this),this.viewer.addEventListener(l_.type,this),this.viewer.addEventListener(h_.type,this),this.viewer.addEventListener(zv.type,this),this.hide()}get panoramaPose(){return this.mesh.rotation}get sphereCorrection(){return this.meshContainer.rotation}init(){this.show(),this.renderer.setAnimationLoop((e=>this.__renderLoop(e)))}destroy(){this.renderer.setAnimationLoop(null),this.cleanScene(this.scene),this.viewer.container.removeChild(this.container),this.viewer.removeEventListener(S_.type,this),this.viewer.removeEventListener(C_.type,this),this.viewer.removeEventListener(l_.type,this),this.viewer.removeEventListener(h_.type,this),this.viewer.removeEventListener(zv.type,this),super.destroy()}handleEvent(e){switch(e.type){case S_.type:this.__onSizeUpdated();break;case C_.type:this.__onZoomUpdated();break;case l_.type:case h_.type:this.__onPositionUpdated();break;case zv.type:e.containsOptions("fisheye")&&this.__onPositionUpdated()}}hide(){this.container.style.opacity="0"}show(){this.container.style.opacity="1"}setCustomRenderer(e){this.customRenderer=e?e(this.renderer):null,this.viewer.needsUpdate()}__onSizeUpdated(){this.renderer.setSize(this.state.size.width,this.state.size.height),this.camera.aspect=this.state.aspect,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onZoomUpdated(){this.camera.fov=this.state.vFov,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onPositionUpdated(){this.camera.position.set(0,0,0),this.camera.lookAt(this.state.direction),this.config.fisheye&&this.camera.position.copy(this.state.direction).multiplyScalar(this.config.fisheye/2).negate(),this.camera.rotateZ(-this.state.roll),this.camera.updateMatrixWorld(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__renderLoop(e){const t=this.timestamp?e-this.timestamp:0;this.timestamp=e,this.viewer.dispatchEvent(new Ov(e,t)),this.viewer.dynamics.update(t),(this.state.needsUpdate||this.state.continuousUpdateCount>0)&&(this.state.needsUpdate=!1,(this.customRenderer||this.renderer).render(this.scene,this.camera),this.viewer.dispatchEvent(new f_))}setTexture(e){this.state.textureData&&this.viewer.adapter.disposeTexture(this.state.textureData),this.state.textureData=e,this.viewer.adapter.setTexture(this.mesh,e),this.viewer.needsUpdate()}setPanoramaPose(e,t=this.mesh){const i=this.viewer.dataHelper.cleanPanoramaPose(e);t.rotation.set(-i.tilt,-i.pan,-i.roll,"ZXY")}setSphereCorrection(e,t=this.meshContainer){const i=this.viewer.dataHelper.cleanSphereCorrection(e);t.rotation.set(i.tilt,i.pan,i.roll,"ZXY")}transition(e,t){const i=!Gg(t.position),n=!Gg(t.zoom),r=new Pv(i?this.viewer.dataHelper.cleanPosition(t.position):void 0,t.zoom);this.viewer.dispatchEvent(r);const s=new mm,a=this.viewer.adapter.createMesh(.5);if(this.viewer.adapter.setTexture(a,e,!0),this.viewer.adapter.setTextureOpacity(a,0),this.setPanoramaPose(e.panoData,a),this.setSphereCorrection(t.sphereCorrection,s),i&&"fade-only"===t.transition){const e=this.viewer.getPosition(),t=new mh(0,1,0);s.rotateOnWorldAxis(t,r.position.yaw-e.yaw);const i=new mh(0,1,0).cross(this.camera.getWorldDirection(new mh)).normalize();s.rotateOnWorldAxis(i,r.position.pitch-e.pitch)}s.add(a),this.scene.add(s),this.renderer.setRenderTarget(new dh),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null);const{duration:o,properties:l}=this.viewer.dataHelper.getAnimationProperties(t.speed,!0===t.transition?r.position:null,r.zoomLevel),c=new yv({properties:{...l,opacity:{start:0,end:1}},duration:o,easing:"inOutCubic",onTick:e=>{this.viewer.adapter.setTextureOpacity(a,e.opacity),i&&!0===t.transition&&this.viewer.dynamics.position.setValue({yaw:e.yaw,pitch:e.pitch}),n&&this.viewer.dynamics.zoom.setValue(e.zoom),this.viewer.needsUpdate()}});return c.then((n=>{n?(this.setTexture(e),this.viewer.adapter.setTextureOpacity(this.mesh,1),this.setPanoramaPose(e.panoData),this.setSphereCorrection(t.sphereCorrection),i&&"fade-only"===t.transition&&this.viewer.rotate(t.position)):this.viewer.adapter.disposeTexture(e),this.scene.remove(s),a.geometry.dispose(),a.geometry=null})),c}getIntersections(e){Iy.x=2*e.x/this.state.size.width-1,Iy.y=-2*e.y/this.state.size.height+1,this.raycaster.setFromCamera(Iy,this.camera);const t=this.raycaster.intersectObjects(this.scene.children,!0).filter((e=>e.object.visible)).filter((e=>e.object.isMesh&&!!e.object.userData));return this.customRenderer?.getIntersections&&t.push(...this.customRenderer.getIntersections(this.raycaster,Iy)),t}isObjectVisible(e){if(!e)return!1;if(this.frustumNeedsUpdate&&(Dy.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.frustum.setFromProjectionMatrix(Dy),this.frustumNeedsUpdate=!1),e.isVector3)return this.frustum.containsPoint(e);if(e.isMesh&&e.geometry){const t=e;return t.geometry.boundingBox||t.geometry.computeBoundingBox(),Ny.copy(t.geometry.boundingBox).applyMatrix4(t.matrixWorld),this.frustum.intersectsBox(Ny)}return!!e.isObject3D&&this.frustum.intersectsObject(e)}addObject(e){this.scene.add(e)}removeObject(e){this.scene.remove(e)}cleanScene(e){const t=e=>{e.map?.dispose(),e.uniforms&&Object.values(e.uniforms).forEach((e=>{e.value?.dispose?.()})),e.dispose()};e.traverse((i=>{i.geometry?.dispose(),i.material&&(Array.isArray(i.material)?i.material.forEach((e=>{t(e)})):t(i.material)),i instanceof Em||i.dispose?.(),i!==e&&this.cleanScene(i)}))}},Fy=class extends Bm{load(e,t,i,n,r){const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(s,{signal:r}).then((e=>{if(200===e.status||0===e.status){const t=e.body.getReader(),r=e.headers.get("Content-Length")||e.headers.get("X-File-Size"),s=r?parseInt(r):0,a=0!==s;let o=0;const l=new ReadableStream({start(e){!function r(){t.read().then((({done:t,value:n})=>{if(t)e.close();else{o+=n.byteLength;const t=new ProgressEvent("progress",{lengthComputable:a,loaded:o,total:s});i(t),e.enqueue(n),r()}})).catch((e=>{n(e)}))}()}});return new Response(l)}throw new Error(`fetch for "${e.url}" responded with ${e.status}: ${e.statusText}`)})).then((e=>e.blob())).then((e=>{t(e)})).catch((e=>{n(e)}))}},zy=class extends Bm{load(e,t,i,n){const r=document.createElement("img");function s(){l(),t(this)}function a(e){if(l(),n?.aborted){const e=new Error;e.name="AbortError",e.message="The operation was aborted.",i(e)}else i(e)}function o(){r.src=""}function l(){r.removeEventListener("load",s,!1),r.removeEventListener("error",a,!1),n?.removeEventListener("abort",o,!1)}return r.addEventListener("load",s,!1),r.addEventListener("error",a,!1),n?.addEventListener("abort",o,!1),e.startsWith("data:")||void 0===this.crossOrigin||(r.crossOrigin=this.crossOrigin),r.src=e,r}},ky=class extends My{constructor(e){super(e),this.abortCtrl={},this.fileLoader=new Fy,this.imageLoader=new zy,this.config.withCredentials&&(this.fileLoader.setWithCredentials(!0),this.imageLoader.setCrossOrigin("use-credentials"))}destroy(){this.abortLoading(),super.destroy()}abortLoading(){Object.values(this.abortCtrl).forEach((e=>e.abort())),this.abortCtrl={}}loadFile(e,t,i){const n=yy.get(e,i);if(n){if(n instanceof Blob)return t?.(100),Promise.resolve(n);yy.remove(e,i)}return this.config.requestHeaders&&this.fileLoader.setRequestHeader(this.config.requestHeaders(e)),new Promise(((n,r)=>{let s=0;t?.(s),this.fileLoader.load(e,(r=>{s=100,t?.(s),yy.add(e,i,r),n(r)}),(e=>{if(e.lengthComputable){const i=e.loaded/e.total*100;i>s&&(s=i,t?.(s))}}),(e=>{r(e)}),this.__getAbortSignal(i))}))}loadImage(e,t,i){const n=yy.get(e,i);return n?(t?.(100),n instanceof Blob?this.blobToImage(n):Promise.resolve(n)):t||this.config.requestHeaders?this.loadFile(e,t,i).then((e=>this.blobToImage(e))):new Promise(((t,n)=>{this.imageLoader.load(e,(n=>{yy.add(e,i,n),t(n)}),(e=>{n(e)}),this.__getAbortSignal(i))}))}blobToImage(e){return new Promise(((t,i)=>{const n=document.createElement("img");n.onload=()=>{URL.revokeObjectURL(n.src),t(n)},n.onerror=i,n.src=URL.createObjectURL(e)}))}preloadPanorama(e){return this.viewer.adapter.supportsPreload(e)?this.viewer.adapter.loadTexture(e,!1):Promise.reject(new Yg("Current adapter does not support preload"))}__getAbortSignal(e){return e?(this.abortCtrl[e]?.signal.aborted&&delete this.abortCtrl[e],this.abortCtrl[e]||(this.abortCtrl[e]=new AbortController),this.abortCtrl[e].signal):null}},Hy=class extends My{constructor(e){super(e),this.zoom=new bv((e=>{this.viewer.state.vFov=this.viewer.dataHelper.zoomLevelToFov(e),this.viewer.state.hFov=this.viewer.dataHelper.vFovToHFov(this.viewer.state.vFov),this.viewer.dispatchEvent(new C_(e))}),{defaultValue:this.viewer.config.defaultZoomLvl,min:0,max:100,wrap:!1}),this.position=new xv((e=>{this.viewer.dataHelper.sphericalCoordsToVector3(e,this.viewer.state.direction),this.viewer.dispatchEvent(new l_(e))}),{yaw:new bv(null,{defaultValue:this.config.defaultYaw,min:0,max:2*Math.PI,wrap:!0}),pitch:new bv(null,{defaultValue:this.config.defaultPitch,min:this.viewer.state.littlePlanet?0:-Math.PI/2,max:this.viewer.state.littlePlanet?2*Math.PI:Math.PI/2,wrap:this.viewer.state.littlePlanet})}),this.roll=new bv((e=>{this.viewer.state.roll=e,this.viewer.dispatchEvent(new h_(e))}),{defaultValue:0,min:-Math.PI,max:Math.PI,wrap:!1}),this.updateSpeeds()}updateSpeeds(){this.zoom.setSpeed(50*this.config.zoomSpeed),this.position.setSpeed(Hc.degToRad(50*this.config.moveSpeed)),this.roll.setSpeed(Hc.degToRad(50*this.config.moveSpeed))}update(e){this.zoom.update(e),this.position.update(e),this.roll.update(e)}},By=class extends Av{constructor(e){if(super(),this.plugins={},this.children=[],this.onResize=kg((()=>this.navbar.autoSize()),500),this.parent=Mg(e.container),!this.parent)throw new Yg('"container" element not found.');this.parent[dg]=this,this.container=document.createElement("div"),this.container.classList.add("psv-container"),this.parent.appendChild(this.container),vv(this.container,"core"),this.state=new class{constructor(){this.ready=!1,this.needsUpdate=!1,this.continuousUpdateCount=0,this.keyboardEnabled=!1,this.direction=new mh(0,0,hg),this.roll=0,this.vFov=60,this.hFov=60,this.aspect=1,this.animation=null,this.transitionAnimation=null,this.loadingPromise=null,this.littlePlanet=!1,this.idleTime=-1,this.objectsObservers={},this.size={width:0,height:0}}},this.config=py(e),this.__setSize(this.config.size),this.overlay=new wy(this);try{k_.load()}catch(e){return console.error(e),void this.showError(this.config.lang.webglError)}yy.init(),this.adapter=new this.config.adapter[0](this,this.config.adapter[1]),this.renderer=new Uy(this),this.textureLoader=new ky(this),this.eventsHandler=new Oy(this),this.dataHelper=new Ly(this),this.dynamics=new Hy(this),this.adapter.init?.(),this.loader=new by(this),this.navbar=new _y(this),this.panel=new Sy(this),this.notification=new xy(this),this.autoSize(),this.setCursor(null),$g(k_.isTouchEnabled,(e=>{Ag(this.container,"psv--is-touch",e)})),this.config.plugins.forEach((([e,t])=>{this.plugins[e.id]=new e(this,t)}));for(const e of Object.values(this.plugins))e.init?.();this.config.navbar&&this.navbar.setButtons(this.config.navbar),this.state.loadingPromise||(this.config.panorama?this.setPanorama(this.config.panorama):this.loader.show())}destroy(){this.stopAll(),this.stopKeyboardControl(),this.exitFullscreen();for(const[e,t]of Object.entries(this.plugins))t.destroy(),delete this.plugins[e];this.children.slice().forEach((e=>e.destroy())),this.children.length=0,this.eventsHandler?.destroy(),this.renderer?.destroy(),this.textureLoader?.destroy(),this.dataHelper?.destroy(),this.adapter?.destroy(),this.dynamics?.destroy(),this.parent.removeChild(this.container),delete this.parent[dg]}init(){this.eventsHandler.init(),this.renderer.init(),this.config.navbar&&this.navbar.show(),"always"===this.config.keyboard&&this.startKeyboardControl(),this.resetIdleTimer(),this.state.ready=!0,this.dispatchEvent(new u_)}resetIdleTimer(){this.state.idleTime=performance.now()}disableIdleTimer(){this.state.idleTime=-1}getPlugin(e){if("string"==typeof e)return this.plugins[e];{const t=cy(e);return t?this.plugins[t.id]:null}}getPosition(){return this.dataHelper.cleanPosition(this.dynamics.position.current)}getZoomLevel(){return this.dynamics.zoom.current}getSize(){return{...this.state.size}}isFullscreenEnabled(){return Ng(this.parent,k_.isIphone)}needsUpdate(){this.state.needsUpdate=!0}needsContinuousUpdate(e){e?this.state.continuousUpdateCount++:this.state.continuousUpdateCount>0&&this.state.continuousUpdateCount--}autoSize(){this.container.clientWidth===this.state.size.width&&this.container.clientHeight===this.state.size.height||(this.state.size.width=Math.round(this.container.clientWidth),this.state.size.height=Math.round(this.container.clientHeight),this.state.aspect=this.state.size.width/this.state.size.height,this.state.hFov=this.dataHelper.vFovToHFov(this.state.vFov),this.dispatchEvent(new S_(this.getSize())),this.onResize())}setPanorama(e,t={}){this.textureLoader.abortLoading(),this.state.transitionAnimation?.cancel(),this.state.ready||["sphereCorrection","panoData"].forEach((e=>{e in t||(t[e]=this.config[e])})),void 0===t.transition&&(t.transition=!0),void 0===t.speed&&(t.speed=ig),void 0===t.showLoader&&(t.showLoader=!0),void 0===t.caption&&(t.caption=this.config.caption),void 0===t.description&&(t.description=this.config.description),t.panoData||"function"!=typeof this.config.panoData||(t.panoData=this.config.panoData);const i=!Gg(t.position),n=!Gg(t.zoom);(i||n)&&this.stopAll(),this.hideError(),this.resetIdleTimer(),this.config.panorama=e,this.config.caption=t.caption,this.config.description=t.description;const r=t=>{if(Jg(t))return!1;if(this.loader.hide(),this.state.loadingPromise=null,t)throw this.navbar.setCaption(""),this.showError(this.config.lang.loadError),console.error(t),this.dispatchEvent(new a_(e,t)),t;return this.navbar.setCaption(this.config.caption),!0};this.navbar.setCaption(`<em>${this.config.lang.loading}</em>`),!t.showLoader&&this.state.ready||this.loader.show(),this.dispatchEvent(new i_(e));const s=this.adapter.loadTexture(this.config.panorama,!0,t.panoData).then((e=>{if(e.panorama!==this.config.panorama)throw this.adapter.disposeTexture(e),Kg();return e}));return t.transition&&this.state.ready&&this.adapter.supportsTransition(this.config.panorama)?this.state.loadingPromise=s.then((e=>(this.loader.hide(),this.dispatchEvent(new r_(e)),this.state.transitionAnimation=this.renderer.transition(e,t),this.state.transitionAnimation))).then((e=>{if(this.state.transitionAnimation=null,!e)throw Kg()})).then((()=>r()),(e=>r(e))):this.state.loadingPromise=s.then((e=>{this.renderer.show(),this.renderer.setTexture(e),this.renderer.setPanoramaPose(e.panoData),this.renderer.setSphereCorrection(t.sphereCorrection),this.state.ready||this.init(),this.dispatchEvent(new r_(e)),n&&this.zoom(t.zoom),i&&this.rotate(t.position)})).then((()=>r()),(e=>r(e))),this.state.loadingPromise}setOptions(e){const t={...this.config,...e};for(let[i,n]of Object.entries(e))if(i in hy)if(i in dy)Qg(dy[i]);else switch(i in uy&&(n=uy[i](n,{rawConfig:t,defValue:hy[i]})),this.config[i]=n,i){case"mousemove":this.state.cursorOverride||this.setCursor(null);break;case"caption":this.navbar.setCaption(this.config.caption);break;case"size":this.resize(this.config.size);break;case"sphereCorrection":this.renderer.setSphereCorrection(this.config.sphereCorrection);break;case"navbar":case"lang":this.navbar.setButtons(this.config.navbar);break;case"moveSpeed":case"zoomSpeed":this.dynamics.updateSpeeds();break;case"minFov":case"maxFov":this.dynamics.zoom.setValue(this.dataHelper.fovToZoomLevel(this.state.vFov)),this.dispatchEvent(new C_(this.getZoomLevel()));break;case"keyboard":"always"===this.config.keyboard?this.startKeyboardControl():this.stopKeyboardControl()}else Qg(`Unknown option ${i}`);this.needsUpdate(),this.dispatchEvent(new zv(Object.keys(e)))}setOption(e,t){this.setOptions({[e]:t})}showError(e){this.overlay.show({id:fg.ERROR,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="15 15 70 70"><path fill="currentColor" d="M50,16.2c-18.6,0-33.8,15.1-33.8,33.8S31.4,83.7,50,83.7S83.8,68.6,83.8,50S68.6,16.2,50,16.2z M50,80.2c-16.7,0-30.2-13.6-30.2-30.2S33.3,19.7,50,19.7S80.3,33.3,80.3,50S66.7,80.2,50,80.2z"/><rect fill="currentColor" x="48" y="31.7" width="4" height="28"/><rect fill="currentColor" x="48" y="63.2" width="4" height="5"/>\x3c!--Created by Shastry from the Noun Project--\x3e</svg>\n',title:e,dissmisable:!1})}hideError(){this.overlay.hide(fg.ERROR)}rotate(e){const t=new Dv(this.dataHelper.cleanPosition(e));this.dispatchEvent(t),t.defaultPrevented||this.dynamics.position.setValue(t.position)}zoom(e){this.dynamics.zoom.setValue(e)}zoomIn(e=1){this.dynamics.zoom.step(e)}zoomOut(e=1){this.dynamics.zoom.step(-e)}animate(e){const t=ev(e),i=!Gg(e.zoom),n=new Pv(t?this.dataHelper.cleanPosition(e):void 0,e.zoom);if(this.dispatchEvent(n),n.defaultPrevented)return;this.stopAll();const{duration:r,properties:s}=this.dataHelper.getAnimationProperties(e.speed,n.position,n.zoomLevel);return r?(this.state.animation=new yv({properties:s,duration:r,easing:e.easing||"inOutSine",onTick:e=>{t&&this.dynamics.position.setValue({yaw:e.yaw,pitch:e.pitch}),i&&this.dynamics.zoom.setValue(e.zoom)}}),this.state.animation.then((()=>{this.state.animation=null,this.resetIdleTimer()})),this.state.animation):(t&&this.rotate(n.position),i&&this.zoom(n.zoomLevel),new yv(null))}stopAnimation(){return this.state.animation?(this.state.animation.cancel(),this.state.animation):Promise.resolve()}resize(e){this.__setSize(e),this.autoSize()}__setSize(e){const t=e;["width","height"].forEach((i=>{e&&t[i]&&(/^[0-9.]+$/.test(t[i])&&(t[i]+="px"),this.parent.style[i]=t[i])}))}enterFullscreen(){this.isFullscreenEnabled()||Ug(this.parent,k_.isIphone)}exitFullscreen(){this.isFullscreenEnabled()&&Fg(k_.isIphone)}toggleFullscreen(){this.isFullscreenEnabled()?this.exitFullscreen():this.enterFullscreen()}startKeyboardControl(){this.state.keyboardEnabled=!0}stopKeyboardControl(){this.state.keyboardEnabled=!1}createTooltip(e){return new Ty(this,e)}setCursor(e){this.state.cursorOverride=e,this.container.style.cursor=e||(this.config.mousemove?"move":"default")}observeObjects(e){this.state.objectsObservers[e]||(this.state.objectsObservers[e]=null)}unobserveObjects(e){delete this.state.objectsObservers[e]}stopAll(){return this.dispatchEvent(new M_),this.disableIdleTimer(),this.stopAnimation()}},Vy=Object.defineProperty;((e,t)=>{for(var i in t)Vy(e,i,{get:t[i],enumerable:!0})})({},{GyroscopeUpdatedEvent:()=>Gy});var jy=class e extends Mv{constructor(t){super(e.type),this.gyroscopeEnabled=t}};jy.type="gyroscope-updated";var Gy=jy,Wy=class extends W_{constructor(e){super(e,{className:"psv-gyroscope-button",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M50 0a50 50 0 1 0 0 100A50 50 0 0 0 50 0zm0 88.81a38.86 38.86 0 0 1-38.81-38.8 38.86 38.86 0 0 1 38.8-38.82A38.86 38.86 0 0 1 88.82 50 38.87 38.87 0 0 1 50 88.81z"/><path fill="currentColor" d="M72.07 25.9L40.25 41.06 27.92 74.12l31.82-15.18v-.01l12.32-33.03zM57.84 54.4L44.9 42.58l21.1-10.06-8.17 21.9z"/>\x3c!--Created by iconoci from the Noun Project--\x3e</svg>',hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("gyroscope"),this.plugin&&this.plugin.addEventListener(Gy.type,this)}destroy(){this.plugin&&this.plugin.removeEventListener(Gy.type,this),super.destroy()}isSupported(){return!!this.plugin&&{initial:!1,promise:this.plugin.isSupported()}}handleEvent(e){e instanceof Gy&&this.toggleActive(e.gyroscopeEnabled)}onClick(){this.plugin.toggle()}};Wy.id="gyroscope";var Xy=new mh(0,0,1),qy=new td,Yy=new fh,$y=new fh(-Math.sqrt(.5),0,0,Math.sqrt(.5)),Zy=_g.getConfigParser({touchmove:!0,roll:!0,absolutePosition:!1,moveMode:"smooth"},{moveMode:(e,{defValue:t})=>"smooth"!==e&&"fast"!==e?(_g.logWarn("GyroscopePlugin: invalid moveMode"),t):e}),Ky=new mh,Jy=class extends ly{constructor(e,t){super(e,t),this.state={isSupported:this.__checkSupport(),alphaOffset:0,enabled:!1,config_moveInertia:!0,moveMode:this.config.moveMode}}init(){super.init(),this.viewer.addEventListener(Tv.StopAllEvent.type,this),this.viewer.addEventListener(Tv.BeforeRotateEvent.type,this),this.viewer.addEventListener(Tv.BeforeRenderEvent.type,this)}destroy(){this.viewer.removeEventListener(Tv.StopAllEvent.type,this),this.viewer.removeEventListener(Tv.BeforeRotateEvent.type,this),this.viewer.removeEventListener(Tv.BeforeRenderEvent.type,this),this.stop(),this.controls?.disconnect(),delete this.controls,super.destroy()}handleEvent(e){e instanceof Tv.StopAllEvent?this.stop():e instanceof Tv.BeforeRenderEvent?this.__onBeforeRender():e instanceof Tv.BeforeRotateEvent&&this.__onBeforeRotate(e)}isSupported(){return this.state.isSupported}isEnabled(){return this.state.enabled}start(e=this.config.moveMode){return this.state.isSupported.then((e=>e?this.__requestPermission():(_g.logWarn("gyroscope not available"),Promise.reject()))).then((e=>e?Promise.resolve():(_g.logWarn("gyroscope not allowed"),Promise.reject()))).then((()=>{this.viewer.stopAll(),this.state.moveMode=e,this.state.config_moveInertia=this.viewer.config.moveInertia,this.viewer.config.moveInertia=!1,this.controls||(this.controls=new class{constructor(e,t){!1===window.isSecureContext&&console.error("THREE.DeviceOrientationControls: DeviceOrientationEvent is only available in secure contexts (https)");const i=this,n=new fh;let r=!1;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;const s=function(e){i.deviceOrientation=e},a=function(e){r&&(window.removeEventListener("deviceorientation",s),r=!1),i.deviceOrientation=e},o=function(){i.screenOrientation=window.orientation||0};this.connect=function(){o(),void 0!==window.DeviceOrientationEvent&&"function"==typeof window.DeviceOrientationEvent.requestPermission?window.DeviceOrientationEvent.requestPermission().then((function(e){"granted"==e&&(window.addEventListener("orientationchange",o),window.addEventListener("deviceorientation",s),t&&(window.addEventListener("deviceorientationabsolute",a),r=!0))})).catch((function(e){console.error("THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:",e)})):(window.addEventListener("orientationchange",o),window.addEventListener("deviceorientation",s),t&&(window.addEventListener("deviceorientationabsolute",a),r=!0)),i.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",o),window.removeEventListener("deviceorientation",s),window.removeEventListener("deviceorientationabsolute",a),r=!1,i.enabled=!1},this.update=function(){if(!1===i.enabled)return!1;const e=i.deviceOrientation;if(e){if(!e.alpha&&!e.beta&&!e.gamma)return!1;const t=e.alpha?Hc.degToRad(e.alpha)+i.alphaOffset:0,r=e.beta?Hc.degToRad(e.beta):0,s=e.gamma?Hc.degToRad(e.gamma):0,a=i.screenOrientation?Hc.degToRad(i.screenOrientation):0;return function(e,t,i,n,r){qy.set(i,t,-n,"YXZ"),e.setFromEuler(qy),e.multiply($y),e.multiply(Yy.setFromAxisAngle(Xy,-r))}(i.object.quaternion,t,r,s,a),8*(1-n.dot(i.object.quaternion))>1e-6&&n.copy(i.object.quaternion),!0}return!1},this.dispose=function(){i.disconnect()},this.connect()}}(new gd,this.config.absolutePosition)),this.controls.alphaOffset=0,this.state.alphaOffset=this.config.absolutePosition?0:null,this.state.enabled=!0,this.dispatchEvent(new Gy(!0))}))}stop(){this.isEnabled()&&(this.state.enabled=!1,this.viewer.config.moveInertia=this.state.config_moveInertia,this.config.roll&&this.viewer.dynamics.roll.goto(0,30),this.dispatchEvent(new Gy(!1)),this.viewer.resetIdleTimer())}toggle(){this.isEnabled()?this.stop():this.start()}__onBeforeRender(){if(!this.isEnabled())return;if(!this.controls.deviceOrientation)return;const e=this.viewer.getPosition();if(null===this.state.alphaOffset){if(this.controls.update()){this.controls.object.getWorldDirection(Ky);const t=this.viewer.dataHelper.vector3ToSphericalCoords(Ky);this.state.alphaOffset=t.yaw-e.yaw}}else if(this.controls.alphaOffset=this.state.alphaOffset,this.controls.update()){this.controls.object.getWorldDirection(Ky);const t=this.viewer.dataHelper.vector3ToSphericalCoords(Ky),i={yaw:t.yaw,pitch:-t.pitch},n="smooth"===this.state.moveMode?3:10;this.viewer.dynamics.position.goto(i,_g.getAngle(e,i)<.01?1:n),this.config.roll&&this.viewer.dynamics.roll.goto(-this.controls.object.rotation.z,"smooth"===this.state.moveMode?10:30)}}__onBeforeRotate(e){this.isEnabled()&&(e.preventDefault(),this.config.touchmove&&(this.state.alphaOffset-=e.position.yaw-this.viewer.getPosition().pitch))}__checkSupport(){return"DeviceOrientationEvent"in window&&"function"==typeof DeviceOrientationEvent.requestPermission?Promise.resolve(!0):"DeviceOrientationEvent"in window?new Promise((e=>{const t=i=>{e(!!i&&!_g.isNil(i.alpha)&&!isNaN(i.alpha)),window.removeEventListener("deviceorientation",t)};window.addEventListener("deviceorientation",t,!1),setTimeout(t,1e4)})):Promise.resolve(!1)}__requestPermission(){return"function"==typeof DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((e=>"granted"===e)).catch((()=>!1)):Promise.resolve(!0)}};function Qy(){return Qy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},Qy.apply(this,arguments)}function eb(e,t,i){return Math.max(e,Math.min(t,i))}Jy.id="gyroscope",Jy.VERSION="5.7.4",Jy.configParser=Zy,Jy.readonlyOptions=["absolutePosition"],hy.lang[Wy.id]="Gyroscope",vy(Wy,"caption:right");class tb{advance(e){var t;if(!this.isRunning)return;let i=!1;if(this.lerp)this.value=(1-(n=this.lerp))*this.value+n*this.to,Math.round(this.value)===this.to&&(this.value=this.to,i=!0);else{this.currentTime+=e;const t=eb(0,this.currentTime/this.duration,1);i=t>=1;const n=i?1:this.easing(t);this.value=this.from+(this.to-this.from)*n}var n;null==(t=this.onUpdate)||t.call(this,this.value,{completed:i}),i&&this.stop()}stop(){this.isRunning=!1}fromTo(e,t,{lerp:i=.1,duration:n=1,easing:r=(e=>e),onUpdate:s}){this.from=this.value=e,this.to=t,this.lerp=i,this.duration=n,this.easing=r,this.currentTime=0,this.isRunning=!0,this.onUpdate=s}}function ib(e,t){let i;return function(){let n=arguments,r=this;clearTimeout(i),i=setTimeout((function(){e.apply(r,n)}),t)}}class nb{constructor(e,t){this.onWindowResize=()=>{this.width=window.innerWidth,this.height=window.innerHeight},this.onWrapperResize=()=>{this.width=this.wrapper.clientWidth,this.height=this.wrapper.clientHeight},this.onContentResize=()=>{const e=this.wrapper===window?document.documentElement:this.wrapper;this.scrollHeight=e.scrollHeight,this.scrollWidth=e.scrollWidth},this.wrapper=e,this.content=t,this.wrapper===window?(window.addEventListener("resize",this.onWindowResize,!1),this.onWindowResize()):(this.wrapperResizeObserver=new ResizeObserver(ib(this.onWrapperResize,100)),this.wrapperResizeObserver.observe(this.wrapper),this.onWrapperResize()),this.contentResizeObserver=new ResizeObserver(ib(this.onContentResize,100)),this.contentResizeObserver.observe(this.content),this.onContentResize()}destroy(){var e,t;window.removeEventListener("resize",this.onWindowResize,!1),null==(e=this.wrapperResizeObserver)||e.disconnect(),null==(t=this.contentResizeObserver)||t.disconnect()}get limit(){return{x:this.scrollWidth-this.width,y:this.scrollHeight-this.height}}}let rb=()=>({events:{},emit(e,...t){let i=this.events[e]||[];for(let e=0,n=i.length;e<n;e++)i[e](...t)},on(e,t){var i;return(null==(i=this.events[e])?void 0:i.push(t))||(this.events[e]=[t]),()=>{var i;this.events[e]=null==(i=this.events[e])?void 0:i.filter((e=>t!==e))}}});class sb{constructor(e,{wheelMultiplier:t=1,touchMultiplier:i=2,normalizeWheel:n=!1}){this.onTouchStart=e=>{const{clientX:t,clientY:i}=e.targetTouches?e.targetTouches[0]:e;this.touchStart.x=t,this.touchStart.y=i,this.lastDelta={x:0,y:0}},this.onTouchMove=e=>{const{clientX:t,clientY:i}=e.targetTouches?e.targetTouches[0]:e,n=-(t-this.touchStart.x)*this.touchMultiplier,r=-(i-this.touchStart.y)*this.touchMultiplier;this.touchStart.x=t,this.touchStart.y=i,this.lastDelta={x:n,y:r},this.emitter.emit("scroll",{type:"touch",deltaX:n,deltaY:r,event:e})},this.onTouchEnd=e=>{this.emitter.emit("scroll",{type:"touch",inertia:!0,deltaX:this.lastDelta.x,deltaY:this.lastDelta.y,event:e})},this.onWheel=e=>{let{deltaX:t,deltaY:i}=e;this.normalizeWheel&&(t=eb(-100,t,100),i=eb(-100,i,100)),t*=this.wheelMultiplier,i*=this.wheelMultiplier,this.emitter.emit("scroll",{type:"wheel",deltaX:t,deltaY:i,event:e})},this.element=e,this.wheelMultiplier=t,this.touchMultiplier=i,this.normalizeWheel=n,this.touchStart={x:null,y:null},this.emitter=rb(),this.element.addEventListener("wheel",this.onWheel,{passive:!1}),this.element.addEventListener("touchstart",this.onTouchStart,{passive:!1}),this.element.addEventListener("touchmove",this.onTouchMove,{passive:!1}),this.element.addEventListener("touchend",this.onTouchEnd,{passive:!1})}on(e,t){return this.emitter.on(e,t)}destroy(){this.emitter.events={},this.element.removeEventListener("wheel",this.onWheel,{passive:!1}),this.element.removeEventListener("touchstart",this.onTouchStart,{passive:!1}),this.element.removeEventListener("touchmove",this.onTouchMove,{passive:!1}),this.element.removeEventListener("touchend",this.onTouchEnd,{passive:!1})}}class ab{constructor({direction:e,gestureDirection:t,mouseMultiplier:i,smooth:n,wrapper:r=window,content:s=document.documentElement,wheelEventsTarget:a=r,smoothWheel:o=null==n||n,smoothTouch:l=!1,syncTouch:c=!1,syncTouchLerp:h=.1,touchInertiaMultiplier:d=35,duration:u,easing:p=(e=>Math.min(1,1.001-Math.pow(2,-10*e))),lerp:f=(u?null:.1),infinite:m=!1,orientation:g=(null!=e?e:"vertical"),gestureOrientation:v=(null!=t?t:"vertical"),touchMultiplier:_=1,wheelMultiplier:y=(null!=i?i:1),normalizeWheel:b=!1}={}){this.onVirtualScroll=({type:e,inertia:t,deltaX:i,deltaY:n,event:r})=>{if(r.ctrlKey)return;const s="touch"===e,a="wheel"===e;if("vertical"===this.options.gestureOrientation&&0===n||"horizontal"===this.options.gestureOrientation&&0===i||s&&"vertical"===this.options.gestureOrientation&&0===this.scroll&&!this.options.infinite&&n<=0)return;if(r.composedPath().find((e=>null==e||null==e.hasAttribute?void 0:e.hasAttribute("data-lenis-prevent"))))return;if(this.isStopped||this.isLocked)return void r.preventDefault();if(this.isSmooth=(this.options.smoothTouch||this.options.syncTouch)&&s||this.options.smoothWheel&&a,!this.isSmooth)return this.isScrolling=!1,void this.animate.stop();r.preventDefault();let o=n;"both"===this.options.gestureOrientation?o=Math.abs(n)>Math.abs(i)?n:i:"horizontal"===this.options.gestureOrientation&&(o=i);const l=s&&this.options.syncTouch,c=s&&t&&Math.abs(o)>1;c&&(o=this.velocity*this.options.touchInertiaMultiplier),this.scrollTo(this.targetScroll+o,Qy({programmatic:!1},l&&{lerp:c?this.syncTouchLerp:.4}))},this.onScroll=()=>{if(!this.isScrolling){const e=this.animatedScroll;this.animatedScroll=this.targetScroll=this.actualScroll,this.velocity=0,this.direction=Math.sign(this.animatedScroll-e),this.emit()}},e&&console.warn("Lenis: `direction` option is deprecated, use `orientation` instead"),t&&console.warn("Lenis: `gestureDirection` option is deprecated, use `gestureOrientation` instead"),i&&console.warn("Lenis: `mouseMultiplier` option is deprecated, use `wheelMultiplier` instead"),n&&console.warn("Lenis: `smooth` option is deprecated, use `smoothWheel` instead"),window.lenisVersion="1.0.10",r!==document.documentElement&&r!==document.body||(r=window),this.options={wrapper:r,content:s,wheelEventsTarget:a,smoothWheel:o,smoothTouch:l,syncTouch:c,syncTouchLerp:h,touchInertiaMultiplier:d,duration:u,easing:p,lerp:f,infinite:m,gestureOrientation:v,orientation:g,touchMultiplier:_,wheelMultiplier:y,normalizeWheel:b},this.dimensions=new nb(r,s),this.rootElement.classList.add("lenis"),this.velocity=0,this.isStopped=!1,this.isSmooth=o||l,this.isScrolling=!1,this.targetScroll=this.animatedScroll=this.actualScroll,this.animate=new tb,this.emitter=rb(),this.options.wrapper.addEventListener("scroll",this.onScroll,{passive:!1}),this.virtualScroll=new sb(a,{touchMultiplier:_,wheelMultiplier:y,normalizeWheel:b}),this.virtualScroll.on("scroll",this.onVirtualScroll)}destroy(){this.emitter.events={},this.options.wrapper.removeEventListener("scroll",this.onScroll,{passive:!1}),this.virtualScroll.destroy()}on(e,t){return this.emitter.on(e,t)}off(e,t){var i;this.emitter.events[e]=null==(i=this.emitter.events[e])?void 0:i.filter((e=>t!==e))}setScroll(e){this.isHorizontal?this.rootElement.scrollLeft=e:this.rootElement.scrollTop=e}emit(){this.emitter.emit("scroll",this)}reset(){this.isLocked=!1,this.isScrolling=!1,this.velocity=0,this.animate.stop()}start(){this.isStopped=!1,this.reset()}stop(){this.isStopped=!0,this.animate.stop(),this.reset()}raf(e){const t=e-(this.time||e);this.time=e,this.animate.advance(.001*t)}scrollTo(e,{offset:t=0,immediate:i=!1,lock:n=!1,duration:r=this.options.duration,easing:s=this.options.easing,lerp:a=!r&&this.options.lerp,onComplete:o=null,force:l=!1,programmatic:c=!0}={}){if(!this.isStopped||l){if(["top","left","start"].includes(e))e=0;else if(["bottom","right","end"].includes(e))e=this.limit;else{var h;let i;if("string"==typeof e?i=document.querySelector(e):null!=(h=e)&&h.nodeType&&(i=e),i){if(this.options.wrapper!==window){const e=this.options.wrapper.getBoundingClientRect();t-=this.isHorizontal?e.left:e.top}const n=i.getBoundingClientRect();e=(this.isHorizontal?n.left:n.top)+this.animatedScroll}}if("number"==typeof e){if(e+=t,this.options.infinite?c&&(this.targetScroll=this.animatedScroll=this.scroll):e=eb(0,e,this.limit),i)return this.animatedScroll=this.targetScroll=e,this.setScroll(this.scroll),this.reset(),this.emit(),void(null==o||o());if(!c){if(e===this.targetScroll)return;this.targetScroll=e}this.animate.fromTo(this.animatedScroll,e,{duration:r,easing:s,lerp:a,onUpdate:(e,{completed:t})=>{n&&(this.isLocked=!0),this.isScrolling=!0,this.velocity=e-this.animatedScroll,this.direction=Math.sign(this.velocity),this.animatedScroll=e,this.setScroll(this.scroll),c&&(this.targetScroll=e),t&&(n&&(this.isLocked=!1),requestAnimationFrame((()=>{this.isScrolling=!1})),this.velocity=0,null==o||o()),this.emit()}})}}}get rootElement(){return this.options.wrapper===window?this.options.content:this.options.wrapper}get limit(){return this.isHorizontal?this.dimensions.limit.x:this.dimensions.limit.y}get isHorizontal(){return"horizontal"===this.options.orientation}get actualScroll(){return this.isHorizontal?this.rootElement.scrollLeft:this.rootElement.scrollTop}get scroll(){return this.options.infinite?function(e,t){let i=e%t;return(t>0&&i<0||t<0&&i>0)&&(i+=t),i}(this.animatedScroll,this.limit):this.animatedScroll}get progress(){return 0===this.limit?1:this.scroll/this.limit}get isSmooth(){return this.__isSmooth}set isSmooth(e){this.__isSmooth!==e&&(this.rootElement.classList.toggle("lenis-smooth",e),this.__isSmooth=e)}get isScrolling(){return this.__isScrolling}set isScrolling(e){this.__isScrolling!==e&&(this.rootElement.classList.toggle("lenis-scrolling",e),this.__isScrolling=e)}get isStopped(){return this.__isStopped}set isStopped(e){this.__isStopped!==e&&(this.rootElement.classList.toggle("lenis-stopped",e),this.__isStopped=e)}}function ob(e,t="max"){return window.matchMedia(`(${t}-width: ${e}px)`).matches}ob(991.98);const lb=ob(767.98);function cb(e,t="active"){e.classList.add(t)}function hb({el:e,event:t,detail:i}){e.dispatchEvent(new CustomEvent(t,{detail:i}))}function db(e,t){sessionStorage.setItem(e,JSON.stringify(t))}function ub(){let e=gsap.matchMedia();document.querySelectorAll(".scroll-down__link").forEach((e=>{e.addEventListener("click",(()=>{let e=80*window.innerHeight/100,t=window.pageYOffset+e;gsap.to(window,{duration:1,scrollTo:t})}))})),document.querySelector(".intro__bg-btn-prev");const t=document.querySelector(".intro__bg-btn-next"),i=document.querySelector(".intro-second");t.addEventListener("click",(()=>{!function(e,t){if(window.innerHeight+window.scrollY>=document.body.scrollHeight)return i.classList.add(e),void i.classList.remove(t);const n=window.scrollY,r=document.body.scrollHeight-window.innerHeight-n,s=performance.now();requestAnimationFrame((function a(o){const l=o-s,c=function(e){return 1- --e*e*e*e}(Math.min(l/800,1));window.scrollTo(0,n+r*c),l<800?requestAnimationFrame(a):(i.classList.add(e),i.classList.remove(t))}))}("introNext")})),e.add("(max-width: 4000px) and (min-width: 767.99px)",(()=>{let e=gsap.timeline({scrollTrigger:{trigger:".intro-second",start:"top 30%",end:"bottom bottom",scrub:2},onComplete:()=>{}});e.to(".intro__container",{clipPath:"inset(10% 15% round 18px)",ease:"power2.out"}),e.to(".intro__img",{scale:1.1,ease:"power2.out"},"<")})),e.add("(max-width: 767.98px) and (min-width: 320px)",(()=>{let e=gsap.timeline({scrollTrigger:{trigger:".intro-second",start:"top 30%",end:"bottom bottom",scrub:2},onComplete:()=>{}});e.to(".intro__container",{clipPath:"inset(15% 10% round 0px)"}),e.to(".intro__img",{scale:1.1},"<")}))}const pb=(e,t=1e4)=>(e=parseFloat(e+"")||0,Math.round((e+Number.EPSILON)*t)/t),fb=function(e){if(!(e&&e instanceof Element&&e.offsetParent))return!1;const t=e.scrollHeight>e.clientHeight,i=window.getComputedStyle(e).overflowY,n=-1!==i.indexOf("hidden"),r=-1!==i.indexOf("visible");return t&&!n&&!r},mb=function(e,t){return!(!e||e===document.body||t&&e===t)&&(fb(e)?e:mb(e.parentElement,t))},gb=function(e){var t=(new DOMParser).parseFromString(e,"text/html").body;if(t.childElementCount>1){for(var i=document.createElement("div");t.firstChild;)i.appendChild(t.firstChild);return i}return t.firstChild},vb=e=>`${e||""}`.split(" ").filter((e=>!!e)),_b=(e,t,i)=>{vb(t).forEach((t=>{e&&e.classList.toggle(t,i||!1)}))};class yb{constructor(e){Object.defineProperty(this,"pageX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pageY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nativePointer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.nativePointer=e,this.pageX=e.pageX,this.pageY=e.pageY,this.clientX=e.clientX,this.clientY=e.clientY,this.id=self.Touch&&e instanceof Touch?e.identifier:-1,this.time=Date.now()}}const bb={passive:!1};class xb{constructor(e,{start:t=(()=>!0),move:i=(()=>{}),end:n=(()=>{})}){Object.defineProperty(this,"element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moveCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"endCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"currentPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"startPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.element=e,this.startCallback=t,this.moveCallback=i,this.endCallback=n;for(const e of["onPointerStart","onTouchStart","onMove","onTouchEnd","onPointerEnd","onWindowBlur"])this[e]=this[e].bind(this);this.element.addEventListener("mousedown",this.onPointerStart,bb),this.element.addEventListener("touchstart",this.onTouchStart,bb),this.element.addEventListener("touchmove",this.onMove,bb),this.element.addEventListener("touchend",this.onTouchEnd),this.element.addEventListener("touchcancel",this.onTouchEnd)}onPointerStart(e){if(!e.buttons||0!==e.button)return;const t=new yb(e);this.currentPointers.some((e=>e.id===t.id))||this.triggerPointerStart(t,e)&&(window.addEventListener("mousemove",this.onMove),window.addEventListener("mouseup",this.onPointerEnd),window.addEventListener("blur",this.onWindowBlur))}onTouchStart(e){for(const t of Array.from(e.changedTouches||[]))this.triggerPointerStart(new yb(t),e);window.addEventListener("blur",this.onWindowBlur)}onMove(e){const t=this.currentPointers.slice(),i="changedTouches"in e?Array.from(e.changedTouches||[]).map((e=>new yb(e))):[new yb(e)],n=[];for(const e of i){const t=this.currentPointers.findIndex((t=>t.id===e.id));t<0||(n.push(e),this.currentPointers[t]=e)}n.length&&this.moveCallback(e,this.currentPointers.slice(),t)}onPointerEnd(e){e.buttons>0&&0!==e.button||(this.triggerPointerEnd(e,new yb(e)),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur))}onTouchEnd(e){for(const t of Array.from(e.changedTouches||[]))this.triggerPointerEnd(e,new yb(t))}triggerPointerStart(e,t){return!!this.startCallback(t,e,this.currentPointers.slice())&&(this.currentPointers.push(e),this.startPointers.push(e),!0)}triggerPointerEnd(e,t){const i=this.currentPointers.findIndex((e=>e.id===t.id));i<0||(this.currentPointers.splice(i,1),this.startPointers.splice(i,1),this.endCallback(e,t,this.currentPointers.slice()))}onWindowBlur(){this.clear()}clear(){for(;this.currentPointers.length;){const e=this.currentPointers[this.currentPointers.length-1];this.currentPointers.splice(this.currentPointers.length-1,1),this.startPointers.splice(this.currentPointers.length-1,1),this.endCallback(new Event("touchend",{bubbles:!0,cancelable:!0,clientX:e.clientX,clientY:e.clientY}),e,this.currentPointers.slice())}}stop(){this.element.removeEventListener("mousedown",this.onPointerStart,bb),this.element.removeEventListener("touchstart",this.onTouchStart,bb),this.element.removeEventListener("touchmove",this.onMove,bb),this.element.removeEventListener("touchend",this.onTouchEnd),this.element.removeEventListener("touchcancel",this.onTouchEnd),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur)}}function wb(e,t){return t?Math.sqrt(Math.pow(t.clientX-e.clientX,2)+Math.pow(t.clientY-e.clientY,2)):0}function Eb(e,t){return t?{clientX:(e.clientX+t.clientX)/2,clientY:(e.clientY+t.clientY)/2}:e}const Sb=e=>"object"==typeof e&&null!==e&&e.constructor===Object&&"[object Object]"===Object.prototype.toString.call(e),Tb=(e,...t)=>{const i=t.length;for(let n=0;n<i;n++){const i=t[n]||{};Object.entries(i).forEach((([t,i])=>{const n=Array.isArray(i)?[]:{};e[t]||Object.assign(e,{[t]:n}),Sb(i)?Object.assign(e[t],Tb(n,i)):Array.isArray(i)?Object.assign(e,{[t]:[...i]}):Object.assign(e,{[t]:i})}))}return e},Mb=function(e,t){return e.split(".").reduce(((e,t)=>"object"==typeof e?e[t]:void 0),t)};class Ab{constructor(e={}){Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this.setOptions(e);for(const e of Object.getOwnPropertyNames(Object.getPrototypeOf(this)))e.startsWith("on")&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}setOptions(e){this.options=e?Tb({},this.constructor.defaults,e):{};for(const[e,t]of Object.entries(this.option("on")||{}))this.on(e,t)}option(e,...t){let i=Mb(e,this.options);return i&&"function"==typeof i&&(i=i.call(this,this,...t)),i}optionFor(e,t,i,...n){let r=Mb(t,e);var s;"string"!=typeof(s=r)||isNaN(s)||isNaN(parseFloat(s))||(r=parseFloat(r)),"true"===r&&(r=!0),"false"===r&&(r=!1),r&&"function"==typeof r&&(r=r.call(this,this,e,...n));let a=Mb(t,this.options);return a&&"function"==typeof a?r=a.call(this,this,e,...n,r):void 0===r&&(r=a),void 0===r?i:r}cn(e){const t=this.options.classes;return t&&t[e]||""}localize(e,t=[]){e=String(e).replace(/\{\{(\w+).?(\w+)?\}\}/g,((e,t,i)=>{let n="";return i?n=this.option(`${t[0]+t.toLowerCase().substring(1)}.l10n.${i}`):t&&(n=this.option(`l10n.${t}`)),n||(n=e),n}));for(let i=0;i<t.length;i++)e=e.split(t[i][0]).join(t[i][1]);return e.replace(/\{\{(.*?)\}\}/g,((e,t)=>t))}on(e,t){let i=[];"string"==typeof e?i=e.split(" "):Array.isArray(e)&&(i=e),this.events||(this.events=new Map),i.forEach((e=>{let i=this.events.get(e);i||(this.events.set(e,[]),i=[]),i.includes(t)||i.push(t),this.events.set(e,i)}))}off(e,t){let i=[];"string"==typeof e?i=e.split(" "):Array.isArray(e)&&(i=e),i.forEach((e=>{const i=this.events.get(e);if(Array.isArray(i)){const e=i.indexOf(t);e>-1&&i.splice(e,1)}}))}emit(e,...t){[...this.events.get(e)||[]].forEach((e=>e(this,...t))),"*"!==e&&this.emit("*",e,...t)}}Object.defineProperty(Ab,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.17"}),Object.defineProperty(Ab,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{}});class Cb extends Ab{constructor(e={}){super(e),Object.defineProperty(this,"plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}})}attachPlugins(e={}){const t=new Map;for(const[i,n]of Object.entries(e)){const e=this.option(i),r=this.plugins[i];r||!1===e?r&&!1===e&&(r.detach(),delete this.plugins[i]):t.set(i,new n(this,e||{}))}for(const[e,i]of t)this.plugins[e]=i,i.attach();this.emit("attachPlugins")}detachPlugins(e){e=e||Object.keys(this.plugins);for(const t of e){const e=this.plugins[t];e&&e.detach(),delete this.plugins[t]}return this.emit("detachPlugins"),this}}var Lb;!function(e){e[e.Init=0]="Init",e[e.Error=1]="Error",e[e.Ready=2]="Ready",e[e.Panning=3]="Panning",e[e.Mousemove=4]="Mousemove",e[e.Destroy=5]="Destroy"}(Lb||(Lb={}));const Pb=["a","b","c","d","e","f"],Rb={PANUP:"Move up",PANDOWN:"Move down",PANLEFT:"Move left",PANRIGHT:"Move right",ZOOMIN:"Zoom in",ZOOMOUT:"Zoom out",TOGGLEZOOM:"Toggle zoom level",TOGGLE1TO1:"Toggle zoom level",ITERATEZOOM:"Toggle zoom level",ROTATECCW:"Rotate counterclockwise",ROTATECW:"Rotate clockwise",FLIPX:"Flip horizontally",FLIPY:"Flip vertically",FITX:"Fit horizontally",FITY:"Fit vertically",RESET:"Reset",TOGGLEFS:"Toggle fullscreen"},Ob={content:null,width:"auto",height:"auto",panMode:"drag",touch:!0,dragMinThreshold:3,lockAxis:!1,mouseMoveFactor:1,mouseMoveFriction:.12,zoom:!0,pinchToZoom:!0,panOnlyZoomed:"auto",minScale:1,maxScale:2,friction:.25,dragFriction:.35,decelFriction:.05,click:"toggleZoom",dblClick:!1,wheel:"zoom",wheelLimit:7,spinner:!0,bounds:"auto",infinite:!1,rubberband:!0,bounce:!0,maxVelocity:75,transformParent:!1,classes:{content:"f-panzoom__content",isLoading:"is-loading",canZoomIn:"can-zoom_in",canZoomOut:"can-zoom_out",isDraggable:"is-draggable",isDragging:"is-dragging",inFullscreen:"in-fullscreen",htmlHasFullscreen:"with-panzoom-in-fullscreen"},l10n:Rb},Ib='<div class="f-spinner"><svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20"></circle><circle cx="25" cy="25" r="20"></circle></svg></div>',Db=e=>e&&null!==e&&e instanceof Element&&"nodeType"in e,Nb=(e,t)=>{e&&vb(t).forEach((t=>{e.classList.remove(t)}))},Ub=(e,t)=>{e&&vb(t).forEach((t=>{e.classList.add(t)}))},Fb={a:1,b:0,c:0,d:1,e:0,f:0};let zb=null,kb=null;class Hb extends Cb{get isTouchDevice(){return null===kb&&(kb=window.matchMedia("(hover: none)").matches),kb}get isMobile(){return null===zb&&(zb=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)),zb}get panMode(){return"mousemove"!==this.options.panMode||this.isTouchDevice?"drag":"mousemove"}get panOnlyZoomed(){const e=this.options.panOnlyZoomed;return"auto"===e?this.isTouchDevice:e}get isInfinite(){return this.option("infinite")}get angle(){return 180*Math.atan2(this.current.b,this.current.a)/Math.PI||0}get targetAngle(){return 180*Math.atan2(this.target.b,this.target.a)/Math.PI||0}get scale(){const{a:e,b:t}=this.current;return Math.sqrt(e*e+t*t)||1}get targetScale(){const{a:e,b:t}=this.target;return Math.sqrt(e*e+t*t)||1}get minScale(){return this.option("minScale")||1}get fullScale(){const{contentRect:e}=this;return e.fullWidth/e.fitWidth||1}get maxScale(){return this.fullScale*(this.option("maxScale")||1)||1}get coverScale(){const{containerRect:e,contentRect:t}=this,i=Math.max(e.height/t.fitHeight,e.width/t.fitWidth)||1;return Math.min(this.fullScale,i)}get isScaling(){return Math.abs(this.targetScale-this.scale)>1e-5&&!this.isResting}get isContentLoading(){const e=this.content;return!!(e&&e instanceof HTMLImageElement)&&!e.complete}get isResting(){if(this.isBouncingX||this.isBouncingY)return!1;for(const e of Pb){const t="e"==e||"f"===e?.001:1e-5;if(Math.abs(this.target[e]-this.current[e])>t)return!1}return!(!this.ignoreBounds&&!this.checkBounds().inBounds)}constructor(e,t={},i={}){var n;if(super(t),Object.defineProperty(this,"pointerTracker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"resizeObserver",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"updateTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"rAF",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isTicking",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"friction",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"ignoreBounds",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingX",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingY",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"clicks",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"trackingPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"cwd",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"pmme",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Lb.Init}),Object.defineProperty(this,"isDragging",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"spinner",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"containerRect",{enumerable:!0,configurable:!0,writable:!0,value:{width:0,height:0,innerWidth:0,innerHeight:0}}),Object.defineProperty(this,"contentRect",{enumerable:!0,configurable:!0,writable:!0,value:{top:0,right:0,bottom:0,left:0,fullWidth:0,fullHeight:0,fitWidth:0,fitHeight:0,width:0,height:0}}),Object.defineProperty(this,"dragStart",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,top:0,left:0,time:0}}),Object.defineProperty(this,"dragOffset",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,time:0}}),Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},Fb)}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},Fb)}),Object.defineProperty(this,"velocity",{enumerable:!0,configurable:!0,writable:!0,value:{a:0,b:0,c:0,d:0,e:0,f:0}}),Object.defineProperty(this,"lockedAxis",{enumerable:!0,configurable:!0,writable:!0,value:!1}),!e)throw new Error("Container Element Not Found");this.container=e,this.initContent(),this.attachPlugins(Object.assign(Object.assign({},Hb.Plugins),i)),this.emit("init");const r=this.content;if(r.addEventListener("load",this.onLoad),r.addEventListener("error",this.onError),this.isContentLoading){if(this.option("spinner")){e.classList.add(this.cn("isLoading"));const t=gb(Ib);!e.contains(r)||r.parentElement instanceof HTMLPictureElement?this.spinner=e.appendChild(t):this.spinner=(null===(n=r.parentElement)||void 0===n?void 0:n.insertBefore(t,r))||null}this.emit("beforeLoad")}else queueMicrotask((()=>{this.enable()}))}initContent(){const{container:e}=this,t=this.cn("content");let i=this.option("content")||e.querySelector(`.${t}`);if(i||(i=e.querySelector("img,picture")||e.firstElementChild,i&&Ub(i,t)),i instanceof HTMLPictureElement&&(i=i.querySelector("img")),!i)throw new Error("No content found");this.content=i}onLoad(){this.spinner&&(this.spinner.remove(),this.spinner=null),this.option("spinner")&&this.container.classList.remove(this.cn("isLoading")),this.emit("afterLoad"),this.state===Lb.Init?this.enable():this.updateMetrics()}onError(){this.state!==Lb.Destroy&&(this.spinner&&(this.spinner.remove(),this.spinner=null),this.stop(),this.detachEvents(),this.state=Lb.Error,this.emit("error"))}attachObserver(){var e;const t=()=>Math.abs(this.containerRect.width-this.container.getBoundingClientRect().width)>.1||Math.abs(this.containerRect.height-this.container.getBoundingClientRect().height)>.1;this.resizeObserver||void 0===window.ResizeObserver||(this.resizeObserver=new ResizeObserver((()=>{this.updateTimer||(t()?(this.onResize(),this.isMobile&&(this.updateTimer=setTimeout((()=>{t()&&this.onResize(),this.updateTimer=null}),500))):this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null))}))),null===(e=this.resizeObserver)||void 0===e||e.observe(this.container)}detachObserver(){var e;null===(e=this.resizeObserver)||void 0===e||e.disconnect()}attachEvents(){const{container:e}=this;e.addEventListener("click",this.onClick,{passive:!1,capture:!1}),e.addEventListener("wheel",this.onWheel,{passive:!1}),this.pointerTracker=new xb(e,{start:this.onPointerDown,move:this.onPointerMove,end:this.onPointerUp}),document.addEventListener("mousemove",this.onMouseMove)}detachEvents(){var e;const{container:t}=this;t.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),t.removeEventListener("wheel",this.onWheel,{passive:!1}),null===(e=this.pointerTracker)||void 0===e||e.stop(),this.pointerTracker=null,document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("keydown",this.onKeydown,!0),this.clickTimer&&(clearTimeout(this.clickTimer),this.clickTimer=null),this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null)}animate(){const e=this.friction;this.setTargetForce();const t=this.option("maxVelocity");for(const i of Pb)e?(this.velocity[i]*=1-e,t&&!this.isScaling&&(this.velocity[i]=Math.max(Math.min(this.velocity[i],t),-1*t)),this.current[i]+=this.velocity[i]):this.current[i]=this.target[i];this.setTransform(),this.setEdgeForce(),!this.isResting||this.isDragging?this.rAF=requestAnimationFrame((()=>this.animate())):this.stop("current")}setTargetForce(){for(const e of Pb)"e"===e&&this.isBouncingX||"f"===e&&this.isBouncingY||(this.velocity[e]=(1/(1-this.friction)-1)*(this.target[e]-this.current[e]))}checkBounds(e=0,t=0){const{current:i}=this,n=i.e+e,r=i.f+t,s=this.getBounds(),{x:a,y:o}=s,l=a.min,c=a.max,h=o.min,d=o.max;let u=0,p=0;return l!==1/0&&n<l?u=l-n:c!==1/0&&n>c&&(u=c-n),h!==1/0&&r<h?p=h-r:d!==1/0&&r>d&&(p=d-r),Math.abs(u)<.001&&(u=0),Math.abs(p)<.001&&(p=0),Object.assign(Object.assign({},s),{xDiff:u,yDiff:p,inBounds:!u&&!p})}clampTargetBounds(){const{target:e}=this,{x:t,y:i}=this.getBounds();t.min!==1/0&&(e.e=Math.max(e.e,t.min)),t.max!==1/0&&(e.e=Math.min(e.e,t.max)),i.min!==1/0&&(e.f=Math.max(e.f,i.min)),i.max!==1/0&&(e.f=Math.min(e.f,i.max))}calculateContentDim(e=this.current){const{content:t,contentRect:i}=this,{fitWidth:n,fitHeight:r,fullWidth:s,fullHeight:a}=i;let o=s,l=a;if(this.option("zoom")||0!==this.angle){const i=!(t instanceof HTMLImageElement||"none"!==window.getComputedStyle(t).maxWidth&&"none"!==window.getComputedStyle(t).maxHeight),c=i?s:n,h=i?a:r,d=this.getMatrix(e),u=new DOMPoint(0,0).matrixTransform(d),p=new DOMPoint(0+c,0).matrixTransform(d),f=new DOMPoint(0+c,0+h).matrixTransform(d),m=new DOMPoint(0,0+h).matrixTransform(d),g=Math.abs(f.x-u.x),v=Math.abs(f.y-u.y),_=Math.abs(m.x-p.x),y=Math.abs(m.y-p.y);o=Math.max(g,_),l=Math.max(v,y)}return{contentWidth:o,contentHeight:l}}setEdgeForce(){if(this.ignoreBounds||this.isDragging||"mousemove"===this.panMode||this.targetScale<this.scale)return this.isBouncingX=!1,void(this.isBouncingY=!1);const{target:e}=this,{x:t,y:i,xDiff:n,yDiff:r}=this.checkBounds(),s=this.option("maxVelocity");let a=this.velocity.e,o=this.velocity.f;0!==n?(this.isBouncingX=!0,n*a<=0?a+=.14*n:(a=.14*n,t.min!==1/0&&(this.target.e=Math.max(e.e,t.min)),t.max!==1/0&&(this.target.e=Math.min(e.e,t.max))),s&&(a=Math.max(Math.min(a,s),-1*s))):this.isBouncingX=!1,0!==r?(this.isBouncingY=!0,r*o<=0?o+=.14*r:(o=.14*r,i.min!==1/0&&(this.target.f=Math.max(e.f,i.min)),i.max!==1/0&&(this.target.f=Math.min(e.f,i.max))),s&&(o=Math.max(Math.min(o,s),-1*s))):this.isBouncingY=!1,this.isBouncingX&&(this.velocity.e=a),this.isBouncingY&&(this.velocity.f=o)}enable(){const{content:e}=this,t=new DOMMatrixReadOnly(window.getComputedStyle(e).transform);for(const e of Pb)this.current[e]=this.target[e]=t[e];this.updateMetrics(),this.attachObserver(),this.attachEvents(),this.state=Lb.Ready,this.emit("ready")}onClick(e){var t;this.isDragging&&(null===(t=this.pointerTracker)||void 0===t||t.clear(),this.trackingPoints=[],this.startDecelAnim());const i=e.target;if(!i||e.defaultPrevented)return;if(i&&i.hasAttribute("disabled"))return e.preventDefault(),void e.stopPropagation();if((()=>{const e=window.getSelection();return e&&"Range"===e.type})()&&!i.closest("button"))return;const n=i.closest("[data-panzoom-action]"),r=i.closest("[data-panzoom-change]"),s=n||r,a=s&&Db(s)?s.dataset:null;if(a){const t=a.panzoomChange,i=a.panzoomAction;if((t||i)&&e.preventDefault(),t){let i={};try{i=JSON.parse(t)}catch(e){console&&console.warn("The given data was not valid JSON")}return void this.applyChange(i)}if(i)return void(this[i]&&this[i]())}if(Math.abs(this.dragOffset.x)>3||Math.abs(this.dragOffset.y)>3)return e.preventDefault(),void e.stopPropagation();const o=this.content.getBoundingClientRect();if(this.dragStart.time&&!this.canZoomOut()&&(Math.abs(o.x-this.dragStart.x)>2||Math.abs(o.y-this.dragStart.y)>2))return;this.dragStart.time=0;const l=t=>{this.option("zoom")&&t&&"string"==typeof t&&/(iterateZoom)|(toggle(Zoom|Full|Cover|Max)|(zoomTo(Fit|Cover|Max)))/.test(t)&&"function"==typeof this[t]&&(e.preventDefault(),this[t]({event:e}))},c=this.option("click",e),h=this.option("dblClick",e);h?(this.clicks++,1==this.clicks&&(this.clickTimer=setTimeout((()=>{1===this.clicks?(this.emit("click",e),!e.defaultPrevented&&c&&l(c)):(this.emit("dblClick",e),e.defaultPrevented||l(h)),this.clicks=0,this.clickTimer=null}),350))):(this.emit("click",e),!e.defaultPrevented&&c&&l(c))}addTrackingPoint(e){const t=this.trackingPoints.filter((e=>e.time>Date.now()-100));t.push(e),this.trackingPoints=t}onPointerDown(e,t,i){var n;this.pwt=0,this.dragOffset={x:0,y:0,time:0},this.trackingPoints=[];const r=this.content.getBoundingClientRect();if(this.dragStart={x:r.x,y:r.y,top:r.top,left:r.left,time:Date.now()},this.clickTimer)return!1;if("mousemove"===this.panMode&&this.targetScale>1)return e.preventDefault(),e.stopPropagation(),!1;if(!i.length){const t=e.composedPath()[0];if(["A","TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].includes(t.nodeName)||t.closest("[contenteditable]")||t.closest("[data-selectable]")||t.closest("[data-panzoom-change]")||t.closest("[data-panzoom-action]"))return!1;null===(n=window.getSelection())||void 0===n||n.removeAllRanges()}if("mousedown"===e.type)e.preventDefault();else if(Math.abs(this.velocity.a)>.3)return!1;return this.target.e=this.current.e,this.target.f=this.current.f,this.stop(),this.isDragging||(this.isDragging=!0,this.addTrackingPoint(t),this.emit("touchStart",e)),!0}onPointerMove(e,t,i){if(!1===this.option("touch",e))return;if(!this.isDragging)return;if(t.length<2&&this.panOnlyZoomed&&pb(this.targetScale)<=pb(this.minScale))return;if(this.emit("touchMove",e),e.defaultPrevented)return;this.addTrackingPoint(t[0]);const{content:n}=this,r=Eb(i[0],i[1]),s=Eb(t[0],t[1]);let a=0,o=0;if(t.length>1){const e=n.getBoundingClientRect();a=r.clientX-e.left-.5*e.width,o=r.clientY-e.top-.5*e.height}const l=wb(i[0],i[1]),c=wb(t[0],t[1]);let h=l?c/l:1,d=s.clientX-r.clientX,u=s.clientY-r.clientY;this.dragOffset.x+=d,this.dragOffset.y+=u,this.dragOffset.time=Date.now()-this.dragStart.time;let p=pb(this.targetScale)===pb(this.minScale)&&this.option("lockAxis");if(p&&!this.lockedAxis)if("xy"===p||"y"===p||"touchmove"===e.type){if(Math.abs(this.dragOffset.x)<6&&Math.abs(this.dragOffset.y)<6)return void e.preventDefault();const t=Math.abs(180*Math.atan2(this.dragOffset.y,this.dragOffset.x)/Math.PI);this.lockedAxis=t>45&&t<135?"y":"x",this.dragOffset.x=0,this.dragOffset.y=0,d=0,u=0}else this.lockedAxis=p;if(mb(e.target,this.content)&&(p="x",this.dragOffset.y=0),p&&"xy"!==p&&this.lockedAxis!==p&&pb(this.targetScale)===pb(this.minScale))return;e.cancelable&&e.preventDefault(),this.container.classList.add(this.cn("isDragging"));const f=this.checkBounds(d,u);this.option("rubberband")?("x"!==this.isInfinite&&(f.xDiff>0&&d<0||f.xDiff<0&&d>0)&&(d*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitWidth*f.xDiff))),"y"!==this.isInfinite&&(f.yDiff>0&&u<0||f.yDiff<0&&u>0)&&(u*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitHeight*f.yDiff)))):(f.xDiff&&(d=0),f.yDiff&&(u=0));const m=this.targetScale,g=this.minScale,v=this.maxScale;m<.5*g&&(h=Math.max(h,g)),m>1.5*v&&(h=Math.min(h,v)),"y"===this.lockedAxis&&pb(m)===pb(g)&&(d=0),"x"===this.lockedAxis&&pb(m)===pb(g)&&(u=0),this.applyChange({originX:a,originY:o,panX:d,panY:u,scale:h,friction:this.option("dragFriction"),ignoreBounds:!0})}onPointerUp(e,t,i){if(i.length)return this.dragOffset.x=0,this.dragOffset.y=0,void(this.trackingPoints=[]);this.container.classList.remove(this.cn("isDragging")),this.isDragging&&(this.addTrackingPoint(t),this.panOnlyZoomed&&this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1&&(this.trackingPoints=[]),mb(e.target,this.content)&&"y"===this.lockedAxis&&(this.trackingPoints=[]),this.emit("touchEnd",e),this.isDragging=!1,this.lockedAxis=!1,this.state!==Lb.Destroy&&(e.defaultPrevented||this.startDecelAnim()))}startDecelAnim(){var e;const t=this.isScaling;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const e of Pb)this.velocity[e]=0;this.target.e=this.current.e,this.target.f=this.current.f,Nb(this.container,"is-scaling"),Nb(this.container,"is-animating"),this.isTicking=!1;const{trackingPoints:i}=this,n=i[0],r=i[i.length-1];let s=0,a=0,o=0;r&&n&&(s=r.clientX-n.clientX,a=r.clientY-n.clientY,o=r.time-n.time);const l=(null===(e=window.visualViewport)||void 0===e?void 0:e.scale)||1;1!==l&&(s*=l,a*=l);let c=0,h=0,d=0,u=0,p=this.option("decelFriction");const f=this.targetScale;if(o>0){d=Math.abs(s)>3?s/(o/30):0,u=Math.abs(a)>3?a/(o/30):0;const e=this.option("maxVelocity");e&&(d=Math.max(Math.min(d,e),-1*e),u=Math.max(Math.min(u,e),-1*e))}d&&(c=d/(1/(1-p)-1)),u&&(h=u/(1/(1-p)-1)),("y"===this.option("lockAxis")||"xy"===this.option("lockAxis")&&"y"===this.lockedAxis&&pb(f)===this.minScale)&&(c=d=0),("x"===this.option("lockAxis")||"xy"===this.option("lockAxis")&&"x"===this.lockedAxis&&pb(f)===this.minScale)&&(h=u=0);const m=this.dragOffset.x,g=this.dragOffset.y,v=this.option("dragMinThreshold")||0;Math.abs(m)<v&&Math.abs(g)<v&&(c=h=0,d=u=0),(f<this.minScale-1e-5||f>this.maxScale+1e-5||t&&!c&&!h)&&(p=.35),this.applyChange({panX:c,panY:h,friction:p}),this.emit("decel",d,u,m,g)}onWheel(e){var t=[-e.deltaX||0,-e.deltaY||0,-e.detail||0].reduce((function(e,t){return Math.abs(t)>Math.abs(e)?t:e}));const i=Math.max(-1,Math.min(1,t));if(this.emit("wheel",e,i),"mousemove"===this.panMode)return;if(e.defaultPrevented)return;const n=this.option("wheel");"pan"===n?(e.preventDefault(),this.panOnlyZoomed&&!this.canZoomOut()||this.applyChange({panX:2*-e.deltaX,panY:2*-e.deltaY,bounce:!1})):"zoom"===n&&!1!==this.option("zoom")&&this.zoomWithWheel(e)}onMouseMove(e){this.panWithMouse(e)}onKeydown(e){"Escape"===e.key&&this.toggleFS()}onResize(){this.updateMetrics(),this.checkBounds().inBounds||this.requestTick()}setTransform(){this.emit("beforeTransform");const{current:e,target:t,content:i,contentRect:n}=this,r=Object.assign({},Fb);for(const i of Pb){const n="e"==i||"f"===i?1e3:1e5;r[i]=pb(e[i],n),Math.abs(t[i]-e[i])<("e"==i||"f"===i?.51:.001)&&(e[i]=t[i])}let{a:s,b:a,c:o,d:l,e:c,f:h}=r,d=`matrix(${s}, ${a}, ${o}, ${l}, ${c}, ${h})`,u=i.parentElement instanceof HTMLPictureElement?i.parentElement:i;if(this.option("transformParent")&&(u=u.parentElement||u),u.style.transform===d)return;u.style.transform=d;const{contentWidth:p,contentHeight:f}=this.calculateContentDim();n.width=p,n.height=f,this.emit("afterTransform")}updateMetrics(e=!1){var t;if(!this||this.state===Lb.Destroy)return;if(this.isContentLoading)return;const i=Math.max(1,(null===(t=window.visualViewport)||void 0===t?void 0:t.scale)||1),{container:n,content:r}=this,s=r instanceof HTMLImageElement,a=n.getBoundingClientRect(),o=getComputedStyle(this.container);let l=a.width*i,c=a.height*i;const h=parseFloat(o.paddingTop)+parseFloat(o.paddingBottom),d=l-(parseFloat(o.paddingLeft)+parseFloat(o.paddingRight)),u=c-h;this.containerRect={width:l,height:c,innerWidth:d,innerHeight:u};let p=this.option("width")||"auto",f=this.option("height")||"auto";"auto"===p&&(p=parseFloat(r.dataset.width||"")||(e=>{let t=0;return t=e instanceof HTMLImageElement?e.naturalWidth:e instanceof SVGElement?e.width.baseVal.value:Math.max(e.offsetWidth,e.scrollWidth),t||0})(r)),"auto"===f&&(f=parseFloat(r.dataset.height||"")||(e=>{let t=0;return t=e instanceof HTMLImageElement?e.naturalHeight:e instanceof SVGElement?e.height.baseVal.value:Math.max(e.offsetHeight,e.scrollHeight),t||0})(r));let m=r.parentElement instanceof HTMLPictureElement?r.parentElement:r;this.option("transformParent")&&(m=m.parentElement||m);const g=m.getAttribute("style")||"";m.style.setProperty("transform","none","important"),s&&(m.style.width="",m.style.height=""),m.offsetHeight;const v=r.getBoundingClientRect();let _=v.width*i,y=v.height*i,b=0,x=0;s&&(Math.abs(p-_)>1||Math.abs(f-y)>1)&&({width:_,height:y,top:b,left:x}=((e,t,i,n)=>{const r=i/n;return r>e/t?(i=e,n=e/r):(i=t*r,n=t),{width:i,height:n,top:.5*(t-n),left:.5*(e-i)}})(_,y,p,f)),this.contentRect=Object.assign(Object.assign({},this.contentRect),{top:v.top-a.top+b,bottom:a.bottom-v.bottom+b,left:v.left-a.left+x,right:a.right-v.right+x,fitWidth:_,fitHeight:y,width:_,height:y,fullWidth:p,fullHeight:f}),m.style.cssText=g,s&&(m.style.width=`${_}px`,m.style.height=`${y}px`),this.setTransform(),!0!==e&&this.emit("refresh"),this.ignoreBounds||(pb(this.targetScale)<pb(this.minScale)?this.zoomTo(this.minScale,{friction:0}):this.targetScale>this.maxScale?this.zoomTo(this.maxScale,{friction:0}):this.state===Lb.Init||this.checkBounds().inBounds||this.requestTick()),this.updateControls()}getBounds(){const e=this.option("bounds");if("auto"!==e)return e;const{contentWidth:t,contentHeight:i}=this.calculateContentDim(this.target);let n=0,r=0,s=0,a=0;const o=this.option("infinite");if(!0===o||this.lockedAxis&&o===this.lockedAxis)n=-1/0,s=1/0,r=-1/0,a=1/0;else{let{containerRect:e,contentRect:o}=this,l=pb(this.contentRect.fitWidth*this.targetScale,1e3),c=pb(this.contentRect.fitHeight*this.targetScale,1e3),{innerWidth:h,innerHeight:d}=e;if(this.containerRect.width===l&&(h=e.width),this.containerRect.width===c&&(d=e.height),t>h){s=.5*(t-h),n=-1*s;let e=.5*(o.right-o.left);n+=e,s+=e}if(this.contentRect.fitWidth>h&&t<h&&(n-=.5*(this.contentRect.fitWidth-h),s-=.5*(this.contentRect.fitWidth-h)),i>d){a=.5*(i-d),r=-1*a;let e=.5*(o.bottom-o.top);r+=e,a+=e}this.contentRect.fitHeight>d&&i<d&&(n-=.5*(this.contentRect.fitHeight-d),s-=.5*(this.contentRect.fitHeight-d))}return{x:{min:n,max:s},y:{min:r,max:a}}}updateControls(){const e=this,t=e.container,{panMode:i,contentRect:n,fullScale:r,targetScale:s,coverScale:a,maxScale:o,minScale:l}=e;let c={toggleMax:s-l<.5*(o-l)?o:l,toggleCover:s-l<.5*(a-l)?a:l,toggleZoom:s-l<.5*(r-l)?r:l}[e.option("click")||""]||l,h=e.canZoomIn(),d=e.canZoomOut(),u=d&&"drag"===i;pb(s)<pb(l)&&!this.panOnlyZoomed&&(u=!0),(pb(n.width,1)>pb(n.fitWidth,1)||pb(n.height,1)>pb(n.fitHeight,1))&&(u=!0),pb(n.width*s,1)<pb(n.fitWidth,1)&&(u=!1),"mousemove"===i&&(u=!1);let p=h&&pb(c)>pb(s),f=!p&&!u&&d&&pb(c)<pb(s);_b(t,this.cn("canZoomIn"),p),_b(t,this.cn("canZoomOut"),f),_b(t,this.cn("isDraggable"),u);for(const e of t.querySelectorAll('[data-panzoom-action="zoomIn"]'))h?(e.removeAttribute("disabled"),e.removeAttribute("tabindex")):(e.setAttribute("disabled",""),e.setAttribute("tabindex","-1"));for(const e of t.querySelectorAll('[data-panzoom-action="zoomOut"]'))d?(e.removeAttribute("disabled"),e.removeAttribute("tabindex")):(e.setAttribute("disabled",""),e.setAttribute("tabindex","-1"));for(const e of t.querySelectorAll('[data-panzoom-action="toggleZoom"],[data-panzoom-action="iterateZoom"]')){h||d?(e.removeAttribute("disabled"),e.removeAttribute("tabindex")):(e.setAttribute("disabled",""),e.setAttribute("tabindex","-1"));const t=e.querySelector("g");t&&(t.style.display=h?"":"none")}}panTo({x:e=this.target.e,y:t=this.target.f,scale:i=this.targetScale,friction:n=this.option("friction"),angle:r=0,originX:s=0,originY:a=0,flipX:o=!1,flipY:l=!1,ignoreBounds:c=!1}){this.state!==Lb.Destroy&&this.applyChange({panX:e-this.target.e,panY:t-this.target.f,scale:i/this.targetScale,angle:r,originX:s,originY:a,friction:n,flipX:o,flipY:l,ignoreBounds:c})}applyChange({panX:e=0,panY:t=0,scale:i=1,angle:n=0,originX:r=-this.current.e,originY:s=-this.current.f,friction:a=this.option("friction"),flipX:o=!1,flipY:l=!1,ignoreBounds:c=!1,bounce:h=this.option("bounce")}){if(this.state===Lb.Destroy)return;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.friction=a||0,this.ignoreBounds=c;const{current:d}=this,u=d.e,p=d.f,f=this.getMatrix(this.target);let m=(new DOMMatrix).translate(u,p).translate(r,s).translate(e,t);if(this.option("zoom")){if(!c){const e=this.targetScale,t=this.minScale,n=this.maxScale;e*i<t&&(i=t/e),e*i>n&&(i=n/e)}m=m.scale(i)}m=m.translate(-r,-s).translate(-u,-p).multiply(f),n&&(m=m.rotate(n)),o&&(m=m.scale(-1,1)),l&&(m=m.scale(1,-1));for(const e of Pb)"e"!==e&&"f"!==e&&(m[e]>this.minScale+1e-5||m[e]<this.minScale-1e-5)?this.target[e]=m[e]:this.target[e]=pb(m[e],1e3);(this.targetScale<this.scale||Math.abs(i-1)>.1||"mousemove"===this.panMode||!1===h)&&!c&&this.clampTargetBounds(),this.isResting||(this.state=Lb.Panning,this.requestTick())}stop(e=!1){if(this.state===Lb.Init||this.state===Lb.Destroy)return;const t=this.isTicking;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const t of Pb)this.velocity[t]=0,"current"===e?this.current[t]=this.target[t]:"target"===e&&(this.target[t]=this.current[t]);this.setTransform(),Nb(this.container,"is-scaling"),Nb(this.container,"is-animating"),this.isTicking=!1,this.state=Lb.Ready,t&&(this.emit("endAnimation"),this.updateControls())}requestTick(){this.isTicking||(this.emit("startAnimation"),this.updateControls(),Ub(this.container,"is-animating"),this.isScaling&&Ub(this.container,"is-scaling")),this.isTicking=!0,this.rAF||(this.rAF=requestAnimationFrame((()=>this.animate())))}panWithMouse(e,t=this.option("mouseMoveFriction")){if(this.pmme=e,"mousemove"!==this.panMode||!e)return;if(pb(this.targetScale)<=pb(this.minScale))return;this.emit("mouseMove",e);const{container:i,containerRect:n,contentRect:r}=this,s=n.width,a=n.height,o=i.getBoundingClientRect(),l=(e.clientX||0)-o.left,c=(e.clientY||0)-o.top;let{contentWidth:h,contentHeight:d}=this.calculateContentDim(this.target);const u=this.option("mouseMoveFactor");u>1&&(h!==s&&(h*=u),d!==a&&(d*=u));let p=.5*(h-s)-l/s*100/100*(h-s);p+=.5*(r.right-r.left);let f=.5*(d-a)-c/a*100/100*(d-a);f+=.5*(r.bottom-r.top),this.applyChange({panX:p-this.target.e,panY:f-this.target.f,friction:t})}zoomWithWheel(e){if(this.state===Lb.Destroy||this.state===Lb.Init)return;const t=Date.now();if(t-this.pwt<45)return void e.preventDefault();this.pwt=t;var i=[-e.deltaX||0,-e.deltaY||0,-e.detail||0].reduce((function(e,t){return Math.abs(t)>Math.abs(e)?t:e}));const n=Math.max(-1,Math.min(1,i)),{targetScale:r,maxScale:s,minScale:a}=this;let o=r*(100+45*n)/100;pb(o)<pb(a)&&pb(r)<=pb(a)?(this.cwd+=Math.abs(n),o=a):pb(o)>pb(s)&&pb(r)>=pb(s)?(this.cwd+=Math.abs(n),o=s):(this.cwd=0,o=Math.max(Math.min(o,s),a)),this.cwd>this.option("wheelLimit")||(e.preventDefault(),pb(o)!==pb(r)&&this.zoomTo(o,{event:e}))}canZoomIn(){return this.option("zoom")&&(pb(this.contentRect.width,1)<pb(this.contentRect.fitWidth,1)||pb(this.targetScale)<pb(this.maxScale))}canZoomOut(){return this.option("zoom")&&pb(this.targetScale)>pb(this.minScale)}zoomIn(e=1.25,t){this.zoomTo(this.targetScale*e,t)}zoomOut(e=.8,t){this.zoomTo(this.targetScale*e,t)}zoomToFit(e){this.zoomTo("fit",e)}zoomToCover(e){this.zoomTo("cover",e)}zoomToFull(e){this.zoomTo("full",e)}zoomToMax(e){this.zoomTo("max",e)}toggleZoom(e){this.zoomTo(this.targetScale-this.minScale<.5*(this.fullScale-this.minScale)?"full":"fit",e)}toggleMax(e){this.zoomTo(this.targetScale-this.minScale<.5*(this.maxScale-this.minScale)?"max":"fit",e)}toggleCover(e){this.zoomTo(this.targetScale-this.minScale<.5*(this.coverScale-this.minScale)?"cover":"fit",e)}iterateZoom(e){this.zoomTo("next",e)}zoomTo(e=1,{friction:t="auto",originX:i=0,originY:n=0,event:r}={}){if(this.isContentLoading||this.state===Lb.Destroy)return;const{targetScale:s}=this;this.stop();let a=1;if("mousemove"===this.panMode&&(r=this.pmme||r),r){const e=this.content.getBoundingClientRect(),t=r.clientX||0,s=r.clientY||0;i=t-e.left-.5*e.width,n=s-e.top-.5*e.height}const o=this.fullScale,l=this.maxScale;let c=this.coverScale;"number"==typeof e?a=e/s:("next"===e&&(o-c<.2&&(c=o),e=s<o-1e-5?"full":s<l-1e-5?"max":"fit"),a="full"===e?o/s||1:"cover"===e?c/s||1:"max"===e?l/s||1:1/s||1),t="auto"===t?a>1?.15:.25:t,this.applyChange({scale:a,originX:i,originY:n,friction:t}),r&&"mousemove"===this.panMode&&this.panWithMouse(r,t)}rotateCCW(){this.applyChange({angle:-90})}rotateCW(){this.applyChange({angle:90})}flipX(){this.applyChange({flipX:!0})}flipY(){this.applyChange({flipY:!0})}fitX(){this.stop("target");const{containerRect:e,contentRect:t,target:i}=this;this.applyChange({panX:.5*e.width-(t.left+.5*t.fitWidth)-i.e,panY:.5*e.height-(t.top+.5*t.fitHeight)-i.f,scale:e.width/t.fitWidth/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}fitY(){this.stop("target");const{containerRect:e,contentRect:t,target:i}=this;this.applyChange({panX:.5*e.width-(t.left+.5*t.fitWidth)-i.e,panY:.5*e.innerHeight-(t.top+.5*t.fitHeight)-i.f,scale:e.height/t.fitHeight/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}toggleFS(){const{container:e}=this,t=this.cn("inFullscreen"),i=this.cn("htmlHasFullscreen");e.classList.toggle(t);const n=e.classList.contains(t);n?(document.documentElement.classList.add(i),document.addEventListener("keydown",this.onKeydown,!0)):(document.documentElement.classList.remove(i),document.removeEventListener("keydown",this.onKeydown,!0)),this.updateMetrics(),this.emit(n?"enterFS":"exitFS")}getMatrix(e=this.current){const{a:t,b:i,c:n,d:r,e:s,f:a}=e;return new DOMMatrix([t,i,n,r,s,a])}reset(e){if(this.state!==Lb.Init&&this.state!==Lb.Destroy){this.stop("current");for(const e of Pb)this.target[e]=Fb[e];this.target.a=this.minScale,this.target.d=this.minScale,this.clampTargetBounds(),this.isResting||(this.friction=void 0===e?this.option("friction"):e,this.state=Lb.Panning,this.requestTick())}}destroy(){this.stop(),this.state=Lb.Destroy,this.detachEvents(),this.detachObserver();const{container:e,content:t}=this,i=this.option("classes")||{};for(const t of Object.values(i))e.classList.remove(t+"");t&&(t.removeEventListener("load",this.onLoad),t.removeEventListener("error",this.onError)),this.detachPlugins()}}Object.defineProperty(Hb,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Ob}),Object.defineProperty(Hb,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}});const Bb=function(e,t){let i=!0;return(...n)=>{i&&(i=!1,e(...n),setTimeout((()=>{i=!0}),t))}},Vb=(e,t)=>{let i=[];return e.childNodes.forEach((e=>{e.nodeType!==Node.ELEMENT_NODE||t&&!e.matches(t)||i.push(e)})),i};var jb;!function(e){e[e.Init=0]="Init",e[e.Ready=1]="Ready",e[e.Destroy=2]="Destroy"}(jb||(jb={}));const Gb=e=>{if("string"==typeof e&&(e={html:e}),!(e instanceof String||e instanceof HTMLElement)){const t=e.thumb;void 0!==t&&("string"==typeof t&&(e.thumbSrc=t),t instanceof HTMLImageElement&&(e.thumbEl=t,e.thumbElSrc=t.src,e.thumbSrc=t.src),delete e.thumb)}return Object.assign({html:"",el:null,isDom:!1,class:"",index:-1,dim:0,gap:0,pos:0,transition:!1},e)},Wb=(e={})=>Object.assign({index:-1,slides:[],dim:0,pos:-1},e);class Xb extends Ab{constructor(e,t){super(t),Object.defineProperty(this,"instance",{enumerable:!0,configurable:!0,writable:!0,value:e})}attach(){}detach(){}}class qb extends Xb{constructor(){super(...arguments),Object.defineProperty(this,"isDynamic",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"list",{enumerable:!0,configurable:!0,writable:!0,value:null})}onRefresh(){this.refresh()}build(){let e=this.list;return e||(e=document.createElement("ul"),Ub(e,this.cn("list")),e.setAttribute("role","tablist"),this.instance.container.appendChild(e),Ub(this.instance.container,this.cn("hasDots")),this.list=e),e}refresh(){var e;const t=this.instance.pages.length,i=Math.min(2,this.option("minCount")),n=Math.max(2e3,this.option("maxCount")),r=this.option("dynamicFrom");if(t<i||t>n)return void this.cleanup();const s="number"==typeof r&&t>5&&t>=r,a=!this.list||this.isDynamic!==s||this.list.children.length!==t;a&&this.cleanup();const o=this.build();if(_b(o,this.cn("isDynamic"),!!s),a)for(let e=0;e<t;e++)o.append(this.createItem(e));let l,c=0;for(const t of[...o.children]){const i=c===this.instance.page;i&&(l=t),_b(t,this.cn("isCurrent"),i),null===(e=t.children[0])||void 0===e||e.setAttribute("aria-selected",i?"true":"false");for(const e of["isBeforePrev","isPrev","isNext","isAfterNext"])Nb(t,this.cn(e));c++}if(l=l||o.firstChild,s&&l){const e=l.previousElementSibling,t=e&&e.previousElementSibling;Ub(e,this.cn("isPrev")),Ub(t,this.cn("isBeforePrev"));const i=l.nextElementSibling,n=i&&i.nextElementSibling;Ub(i,this.cn("isNext")),Ub(n,this.cn("isAfterNext"))}this.isDynamic=s}createItem(e=0){var t;const i=document.createElement("li");i.setAttribute("role","presentation");const n=gb(this.instance.localize(this.option("dotTpl"),[["%d",e+1]]).replace(/\%i/g,e+""));return i.appendChild(n),null===(t=i.children[0])||void 0===t||t.setAttribute("role","tab"),i}cleanup(){this.list&&(this.list.remove(),this.list=null),this.isDynamic=!1,Nb(this.instance.container,this.cn("hasDots"))}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(qb,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{classes:{list:"f-carousel__dots",isDynamic:"is-dynamic",hasDots:"has-dots",dot:"f-carousel__dot",isBeforePrev:"is-before-prev",isPrev:"is-prev",isCurrent:"is-current",isNext:"is-next",isAfterNext:"is-after-next"},dotTpl:'<button type="button" data-carousel-page="%i" aria-label="{{GOTO}}"><span class="f-carousel__dot" aria-hidden="true"></span></button>',dynamicFrom:11,maxCount:1/0,minCount:2}});class Yb extends Xb{constructor(){super(...arguments),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prev",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"next",{enumerable:!0,configurable:!0,writable:!0,value:null})}onRefresh(){const e=this.instance,t=e.pages.length,i=e.page;if(t<2)return void this.cleanup();this.build();let n=this.prev,r=this.next;n&&r&&(n.removeAttribute("disabled"),r.removeAttribute("disabled"),e.isInfinite||(i<=0&&n.setAttribute("disabled",""),i>=t-1&&r.setAttribute("disabled","")))}createButton(e){const t=this.instance,i=document.createElement("button");i.setAttribute("tabindex","0"),i.setAttribute("title",t.localize(`{{${e.toUpperCase()}}}`)),Ub(i,this.cn("button")+" "+this.cn("next"===e?"isNext":"isPrev"));const n=t.isRTL?"next"===e?"prev":"next":e;var r;return i.innerHTML=t.localize(this.option(`${n}Tpl`)),i.dataset[`carousel${r=e,r?r.match("^[a-z]")?r.charAt(0).toUpperCase()+r.substring(1):r:""}`]="true",i}build(){let e=this.container;e||(this.container=e=document.createElement("div"),Ub(e,this.cn("container")),this.instance.container.appendChild(e)),this.next||(this.next=e.appendChild(this.createButton("next"))),this.prev||(this.prev=e.appendChild(this.createButton("prev")))}cleanup(){this.prev&&this.prev.remove(),this.next&&this.next.remove(),this.container&&this.container.remove(),this.prev=null,this.next=null,this.container=null}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(Yb,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{classes:{container:"f-carousel__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"},nextTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M9 3l9 9-9 9"/></svg>',prevTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M15 3l-9 9 9 9"/></svg>'}});class $b extends Xb{constructor(){super(...arguments),Object.defineProperty(this,"selectedIndex",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"nav",{enumerable:!0,configurable:!0,writable:!0,value:null})}addAsTargetFor(e){this.target=this.instance,this.nav=e,this.attachEvents()}addAsNavFor(e){this.nav=this.instance,this.target=e,this.attachEvents()}attachEvents(){this.nav&&this.target&&(this.nav.options.initialSlide=this.target.options.initialPage,this.nav.on("ready",this.onNavReady),this.nav.state===jb.Ready&&this.onNavReady(this.nav),this.target.on("ready",this.onTargetReady),this.target.state===jb.Ready&&this.onTargetReady(this.target))}onNavReady(e){e.on("createSlide",this.onNavCreateSlide),e.on("Panzoom.click",this.onNavClick),e.on("Panzoom.touchEnd",this.onNavTouch),this.onTargetChange()}onTargetReady(e){e.on("change",this.onTargetChange),e.on("Panzoom.refresh",this.onTargetChange),this.onTargetChange()}onNavClick(e,t,i){i.pointerType||this.onNavTouch(e,e.panzoom,i)}onNavTouch(e,t,i){var n,r;if(Math.abs(t.dragOffset.x)>3||Math.abs(t.dragOffset.y)>3)return;const s=i.target,{nav:a,target:o}=this;if(!a||!o||!s)return;const l=s.closest("[data-index]");if(i.stopPropagation(),i.preventDefault(),!l)return;const c=parseInt(l.dataset.index||"",10)||0,h=o.getPageForSlide(c),d=a.getPageForSlide(c);a.slideTo(d),o.slideTo(h,{friction:null===(r=null===(n=this.nav)||void 0===n?void 0:n.plugins)||void 0===r?void 0:r.Sync.option("friction")}),this.markSelectedSlide(c)}onNavCreateSlide(e,t){t.index===this.selectedIndex&&this.markSelectedSlide(t.index)}onTargetChange(){const{target:e,nav:t}=this;if(!e||!t)return;if(t.state!==jb.Ready||e.state!==jb.Ready)return;const i=e.pages[e.page].slides[0].index,n=t.getPageForSlide(i);this.markSelectedSlide(i),t.slideTo(n)}markSelectedSlide(e){const{nav:t}=this;t&&t.state===jb.Ready&&(this.selectedIndex=e,[...t.slides].map((t=>{t.el&&t.el.classList[t.index===e?"add":"remove"]("is-nav-selected")})))}attach(){let e=this.options.target,t=this.options.nav;e?this.addAsNavFor(e):t&&this.addAsTargetFor(t)}detach(){const e=this,t=e.nav,i=e.target;t&&(t.off("ready",e.onNavReady),t.off("createSlide",e.onNavCreateSlide),t.off("Panzoom.click",e.onNavClick),t.off("Panzoom.touchEnd",e.onNavTouch)),this.nav=null,i&&(i.off("ready",e.onTargetReady),i.off("refresh",e.onTargetChange),i.off("change",e.onTargetChange)),this.target=null}}Object.defineProperty($b,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{friction:.35}});const Zb={Navigation:Yb,Dots:qb,Sync:$b};class Kb extends Cb{get axis(){return this.isHorizontal?"e":"f"}get isEnabled(){return this.state===jb.Ready}get isInfinite(){let e=!1;const{contentDim:t,viewportDim:i,pages:n,slides:r}=this;return n.length>=2&&t+r[0].dim>=i&&(e=this.option("infinite")),e}get isRTL(){return"rtl"===this.option("direction")}get isHorizontal(){return"x"===this.option("axis")}constructor(e,t={},i={}){if(super(),Object.defineProperty(this,"userOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"bp",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"lp",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:jb.Init}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"prevPage",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"viewport",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"slides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pages",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"panzoom",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"inTransition",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"contentDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"viewportDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),"string"==typeof e&&(e=document.querySelector(e)),!e||!Db(e))throw new Error("No Element found");this.container=e,this.slideNext=Bb(this.slideNext.bind(this),150),this.slidePrev=Bb(this.slidePrev.bind(this),150),this.userOptions=t,this.userPlugins=i,queueMicrotask((()=>{this.processOptions()}))}processOptions(){const e=Tb({},Kb.defaults,this.userOptions);let t="";const i=e.breakpoints;if(i&&Sb(i))for(const[n,r]of Object.entries(i))window.matchMedia(n).matches&&Sb(r)&&(t+=n,Tb(e,r));t===this.bp&&this.state!==jb.Init||(this.bp=t,this.state===jb.Ready&&(e.initialSlide=this.pages[this.page].slides[0].index),this.state!==jb.Init&&this.destroy(),super.setOptions(e),!1===this.option("enabled")?this.attachEvents():setTimeout((()=>{this.init()}),0))}init(){this.state=jb.Init,this.emit("init"),this.attachPlugins(Object.assign(Object.assign({},Kb.Plugins),this.userPlugins)),this.initLayout(),this.initSlides(),this.updateMetrics(),this.setInitialPosition(),this.initPanzoom(),this.attachEvents(),this.state=jb.Ready,this.emit("ready")}initLayout(){const{container:e}=this,t=this.option("classes");Ub(e,this.cn("container")),_b(e,t.isLTR,!this.isRTL),_b(e,t.isRTL,this.isRTL),_b(e,t.isVertical,!this.isHorizontal),_b(e,t.isHorizontal,this.isHorizontal);let i=this.option("viewport")||e.querySelector(`.${t.viewport}`);i||(i=document.createElement("div"),Ub(i,t.viewport),i.append(...Vb(e,`.${t.slide}`)),e.prepend(i));let n=this.option("track")||e.querySelector(`.${t.track}`);n||(n=document.createElement("div"),Ub(n,t.track),n.append(...Array.from(i.childNodes))),n.setAttribute("aria-live","polite"),i.contains(n)||i.prepend(n),this.viewport=i,this.track=n,this.emit("initLayout")}initSlides(){const{track:e}=this;if(e){this.slides=[],[...Vb(e,`.${this.cn("slide")}`)].forEach((e=>{if(Db(e)){const t=Gb({el:e,isDom:!0,index:this.slides.length});this.slides.push(t),this.emit("initSlide",t,this.slides.length)}}));for(let e of this.option("slides",[])){const t=Gb(e);t.index=this.slides.length,this.slides.push(t),this.emit("initSlide",t,this.slides.length)}this.emit("initSlides")}}setInitialPage(){let e=0;const t=this.option("initialSlide");e="number"==typeof t?this.getPageForSlide(t):parseInt(this.option("initialPage",0)+"",10)||0,this.page=e}setInitialPosition(){if(!this.track||!this.pages.length)return;const e=this.isHorizontal;let t=this.page;this.pages[t]||(this.page=t=0);const i=this.pages[t].pos*(this.isRTL&&e?1:-1),n=e?`${i}px`:"0",r=e?"0":`${i}px`;this.track.style.transform=`translate3d(${n}, ${r}, 0) scale(1)`,this.option("adaptiveHeight")&&this.setViewportHeight()}initPanzoom(){this.panzoom&&(this.panzoom.destroy(),this.panzoom=null);const e=this.option("Panzoom")||{};this.panzoom=new Hb(this.viewport,Tb({},{content:this.track,zoom:!1,panOnlyZoomed:!1,lockAxis:this.isHorizontal?"x":"y",infinite:this.isInfinite,click:!1,dblClick:!1,touch:e=>!(this.pages.length<2&&!e.options.infinite),bounds:()=>this.getBounds(),maxVelocity:e=>Math.abs(e.target[this.axis]-e.current[this.axis])<2*this.viewportDim?100:0},e)),this.panzoom.on("*",((e,t,...i)=>{this.emit(`Panzoom.${t}`,e,...i)})),this.panzoom.on("decel",this.onDecel),this.panzoom.on("refresh",this.onRefresh),this.panzoom.on("beforeTransform",this.onBeforeTransform),this.panzoom.on("endAnimation",this.onEndAnimation)}attachEvents(){const e=this.container;e&&(e.addEventListener("click",this.onClick,{passive:!1,capture:!1}),e.addEventListener("slideTo",this.onSlideTo)),window.addEventListener("resize",this.onResize)}createPages(){let e=[];const{contentDim:t,viewportDim:i}=this;let n=this.option("slidesPerPage");("number"!=typeof n||t<=i)&&(n=1/0);let r=0,s=0,a=0;for(const t of this.slides)(!e.length||s+t.dim>i||a===n)&&(e.push(Wb()),r=e.length-1,s=0,a=0),e[r].slides.push(t),s+=t.dim+t.gap,a++;return e}processPages(){const e=this.pages,{contentDim:t,viewportDim:i}=this,n=this.option("center"),r=this.option("fill"),s=r&&n&&t>i&&!this.isInfinite;if(e.forEach(((e,r)=>{e.index=r,e.pos=e.slides[0].pos,e.dim=0;for(const[t,i]of e.slides.entries())e.dim+=i.dim,t<e.slides.length-1&&(e.dim+=i.gap);s&&e.pos+.5*e.dim<.5*i?e.pos=0:s&&e.pos+.5*e.dim>=t-.5*i?e.pos=t-i:n&&(e.pos+=-.5*(i-e.dim))})),e.forEach(((e,n)=>{r&&!this.isInfinite&&t>i&&(e.pos=Math.max(e.pos,0),e.pos=Math.min(e.pos,t-i)),e.pos=pb(e.pos,1e3),e.dim=pb(e.dim,1e3),e.pos<.1&&e.pos>-.1&&(e.pos=0)})),this.isInfinite)return e;const a=[];let o;return e.forEach((e=>{const t=Object.assign({},e);o&&t.pos===o.pos?(o.dim+=t.dim,o.slides=[...o.slides,...t.slides]):(t.index=a.length,o=t,a.push(t))})),a}getPageFromIndex(e=0){const t=this.pages.length;let i;return e=parseInt((e||0).toString())||0,i=this.isInfinite?(e%t+t)%t:Math.max(Math.min(e,t-1),0),i}getSlideMetrics(e){var t;const i=this.isHorizontal?"width":"height";let n=0,r=0,s=e.el;if(s?n=parseFloat(s.dataset[i]||"")||0:(s=document.createElement("div"),s.style.visibility="hidden",Ub(s,this.cn("slide")+" "+e.class),(this.track||document.body).prepend(s)),n)s.style[i]=`${n}px`,s.style["width"===i?"height":"width"]="";else{const e=Math.max(1,(null===(t=window.visualViewport)||void 0===t?void 0:t.scale)||1);n=s.getBoundingClientRect()[i]*e}const a=getComputedStyle(s);return"content-box"===a.boxSizing&&(this.isHorizontal?(n+=parseFloat(a.paddingLeft)||0,n+=parseFloat(a.paddingRight)||0):(n+=parseFloat(a.paddingTop)||0,n+=parseFloat(a.paddingBottom)||0)),r=parseFloat(a[this.isHorizontal?"marginRight":"marginBottom"])||0,e.el||s.remove(),{dim:pb(n,1e3),gap:pb(r,1e3)}}getBounds(){const{isInfinite:e,isRTL:t,isHorizontal:i,pages:n}=this;let r={min:0,max:0};if(e)r={min:-1/0,max:1/0};else if(n.length){const e=n[0].pos,s=n[n.length-1].pos;r=t&&i?{min:e,max:s}:{min:-1*s,max:-1*e}}return{x:i?r:{min:0,max:0},y:i?{min:0,max:0}:r}}repositionSlides(){let e,{isHorizontal:t,isRTL:i,isInfinite:n,viewport:r,viewportDim:s,contentDim:a,page:o,pages:l,slides:c,panzoom:h}=this,d=0,u=0,p=0,f=0;h?f=-1*h.current[this.axis]:l[o]&&(f=l[o].pos||0),e=t?i?"right":"left":"top",i&&t&&(f*=-1);for(const t of c)t.el?("top"===e?(t.el.style.right="",t.el.style.left=""):t.el.style.top="",t.index!==d?t.el.style[e]=0===u?"":`${pb(u,1e3)}px`:t.el.style[e]="",p+=t.dim+t.gap,d++):u+=t.dim+t.gap;if(n&&p&&r){let i=getComputedStyle(r),n="padding",o=t?"Right":"Bottom",l=parseFloat(i[n+(t?"Left":"Top")]);f-=l,s+=l,s+=parseFloat(i[n+o]);for(const t of c)t.el&&(pb(t.pos)<pb(s)&&pb(t.pos+t.dim+t.gap)<pb(f)&&pb(f)>pb(a-s)&&(t.el.style[e]=`${pb(u+p,1e3)}px`),pb(t.pos+t.gap)>=pb(a-s)&&pb(t.pos)>pb(f+s)&&pb(f)<pb(s)&&(t.el.style[e]=`-${pb(p,1e3)}px`))}let m,g,v=[...this.inTransition];if(v.length>1&&(m=l[v[0]],g=l[v[1]]),m&&g){let t=0;for(const i of c)i.el?this.inTransition.has(i.index)&&m.slides.indexOf(i)<0&&(i.el.style[e]=`${pb(t+(m.pos-g.pos),1e3)}px`):t+=i.dim+i.gap}}createSlideEl(e){const{track:t,slides:i}=this;if(!t||!e)return;if(e.el)return;const n=document.createElement("div");Ub(n,this.cn("slide")),Ub(n,e.class),Ub(n,e.customClass),e.html&&(n.innerHTML=e.html);const r=[];i.forEach(((e,t)=>{e.el&&r.push(t)}));const s=e.index;let a=null;r.length&&(a=i[r.reduce(((e,t)=>Math.abs(t-s)<Math.abs(e-s)?t:e))]);const o=a&&a.el?a.index<e.index?a.el.nextSibling:a.el:null;t.insertBefore(n,t.contains(o)?o:null),e.el=n,this.emit("createSlide",e)}removeSlideEl(e,t=!1){const i=e.el;if(!i)return;if(Nb(i,this.cn("isSelected")),e.isDom&&!t)return i.removeAttribute("aria-hidden"),i.removeAttribute("data-index"),Nb(i,this.cn("isSelected")),void(i.style.left="");this.emit("removeSlide",e);const n=new CustomEvent("animationend");i.dispatchEvent(n),e.el&&e.el.remove(),e.el=null}transitionTo(e=0,t=this.option("transition")){if(!t)return!1;const{pages:i,panzoom:n}=this;e=parseInt((e||0).toString())||0;const r=this.getPageFromIndex(e);if(!n||!i[r]||i.length<2||Math.abs(i[this.page].slides[0].dim-this.viewportDim)>1)return!1;const s=e>this.page?1:-1,a=this.pages[r].pos*(this.isRTL?1:-1);if(this.page===r&&pb(a,1e3)===pb(n.target[this.axis],1e3))return!1;this.clearTransitions();const o=n.isResting;Ub(this.container,this.cn("inTransition"));const l=this.pages[this.page].slides[0],c=this.pages[r].slides[0];this.inTransition.add(c.index),this.createSlideEl(c);let h=l.el,d=c.el;o||"slide"===t||(t="fadeFast",h=null);const u=this.isRTL?"next":"prev",p=this.isRTL?"prev":"next";return h&&(this.inTransition.add(l.index),l.transition=t,h.addEventListener("animationend",this.onAnimationEnd),h.classList.add(`f-${t}Out`,`to-${s>0?p:u}`)),d&&(c.transition=t,d.addEventListener("animationend",this.onAnimationEnd),d.classList.add(`f-${t}In`,`from-${s>0?u:p}`)),n.panTo({x:this.isHorizontal?a:0,y:this.isHorizontal?0:a,friction:0}),this.onChange(r),!0}manageSlideVisiblity(){const e=new Set,t=new Set,i=this.getVisibleSlides(parseFloat(this.option("preload",0)+"")||0);for(const n of this.slides)i.has(n)?e.add(n):t.add(n);for(const t of this.inTransition)e.add(this.slides[t]);for(const t of e)this.createSlideEl(t),this.lazyLoadSlide(t);for(const i of t)e.has(i)||this.removeSlideEl(i);this.markSelectedSlides(),this.repositionSlides()}markSelectedSlides(){if(!this.pages[this.page]||!this.pages[this.page].slides)return;const e="aria-hidden";let t=this.cn("isSelected");if(t)for(const i of this.slides)i.el&&(i.el.dataset.index=`${i.index}`,this.pages[this.page].slides.includes(i)?(i.el.classList.contains(t)||(Ub(i.el,t),this.emit("selectSlide",i)),i.el.removeAttribute(e)):(i.el.classList.contains(t)&&(Nb(i.el,t),this.emit("unselectSlide",i)),i.el.setAttribute(e,"true")))}flipInfiniteTrack(){const e=this.panzoom;if(!e||!this.isInfinite)return;const t="x"===this.option("axis")?"e":"f",{viewportDim:i,contentDim:n}=this;let r=e.current[t],s=e.target[t]-r,a=0,o=.5*i,l=n;this.isRTL&&this.isHorizontal?(r<-o&&(a=-1,r+=l),r>l-o&&(a=1,r-=l)):(r>o&&(a=1,r-=l),r<-l+o&&(a=-1,r+=l)),a&&(e.current[t]=r,e.target[t]=r+s)}lazyLoadSlide(e){const t=this,i=e&&e.el;if(!i)return;const n=new Set,r="f-fadeIn";i.querySelectorAll("[data-lazy-srcset]").forEach((e=>{e instanceof HTMLImageElement&&n.add(e)}));let s=Array.from(i.querySelectorAll("[data-lazy-src]"));i.dataset.lazySrc&&s.push(i),s.map((e=>{e instanceof HTMLImageElement?n.add(e):Db(e)&&(e.style.backgroundImage=`url('${e.dataset.lazySrc||""}')`,delete e.dataset.lazySrc)}));const a=(e,i,n)=>{n&&(n.remove(),n=null),i.complete&&(i.classList.add(r),setTimeout((()=>{i.classList.remove(r)}),350),i.style.display=""),this.option("adaptiveHeight")&&e.el&&this.pages[this.page].slides.indexOf(e)>-1&&(t.updateMetrics(),t.setViewportHeight()),this.emit("load",e)};for(const t of n){let i=null;t.src=t.dataset.lazySrcset||t.dataset.lazySrc||"",delete t.dataset.lazySrc,delete t.dataset.lazySrcset,t.style.display="none",t.addEventListener("error",(()=>{a(e,t,i)})),t.addEventListener("load",(()=>{a(e,t,i)})),setTimeout((()=>{t.parentNode&&e.el&&(t.complete?a(e,t,i):(i=gb(Ib),t.parentNode.insertBefore(i,t)))}),300)}}onAnimationEnd(e){var t;const i=e.target,n=i?parseInt(i.dataset.index||"",10)||0:-1,r=this.slides[n],s=e.animationName;if(!i||!r||!s)return;const a=!!this.inTransition.has(n)&&r.transition;a&&s.substring(0,a.length+2)===`f-${a}`&&this.inTransition.delete(n),this.inTransition.size||this.clearTransitions(),n===this.page&&(null===(t=this.panzoom)||void 0===t?void 0:t.isResting)&&this.emit("settle")}onDecel(e,t=0,i=0){const{isRTL:n,isHorizontal:r,axis:s,pages:a}=this,o=a.length,l=Math.abs(Math.atan2(i,t)/(Math.PI/180));let c=0;if(c=l>45&&l<135?r?0:i:r?t:0,!o)return;const h=this.option("dragFree");let d=this.page,u=n&&r?1:-1;const p=e.target[s]*u,f=e.current[s]*u;let{pageIndex:m}=this.getPageFromPosition(p),{pageIndex:g}=this.getPageFromPosition(f);h?this.onChange(m):(Math.abs(c)>5?(a[d].dim<document.documentElement["client"+(this.isHorizontal?"Width":"Height")]-1&&(d=g),d=n&&r?c<0?d-1:d+1:c<0?d+1:d-1):d=g,this.slideTo(d,{transition:!1,friction:e.option("decelFriction")}))}onClick(e){const t=e.target,i=t&&Db(t)?t.dataset:null;let n,r;i&&(void 0!==i.carouselPage?(r="slideTo",n=i.carouselPage):void 0!==i.carouselNext?r="slideNext":void 0!==i.carouselPrev&&(r="slidePrev")),r?(e.preventDefault(),e.stopPropagation(),t&&!t.hasAttribute("disabled")&&this[r](n)):this.emit("click",e)}onSlideTo(e){const t=e.detail||0;this.slideTo(this.getPageForSlide(t),{friction:0})}onChange(e,t=0){const i=this.page;this.prevPage=i,this.page=e,this.option("adaptiveHeight")&&this.setViewportHeight(),e!==i&&(this.markSelectedSlides(),this.emit("change",e,i,t))}onRefresh(){let e=this.contentDim,t=this.viewportDim;this.updateMetrics(),this.contentDim===e&&this.viewportDim===t||this.slideTo(this.page,{friction:0,transition:!1})}onResize(){this.option("breakpoints")&&this.processOptions()}onBeforeTransform(e){this.lp!==e.current[this.axis]&&(this.flipInfiniteTrack(),this.manageSlideVisiblity()),this.lp=e.current.e}onEndAnimation(){this.inTransition.size||this.emit("settle")}reInit(e=null,t=null){this.destroy(),this.state=jb.Init,this.userOptions=e||this.userOptions,this.userPlugins=t||this.userPlugins,this.processOptions()}slideTo(e=0,{friction:t=this.option("friction"),transition:i=this.option("transition")}={}){if(this.state===jb.Destroy)return;const{axis:n,isHorizontal:r,isRTL:s,pages:a,panzoom:o}=this,l=a.length,c=s&&r?1:-1;if(!o||!l)return;if(this.transitionTo(e,i))return;const h=this.getPageFromIndex(e);let d=a[h].pos;if(this.isInfinite){const t=this.contentDim,i=o.target[n]*c;if(2===l)d+=t*Math.floor(parseFloat(e+"")/2);else{const e=i;d=[d,d-t,d+t].reduce((function(t,i){return Math.abs(i-e)<Math.abs(t-e)?i:t}))}}d*=c,Math.abs(o.target[n]-d)<.1||(o.panTo({x:r?d:0,y:r?0:d,friction:t}),this.onChange(h))}slideToClosest(e){if(this.panzoom){const{pageIndex:t}=this.getPageFromPosition(this.panzoom.current[this.isHorizontal?"e":"f"]);this.slideTo(t,e)}}slideNext(){this.slideTo(this.page+1)}slidePrev(){this.slideTo(this.page-1)}clearTransitions(){this.inTransition.clear(),Nb(this.container,this.cn("inTransition"));const e=["to-prev","to-next","from-prev","from-next"];for(const t of this.slides){const i=t.el;if(i){i.removeEventListener("animationend",this.onAnimationEnd),i.classList.remove(...e);const n=t.transition;n&&i.classList.remove(`f-${n}Out`,`f-${n}In`)}}this.manageSlideVisiblity()}prependSlide(e){var t,i;let n=Array.isArray(e)?e:[e];for(const e of n.reverse())this.slides.unshift(Gb(e));for(let e=0;e<this.slides.length;e++)this.slides[e].index=e;const r=(null===(t=this.pages[this.page])||void 0===t?void 0:t.pos)||0;this.page+=n.length,this.updateMetrics();const s=(null===(i=this.pages[this.page])||void 0===i?void 0:i.pos)||0;if(this.panzoom){const e=this.isRTL?r-s:s-r;this.panzoom.target.e-=e,this.panzoom.current.e-=e,this.panzoom.requestTick()}}appendSlide(e){let t=Array.isArray(e)?e:[e];for(const e of t){const t=Gb(e);t.index=this.slides.length,this.slides.push(t),this.emit("initSlide",e,this.slides.length)}this.updateMetrics()}removeSlide(e){const t=this.slides.length;e=(e%t+t)%t,this.removeSlideEl(this.slides[e],!0),this.slides.splice(e,1);for(let e=0;e<this.slides.length;e++)this.slides[e].index=e;this.updateMetrics(),this.slideTo(this.page,{friction:0,transition:!1})}updateMetrics(){const{panzoom:e,viewport:t,track:i,isHorizontal:n}=this;if(!i)return;const r=n?"width":"height",s=n?"offsetWidth":"offsetHeight";if(t){let e=Math.max(t[s],pb(t.getBoundingClientRect()[r],1e3)),i=getComputedStyle(t),a="padding",o=n?"Right":"Bottom";e-=parseFloat(i[a+(n?"Left":"Top")])+parseFloat(i[a+o]),this.viewportDim=e}let a,o=this.pages.length,l=0;for(const[e,t]of this.slides.entries()){let i=0,n=0;!t.el&&a?(i=a.dim,n=a.gap):(({dim:i,gap:n}=this.getSlideMetrics(t)),a=t),i=pb(i,1e3),n=pb(n,1e3),t.dim=i,t.gap=n,t.pos=l,l+=i,(this.isInfinite||e<this.slides.length-1)&&(l+=n)}const c=this.contentDim;l=pb(l,1e3),this.contentDim=l,e&&(e.contentRect[r]=l,e.contentRect["e"===this.axis?"fullWidth":"fullHeight"]=l),this.pages=this.createPages(),this.pages=this.processPages(),this.state===jb.Init&&this.setInitialPage(),this.page=Math.max(0,Math.min(this.page,this.pages.length-1)),e&&o===this.pages.length&&Math.abs(l-c)>.5&&(e.target[this.axis]=-1*this.pages[this.page].pos,e.current[this.axis]=-1*this.pages[this.page].pos,e.stop()),this.manageSlideVisiblity(),this.emit("refresh")}getProgress(e,t=!1){void 0===e&&(e=this.page);const i=this,n=i.panzoom,r=i.pages[e]||0;if(!r||!n)return 0;let s=-1*n.current.e,a=i.contentDim;var o=[pb((s-r.pos)/(1*r.dim),1e3),pb((s+a-r.pos)/(1*r.dim),1e3),pb((s-a-r.pos)/(1*r.dim),1e3)].reduce((function(e,t){return Math.abs(t)<Math.abs(e)?t:e}));return t?o:Math.max(-1,Math.min(1,o))}setViewportHeight(){const{page:e,pages:t,viewport:i,isHorizontal:n}=this;if(!i||!t[e])return;let r=0;n&&this.track&&(this.track.style.height="auto",t[e].slides.forEach((e=>{e.el&&(r=Math.max(r,e.el.offsetHeight))}))),i.style.height=r?`${r}px`:""}getPageForSlide(e){for(const t of this.pages)for(const i of t.slides)if(i.index===e)return t.index;return-1}getVisibleSlides(e=0){var t;const i=new Set;let{contentDim:n,viewportDim:r,pages:s,page:a}=this;n=n+(null===(t=this.slides[this.slides.length-1])||void 0===t?void 0:t.gap)||0;let o=0;o=this.panzoom?-1*this.panzoom.current[this.axis]:s[a]&&s[a].pos||0,this.isInfinite&&(o-=Math.floor(o/n)*n),this.isRTL&&this.isHorizontal&&(o*=-1);const l=o-r*e,c=o+r*(e+1),h=this.isInfinite?[-1,0,1]:[0];for(const e of this.slides)for(const t of h){const r=e.pos+t*n,s=e.pos+e.dim+e.gap+t*n;r<c&&s>l&&i.add(e)}return i}getPageFromPosition(e){const{viewportDim:t,contentDim:i}=this,n=this.pages.length,r=this.slides.length,s=this.slides[r-1];let a=0,o=0,l=0;const c=this.option("center");c&&(e+=.5*t),this.isInfinite||(e=Math.max(this.slides[0].pos,Math.min(e,s.pos)));const h=i+s.gap;l=Math.floor(e/h)||0,e-=l*h;let d=s,u=this.slides.find((t=>{const i=e+(d&&!c?.5*d.dim:0);return d=t,t.pos<=i&&t.pos+t.dim+t.gap>i}));return u||(u=s),o=this.getPageForSlide(u.index),a=o+l*n,{page:a,pageIndex:o}}destroy(){if([jb.Destroy].includes(this.state))return;this.state=jb.Destroy;const{container:e,viewport:t,track:i,slides:n,panzoom:r}=this,s=this.option("classes");e.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),e.removeEventListener("slideTo",this.onSlideTo),window.removeEventListener("resize",this.onResize),r&&(r.destroy(),this.panzoom=null),n&&n.forEach((e=>{this.removeSlideEl(e)})),this.detachPlugins(),t&&t.offsetParent&&i&&i.offsetParent&&t.replaceWith(...i.childNodes);for(const[t,i]of Object.entries(s))"container"!==t&&i&&e.classList.remove(i);this.track=null,this.viewport=null,this.page=0,this.slides=[];const a=this.events.get("ready");this.events=new Map,a&&this.events.set("ready",a)}}Object.defineProperty(Kb,"Panzoom",{enumerable:!0,configurable:!0,writable:!0,value:Hb}),Object.defineProperty(Kb,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{viewport:null,track:null,enabled:!0,slides:[],axis:"x",transition:"fade",preload:1,slidesPerPage:"auto",initialPage:0,friction:.12,Panzoom:{decelFriction:.12},center:!0,infinite:!0,fill:!0,dragFree:!1,adaptiveHeight:!1,direction:"ltr",classes:{container:"f-carousel",viewport:"f-carousel__viewport",track:"f-carousel__track",slide:"f-carousel__slide",isLTR:"is-ltr",isRTL:"is-rtl",isHorizontal:"is-horizontal",isVertical:"is-vertical",inTransition:"in-transition",isSelected:"is-selected"},l10n:{NEXT:"Next slide",PREV:"Previous slide",GOTO:"Go to slide #%d"}}}),Object.defineProperty(Kb,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:Zb});const Jb=function(e){const t=window.pageYOffset,i=window.pageYOffset+window.innerHeight;if(!Db(e))return 0;const n=e.getBoundingClientRect(),r=n.y+window.pageYOffset,s=n.y+n.height+window.pageYOffset;if(t>s||i<r)return 0;if(t<r&&i>s)return 100;if(r<t&&s>i)return 100;let a=n.height;r<t&&(a-=window.pageYOffset-r),s>i&&(a-=s-i);const o=a/window.innerHeight*100;return Math.round(o)},Qb=!("undefined"==typeof window||!window.document||!window.document.createElement);let ex;const tx=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden]):not(.fancybox-focus-guard)","iframe","object","embed","video","audio","[contenteditable]",'[tabindex]:not([tabindex^="-"]):not([disabled]):not([aria-hidden])'].join(","),ix=e=>{if(e&&Qb){void 0===ex&&document.createElement("div").focus({get preventScroll(){return ex=!0,!1}});try{if(ex)e.focus({preventScroll:!0});else{const t=window.pageXOffset||document.body.scrollTop,i=window.pageYOffset||document.body.scrollLeft;e.focus(),document.body.scrollTo({top:t,left:i,behavior:"auto"})}}catch(e){}}},nx={dragToClose:!0,hideScrollbar:!0,Carousel:{classes:{container:"fancybox__carousel",viewport:"fancybox__viewport",track:"fancybox__track",slide:"fancybox__slide"}},contentClick:"toggleZoom",contentDblClick:!1,backdropClick:"close",animated:!0,idle:3500,showClass:"f-zoomInUp",hideClass:"f-fadeOut",commonCaption:!1,parentEl:null,startIndex:0,l10n:Object.assign(Object.assign({},Rb),{CLOSE:"Close",NEXT:"Next",PREV:"Previous",MODAL:"You can close this modal content with the ESC key",ERROR:"Something Went Wrong, Please Try Again Later",IMAGE_ERROR:"Image Not Found",ELEMENT_NOT_FOUND:"HTML Element Not Found",AJAX_NOT_FOUND:"Error Loading AJAX : Not Found",AJAX_FORBIDDEN:"Error Loading AJAX : Forbidden",IFRAME_ERROR:"Error Loading Page",TOGGLE_ZOOM:"Toggle zoom level",TOGGLE_THUMBS:"Toggle thumbnails",TOGGLE_SLIDESHOW:"Toggle slideshow",TOGGLE_FULLSCREEN:"Toggle full-screen mode",DOWNLOAD:"Download"}),tpl:{closeButton:'<button data-fancybox-close class="f-button is-close-btn" title="{{CLOSE}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M20 20L4 4m16 0L4 20"/></svg></button>',main:'<div class="fancybox__container" role="dialog" aria-modal="true" aria-label="{{MODAL}}" tabindex="-1">\n    <div class="fancybox__backdrop"></div>\n    <div class="fancybox__carousel"></div>\n    <div class="fancybox__footer"></div>\n  </div>'},groupAll:!1,groupAttr:"data-fancybox",defaultType:"image",defaultDisplay:"block",autoFocus:!0,trapFocus:!0,placeFocusBack:!0,closeButton:"auto",keyboard:{Escape:"close",Delete:"close",Backspace:"close",PageUp:"next",PageDown:"prev",ArrowUp:"prev",ArrowDown:"next",ArrowRight:"next",ArrowLeft:"prev"},Fullscreen:{autoStart:!1},compact:()=>window.matchMedia("(max-width: 578px), (max-height: 578px)").matches,wheel:"zoom"};var rx,sx;!function(e){e[e.Init=0]="Init",e[e.Ready=1]="Ready",e[e.Closing=2]="Closing",e[e.CustomClosing=3]="CustomClosing",e[e.Destroy=4]="Destroy"}(rx||(rx={})),function(e){e[e.Loading=0]="Loading",e[e.Opening=1]="Opening",e[e.Ready=2]="Ready",e[e.Closing=3]="Closing"}(sx||(sx={}));const ax=()=>{queueMicrotask((()=>{(()=>{const{slug:e,index:t}=ox.parseURL(),i=Px.getInstance();if(i&&!1!==i.option("Hash")){const n=i.carousel;if(e&&n){for(let t of n.slides)if(t.slug&&t.slug===e)return n.slideTo(t.index);if(e===i.option("slug"))return n.slideTo(t-1);const r=i.getSlide(),s=r&&r.triggerEl&&r.triggerEl.dataset;if(s&&s.fancybox===e)return n.slideTo(t-1)}ox.hasSilentClose=!0,i.close()}ox.startFromUrl()})()}))};class ox extends Xb{constructor(){super(...arguments),Object.defineProperty(this,"origHash",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"timer",{enumerable:!0,configurable:!0,writable:!0,value:null})}onChange(){const e=this.instance,t=e.carousel;this.timer&&clearTimeout(this.timer);const i=e.getSlide();if(!t||!i)return;const n=e.isOpeningSlide(i),r=new URL(document.URL).hash;let s,a=i.slug||void 0,o=i.triggerEl||void 0;s=a||this.instance.option("slug"),!s&&o&&o.dataset&&(s=o.dataset.fancybox);let l="";s&&"true"!==s&&(l="#"+s+(!a&&t.slides.length>1?"-"+(i.index+1):"")),n&&(this.origHash=r!==l?r:""),l&&r!==l&&(this.timer=setTimeout((()=>{try{e.state===rx.Ready&&window.history[n?"pushState":"replaceState"]({},document.title,window.location.pathname+window.location.search+l)}catch(e){}}),300))}onClose(){if(this.timer&&clearTimeout(this.timer),!0!==ox.hasSilentClose)try{window.history.replaceState({},document.title,window.location.pathname+window.location.search+(this.origHash||""))}catch(e){}}attach(){const e=this.instance;e.on("Carousel.ready",this.onChange),e.on("Carousel.change",this.onChange),e.on("close",this.onClose)}detach(){const e=this.instance;e.off("Carousel.ready",this.onChange),e.off("Carousel.change",this.onChange),e.off("close",this.onClose)}static parseURL(){const e=window.location.hash.slice(1),t=e.split("-"),i=t[t.length-1],n=i&&/^\+?\d+$/.test(i)&&parseInt(t.pop()||"1",10)||1;return{hash:e,slug:t.join("-"),index:n}}static startFromUrl(){if(ox.hasSilentClose=!1,Px.getInstance()||!1===Px.defaults.Hash)return;const{hash:e,slug:t,index:i}=ox.parseURL();if(!t)return;let n=document.querySelector(`[data-slug="${e}"]`);if(n&&n.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})),Px.getInstance())return;const r=document.querySelectorAll(`[data-fancybox="${t}"]`);r.length&&(n=r[i-1],n&&n.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})))}static destroy(){window.removeEventListener("hashchange",ax,!1)}}function lx(){window.addEventListener("hashchange",ax,!1),setTimeout((()=>{ox.startFromUrl()}),500)}Object.defineProperty(ox,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(ox,"hasSilentClose",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Qb&&(/complete|interactive|loaded/.test(document.readyState)?lx():document.addEventListener("DOMContentLoaded",lx));class cx extends Xb{onCreateSlide(e,t,i){const n=this.instance,r=n.optionFor(i,"src")||"",{el:s,type:a}=i;s&&"image"===a&&"string"==typeof r&&this.setContent(i,r).then((e=>{const t=i.contentEl,r=i.imageEl,a=i.thumbElSrc;if(n.isClosing()||!t||!r)return;t.offsetHeight;const o=!!n.isOpeningSlide(i)&&this.getZoomInfo(i);if(this.option("protected")){s.addEventListener("contextmenu",(e=>{e.preventDefault()}));const e=document.createElement("div");Ub(e,"fancybox-protected"),t.appendChild(e)}if(a&&o){const r=e.contentRect,s=Math.max(r.fullWidth,r.fullHeight);let c=null;!o.opacity&&s>1200&&(c=document.createElement("img"),Ub(c,"fancybox-ghost"),c.src=a,t.appendChild(c));const h=()=>{c&&(Ub(c,"f-fadeFastOut"),setTimeout((()=>{c&&(c.remove(),c=null)}),200))};(l=a,new Promise(((e,t)=>{const i=new Image;i.onload=e,i.onerror=t,i.src=l}))).then((()=>{i.state=sx.Opening,this.instance.emit("reveal",i),this.zoomIn(i).then((()=>{h(),this.instance.done(i)}),(()=>{n.hideLoading(i)})),c&&setTimeout((()=>{h()}),s>2500?800:200)}),(()=>{n.hideLoading(i),n.revealContent(i)}))}else{const t=this.optionFor(i,"initialSize"),r=this.optionFor(i,"zoom"),s={event:n.prevMouseMoveEvent||n.options.event,friction:r?.12:0};let a=n.optionFor(i,"showClass")||void 0,o=!0;n.isOpeningSlide(i)&&("full"===t?e.zoomToFull(s):"cover"===t?e.zoomToCover(s):"max"===t?e.zoomToMax(s):o=!1,e.stop("current")),o&&a&&(a=e.isDragging?"f-fadeIn":""),n.revealContent(i,a)}var l}),(()=>{n.setError(i,"{{IMAGE_ERROR}}")}))}onRemoveSlide(e,t,i){i.panzoom&&i.panzoom.destroy(),i.panzoom=void 0,i.imageEl=void 0}onChange(e,t,i,n){for(const e of t.slides){const t=e.panzoom;t&&e.index!==i&&t.reset(.35)}}onClose(){var e;const t=this.instance,i=t.container,n=t.getSlide();if(!i||!i.parentElement||!n)return;const{el:r,contentEl:s,panzoom:a}=n,o=n.thumbElSrc;if(!r||!o||!s||!a||a.isContentLoading||a.state===Lb.Init||a.state===Lb.Destroy)return;a.updateMetrics();let l=this.getZoomInfo(n);if(!l)return;this.instance.state=rx.CustomClosing,i.classList.remove("is-zooming-in"),i.classList.add("is-zooming-out"),s.style.backgroundImage=`url('${o}')`;const c=i.getBoundingClientRect();1===((null===(e=window.visualViewport)||void 0===e?void 0:e.scale)||1)&&Object.assign(i.style,{position:"absolute",top:`${window.pageYOffset}px`,left:`${window.pageXOffset}px`,bottom:"auto",right:"auto",width:`${c.width}px`,height:`${c.height}px`,overflow:"hidden"});const{x:h,y:d,scale:u,opacity:p}=l;if(p){const e=((e,t,i,n)=>{const r=t-e;return t=>1+((t-e)/r*-1||0)})(a.scale,u);a.on("afterTransform",(()=>{s.style.opacity=e(a.scale)+""}))}a.on("endAnimation",(()=>{t.destroy()})),a.target.a=u,a.target.b=0,a.target.c=0,a.target.d=u,a.panTo({x:h,y:d,scale:u,friction:p?.2:.33,ignoreBounds:!0}),a.isResting&&t.destroy()}setContent(e,t){return new Promise(((i,n)=>{var r,s;const a=this.instance,o=e.el;if(!o)return void n();a.showLoading(e);let l=this.optionFor(e,"content");"string"==typeof l&&(l=gb(l)),l&&Db(l)||(l=document.createElement("img"),l instanceof HTMLImageElement&&(l.src=t||"",l.alt=(null===(r=e.caption)||void 0===r?void 0:r.replace(/<[^>]+>/gi,"").substring(0,1e3))||`Image ${e.index+1} of ${null===(s=a.carousel)||void 0===s?void 0:s.pages.length}`,l.draggable=!1,e.srcset&&l.setAttribute("srcset",e.srcset)),e.sizes&&l.setAttribute("sizes",e.sizes)),l.classList.add("fancybox-image"),e.imageEl=l,a.setContent(e,l,!1),e.panzoom=new Hb(o,Tb({},this.option("Panzoom")||{},{content:l,width:a.optionFor(e,"width","auto"),height:a.optionFor(e,"height","auto"),wheel:()=>{const e=a.option("wheel");return("zoom"===e||"pan"==e)&&e},click:(t,i)=>{var n,r;if(a.isCompact||a.isClosing())return!1;if(e.index!==(null===(n=a.getSlide())||void 0===n?void 0:n.index))return!1;let s=!i||i.target&&(null===(r=e.contentEl)||void 0===r?void 0:r.contains(i.target));return a.option(s?"contentClick":"backdropClick")||!1},dblClick:()=>a.isCompact?"toggleZoom":a.option("contentDblClick")||!1,spinner:!1,panOnlyZoomed:!0,wheelLimit:1/0,transformParent:!0,on:{ready:e=>{i(e)},error:()=>{n()},destroy:()=>{n()}}}))}))}zoomIn(e){return new Promise(((t,i)=>{const n=this.instance,r=n.container,{panzoom:s,contentEl:a,el:o}=e;s&&s.updateMetrics();const l=this.getZoomInfo(e);if(!(l&&o&&a&&s&&r))return void i();const{x:c,y:h,scale:d,opacity:u}=l,p=()=>{e.state!==sx.Closing&&(u&&(a.style.opacity=Math.max(Math.min(1,1-(1-s.scale)/(1-d)),0)+""),s.scale>=1&&s.scale>s.targetScale-.1&&t(s))},f=e=>{Nb(r,"is-zooming-in"),e.scale<.99||e.scale>1.01||(a.style.opacity="",e.off("endAnimation",f),e.off("touchStart",f),e.off("afterTransform",p),t(e))};s.on("endAnimation",f),s.on("touchStart",f),s.on("afterTransform",p),s.on(["error","destroy"],(()=>{i()})),s.panTo({x:c,y:h,scale:d,friction:0,ignoreBounds:!0}),s.stop("current");const m={event:"mousemove"===s.panMode?n.prevMouseMoveEvent||n.options.event:void 0},g=this.optionFor(e,"initialSize");Ub(r,"is-zooming-in"),n.hideLoading(e),"full"===g?s.zoomToFull(m):"cover"===g?s.zoomToCover(m):"max"===g?s.zoomToMax(m):s.reset(.172)}))}getZoomInfo(e){var t;const{el:i,imageEl:n,thumbEl:r,panzoom:s}=e;if(!i||!n||!r||!s||Jb(r)<3||!this.optionFor(e,"zoom")||this.instance.state===rx.Destroy)return!1;if(1!==((null===(t=window.visualViewport)||void 0===t?void 0:t.scale)||1))return!1;let{top:a,left:o,width:l,height:c}=r.getBoundingClientRect(),{top:h,left:d,fitWidth:u,fitHeight:p}=s.contentRect;if(!(l&&c&&u&&p))return!1;const f=s.container.getBoundingClientRect();d+=f.left,h+=f.top;const m=-1*(d+.5*u-(o+.5*l)),g=-1*(h+.5*p-(a+.5*c)),v=l/u;let _=this.option("zoomOpacity")||!1;return"auto"===_&&(_=Math.abs(l/c-u/p)>.1),{x:m,y:g,scale:v,opacity:_}}attach(){const e=this,t=e.instance;t.on("Carousel.change",e.onChange),t.on("Carousel.createSlide",e.onCreateSlide),t.on("Carousel.removeSlide",e.onRemoveSlide),t.on("close",e.onClose)}detach(){const e=this,t=e.instance;t.off("Carousel.change",e.onChange),t.off("Carousel.createSlide",e.onCreateSlide),t.off("Carousel.removeSlide",e.onRemoveSlide),t.off("close",e.onClose)}}Object.defineProperty(cx,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{initialSize:"fit",Panzoom:{maxScale:1},protected:!1,zoom:!0,zoomOpacity:"auto"}});const hx=(e,t={})=>{const i=new URL(e),n=new URLSearchParams(i.search),r=new URLSearchParams;for(const[e,i]of[...n,...Object.entries(t)]){let t=i.toString();"t"===e?r.set("start",parseInt(t).toString()):r.set(e,t)}let s=r.toString(),a=e.match(/#t=((.*)?\d+s)/);return a&&(s+=`#t=${a[1]}`),s},dx=["image","html","ajax","inline","clone","iframe","map","pdf","html5video","youtube","vimeo","video"];class ux extends Xb{onInitSlide(e,t,i){this.processType(i)}onCreateSlide(e,t,i){this.setContent(i)}onRemoveSlide(e,t,i){i.closeBtnEl&&(i.closeBtnEl.remove(),i.closeBtnEl=void 0),i.xhr&&(i.xhr.abort(),i.xhr=null);const n=i.iframeEl;n&&(n.onload=n.onerror=null,n.src="//about:blank",i.iframeEl=null);const r=i.contentEl,s=i.placeholderEl;if("inline"===i.type&&r&&s)r.classList.remove("fancybox__content"),"none"!==r.style.display&&(r.style.display="none"),s.parentNode&&s.parentNode.insertBefore(r,s),s.remove(),i.placeholderEl=null;else for(;i.el&&i.el.firstChild;)i.el.removeChild(i.el.firstChild)}onSelectSlide(e,t,i){i.state===sx.Ready&&this.playVideo()}onUnselectSlide(e,t,i){var n,r;if("html5video"===i.type){try{null===(r=null===(n=i.el)||void 0===n?void 0:n.querySelector("video"))||void 0===r||r.pause()}catch(e){}return}let s;"vimeo"===i.type?s={method:"pause",value:"true"}:"youtube"===i.type&&(s={event:"command",func:"pauseVideo"}),s&&i.iframeEl&&i.iframeEl.contentWindow&&i.iframeEl.contentWindow.postMessage(JSON.stringify(s),"*"),i.poller&&clearTimeout(i.poller)}onDone(e,t){e.isCurrentSlide(t)&&!e.isClosing()&&this.playVideo()}onRefresh(e,t){t.slides.forEach((e=>{e.el&&(this.setAspectRatio(e),this.resizeIframe(e))}))}onMessage(e){try{let t=JSON.parse(e.data);if("https://player.vimeo.com"===e.origin){if("ready"===t.event)for(let t of Array.from(document.getElementsByClassName("fancybox__iframe")))t instanceof HTMLIFrameElement&&t.contentWindow===e.source&&(t.dataset.ready="true")}else if(e.origin.match(/^https:\/\/(www.)?youtube(-nocookie)?.com$/)&&"onReady"===t.event){const e=document.getElementById(t.id);e&&(e.dataset.ready="true")}}catch(e){}}loadAjaxContent(e){const t=this.instance.optionFor(e,"src")||"";this.instance.showLoading(e);const i=this.instance,n=new XMLHttpRequest;i.showLoading(e),n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&i.state===rx.Ready&&(i.hideLoading(e),200===n.status?i.setContent(e,n.responseText):i.setError(e,404===n.status?"{{AJAX_NOT_FOUND}}":"{{AJAX_FORBIDDEN}}"))};const r=e.ajax||null;n.open(r?"POST":"GET",t+""),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(r),e.xhr=n}setInlineContent(e){let t=null;if(Db(e.src))t=e.src;else if("string"==typeof e.src){const i=e.src.split("#",2).pop();t=i?document.getElementById(i):null}if(t){if("clone"===e.type||t.closest(".fancybox__slide")){t=t.cloneNode(!0);const i=t.dataset.animationName;i&&(t.classList.remove(i),delete t.dataset.animationName);let n=t.getAttribute("id");n=n?`${n}--clone`:`clone-${this.instance.id}-${e.index}`,t.setAttribute("id",n)}else if(t.parentNode){const i=document.createElement("div");i.classList.add("fancybox-placeholder"),t.parentNode.insertBefore(i,t),e.placeholderEl=i}this.instance.setContent(e,t)}else this.instance.setError(e,"{{ELEMENT_NOT_FOUND}}")}setIframeContent(e){const{src:t,el:i}=e;if(!t||"string"!=typeof t||!i)return;const n=this.instance,r=document.createElement("iframe");r.className="fancybox__iframe",r.setAttribute("id",`fancybox__iframe_${n.id}_${e.index}`);for(const[t,i]of Object.entries(this.optionFor(e,"iframeAttr")||{}))r.setAttribute(t,i);r.onerror=()=>{n.setError(e,"{{IFRAME_ERROR}}")},e.iframeEl=r;const s=this.optionFor(e,"preload");if(i.classList.add("is-loading"),"iframe"!==e.type||!1===s)return r.setAttribute("src",e.src+""),this.resizeIframe(e),void n.setContent(e,r);n.showLoading(e),r.onload=()=>{if(!r.src.length)return;const t="true"!==r.dataset.ready;r.dataset.ready="true",this.resizeIframe(e),t?n.revealContent(e):n.hideLoading(e)},r.setAttribute("src",t),n.setContent(e,r,!1)}resizeIframe(e){const t=e.iframeEl,i=null==t?void 0:t.parentElement;if(!t||!i)return;let n=e.autoSize,r=e.width||0,s=e.height||0;r&&s&&(n=!1);const a=i&&i.style;if(!1!==e.preload&&!1!==n&&a)try{const e=window.getComputedStyle(i),n=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight),o=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom),l=t.contentWindow;if(l){const e=l.document,t=e.getElementsByTagName("html")[0],i=e.body;a.width="",i.style.overflow="hidden",r=r||t.scrollWidth+n,a.width=`${r}px`,i.style.overflow="",a.flex="0 0 auto",a.height=`${i.scrollHeight}px`,s=t.scrollHeight+o}}catch(e){}if(r||s){const e={flex:"0 1 auto",width:"",height:""};r&&(e.width=`${r}px`),s&&(e.height=`${s}px`),Object.assign(a,e)}}playVideo(){const e=this.instance.getSlide();if(!e)return;const{el:t}=e;if(!t||!t.offsetParent)return;if(!this.optionFor(e,"videoAutoplay"))return;if("html5video"===e.type)try{const e=t.querySelector("video");if(e){const t=e.play();void 0!==t&&t.then((()=>{})).catch((t=>{e.muted=!0,e.play()}))}}catch(e){}if("youtube"!==e.type&&"vimeo"!==e.type)return;const i=()=>{if(e.iframeEl&&e.iframeEl.contentWindow){let t;if("true"===e.iframeEl.dataset.ready)return t="youtube"===e.type?{event:"command",func:"playVideo"}:{method:"play",value:"true"},t&&e.iframeEl.contentWindow.postMessage(JSON.stringify(t),"*"),void(e.poller=void 0);"youtube"===e.type&&(t={event:"listening",id:e.iframeEl.getAttribute("id")},e.iframeEl.contentWindow.postMessage(JSON.stringify(t),"*"))}e.poller=setTimeout(i,250)};i()}processType(e){if(e.html)return e.type="html",e.src=e.html,void(e.html="");const t=this.instance.optionFor(e,"src","");if(!t||"string"!=typeof t)return;let i=e.type,n=null;if(n=t.match(/(youtube\.com|youtu\.be|youtube\-nocookie\.com)\/(?:watch\?(?:.*&)?v=|v\/|u\/|shorts\/|embed\/?)?(videoseries\?list=(?:.*)|[\w-]{11}|\?listType=(?:.*)&list=(?:.*))(?:.*)/i)){const r=this.optionFor(e,"youtube"),{nocookie:s}=r,a=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(r,["nocookie"]),o=`www.youtube${s?"-nocookie":""}.com`,l=hx(t,a),c=encodeURIComponent(n[2]);e.videoId=c,e.src=`https://${o}/embed/${c}?${l}`,e.thumbSrc=e.thumbSrc||`https://i.ytimg.com/vi/${c}/mqdefault.jpg`,i="youtube"}else if(n=t.match(/^.+vimeo.com\/(?:\/)?([\d]+)((\/|\?h=)([a-z0-9]+))?(.*)?/)){const r=hx(t,this.optionFor(e,"vimeo")),s=encodeURIComponent(n[1]),a=n[4]||"";e.videoId=s,e.src=`https://player.vimeo.com/video/${s}?${a?`h=${a}${r?"&":""}`:""}${r}`,i="vimeo"}if(!i&&e.triggerEl){const t=e.triggerEl.dataset.type;dx.includes(t)&&(i=t)}i||"string"==typeof t&&("#"===t.charAt(0)?i="inline":(n=t.match(/\.(mp4|mov|ogv|webm)((\?|#).*)?$/i))?(i="html5video",e.videoFormat=e.videoFormat||"video/"+("ogv"===n[1]?"ogg":n[1])):t.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\?|#).*)?$)/i)?i="image":t.match(/\.(pdf)((\?|#).*)?$/i)?i="pdf":(n=t.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:(?:(?:maps\/(?:place\/(?:.*)\/)?\@(.*),(\d+.?\d+?)z))|(?:\?ll=))(.*)?/i))?(e.src=`https://maps.google.${n[1]}/?ll=${(n[2]?n[2]+"&z="+Math.floor(parseFloat(n[3]))+(n[4]?n[4].replace(/^\//,"&"):""):n[4]+"").replace(/\?/,"&")}&output=${n[4]&&n[4].indexOf("layer=c")>0?"svembed":"embed"}`,i="map"):(n=t.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:maps\/search\/)(.*)/i))&&(e.src=`https://maps.google.${n[1]}/maps?q=${n[2].replace("query=","q=").replace("api=1","")}&output=embed`,i="map")),i=i||this.instance.option("defaultType"),e.type=i,"image"===i&&(e.thumbSrc=e.thumbSrc||e.src)}setContent(e){const t=this.instance.optionFor(e,"src")||"";if(e&&e.type&&t){switch(e.type){case"html":this.instance.setContent(e,t);break;case"html5video":const i=this.option("videoTpl");i&&this.instance.setContent(e,i.replace(/\{\{src\}\}/gi,t+"").replace(/\{\{format\}\}/gi,this.optionFor(e,"videoFormat")||"").replace(/\{\{poster\}\}/gi,e.poster||e.thumbSrc||""));break;case"inline":case"clone":this.setInlineContent(e);break;case"ajax":this.loadAjaxContent(e);break;case"pdf":case"map":case"youtube":case"vimeo":e.preload=!1;case"iframe":this.setIframeContent(e)}this.setAspectRatio(e)}}setAspectRatio(e){var t;const i=e.contentEl,n=this.optionFor(e,"videoRatio"),r=null===(t=e.el)||void 0===t?void 0:t.getBoundingClientRect();if(!(i&&r&&n&&1!==n&&e.type&&["video","youtube","vimeo","html5video"].includes(e.type)))return;const s=r.width,a=r.height;i.style.aspectRatio=n+"",i.style.width=s/a>n?"auto":"",i.style.height=s/a>n?"":"auto"}attach(){const e=this.instance;e.on("Carousel.initSlide",this.onInitSlide),e.on("Carousel.createSlide",this.onCreateSlide),e.on("Carousel.removeSlide",this.onRemoveSlide),e.on("Carousel.selectSlide",this.onSelectSlide),e.on("Carousel.unselectSlide",this.onUnselectSlide),e.on("Carousel.Panzoom.refresh",this.onRefresh),e.on("done",this.onDone),window.addEventListener("message",this.onMessage)}detach(){const e=this.instance;e.off("Carousel.initSlide",this.onInitSlide),e.off("Carousel.createSlide",this.onCreateSlide),e.off("Carousel.removeSlide",this.onRemoveSlide),e.off("Carousel.selectSlide",this.onSelectSlide),e.off("Carousel.unselectSlide",this.onUnselectSlide),e.off("Carousel.Panzoom.refresh",this.onRefresh),e.off("done",this.onDone),window.removeEventListener("message",this.onMessage)}}Object.defineProperty(ux,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{ajax:null,autoSize:!0,iframeAttr:{allow:"autoplay; fullscreen",scrolling:"auto"},preload:!0,videoAutoplay:!0,videoRatio:16/9,videoTpl:'<video class="fancybox__html5video" playsinline controls controlsList="nodownload" poster="{{poster}}">\n  <source src="{{src}}" type="{{format}}" />Sorry, your browser doesn\'t support embedded videos.</video>',videoFormat:"",vimeo:{byline:1,color:"00adef",controls:1,dnt:1,muted:0},youtube:{controls:1,enablejsapi:1,nocookie:1,rel:0,fs:1}}});class px extends Xb{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:"ready"}),Object.defineProperty(this,"inHover",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"progressBar",{enumerable:!0,configurable:!0,writable:!0,value:null})}get isActive(){return"ready"!==this.state}onReady(e){this.option("autoStart")&&(e.isInfinite||e.page<e.pages.length-1)&&this.start()}onChange(){var e;(null===(e=this.instance.panzoom)||void 0===e?void 0:e.isResting)||(this.removeProgressBar(),this.pause())}onSettle(){this.resume()}onVisibilityChange(){"visible"===document.visibilityState?this.resume():this.pause()}onMouseEnter(){this.inHover=!0,this.pause()}onMouseLeave(){var e;this.inHover=!1,(null===(e=this.instance.panzoom)||void 0===e?void 0:e.isResting)&&this.resume()}onTimerEnd(){"play"===this.state&&(this.instance.isInfinite||this.instance.page!==this.instance.pages.length-1?this.instance.slideNext():this.instance.slideTo(0))}removeProgressBar(){this.progressBar&&(this.progressBar.remove(),this.progressBar=null)}createProgressBar(){var e;if(!this.option("showProgress"))return null;this.removeProgressBar();const t=this.instance,i=(null===(e=t.pages[t.page])||void 0===e?void 0:e.slides)||[];let n=this.option("progressParentEl");if(n||(n=(1===i.length?i[0].el:null)||t.viewport),!n)return null;const r=document.createElement("div");return Ub(r,"f-progress"),n.prepend(r),this.progressBar=r,r.offsetHeight,r}set(){if(this.instance.pages.length<2)return;if(this.progressBar)return;const e=this.option("timeout");this.state="play",Ub(this.instance.container,"has-autoplay");let t=this.createProgressBar();t&&(t.style.transitionDuration=`${e}ms`,t.style.transform="scaleX(1)"),this.timer=setTimeout((()=>{this.timer=null,this.inHover||this.onTimerEnd()}),e),this.emit("set")}clear(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.removeProgressBar()}start(){if(this.set(),this.option("pauseOnHover")){const e=this.instance.container;e.addEventListener("mouseenter",this.onMouseEnter,!1),e.addEventListener("mouseleave",this.onMouseLeave,!1)}document.addEventListener("visibilitychange",this.onVisibilityChange,!1)}stop(){const e=this.instance.container;this.clear(),this.state="ready",e.removeEventListener("mouseenter",this.onMouseEnter,!1),e.removeEventListener("mouseleave",this.onMouseLeave,!1),document.removeEventListener("visibilitychange",this.onVisibilityChange,!1),Nb(e,"has-autoplay"),this.emit("stop")}pause(){"play"===this.state&&(this.state="pause",this.clear(),this.emit("pause"))}resume(){const e=this.instance;if(e.isInfinite||e.page!==e.pages.length-1)if("play"!==this.state){if("pause"===this.state&&!this.inHover){const e=new Event("resume",{bubbles:!0,cancelable:!0});this.emit("resume",event),e.defaultPrevented||this.set()}}else this.set();else this.stop()}toggle(){"play"===this.state||"pause"===this.state?this.stop():this.set()}attach(){const e=this,t=e.instance;t.on("ready",e.onReady),t.on("Panzoom.startAnimation",e.onChange),t.on("Panzoom.endAnimation",e.onSettle),t.on("Panzoom.touchMove",e.onChange)}detach(){const e=this,t=e.instance;t.off("ready",e.onReady),t.off("Panzoom.startAnimation",e.onChange),t.off("Panzoom.endAnimation",e.onSettle),t.off("Panzoom.touchMove",e.onChange),e.stop()}}Object.defineProperty(px,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{autoStart:!0,pauseOnHover:!0,progressParentEl:null,showProgress:!0,timeout:3e3}});class fx extends Xb{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null})}onPrepare(e){const t=e.carousel;if(!t)return;const i=e.container;i&&(t.options.Autoplay=Tb({autoStart:!1},this.option("Autoplay")||{},{pauseOnHover:!1,timeout:this.option("timeout"),progressParentEl:()=>this.option("progressParentEl")||null,on:{set:t=>{var n;i.classList.add("has-slideshow"),(null===(n=e.getSlide())||void 0===n?void 0:n.state)!==sx.Ready&&t.pause()},stop:()=>{i.classList.remove("has-slideshow"),e.isCompact||e.endIdle()},resume:(t,i)=>{var n,r,s;!i||!i.cancelable||(null===(n=e.getSlide())||void 0===n?void 0:n.state)===sx.Ready&&(null===(s=null===(r=e.carousel)||void 0===r?void 0:r.panzoom)||void 0===s?void 0:s.isResting)||i.preventDefault()}}}),t.attachPlugins({Autoplay:px}),this.ref=t.plugins.Autoplay)}onReady(e){const t=e.carousel,i=this.ref;t&&i&&this.option("playOnStart")&&(t.isInfinite||t.page<t.pages.length-1)&&i.start()}onDone(e,t){const i=this.ref;if(!i)return;const n=t.panzoom;n&&n.on("startAnimation",(()=>{e.isCurrentSlide(t)&&i.stop()})),e.isCurrentSlide(t)&&i.resume()}onKeydown(e,t){var i;const n=this.ref;n&&t===this.option("key")&&"BUTTON"!==(null===(i=document.activeElement)||void 0===i?void 0:i.nodeName)&&n.toggle()}attach(){const e=this,t=e.instance;t.on("Carousel.init",e.onPrepare),t.on("Carousel.ready",e.onReady),t.on("done",e.onDone),t.on("keydown",e.onKeydown)}detach(){const e=this,t=e.instance;t.off("Carousel.init",e.onPrepare),t.off("Carousel.ready",e.onReady),t.off("done",e.onDone),t.off("keydown",e.onKeydown)}}Object.defineProperty(fx,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{key:" ",playOnStart:!1,progressParentEl:e=>{var t;return(null===(t=e.instance.container)||void 0===t?void 0:t.querySelector(".fancybox__toolbar [data-fancybox-toggle-slideshow]"))||e.instance.container},timeout:3e3}});const mx={classes:{container:"f-thumbs f-carousel__thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide",isResting:"is-resting",isSelected:"is-selected",isLoading:"is-loading",hasThumbs:"has-thumbs"},minCount:2,parentEl:null,thumbTpl:'<button class="f-thumbs__slide__button" tabindex="0" type="button" aria-label="{{GOTO}}" data-carousel-index="%i"><img class="f-thumbs__slide__img" data-lazy-src="{{%s}}" alt="" /></button>',type:"modern"};var gx;!function(e){e[e.Init=0]="Init",e[e.Ready=1]="Ready",e[e.Hidden=2]="Hidden",e[e.Disabled=3]="Disabled"}(gx||(gx={}));let vx=class extends Xb{constructor(){super(...arguments),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:"modern"}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"panzoom",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"thumbWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbClipWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbExtraGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"shouldCenter",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:gx.Init})}formatThumb(e,t){return this.instance.localize(t,[["%i",e.index],["%d",e.index+1],["%s",e.thumbSrc||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"]])}getSlides(){const e=[],t=this.option("thumbTpl")||"";if(t)for(const i of this.instance.slides||[]){let n="";i.type&&(n=`for-${i.type}`,i.type&&["video","youtube","vimeo","html5video"].includes(i.type)&&(n+=" for-video")),e.push({html:this.formatThumb(i,t),customClass:n})}return e}onInitSlide(e,t){const i=t.el;i&&(t.thumbSrc=i.dataset.thumbSrc||t.thumbSrc||"",t.thumbClipWidth=parseFloat(i.dataset.thumbClipWidth||"")||t.thumbClipWidth||0,t.thumbHeight=parseFloat(i.dataset.thumbHeight||"")||t.thumbHeight||0)}onInitSlides(){this.state===gx.Init&&this.build()}onRefreshM(){this.refreshModern()}onChangeM(){"modern"===this.type&&(this.shouldCenter=!0,this.centerModern())}onClickModern(e){e.preventDefault(),e.stopPropagation();const t=this.instance,i=t.page,n=e=>{if(e){const t=e.closest("[data-carousel-index]");if(t)return parseInt(t.dataset.carouselIndex||"",10)||0}return-1},r=(e,t)=>{const i=document.elementFromPoint(e,t);return i?n(i):-1};let s=n(e.target);s<0&&(s=r(e.clientX+this.thumbGap,e.clientY),s===i&&(s=i-1)),s<0&&(s=r(e.clientX-this.thumbGap,e.clientY),s===i&&(s=i+1)),s<0&&(s=(t=>{let n=r(e.clientX-t,e.clientY),a=r(e.clientX+t,e.clientY);return s<0&&n===i&&(s=i+1),s<0&&a===i&&(s=i-1),s})(this.thumbExtraGap)),s===i?this.centerModern():s>-1&&s<t.pages.length&&t.slideTo(s)}onTransformM(){if("modern"!==this.type)return;const{instance:e,container:t,track:i}=this,n=e.panzoom;if(!(t&&i&&n&&this.panzoom))return;_b(t,this.cn("isResting"),n.state!==Lb.Init&&n.isResting);const r=this.thumbGap,s=this.thumbExtraGap,a=this.thumbClipWidth;let o=0,l=0,c=0;for(const t of e.slides){let i=t.index,n=t.thumbSlideEl;if(!n)continue;_b(n,this.cn("isSelected"),i===e.page),l=1-Math.abs(e.getProgress(i)),n.style.setProperty("--progress",l?l+"":"");const h=.5*((t.thumbWidth||0)-a);o+=r,o+=h,l&&(o-=l*(h+s)),n.style.setProperty("--shift",o-r+""),o+=h,l&&(o-=l*(h+s)),o-=r,0===i&&(c=s*l)}i&&(i.style.setProperty("--left",c+""),i.style.setProperty("--width",o+c+r+s*l+"")),this.shouldCenter&&this.centerModern()}buildClassic(){const{container:e,track:t}=this,i=this.getSlides();if(!e||!t||!i)return;const n=new this.instance.constructor(e,Tb({track:t,infinite:!1,center:!0,fill:!0,dragFree:!0,slidesPerPage:1,transition:!1,Dots:!1,Navigation:!1,Sync:{},classes:{container:"f-thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide"}},this.option("Carousel")||{},{Sync:{target:this.instance},slides:i}));this.carousel=n,this.track=t,n.on("ready",(()=>{this.emit("ready")}))}buildModern(){if("modern"!==this.type)return;const{container:e,track:t,instance:i}=this,n=this.option("thumbTpl")||"";if(!e||!t||!n)return;Ub(e,"is-horizontal"),this.updateModern();for(const e of i.slides||[]){const i=document.createElement("div");if(Ub(i,this.cn("slide")),e.type){let t=`for-${e.type}`;["video","youtube","vimeo","html5video"].includes(e.type)&&(t+=" for-video"),Ub(i,t)}i.appendChild(gb(this.formatThumb(e,n))),e.thumbSlideEl=i,t.appendChild(i),this.resizeModernSlide(e)}const r=new i.constructor.Panzoom(e,{content:t,lockAxis:"x",zoom:!1,panOnlyZoomed:!1,bounds:()=>{let e=0,t=0,n=i.slides[0],r=i.slides[i.slides.length-1],s=i.slides[i.page];return n&&r&&s&&(t=-1*this.getModernThumbPos(0),0!==i.page&&(t+=.5*(n.thumbWidth||0)),e=-1*this.getModernThumbPos(i.slides.length-1),i.page!==i.slides.length-1&&(e+=(r.thumbWidth||0)-(s.thumbWidth||0)-.5*(r.thumbWidth||0))),{x:{min:e,max:t},y:{min:0,max:0}}}});r.on("touchStart",((e,t)=>{this.shouldCenter=!1})),r.on("click",((e,t)=>this.onClickModern(t))),r.on("ready",(()=>{this.centerModern(),this.emit("ready")})),r.on(["afterTransform","refresh"],(e=>{this.lazyLoadModern()})),this.panzoom=r,this.refreshModern()}updateModern(){if("modern"!==this.type)return;const{container:e}=this;e&&(this.thumbGap=parseFloat(getComputedStyle(e).getPropertyValue("--f-thumb-gap"))||0,this.thumbExtraGap=parseFloat(getComputedStyle(e).getPropertyValue("--f-thumb-extra-gap"))||0,this.thumbWidth=parseFloat(getComputedStyle(e).getPropertyValue("--f-thumb-width"))||40,this.thumbClipWidth=parseFloat(getComputedStyle(e).getPropertyValue("--f-thumb-clip-width"))||40,this.thumbHeight=parseFloat(getComputedStyle(e).getPropertyValue("--f-thumb-height"))||40)}refreshModern(){var e;if("modern"===this.type){this.updateModern();for(const e of this.instance.slides||[])this.resizeModernSlide(e);this.onTransformM(),null===(e=this.panzoom)||void 0===e||e.updateMetrics(!0),this.centerModern(0)}}centerModern(e){const t=this.instance,{container:i,panzoom:n}=this;if(!i||!n||n.state===Lb.Init)return;const r=t.page;let s=this.getModernThumbPos(r),a=s;for(let e=t.page-3;e<t.page+3;e++){if(e<0||e>t.pages.length-1||e===t.page)continue;const i=1-Math.abs(t.getProgress(e));i>0&&i<1&&(a+=i*(this.getModernThumbPos(e)-s))}let o=100;void 0===e&&(e=.2,t.inTransition.size>0&&(e=.12),Math.abs(-1*n.current.e-a)>n.containerRect.width&&(e=.5,o=0)),n.options.maxVelocity=o,n.applyChange({panX:pb(-1*a-n.target.e,1e3),friction:null===t.prevPage?0:e})}lazyLoadModern(){const{instance:e,panzoom:t}=this;if(!t)return;const i=-1*t.current.e||0;let n=this.getModernThumbPos(e.page);if(t.state!==Lb.Init||0===n)for(const n of e.slides||[]){const e=n.thumbSlideEl;if(!e)continue;const r=e.querySelector("img[data-lazy-src]"),s=n.index,a=this.getModernThumbPos(s),o=i-.5*t.containerRect.innerWidth,l=o+t.containerRect.innerWidth;if(!r||a<o||a>l)continue;let c=r.dataset.lazySrc;if(!c||!c.length)continue;if(delete r.dataset.lazySrc,r.src=c,r.complete)continue;Ub(e,this.cn("isLoading"));const h=gb(Ib);e.appendChild(h),r.addEventListener("load",(()=>{e.offsetParent&&(e.classList.remove(this.cn("isLoading")),h.remove())}),!1)}}resizeModernSlide(e){if("modern"!==this.type)return;if(!e.thumbSlideEl)return;const t=e.thumbClipWidth&&e.thumbHeight?Math.round(this.thumbHeight*(e.thumbClipWidth/e.thumbHeight)):this.thumbWidth;e.thumbWidth=t}getModernThumbPos(e){const t=this.instance.slides[e],i=this.panzoom;if(!i||!i.contentRect.fitWidth)return 0;let n=i.containerRect.innerWidth,r=i.contentRect.width;2===this.instance.slides.length&&(e-=1,r=2*this.thumbClipWidth);let s=e*(this.thumbClipWidth+this.thumbGap)+this.thumbExtraGap+.5*(t.thumbWidth||0);return s-=r>n?.5*n:.5*r,pb(s||0,1)}build(){const e=this.instance,t=e.container,i=this.option("minCount")||0;if(i){let t=0;for(const i of e.slides||[])i.thumbSrc&&t++;if(t<i)return this.cleanup(),void(this.state=gx.Disabled)}const n=this.option("type");if(["modern","classic"].indexOf(n)<0)return void(this.state=gx.Disabled);this.type=n;const r=document.createElement("div");Ub(r,this.cn("container")),Ub(r,`is-${n}`);const s=this.option("parentEl");s?s.appendChild(r):t.after(r),this.container=r,Ub(t,this.cn("hasThumbs"));const a=document.createElement("div");Ub(a,this.cn("track")),r.appendChild(a),this.track=a,"classic"===n?this.buildClassic():this.buildModern(),this.state=gx.Ready,r.addEventListener("click",(t=>{setTimeout((()=>{var t;null===(t=null==r?void 0:r.querySelector(`[data-carousel-index="${e.page}"]`))||void 0===t||t.focus()}),100)}))}cleanup(){this.carousel&&this.carousel.destroy(),this.carousel=null,this.panzoom&&this.panzoom.destroy(),this.panzoom=null,this.container&&this.container.remove(),this.container=null,this.track=null,this.state=gx.Init,Nb(this.instance.container,this.cn("hasThumbs"))}attach(){const e=this,t=e.instance;t.on("initSlide",e.onInitSlide),t.state===jb.Init?t.on("initSlides",e.onInitSlides):e.onInitSlides(),t.on("Panzoom.afterTransform",e.onTransformM),t.on("Panzoom.refresh",e.onRefreshM),t.on("change",e.onChangeM)}detach(){const e=this,t=e.instance;t.off("initSlide",e.onInitSlide),t.off("initSlides",e.onInitSlides),t.off("Panzoom.afterTransform",e.onTransformM),t.off("Panzoom.refresh",e.onRefreshM),t.off("change",e.onChangeM),e.cleanup()}};Object.defineProperty(vx,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:mx});const _x=Object.assign(Object.assign({},mx),{key:"t",showOnStart:!0,parentEl:null});class yx extends Xb{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hidden",{enumerable:!0,configurable:!0,writable:!0,value:!1})}get isEnabled(){const e=this.ref;return e&&e.state!==gx.Disabled}get isHidden(){return this.hidden}onInit(){const e=this.instance,t=e.carousel;if(this.ref||!t)return;const i=this.option("parentEl")||e.footer||e.container;i&&(t.options.Thumbs=Tb({},this.options,{parentEl:i,classes:{container:"f-thumbs fancybox__thumbs"},Carousel:{Sync:{friction:e.option("Carousel.friction")},on:{click:(e,t)=>{t.stopPropagation()}}},on:{ready:e=>{const t=e.container;t&&this.hidden&&(this.refresh(),t.style.transition="none",this.hide(),t.offsetHeight,queueMicrotask((()=>{t.style.transition="",this.show()})))}}}),t.attachPlugins({Thumbs:vx}),this.ref=t.plugins.Thumbs,this.option("showOnStart")||(this.ref.state=gx.Hidden,this.hidden=!0))}onResize(){var e;const t=null===(e=this.ref)||void 0===e?void 0:e.container;t&&(t.style.maxHeight="")}onKeydown(e,t){const i=this.option("key");i&&i===t&&this.toggle()}toggle(){const e=this.ref;e&&e.state!==gx.Disabled&&(e.state!==gx.Hidden?this.hidden?this.show():this.hide():e.build())}show(){const e=this.ref,t=e&&e.state!==gx.Disabled&&e.container;t&&(this.refresh(),t.offsetHeight,t.removeAttribute("aria-hidden"),t.classList.remove("is-hidden"),this.hidden=!1)}hide(){const e=this.ref,t=e&&e.container;t&&(this.refresh(),t.offsetHeight,t.classList.add("is-hidden"),t.setAttribute("aria-hidden","true")),this.hidden=!0}refresh(){const e=this.ref;if(!e||e.state===gx.Disabled)return;const t=e.container,i=(null==t?void 0:t.firstChild)||null;t&&i&&i.childNodes.length&&(t.style.maxHeight=`${i.getBoundingClientRect().height}px`)}attach(){const e=this,t=e.instance;t.state===rx.Init?t.on("Carousel.init",e.onInit):e.onInit(),t.on("resize",e.onResize),t.on("keydown",e.onKeydown)}detach(){var e;const t=this,i=t.instance;i.off("Carousel.init",t.onInit),i.off("resize",t.onResize),i.off("keydown",t.onKeydown),null===(e=i.carousel)||void 0===e||e.detachPlugins(["Thumbs"]),t.ref=null}}Object.defineProperty(yx,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:_x});const bx={panLeft:{icon:'<svg><path d="M5 12h14M5 12l6 6M5 12l6-6"/></svg>',change:{panX:-100}},panRight:{icon:'<svg><path d="M5 12h14M13 18l6-6M13 6l6 6"/></svg>',change:{panX:100}},panUp:{icon:'<svg><path d="M12 5v14M18 11l-6-6M6 11l6-6"/></svg>',change:{panY:-100}},panDown:{icon:'<svg><path d="M12 5v14M18 13l-6 6M6 13l6 6"/></svg>',change:{panY:100}},zoomIn:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M11 8v6M8 11h6"/></svg>',action:"zoomIn"},zoomOut:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"zoomOut"},toggle1to1:{icon:'<svg><path d="M3.51 3.07c5.74.02 11.48-.02 17.22.02 1.37.1 2.34 1.64 2.18 3.13 0 4.08.02 8.16 0 12.23-.1 1.54-1.47 2.64-2.79 2.46-5.61-.01-11.24.02-16.86-.01-1.36-.12-2.33-1.65-2.17-3.14 0-4.07-.02-8.16 0-12.23.1-1.36 1.22-2.48 2.42-2.46Z"/><path d="M5.65 8.54h1.49v6.92m8.94-6.92h1.49v6.92M11.5 9.4v.02m0 5.18v0"/></svg>',action:"toggleZoom"},toggleZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"toggleZoom"},iterateZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"iterateZoom"},rotateCCW:{icon:'<svg><path d="M15 4.55a8 8 0 0 0-6 14.9M9 15v5H4M18.37 7.16v.01M13 19.94v.01M16.84 18.37v.01M19.37 15.1v.01M19.94 11v.01"/></svg>',action:"rotateCCW"},rotateCW:{icon:'<svg><path d="M9 4.55a8 8 0 0 1 6 14.9M15 15v5h5M5.63 7.16v.01M4.06 11v.01M4.63 15.1v.01M7.16 18.37v.01M11 19.94v.01"/></svg>',action:"rotateCW"},flipX:{icon:'<svg style="stroke-width: 1.3"><path d="M12 3v18M16 7v10h5L16 7M8 7v10H3L8 7"/></svg>',action:"flipX"},flipY:{icon:'<svg style="stroke-width: 1.3"><path d="M3 12h18M7 16h10L7 21v-5M7 8h10L7 3v5"/></svg>',action:"flipY"},fitX:{icon:'<svg><path d="M4 12V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v6M10 18H3M21 18h-7M6 15l-3 3 3 3M18 15l3 3-3 3"/></svg>',action:"fitX"},fitY:{icon:'<svg><path d="M12 20H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h6M18 14v7M18 3v7M15 18l3 3 3-3M15 6l3-3 3 3"/></svg>',action:"fitY"},reset:{icon:'<svg><path d="M20 11A8.1 8.1 0 0 0 4.5 9M4 5v4h4M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4"/></svg>',action:"reset"},toggleFS:{icon:'<svg><g><path d="M14.5 9.5 21 3m0 0h-6m6 0v6M3 21l6.5-6.5M3 21v-6m0 6h6"/></g><g><path d="m14 10 7-7m-7 7h6m-6 0V4M3 21l7-7m0 0v6m0-6H4"/></g></svg>',action:"toggleFS"}};var xx;!function(e){e[e.Init=0]="Init",e[e.Ready=1]="Ready",e[e.Disabled=2]="Disabled"}(xx||(xx={}));const wx={tabindex:"-1",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"};class Ex extends Xb{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:xx.Init}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null})}onReady(e){var t;if(!e.carousel)return;let i=this.option("display"),n=this.option("absolute"),r=this.option("enabled");if("auto"===r){const e=this.instance.carousel;let t=0;if(e)for(const i of e.slides)(i.panzoom||"image"===i.type)&&t++;t||(r=!1)}r||(i=void 0);let s=0;const a={left:[],middle:[],right:[]};if(i)for(const e of["left","middle","right"])for(const n of i[e]){const i=this.createEl(n);i&&(null===(t=a[e])||void 0===t||t.push(i),s++)}let o=null;if(s&&(o=this.createContainer()),o){for(const[e,t]of Object.entries(a)){const i=document.createElement("div");Ub(i,"fancybox__toolbar__column is-"+e);for(const e of t)i.appendChild(e);"auto"!==n||"middle"!==e||t.length||(n=!0),o.appendChild(i)}!0===n&&Ub(o,"is-absolute"),this.state=xx.Ready,this.onRefresh()}else this.state=xx.Disabled}onClick(e){var t,i;const n=this.instance,r=n.getSlide(),s=null==r?void 0:r.panzoom,a=e.target,o=a&&Db(a)?a.dataset:null;if(!o)return;if(void 0!==o.fancyboxToggleThumbs)return e.preventDefault(),e.stopPropagation(),void(null===(t=n.plugins.Thumbs)||void 0===t||t.toggle());if(void 0!==o.fancyboxToggleFullscreen)return e.preventDefault(),e.stopPropagation(),void this.instance.toggleFullscreen();if(void 0!==o.fancyboxToggleSlideshow){e.preventDefault(),e.stopPropagation();const t=null===(i=n.carousel)||void 0===i?void 0:i.plugins.Autoplay;let r=t.isActive;return s&&"mousemove"===s.panMode&&!r&&s.reset(),void(r?t.stop():t.start())}const l=o.panzoomAction,c=o.panzoomChange;if((c||l)&&(e.preventDefault(),e.stopPropagation()),c){let t={};try{t=JSON.parse(c)}catch(e){}s&&s.applyChange(t)}else l&&s&&s[l]&&s[l]()}onChange(){this.onRefresh()}onRefresh(){if(this.instance.isClosing())return;const e=this.container;if(!e)return;const t=this.instance.getSlide();if(!t||t.state!==sx.Ready)return;const i=t&&!t.error&&t.panzoom;for(const t of e.querySelectorAll("[data-panzoom-action]"))i?(t.removeAttribute("disabled"),t.removeAttribute("tabindex")):(t.setAttribute("disabled",""),t.setAttribute("tabindex","-1"));let n=i&&i.canZoomIn(),r=i&&i.canZoomOut();for(const t of e.querySelectorAll('[data-panzoom-action="zoomIn"]'))n?(t.removeAttribute("disabled"),t.removeAttribute("tabindex")):(t.setAttribute("disabled",""),t.setAttribute("tabindex","-1"));for(const t of e.querySelectorAll('[data-panzoom-action="zoomOut"]'))r?(t.removeAttribute("disabled"),t.removeAttribute("tabindex")):(t.setAttribute("disabled",""),t.setAttribute("tabindex","-1"));for(const t of e.querySelectorAll('[data-panzoom-action="toggleZoom"],[data-panzoom-action="iterateZoom"]')){r||n?(t.removeAttribute("disabled"),t.removeAttribute("tabindex")):(t.setAttribute("disabled",""),t.setAttribute("tabindex","-1"));const e=t.querySelector("g");e&&(e.style.display=n?"":"none")}}onDone(e,t){var i;null===(i=t.panzoom)||void 0===i||i.on("afterTransform",(()=>{this.instance.isCurrentSlide(t)&&this.onRefresh()})),this.instance.isCurrentSlide(t)&&this.onRefresh()}createContainer(){const e=this.instance.container;if(!e)return null;const t=this.option("parentEl")||e,i=document.createElement("div");return Ub(i,"fancybox__toolbar"),t.prepend(i),i.addEventListener("click",this.onClick,{passive:!1,capture:!0}),e&&Ub(e,"has-toolbar"),this.container=i,i}createEl(e){var t;const i=this.instance.carousel;if(!i)return null;if("toggleFS"===e)return null;if("fullscreen"===e&&!this.instance.fsAPI)return null;let n=null;const r=i.slides.length||0;let s=0,a=0;for(const e of i.slides)(e.panzoom||"image"===e.type)&&s++,("image"===e.type||e.downloadSrc)&&a++;if(r<2&&["infobar","prev","next"].includes(e))return n;if(void 0!==bx[e]&&!s)return null;if("download"===e&&!a)return null;if("thumbs"===e){const e=this.instance.plugins.Thumbs;if(!e||!e.isEnabled)return null}if("slideshow"===e&&(!(null===(t=this.instance.carousel)||void 0===t?void 0:t.plugins.Autoplay)||r<2))return null;if(void 0!==bx[e]){const t=bx[e];n=document.createElement("button"),n.setAttribute("title",this.instance.localize(`{{${e.toUpperCase()}}}`)),Ub(n,"f-button"),t.action&&(n.dataset.panzoomAction=t.action),t.change&&(n.dataset.panzoomChange=JSON.stringify(t.change)),n.appendChild(gb(this.instance.localize(t.icon)))}else{const t=(this.option("items")||[])[e];t&&(n=gb(this.instance.localize(t.tpl)),"function"==typeof t.click&&n.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),"function"==typeof t.click&&t.click.call(this,this,e)})))}const o=null==n?void 0:n.querySelector("svg");if(o)for(const[e,t]of Object.entries(wx))o.getAttribute(e)||o.setAttribute(e,String(t));return n}removeContainer(){const e=this.container;e&&e.remove(),this.container=null,this.state=xx.Disabled;const t=this.instance.container;t&&Nb(t,"has-toolbar")}attach(){const e=this,t=e.instance;t.on("Carousel.initSlides",e.onReady),t.on("done",e.onDone),t.on("reveal",e.onChange),t.on("Carousel.change",e.onChange),e.onReady(e.instance)}detach(){const e=this,t=e.instance;t.off("Carousel.initSlides",e.onReady),t.off("done",e.onDone),t.off("reveal",e.onChange),t.off("Carousel.change",e.onChange),e.removeContainer()}}Object.defineProperty(Ex,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{absolute:"auto",display:{left:["infobar"],middle:[],right:["iterateZoom","slideshow","fullscreen","thumbs","close"]},enabled:"auto",items:{infobar:{tpl:'<div class="fancybox__infobar" tabindex="-1"><span data-fancybox-current-index></span>/<span data-fancybox-count></span></div>'},download:{tpl:'<a class="f-button" title="{{DOWNLOAD}}" data-fancybox-download href="javasript:;"><svg><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2M7 11l5 5 5-5M12 4v12"/></svg></a>'},prev:{tpl:'<button class="f-button" title="{{PREV}}" data-fancybox-prev><svg><path d="m15 6-6 6 6 6"/></svg></button>'},next:{tpl:'<button class="f-button" title="{{NEXT}}" data-fancybox-next><svg><path d="m9 6 6 6-6 6"/></svg></button>'},slideshow:{tpl:'<button class="f-button" title="{{TOGGLE_SLIDESHOW}}" data-fancybox-toggle-slideshow><svg><g><path d="M8 4v16l13 -8z"></path></g><g><path d="M8 4v15M17 4v15"/></g></svg></button>'},fullscreen:{tpl:'<button class="f-button" title="{{TOGGLE_FULLSCREEN}}" data-fancybox-toggle-fullscreen><svg><g><path d="M4 8V6a2 2 0 0 1 2-2h2M4 16v2a2 2 0 0 0 2 2h2M16 4h2a2 2 0 0 1 2 2v2M16 20h2a2 2 0 0 0 2-2v-2"/></g><g><path d="M15 19v-2a2 2 0 0 1 2-2h2M15 5v2a2 2 0 0 0 2 2h2M5 15h2a2 2 0 0 1 2 2v2M5 9h2a2 2 0 0 0 2-2V5"/></g></svg></button>'},thumbs:{tpl:'<button class="f-button" title="{{TOGGLE_THUMBS}}" data-fancybox-toggle-thumbs><svg><circle cx="5.5" cy="5.5" r="1"/><circle cx="12" cy="5.5" r="1"/><circle cx="18.5" cy="5.5" r="1"/><circle cx="5.5" cy="12" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="18.5" cy="12" r="1"/><circle cx="5.5" cy="18.5" r="1"/><circle cx="12" cy="18.5" r="1"/><circle cx="18.5" cy="18.5" r="1"/></svg></button>'},close:{tpl:'<button class="f-button" title="{{CLOSE}}" data-fancybox-close><svg><path d="m19.5 4.5-15 15M4.5 4.5l15 15"/></svg></button>'}},parentEl:null}});const Sx={Hash:ox,Html:ux,Images:cx,Slideshow:fx,Thumbs:yx,Toolbar:Ex},Tx=function(){var e=window.getSelection();return e&&"Range"===e.type};let Mx=null,Ax=null;const Cx=new Map;let Lx=0;class Px extends Cb{get isIdle(){return this.idle}get isCompact(){return this.option("compact")}constructor(e=[],t={},i={}){super(t),Object.defineProperty(this,"userSlides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"idle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"idleTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"ignoreFocusChange",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:rx.Init}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"footer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"lastFocus",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prevMouseMoveEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fsAPI",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.fsAPI=(()=>{let e,t="",i="",n="";return document.fullscreenEnabled?(t="requestFullscreen",i="exitFullscreen",n="fullscreenElement"):document.webkitFullscreenEnabled&&(t="webkitRequestFullscreen",i="webkitExitFullscreen",n="webkitFullscreenElement"),t&&(e={request:function(e){return"webkitRequestFullscreen"===t?e[t](Element.ALLOW_KEYBOARD_INPUT):e[t]()},exit:function(){return document[n]&&document[i]()},isFullscreen:function(){return document[n]}}),e})(),this.id=t.id||++Lx,Cx.set(this.id,this),this.userSlides=e,this.userPlugins=i,queueMicrotask((()=>{this.init()}))}init(){if(this.state===rx.Destroy)return;this.state=rx.Init,this.attachPlugins(Object.assign(Object.assign({},Px.Plugins),this.userPlugins)),this.emit("init"),!0===this.option("hideScrollbar")&&(()=>{if(!Qb)return;const e=document.body;if(e.classList.contains("hide-scrollbar"))return;let t=window.innerWidth-document.documentElement.getBoundingClientRect().width;t<0&&(t=0);const i=e.currentStyle||window.getComputedStyle(e),n=parseFloat(i.marginRight);document.documentElement.style.setProperty("--fancybox-scrollbar-compensate",`${t}px`),n&&e.style.setProperty("--fancybox-body-margin",`${n}px`),e.classList.add("hide-scrollbar")})(),this.initLayout(),this.scale();const e=()=>{this.initCarousel(this.userSlides),this.state=rx.Ready,this.attachEvents(),this.emit("ready"),setTimeout((()=>{this.container&&this.container.setAttribute("aria-hidden","false")}),16)},t=this.fsAPI;this.option("Fullscreen.autoStart")&&t&&!t.isFullscreen()?t.request(this.container).then((()=>e())).catch((()=>e())):e()}initLayout(){var e,t;const i=this.option("parentEl")||document.body,n=gb(this.localize(this.option("tpl.main")||""));n&&(n.setAttribute("id",`fancybox-${this.id}`),n.setAttribute("aria-label",this.localize("{{MODAL}}")),n.classList.toggle("is-compact",this.isCompact),Ub(n,this.option("mainClass")||""),this.container=n,this.footer=n.querySelector(".fancybox__footer"),i.appendChild(n),Ub(document.documentElement,"with-fancybox"),Mx&&Ax||(Mx=document.createElement("span"),Ub(Mx,"fancybox-focus-guard"),Mx.setAttribute("tabindex","0"),Mx.setAttribute("aria-hidden","true"),Mx.setAttribute("aria-label","Focus guard"),Ax=Mx.cloneNode(),null===(e=n.parentElement)||void 0===e||e.insertBefore(Mx,n),null===(t=n.parentElement)||void 0===t||t.append(Ax)),this.option("animated")&&(Ub(n,"is-animated"),setTimeout((()=>{this.isClosing()||Nb(n,"is-animated")}),350)),this.emit("initLayout"))}initCarousel(e){const t=this.container;if(!t)return;const i=t.querySelector(".fancybox__carousel");if(!i)return;const n=this.carousel=new Kb(i,Tb({},{slides:e,transition:"fade",Panzoom:{lockAxis:this.option("dragToClose")?"xy":"x",infinite:!!this.option("dragToClose")&&"y"},Dots:!1,Navigation:{classes:{container:"fancybox__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"}},initialPage:this.option("startIndex"),l10n:this.option("l10n")},this.option("Carousel")||{}));n.on("*",((e,t,...i)=>{this.emit(`Carousel.${t}`,e,...i)})),n.on(["ready","change"],(()=>{var e;const t=this.getSlide();t&&(null===(e=t.panzoom)||void 0===e||e.updateControls()),this.manageCaption(t)})),n.on("removeSlide",((e,t)=>{t.closeBtnEl&&t.closeBtnEl.remove(),t.closeBtnEl=void 0,t.captionEl&&t.captionEl.remove(),t.captionEl=void 0,t.spinnerEl&&t.spinnerEl.remove(),t.spinnerEl=void 0,t.state=void 0})),n.on("Panzoom.touchStart",(()=>{this.isCompact||this.endIdle()})),n.on("settle",(()=>{this.idleTimer||this.isCompact||!this.option("idle")||this.setIdle(),this.option("autoFocus")&&this.checkFocus()})),this.option("dragToClose")&&(n.on("Panzoom.afterTransform",((e,t)=>{const i=this.getSlide();if(i&&fb(i.el))return;const n=this.container;if(n){const e=Math.abs(t.current.f),i=e<1?"":Math.max(.5,Math.min(1,1-e/t.contentRect.fitHeight*1.5));n.style.setProperty("--fancybox-ts",i?"0s":""),n.style.setProperty("--fancybox-opacity",i+"")}})),n.on("Panzoom.touchEnd",((e,t,i)=>{var n;const r=this.getSlide();if(r&&fb(r.el))return;if(t.isMobile&&document.activeElement&&-1!==["TEXTAREA","INPUT"].indexOf(null===(n=document.activeElement)||void 0===n?void 0:n.nodeName))return;const s=Math.abs(t.dragOffset.y);"y"===t.lockedAxis&&(s>=200||s>=50&&t.dragOffset.time<300)&&(i&&i.cancelable&&i.preventDefault(),this.close(i,"f-throwOut"+(t.current.f<0?"Up":"Down")))}))),n.on(["change"],(e=>{var t;let i=null===(t=this.getSlide())||void 0===t?void 0:t.triggerEl;if(i){const t=new CustomEvent("slideTo",{bubbles:!0,cancelable:!0,detail:e.page});i.dispatchEvent(t)}})),n.on(["refresh","change"],(e=>{const t=this.container;if(!t)return;for(const i of t.querySelectorAll("[data-fancybox-current-index]"))i.innerHTML=e.page+1;for(const i of t.querySelectorAll("[data-fancybox-count]"))i.innerHTML=e.pages.length;if(!e.isInfinite){for(const i of t.querySelectorAll("[data-fancybox-next]"))e.page<e.pages.length-1?(i.removeAttribute("disabled"),i.removeAttribute("tabindex")):(i.setAttribute("disabled",""),i.setAttribute("tabindex","-1"));for(const i of t.querySelectorAll("[data-fancybox-prev]"))e.page>0?(i.removeAttribute("disabled"),i.removeAttribute("tabindex")):(i.setAttribute("disabled",""),i.setAttribute("tabindex","-1"))}const i=this.getSlide();if(!i)return;let n=i.downloadSrc||"";n||"image"!==i.type||i.error||"string"!=typeof i.src||(n=i.src);for(const e of t.querySelectorAll("[data-fancybox-download]")){const t=i.downloadFilename;n?(e.removeAttribute("disabled"),e.removeAttribute("tabindex"),e.setAttribute("href",n),e.setAttribute("download",t||n),e.setAttribute("target","_blank")):(e.setAttribute("disabled",""),e.setAttribute("tabindex","-1"),e.removeAttribute("href"),e.removeAttribute("download"))}})),this.emit("initCarousel")}attachEvents(){const e=this.container;if(!e)return;e.addEventListener("click",this.onClick,{passive:!1,capture:!1}),e.addEventListener("wheel",this.onWheel,{passive:!1,capture:!1}),document.addEventListener("keydown",this.onKeydown,{passive:!1,capture:!0}),document.addEventListener("visibilitychange",this.onVisibilityChange,!1),document.addEventListener("mousemove",this.onMousemove),this.option("trapFocus")&&document.addEventListener("focus",this.onFocus,!0),window.addEventListener("resize",this.onResize);const t=window.visualViewport;t&&(t.addEventListener("scroll",this.onResize),t.addEventListener("resize",this.onResize))}detachEvents(){const e=this.container;if(!e)return;document.removeEventListener("keydown",this.onKeydown,{passive:!1,capture:!0}),e.removeEventListener("wheel",this.onWheel,{passive:!1,capture:!1}),e.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),document.removeEventListener("mousemove",this.onMousemove),window.removeEventListener("resize",this.onResize);const t=window.visualViewport;t&&(t.removeEventListener("resize",this.onResize),t.removeEventListener("scroll",this.onResize)),document.removeEventListener("visibilitychange",this.onVisibilityChange,!1),document.removeEventListener("focus",this.onFocus,!0)}scale(){const e=this.container;if(!e)return;const t=window.visualViewport,i=Math.max(1,(null==t?void 0:t.scale)||1);let n="",r="",s="";if(t&&i>1){let e=`${t.offsetLeft}px`,a=`${t.offsetTop}px`;n=t.width*i+"px",r=t.height*i+"px",s=`translate3d(${e}, ${a}, 0) scale(${1/i})`}e.style.transform=s,e.style.width=n,e.style.height=r}onClick(e){var t,i;const{container:n,isCompact:r}=this;if(!n||this.isClosing())return;!r&&this.option("idle")&&this.resetIdle();const s=document.activeElement;if(Tx()&&s&&n.contains(s))return;const a=e.composedPath()[0];if(a===(null===(t=this.carousel)||void 0===t?void 0:t.container))return;if(a.closest(".f-spinner")||a.closest("[data-fancybox-close]"))return e.preventDefault(),void this.close(e);if(a.closest("[data-fancybox-prev]"))return e.preventDefault(),void this.prev();if(a.closest("[data-fancybox-next]"))return e.preventDefault(),void this.next();if(r&&"image"===(null===(i=this.getSlide())||void 0===i?void 0:i.type))return void(this.clickTimer?(clearTimeout(this.clickTimer),this.clickTimer=null):this.clickTimer=setTimeout((()=>{this.toggleIdle(),this.clickTimer=null}),350));if(this.emit("click",e),e.defaultPrevented)return;let o=!1;if(a.closest(".fancybox__content")){if(s){if(s.closest("[contenteditable]"))return;a.matches(tx)||s.blur()}if(Tx())return;o=this.option("contentClick")}else a.closest(".fancybox__carousel")&&!a.matches(tx)&&(o=this.option("backdropClick"));"close"===o?(e.preventDefault(),this.close(e)):"next"===o?(e.preventDefault(),this.next()):"prev"===o&&(e.preventDefault(),this.prev())}onWheel(e){const t=this.option("wheel",e),i="slide"===t,n=[-e.deltaX||0,-e.deltaY||0,-e.detail||0].reduce((function(e,t){return Math.abs(t)>Math.abs(e)?t:e})),r=Math.max(-1,Math.min(1,n)),s=Date.now();this.pwt&&s-this.pwt<300?i&&e.preventDefault():(this.pwt=s,this.emit("wheel",e),e.defaultPrevented||("close"===t?(e.preventDefault(),this.close(e)):"slide"===t&&(e.preventDefault(),this[r>0?"prev":"next"]())))}onKeydown(e){if(!this.isTopmost())return;this.isCompact||!this.option("idle")||this.isClosing()||this.resetIdle();const t=e.key,i=this.option("keyboard");if(!i||e.ctrlKey||e.altKey||e.shiftKey)return;const n=e.composedPath()[0],r=document.activeElement&&document.activeElement.classList,s=r&&r.contains("f-button")||n.dataset.carouselPage||n.dataset.carouselIndex;if("Escape"!==t&&!s&&Db(n)&&(n.isContentEditable||-1!==["TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].indexOf(n.nodeName)))return;this.emit("keydown",t,e);const a=i[t];"function"==typeof this[a]&&(e.preventDefault(),this[a]())}onResize(){const e=this.container;if(!e)return;const t=this.isCompact;e.classList.toggle("is-compact",t),this.manageCaption(this.getSlide()),this.isCompact?this.clearIdle():this.endIdle(),this.scale(),this.emit("resize")}onFocus(e){this.isTopmost()&&this.checkFocus(e)}onMousemove(e){this.prevMouseMoveEvent=e,!this.isCompact&&this.option("idle")&&this.resetIdle()}onVisibilityChange(){"visible"===document.visibilityState?this.checkFocus():this.endIdle()}manageCloseBtn(e){const t=this.optionFor(e,"closeButton")||!1;if("auto"===t){const e=this.plugins.Toolbar;if(e&&e.state===xx.Ready)return}if(!t)return;if(!e.contentEl||e.closeBtnEl)return;const i=this.option("tpl.closeButton");if(i){const t=gb(this.localize(i));e.closeBtnEl=e.contentEl.appendChild(t),e.el&&Ub(e.el,"has-close-btn")}}manageCaption(e){var t,i;const n="fancybox__caption",r="has-caption",s=this.container;if(!s)return;const a=this.isCompact||this.option("commonCaption"),o=!a;if(this.caption&&this.stop(this.caption),o&&this.caption&&(this.caption.remove(),this.caption=null),a&&!this.caption)for(const e of(null===(t=this.carousel)||void 0===t?void 0:t.slides)||[])e.captionEl&&(e.captionEl.remove(),e.captionEl=void 0,Nb(e.el,r),null===(i=e.el)||void 0===i||i.removeAttribute("aria-labelledby"));if(e||(e=this.getSlide()),!e||a&&!this.isCurrentSlide(e))return;const l=e.el;let c=this.optionFor(e,"caption","");if("string"!=typeof c||!c.length)return void(a&&this.caption&&this.animate(this.caption,"f-fadeOut",(()=>{var e;null===(e=this.caption)||void 0===e||e.remove(),this.caption=null})));let h=null;if(o){if(h=e.captionEl||null,l&&!h){const t=`fancybox__caption_${this.id}_${e.index}`;h=document.createElement("div"),Ub(h,n),h.setAttribute("id",t),e.captionEl=l.appendChild(h),Ub(l,r),l.setAttribute("aria-labelledby",t)}}else h=this.caption,h||(h=s.querySelector("."+n)),h||(h=document.createElement("div"),h.dataset.fancyboxCaption="",Ub(h,n),h.innerHTML=c,(this.footer||s).prepend(h)),Ub(s,r),this.caption=h;h&&(h.innerHTML=c)}checkFocus(e){var t;const i=document.activeElement||null;i&&(null===(t=this.container)||void 0===t?void 0:t.contains(i))||this.focus(e)}focus(e){var t;if(this.ignoreFocusChange)return;const i=document.activeElement||null,n=(null==e?void 0:e.target)||null,r=this.container,s=this.getSlide();if(!r||!(null===(t=this.carousel)||void 0===t?void 0:t.viewport))return;if(!e&&i&&r.contains(i))return;const a=s&&s.state===sx.Ready?s.el:null;if(!a||a.contains(i)||r===i)return;e&&e.cancelable&&e.preventDefault(),this.ignoreFocusChange=!0;const o=Array.from(r.querySelectorAll(tx));let l=[],c=null;for(let e of o){const t=!e.offsetParent||e.closest('[aria-hidden="true"]'),i=a&&a.contains(e),n=!this.carousel.viewport.contains(e);e===r||(i||n)&&!t?(l.push(e),void 0!==e.dataset.origTabindex&&(e.tabIndex=parseFloat(e.dataset.origTabindex)),e.removeAttribute("data-orig-tabindex"),!e.hasAttribute("autoFocus")&&c||(c=e)):(e.dataset.origTabindex=void 0===e.dataset.origTabindex?e.getAttribute("tabindex")||void 0:e.dataset.origTabindex,e.tabIndex=-1)}let h=null;e?(!n||l.indexOf(n)<0)&&(h=c||r,l.length&&(i===Ax?h=l[0]:this.lastFocus!==r&&i!==Mx||(h=l[l.length-1]))):h=s&&"image"===s.type?r:c||r,h&&ix(h),this.lastFocus=document.activeElement,this.ignoreFocusChange=!1}next(){const e=this.carousel;e&&e.pages.length>1&&e.slideNext()}prev(){const e=this.carousel;e&&e.pages.length>1&&e.slidePrev()}jumpTo(...e){this.carousel&&this.carousel.slideTo(...e)}isTopmost(){var e;return(null===(e=Px.getInstance())||void 0===e?void 0:e.id)==this.id}animate(e=null,t="",i){if(!e||!t)return void(i&&i());this.stop(e);const n=r=>{r.target===e&&e.dataset.animationName&&(e.removeEventListener("animationend",n),delete e.dataset.animationName,i&&i(),Nb(e,t))};e.dataset.animationName=t,e.addEventListener("animationend",n),Ub(e,t)}stop(e){e&&e.dispatchEvent(new CustomEvent("animationend",{bubbles:!1,cancelable:!0,currentTarget:e}))}setContent(e,t="",i=!0){if(this.isClosing())return;const n=e.el;if(!n)return;let r=null;if(Db(t)?r=t:(r=gb(t+""),Db(r)||(r=document.createElement("div"),r.innerHTML=t+"")),["img","picture","iframe","video","audio"].includes(r.nodeName.toLowerCase())){const e=document.createElement("div");e.appendChild(r),r=e}Db(r)&&e.filter&&!e.error&&(r=r.querySelector(e.filter)),r&&Db(r)?(Ub(r,"fancybox__content"),e.id&&r.setAttribute("id",e.id),"none"!==r.style.display&&"none"!==getComputedStyle(r).getPropertyValue("display")||(r.style.display=e.display||this.option("defaultDisplay")||"flex"),n.classList.add(`has-${e.error?"error":e.type||"unknown"}`),n.prepend(r),e.contentEl=r,i&&this.revealContent(e),this.manageCloseBtn(e),this.manageCaption(e)):this.setError(e,"{{ELEMENT_NOT_FOUND}}")}revealContent(e,t){const i=e.el,n=e.contentEl;i&&n&&(this.emit("reveal",e),this.hideLoading(e),e.state=sx.Opening,(t=this.isOpeningSlide(e)?void 0===t?this.optionFor(e,"showClass"):t:"f-fadeIn")?this.animate(n,t,(()=>{this.done(e)})):this.done(e))}done(e){this.isClosing()||(e.state=sx.Ready,this.emit("done",e),Ub(e.el,"is-done"),this.isCurrentSlide(e)&&this.option("autoFocus")&&queueMicrotask((()=>{this.option("autoFocus")&&(this.option("autoFocus")?this.focus():this.checkFocus())})),this.isOpeningSlide(e)&&!this.isCompact&&this.option("idle")&&this.setIdle())}isCurrentSlide(e){const t=this.getSlide();return!(!e||!t)&&t.index===e.index}isOpeningSlide(e){var t,i;return null===(null===(t=this.carousel)||void 0===t?void 0:t.prevPage)&&e.index===(null===(i=this.getSlide())||void 0===i?void 0:i.index)}showLoading(e){e.state=sx.Loading;const t=e.el;t&&(Ub(t,"is-loading"),this.emit("loading",e),e.spinnerEl||setTimeout((()=>{if(!this.isClosing()&&!e.spinnerEl&&e.state===sx.Loading){let i=gb(Ib);e.spinnerEl=i,t.prepend(i),this.animate(i,"f-fadeIn")}}),250))}hideLoading(e){const t=e.el;if(!t)return;const i=e.spinnerEl;this.isClosing()?null==i||i.remove():(Nb(t,"is-loading"),i&&this.animate(i,"f-fadeOut",(()=>{i.remove()})),e.state===sx.Loading&&(this.emit("loaded",e),e.state=sx.Ready))}setError(e,t){if(this.isClosing())return;this.emit("error"),e.error=t,this.hideLoading(e),this.clearContent(e);const i=document.createElement("div");i.classList.add("fancybox-error"),i.innerHTML=this.localize(t||"<p>{{ERROR}}</p>"),this.setContent(e,i)}clearContent(e){var t;null===(t=this.carousel)||void 0===t||t.emit("removeSlide",e),e.contentEl&&(e.contentEl.remove(),e.contentEl=void 0),e.closeBtnEl&&(e.closeBtnEl.remove(),e.closeBtnEl=void 0);const i=e.el;i&&(Nb(i,"is-loading"),Nb(i,"has-error"),Nb(i,"has-unknown"),Nb(i,`has-${e.type||"unknown"}`))}getSlide(){var e;const t=this.carousel;return(null===(e=null==t?void 0:t.pages[null==t?void 0:t.page])||void 0===e?void 0:e.slides[0])||void 0}close(e,t){if(this.isClosing())return;const i=new Event("shouldClose",{bubbles:!0,cancelable:!0});if(this.emit("shouldClose",i,e),i.defaultPrevented)return;e&&e.cancelable&&(e.preventDefault(),e.stopPropagation());const n=this.fsAPI,r=()=>{this.proceedClose(e,t)};n&&n.isFullscreen()?Promise.resolve(n.exit()).then((()=>r())):r()}clearIdle(){this.idleTimer&&clearTimeout(this.idleTimer),this.idleTimer=null}setIdle(e=!1){const t=()=>{this.clearIdle(),this.idle=!0,Ub(this.container,"is-idle"),this.emit("setIdle")};if(this.clearIdle(),!this.isClosing())if(e)t();else{const e=this.option("idle");e&&(this.idleTimer=setTimeout(t,e))}}endIdle(){this.clearIdle(),this.idle&&!this.isClosing()&&(this.idle=!1,Nb(this.container,"is-idle"),this.emit("endIdle"))}resetIdle(){this.endIdle(),this.setIdle()}toggleIdle(){this.idle?this.endIdle():this.setIdle(!0)}toggleFullscreen(){const e=this.fsAPI;e&&(e.isFullscreen()?e.exit():this.container&&e.request(this.container))}isClosing(){return[rx.Closing,rx.CustomClosing,rx.Destroy].includes(this.state)}proceedClose(e,t){var i,n;this.state=rx.Closing,this.clearIdle(),this.detachEvents();const r=this.container,s=this.carousel,a=this.getSlide(),o=a&&this.option("placeFocusBack")?a.triggerEl||this.option("trigger"):null;if(o&&(Jb(o)?ix(o):o.focus()),r&&(Ub(r,"is-closing"),r.setAttribute("aria-hidden","true"),this.option("animated")&&Ub(r,"is-animated"),r.style.pointerEvents="none"),s){s.clearTransitions(),null===(i=s.panzoom)||void 0===i||i.destroy(),null===(n=s.plugins.Navigation)||void 0===n||n.detach();for(const e of s.slides){e.state=sx.Closing,this.hideLoading(e);const t=e.contentEl;t&&this.stop(t);const i=null==e?void 0:e.panzoom;i&&(i.stop(),i.detachEvents(),i.detachObserver()),this.isCurrentSlide(e)||s.emit("removeSlide",e)}}this.emit("close",e),this.state!==rx.CustomClosing?(void 0===t&&a&&(t=this.optionFor(a,"hideClass")),t&&a?(this.animate(a.contentEl,t,(()=>{s&&s.emit("removeSlide",a)})),setTimeout((()=>{this.destroy()}),500)):this.destroy()):setTimeout((()=>{this.destroy()}),500)}destroy(){var e;if(this.state===rx.Destroy)return;this.state=rx.Destroy,null===(e=this.carousel)||void 0===e||e.destroy();const t=this.container;t&&t.remove(),Cx.delete(this.id);const i=Px.getInstance();i?i.focus():(Mx&&(Mx.remove(),Mx=null),Ax&&(Ax.remove(),Ax=null),Nb(document.documentElement,"with-fancybox"),(()=>{if(!Qb)return;const e=document,t=e.body;t.classList.remove("hide-scrollbar"),t.style.setProperty("--fancybox-body-margin",""),e.documentElement.style.setProperty("--fancybox-scrollbar-compensate","")})(),this.emit("destroy"))}static bind(e,t,i){if(!Qb)return;let n,r="",s={};if(void 0===e?n=document.body:"string"==typeof e?(n=document.body,r=e,"object"==typeof t&&(s=t||{})):(n=e,"string"==typeof t&&(r=t),"object"==typeof i&&(s=i||{})),!n||!Db(n))return;r=r||"[data-fancybox]";const a=Px.openers.get(n)||new Map;a.set(r,s),Px.openers.set(n,a),1===a.size&&n.addEventListener("click",Px.fromEvent)}static unbind(e,t){let i,n="";if("string"==typeof e?(i=document.body,n=e):(i=e,"string"==typeof t&&(n=t)),!i)return;const r=Px.openers.get(i);r&&n&&r.delete(n),n&&r||(Px.openers.delete(i),i.removeEventListener("click",Px.fromEvent))}static destroy(){let e;for(;e=Px.getInstance();)e.destroy();for(const e of Px.openers.keys())e.removeEventListener("click",Px.fromEvent);Px.openers=new Map}static fromEvent(e){if(e.defaultPrevented)return;if(e.button&&0!==e.button)return;if(e.ctrlKey||e.metaKey||e.shiftKey)return;let t=e.composedPath()[0];const i=t.closest("[data-fancybox-trigger]");if(i){const e=i.dataset.fancyboxTrigger||"",n=document.querySelectorAll(`[data-fancybox="${e}"]`),r=parseInt(i.dataset.fancyboxIndex||"",10)||0;t=n[r]||t}if(!(t&&t instanceof Element))return;let n,r,s,a;if([...Px.openers].reverse().find((([e,i])=>!(!e.contains(t)||![...i].reverse().find((([i,o])=>{let l=t.closest(i);return!!l&&(n=e,r=i,s=l,a=o,!0)}))))),!n||!r||!s)return;a=a||{},e.preventDefault(),t=s;let o=[],l=Tb({},nx,a);l.event=e,l.trigger=t,l.delegate=i;const c=l.groupAll,h=l.groupAttr,d=h&&t?t.getAttribute(`${h}`):"";if((!t||d||c)&&(o=[].slice.call(n.querySelectorAll(r))),t&&!c&&(o=d?o.filter((e=>e.getAttribute(`${h}`)===d)):[t]),!o.length)return;const u=Px.getInstance();return u&&u.options.trigger&&o.indexOf(u.options.trigger)>-1?void 0:(t&&(l.startIndex=o.indexOf(t)),Px.fromNodes(o,l))}static fromSelector(e,t){let i=null,n="";if("string"==typeof e?(i=document.body,n=e):e instanceof HTMLElement&&"string"==typeof t&&(i=e,n=t),!i||!n)return!1;const r=Px.openers.get(i);if(!r)return!1;const s=r.get(n);return!!s&&Px.fromNodes(Array.from(i.querySelectorAll(n)),s)}static fromNodes(e,t){t=Tb({},nx,t||{});const i=[];for(const n of e){const e=n.dataset||{},r=e.src||n.getAttribute("href")||n.getAttribute("currentSrc")||n.getAttribute("src")||void 0;let s;const a=t.delegate;let o;a&&i.length===t.startIndex&&(s=a instanceof HTMLImageElement?a:a.querySelector("img:not([aria-hidden])")),s||(s=n instanceof HTMLImageElement?n:n.querySelector("img:not([aria-hidden])")),s&&(o=s.currentSrc||s.src||void 0,!o&&s.dataset&&(o=s.dataset.lazySrc||s.dataset.src||void 0));const l={src:r,triggerEl:n,thumbEl:s,thumbElSrc:o,thumbSrc:o};for(const t in e)"fancybox"!==t&&(l[t]=e[t]+"");i.push(l)}return new Px(i,t)}static getInstance(e){return e?Cx.get(e):Array.from(Cx.values()).reverse().find((e=>!e.isClosing()&&e))||null}static getSlide(){var e;return(null===(e=Px.getInstance())||void 0===e?void 0:e.getSlide())||null}static show(e=[],t={}){return new Px(e,t)}static next(){const e=Px.getInstance();e&&e.next()}static prev(){const e=Px.getInstance();e&&e.prev()}static close(e=!0,...t){if(e)for(const e of Cx.values())e.close(...t);else{const e=Px.getInstance();e&&e.close(...t)}}}Object.defineProperty(Px,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.17"}),Object.defineProperty(Px,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:nx}),Object.defineProperty(Px,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:Sx}),Object.defineProperty(Px,"openers",{enumerable:!0,configurable:!0,writable:!0,value:new Map});const Rx=window.parent,Ox=document.querySelectorAll(".stages__img img");Ox.length>0&&Ox.forEach((e=>{e.addEventListener("click",(()=>{Rx.document.body.classList.add("gallery-open")}))}));const Ix=function(){const e=window.parent;return function(t,i=!1){cb(e.document.documentElement,"show-work-preloader"),hb({el:e,event:"preload-next-work",detail:{currentWork:t,isClicked:!0}}),setTimeout((()=>{hb({el:e,event:"show-next-work",detail:{isCollect:i}})}),1e3)}}();i(680);const Dx=function(){const e=window.parent.document.querySelector(".preloader-work__total span"),t=JSON.parse(sessionStorage.getItem("isPreloadOnTrigger"));return sessionStorage.removeItem("isPreloadOnTrigger"),e&&!t?function(t){e.innerHTML=Math.floor(100*t)}:function(e){}}();window.addEventListener("DOMContentLoaded",(()=>{window.gsap=Hn,window.ScrollToPlugin=lo,window.ScrollTrigger=Ua,window.Swiper=al,window.Navigation=ll,window.Autoplay=dl,window.Pagination=hl,window.EffectFade=pl,window.Viewer=By,window.GyroscopePlugin=Jy,Hn.registerPlugin(Ua,lo),setTimeout((()=>{!async function(){const e=function(){const e=[...document.querySelectorAll("[data-preload]")];if(!e.length)return[];const t=[],i=e.filter((e=>{const i=e.getAttribute("data-preload-query");if(i){const[n,r]=i.split(",").map((e=>e.trim())),s=ob(n,r);return!s&&t.push(e),s}return!0}));return t.forEach((e=>e.style.display="none")),i}();if(!e.length)return Dx(1),hb({el:window.parent,event:"work-page-ready"}),void hb({el:window,event:"work-page-ready-local"});try{const t=await async function(e){return new Promise(((t,i)=>{const n=new createjs.LoadQueue(!0,null,!0);n.on("progress",(async e=>{Dx(e.loaded)})),n.on("complete",(()=>{const i=e.reduce(((e,t)=>(e[t.id]=URL.createObjectURL(n.getResult(t.id,!0)),e)),{});t(i)})),n.on("error",(e=>{i(e)})),n.loadManifest(e)}))}(function(e){const t=e.map(((e,t)=>{const i=e.tagName;return(new createjs.LoadItem).set({id:`${t}-${i}`,src:e.getAttribute("data-preload"),type:createjs.AbstractLoader.BLOB})}));return t}(e));!function(e,t){t.forEach(((t,i)=>{const n=t.tagName;t.src=e[`${i}-${n}`]}))}(t,e)}catch(e){Dx(1),console.log(e)}hb({el:window.parent,event:"work-page-ready"}),hb({el:window,event:"work-page-ready-local"})}()}),700),function(){window.lenisScroll=new ab({lerp:.1,normalizeWheel:!0,smoothWheel:!0,wheelMultiplier:1,smoothTouch:!1}),lenisScroll.on("scroll",ScrollTrigger.update);const e=t=>{lenisScroll.raf(t),requestAnimationFrame(e)};requestAnimationFrame(e)}(),function(){function e(e){return JSON.parse(sessionStorage.getItem(e))}function t(e){let t="";return t=e.content.isImg?`<img src='${e.content.media}' alt="">`:`<video class="next-work-media" src="${e.content.media}" loop muted playsinline></video>`,t}!function(){const i=window.parent;if(sessionStorage.getItem("nextWorkInfo")){const n=e("nextWorkInfo");!function(e){const i=document.querySelector(".intro-second .intro__img");document.querySelector(".intro__bg-title").innerHTML=e.content.title,i.innerHTML=t(e)}(n[0]),function(e){const i=document.querySelector(".advise__list");e.forEach((e=>{i.innerHTML+=`\n            <div class="advise__card tap-animation">\n                  <a href="#" data-work-name="${e.content.dataWorkName}">\n                      <div class="advise__card-img">\n                          ${t(e)}\n                      </div>\n                      <div class="advise__card-title">\n                          <h6>${e.content.title}</h6>\n                      </div>\n                      <div class="advise__card-text">\n                          <span>${e.content.subtitle}</span>\n                      </div>\n                  </a>\n              </div>\n      `}))}(n),n.some((e=>!e.content.isImg))&&gsap.timeline({scrollTrigger:{trigger:".advise",start:"top bottom",end:"+=1",once:!0,onEnter:()=>{document.querySelectorAll(".next-work-media").forEach((e=>e.play())),hb({el:window.parent,event:"play-next-video"})}}}),function(t){gsap.timeline({scrollTrigger:{trigger:document.body,start:"10% center",end:"+=1",once:!0,onEnter:()=>{db("isPreloadOnTrigger",!0),hb({el:t,event:"preload-next-work",detail:{isClicked:!1}}),e("worksCollection")?.length||cb(document.body,"hide-prev-btn")}}})}(i),hb({el:window,event:"next-work"}),function(t){document.querySelectorAll("[data-click]").forEach((i=>{i.addEventListener("click",(n=>{switch(i.getAttribute("data-click")){case"prev":!function(e){const t=e.pop();Ix(t,!0),db("worksCollection",e)}(e("worksCollection"));break;case"next":document.querySelector(".intro-second").classList.add("introNext"),lenisScroll.stop(),cb(document.body,"no-scroll-intro2"),setTimeout((()=>{!function(e){hb({el:e,event:"show-next-work"})}(t)}),1100);break;default:console.log("there is no such action in showWorkOnClick")}}))}))}(i),window.parent.addEventListener("play-next-video",(()=>{document.querySelector(".intro__img video")?.play()}))}else console.log("there is no nextWorkInfo in sessionStorage")}()}(),document.querySelectorAll("[data-work-name]").forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault(),Ix(e.getAttribute("data-work-name"))}))})),Px.bind("[data-fancybox]",{Image:{zoom:!1},on:{init:()=>{lenisScroll.stop()},done:()=>{const e=document.querySelector("[data-fancybox-close]");var t;t=e,window.addEventListener("click",(e=>{e.target.closest("img")||t.click()}))},close:()=>{lenisScroll.start(),Rx.document.body.classList.remove("gallery-open")}}}),function(){const e=document.querySelectorAll(".tap-animation");function t(e){cb(e,"tap")}function i(e){!function(e,t="active"){e.classList.remove(t)}(e,"tap")}lb?e.forEach((e=>{e.addEventListener("touchstart",(i=>{t(e)})),e.addEventListener("touchend",(t=>{i(e)}))})):e.forEach((e=>{e.addEventListener("mousedown",(i=>{t(e)})),e.addEventListener("mouseup",(t=>{i(e)}))}))}(),function(){const e=document.querySelectorAll(".video-control__bar_passive"),t=document.querySelectorAll(".video-control__bar_active"),i=document.querySelectorAll(".video-control__bar_load"),n=document.querySelectorAll(".video-control__play"),r=document.querySelectorAll(".video-control__pause"),s=document.querySelectorAll(".video-control__time p"),a=document.querySelectorAll("[data-video]"),o=document.querySelectorAll(".video-control"),l=document.querySelectorAll(".stages__video-play"),c=[];function h(e){return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`}window.addEventListener("work-page-ready-local",(()=>{t.forEach(((e,t)=>{console.log(a[t].duration);const i=gsap.timeline();i.to(e,{width:"100%",duration:a[t].duration,ease:"none",onComplete:()=>{i.restart(),a[t].currentTime=0}}),0!==t&&i.pause(),c.push(i),i.pause()})),gsap.timeline({scrollTrigger:{trigger:a[0],start:"top bottom",end:"top bottom",onEnter:()=>{c[0].play(),a[0].play()}}})})),l.length>0&&o.length>0&&(l[0].classList.add("active"),o[0].classList.add("active"),l.forEach(((e,t)=>{e.addEventListener("click",(()=>{c[t].play(),e.classList.add("active"),o[t].classList.add("active"),a[t].play(),n[t].classList.remove("active"),r[t].classList.add("active")}))}))),e.forEach(((e,t)=>{e.addEventListener("input",(i=>{const n=e.value;c[t].progress(n/100).pause(),setTimeout((()=>{c[t].play()}),100),a[t].currentTime=a[t].duration*n/100,s[t].innerText=`${h(a[t].currentTime)}`}))})),a.forEach(((e,t)=>{e.addEventListener("timeupdate",(()=>{e.currentTime,e.duration,s[t].innerText=`${h(e.currentTime)}`})),e.addEventListener("progress",(()=>{if(e.buffered.length>0){const n=e.buffered.end(e.buffered.length-1),r=e.duration;if(r>0){const e=n/r*100;i[t].style.width=`${e}%`}}})),e.addEventListener("click",(()=>{e.paused?(e.play(),n[t].classList.remove("active"),r[t].classList.add("active"),l[t].classList.add("active"),o[t].classList.add("active"),c[t].play()):(e.pause(),r[t].classList.remove("active"),n[t].classList.add("active"),l[t].classList.remove("active"),o[t].classList.remove("active"),c[t].pause())}))})),n.forEach(((e,t)=>{0!==t&&e.classList.add("active"),e.addEventListener("click",(()=>{c[t].play(),e.classList.remove("active"),r[t].classList.add("active"),a[t].play(),l[t].classList.add("active"),o[t].classList.add("active")}))})),r.forEach(((e,t)=>{0===t&&e.classList.add("active"),e.addEventListener("click",(()=>{c[t].pause(),a[t].pause(),e.classList.remove("active"),n[t].classList.add("active"),l[t].classList.remove("active"),o[t].classList.remove("active")}))})),a[0]?.pause()}(),function(){let e=gsap.matchMedia();e.add("(max-width: 4000px) and (min-width: 767.99px)",(()=>{gsap.utils.toArray(".gs-anim").forEach((e=>{gsap.from(e,{yPercent:100,duration:1,opacity:0,scrollTrigger:{trigger:e,start:"top bottom",end:"bottom bottom"}})})),gsap.utils.toArray(".gs-anim-more").forEach((e=>{gsap.from(e,{yPercent:100,duration:1,opacity:0,scrollTrigger:{trigger:e,start:"-=200 bottom",end:"bottom bottom"}})})),gsap.utils.toArray(".gs-anim-img").forEach((e=>{gsap.from(e,{yPercent:10,duration:1,opacity:0,scrollTrigger:{trigger:e,start:"top 85%",end:"bottom bottom"}})}))})),e.add("(max-width: 767.98px) and (min-width: 320px)",(()=>{gsap.utils.toArray(".gs-anim").forEach((e=>{gsap.from(e,{yPercent:10,duration:1,opacity:0,scrollTrigger:{trigger:e,start:"top bottom",end:"bottom bottom"}})})),gsap.utils.toArray(".gs-anim-more").forEach((e=>{gsap.from(e,{yPercent:10,duration:1,opacity:0,scrollTrigger:{trigger:e,start:"-=200 bottom",end:"bottom bottom"}})})),gsap.utils.toArray(".gs-anim-img").forEach((e=>{gsap.from(e,{yPercent:10,duration:1,opacity:0,scrollTrigger:{trigger:e,start:"top 85%",end:"bottom bottom"}})}))}))}(),function(){const e=document.querySelectorAll(".intro__bg-btn__wrapper"),t=document.querySelectorAll(".intro__bg-btn__container"),i=document.querySelectorAll(".intro__bg-btn");/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Tablet|KFAPWI/i.test(navigator.userAgent)||e.forEach(((n,r)=>{e[r].addEventListener("mousemove",(e=>{const t=e.offsetX,n=e.offsetY;gsap.to(i[r],{y:Math.min(Math.max(n,20),44)-i[r].offsetHeight/2,x:Math.min(Math.max(t,80),90)-i[r].offsetWidth/2,duration:.5})})),e[r].addEventListener("mouseleave",(()=>{gsap.to(i[r],{x:0,y:0,duration:.5}),gsap.to(t[r],{scale:1,duration:.5}),gsap.to(i[r],{scale:1,duration:.5})})),e[r].addEventListener("mouseenter",(()=>{gsap.to(t[r],{scale:1.5,duration:.5}),gsap.to(i[r],{scale:.7,duration:.5})}))}))}(),function(){const e=document.querySelector(".best-collections__draggable-hand");e&&(e.addEventListener("click",(()=>{e.classList.add("hide"),n()})),e.addEventListener("touchstart",(()=>{e.classList.add("hide"),n()})));const t=(e,i,n=10)=>{n<=0||(i.querySelector(".swiper-pagination-progressbar-fill")?((e,t)=>{const i=t.querySelector(".swiper-pagination-progressbar-fill");if(i){let t;t=e.isEnd?100:e.activeIndex/(e.slides.length-1)*90+10,i.style.width=`${t}%`}})(e,i):setTimeout((()=>{t(e,i,n-1)}),100))},i=new IntersectionObserver(((e,i)=>{e.forEach((e=>{if(e.isIntersecting){const n=e.target,r=null!==n.querySelector("video"),s=n.classList.contains("visual-collections__swiper");let a;r&&n.classList.add("best-collections__swiper-video"),s?a={modules:[Pagination],slidesPerView:"auto",spaceBetween:10,freeMode:!0,speed:1500,breakpoints:{992:{spaceBetween:40}},pagination:{el:n.querySelector(".best-collections__swiper-pagination"),type:"progressbar",clickable:!0},on:{init:function(){((e,t)=>{const i=t.querySelector(".visual-collections__swiper .swiper-pagination");i.addEventListener("click",(function(t){const n=i.offsetWidth,r=t.offsetX,s=Math.round(r/n*(e.slides.length-1));e.slideTo(s)}))})(this,n),t(this,n)},slideChange:function(){t(this,n)},progress:function(){t(this,n)}}}:(a={modules:[Pagination,EffectFade,Navigation],spaceBetween:30,centeredSlides:!0,speed:1500,watchSlidesProgress:!0,pagination:{el:n.querySelector(".best-collections__swiper-pagination"),clickable:!0,renderBullet:function(e,t){const i=document.createElement("span");i.className="swiper-pagination-bullet "+t;const n=document.createElement("span");return n.className="autoplay-progress",i.appendChild(n),i.outerHTML}}},r||(a.modules.push(Autoplay),a.autoplay={delay:2500,disableOnInteraction:!1},a.on={autoplayTimeLeft(e,t,i){n.querySelectorAll(".swiper-pagination-bullet").forEach((e=>{if(e.classList.contains("swiper-pagination-bullet-active")){const t=e.querySelector(".autoplay-progress");t&&(t.style.width=100*(1-i)+"%")}}))}})),new Swiper(n,a),i.unobserve(n)}}))}),{threshold:0});function n(){document.querySelectorAll(".viewer-container").forEach((e=>{const t=e.querySelector(".best-collections__img img").getAttribute("src");e.innerHTML="",new Viewer({container:e,panorama:t,plugins:[GyroscopePlugin],navbar:!1,mousewheel:!1,GyroscopePluginConfig:{absolutePosition:!0,moveMode:"smooth",touchmove:!0}})}))}document.querySelectorAll(".best-collections__swiper.swiper").forEach((e=>{i.observe(e)})),document.querySelectorAll(".best-collections__swiper-viewer.swiper").forEach((e=>{new Swiper(e,{modules:[Pagination,Navigation],allowTouchMove:!1,speed:1500,pagination:{el:".best-collections__swiper-viewer-pagination.swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})}))}(),ub()})),window.addEventListener("next-work",(e=>{ub()}))})()})();